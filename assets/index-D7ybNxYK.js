import{t as fr,c as jr,r as o,j as e,V as zt,R as qt,a as rs,A as Bt,C as Gt,b as Vt,T as Ht,D as Wt,P as vr,d as Yt,e as S,S as yr,f as Kt,g as Nr,h as br,i as Jt,k as wr,l as Sr,m as Ks,X as nt,n as Zt,L as Xt,o as Qt,p as it,q as ea,s as sa,I as ta,u as _r,v as kr,w as aa,x as ra,F as na,y as ia,z as Cr,B as la,E as Pr,G as oa,H as ca,J as da,K as ma,M as ua,N as ha,O as Ar,Q as xa,U as pa,W as Ir,Y as Rr,Z as ga,_ as Mr,$ as fa,a0 as Er,a1 as ja,a2 as va,a3 as Tr,a4 as Dr,a5 as ya,a6 as ze,a7 as Na,a8 as Js,a9 as us,aa as Nt,ab as bt,ac as gs,ad as wt,ae as Lr,af as Fr,ag as Or,ah as ba,ai as wa,aj as St,ak as Sa,al as _a,am as ka,an as $r,ao as Ur,ap as zr,aq as Ca,ar as Pa,as as Aa,at as qr,au as le,av as Zs,aw as cs,ax as Br,ay as lt,az as Gr,aA as Ps,aB as Vr,aC as Ia,aD as Ra,aE as Ke,aF as We,aG as je,aH as _t,aI as Ma,aJ as Xs,aK as $e,aL as Ea,aM as As,aN as Hr,aO as Wr,aP as Yr,aQ as Qs,aR as ts,aS as ot,aT as Kr,aU as Jr,aV as Zr,aW as Ye,aX as qe,aY as Ds,aZ as Je,a_ as Ze,a$ as Xe,b0 as Be,b1 as hs,b2 as Xr,b3 as Qr,b4 as ct,b5 as Gs,b6 as en,b7 as sn,b8 as tn,b9 as kt,ba as Ct,bb as an,bc as rn,bd as Is,be as Ls,bf as nn,bg as Ta,bh as ln,bi as Da,bj as on,bk as La,bl as cn,bm as Fa,bn as dn,bo as Oa,bp as mn,bq as $a,br as Ua,bs as un,bt as hn,bu as za,bv as xn,bw as pn,bx as Pt,by as gn,bz as fn,bA as jn,bB as vn,bC as yn,bD as qa,bE as os,bF as Nn,bG as Ba,bH as bn,bI as wn,bJ as Sn,bK as _n,bL as Ga,bM as kn,bN as Cn,bO as Pn,bP as An,bQ as In,bR as Rn,bS as Va,bT as Mn,bU as Ha,bV as En,bW as Tn,bX as Dn,bY as Ln,bZ as Fn,b_ as re,b$ as On,c0 as $n,c1 as Un,c2 as zn,c3 as qn,c4 as Bn,c5 as Gn,c6 as Vn}from"./vendor-B-hfc2Y7.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}})();function _(...s){return fr(jr(s))}function B(s){return new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)}function Rs(s){return new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"long",year:"numeric"}).format(new Date(s))}function Wa(s){return new Intl.NumberFormat("en-GB").format(s)}const Hn=vr,Ya=o.forwardRef(({className:s,...a},t)=>e.jsx(zt,{ref:t,className:_("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...a}));Ya.displayName=zt.displayName;const Wn=rs("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ka=o.forwardRef(({className:s,variant:a,...t},r)=>e.jsx(qt,{ref:r,className:_(Wn({variant:a}),s),...t}));Ka.displayName=qt.displayName;const Yn=o.forwardRef(({className:s,...a},t)=>e.jsx(Bt,{ref:t,className:_("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...a}));Yn.displayName=Bt.displayName;const Ja=o.forwardRef(({className:s,...a},t)=>e.jsx(Gt,{ref:t,className:_("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...a,children:e.jsx(Vt,{className:"h-4 w-4"})}));Ja.displayName=Gt.displayName;const Za=o.forwardRef(({className:s,...a},t)=>e.jsx(Ht,{ref:t,className:_("text-sm font-semibold [&+div]:text-xs",s),...a}));Za.displayName=Ht.displayName;const Xa=o.forwardRef(({className:s,...a},t)=>e.jsx(Wt,{ref:t,className:_("text-sm opacity-90",s),...a}));Xa.displayName=Wt.displayName;const Kn=1,Jn=1e6;let Vs=0;function Zn(){return Vs=(Vs+1)%Number.MAX_SAFE_INTEGER,Vs.toString()}const Hs=new Map,At=s=>{if(Hs.has(s))return;const a=setTimeout(()=>{Hs.delete(s),ds({type:"REMOVE_TOAST",toastId:s})},Jn);Hs.set(s,a)},Xn=(s,a)=>{switch(a.type){case"ADD_TOAST":return{...s,toasts:[a.toast,...s.toasts].slice(0,Kn)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(t=>t.id===a.toast.id?{...t,...a.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=a;return t?At(t):s.toasts.forEach(r=>{At(r.id)}),{...s,toasts:s.toasts.map(r=>r.id===t||t===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return a.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==a.toastId)}}},Ms=[];let Es={toasts:[]};function ds(s){Es=Xn(Es,s),Ms.forEach(a=>{a(Es)})}function Qn({...s}){const a=Zn(),t=i=>ds({type:"UPDATE_TOAST",toast:{...i,id:a}}),r=()=>ds({type:"DISMISS_TOAST",toastId:a});return ds({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:i=>{i||r()}}}),{id:a,dismiss:r,update:t}}function Ce(){const[s,a]=o.useState(Es);return o.useEffect(()=>(Ms.push(a),()=>{const t=Ms.indexOf(a);t>-1&&Ms.splice(t,1)}),[s]),{...s,toast:Qn,dismiss:t=>ds({type:"DISMISS_TOAST",toastId:t})}}function ei(){const{toasts:s}=Ce();return e.jsxs(Hn,{children:[s.map(function({id:a,title:t,description:r,action:i,...l}){return e.jsxs(Ka,{...l,children:[e.jsxs("div",{className:"grid gap-1",children:[t&&e.jsx(Za,{children:t}),r&&e.jsx(Xa,{children:r})]}),i,e.jsx(Ja,{})]},a)}),e.jsx(Ya,{})]})}const si="https://zcuapuvvygahkzljuhyg.supabase.co",ti="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpjdWFwdXZ2eWdhaGt6bGp1aHlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc5MTQwMzcsImV4cCI6MjA1MzQ5MDAzN30.GIhphzkznmDXgrUApGW479uHHluqDWqy_9cfG5sU5Xc",ge=Yt(si,ti),Qa=o.createContext({user:null,session:null,profile:null,isLoading:!0,signOut:async()=>{},refreshSession:async()=>{}}),Ws=async s=>{try{const{data:a,error:t}=await ge.from("profiles").select("*").eq("id",s).single();return t?(console.error("Error fetching profile:",t),null):(console.log("Fetched profile data:",a),a)}catch(a){return console.error("Error in fetchProfile:",a),null}},er=({children:s})=>{const[a,t]=o.useState(null),[r,i]=o.useState(null),[l,n]=o.useState(null),[f,h]=o.useState(!0),N=async()=>{var j,y;try{h(!0),console.log("Refreshing session...");const{data:v,error:L}=await ge.auth.getSession();if(L)throw L;if(console.log("Session data:",v),i(v.session),t(((j=v.session)==null?void 0:j.user)||null),(y=v.session)!=null&&y.user){const b=await Ws(v.session.user.id);n(b)}else n(null)}catch(v){console.error("Error refreshing session:",v),t(null),n(null),i(null)}finally{h(!1)}},p=async()=>{try{h(!0);const{error:j}=await ge.auth.signOut();if(j)throw j;t(null),n(null),i(null)}catch(j){console.error("Error signing out:",j)}finally{h(!1)}};o.useEffect(()=>{const y=(async()=>{var L,b;h(!0),console.log("Initializing auth...");try{const{data:d,error:c}=await ge.auth.getSession();if(c)throw c;if(console.log("Initial session data:",d),i(d.session),t(((L=d.session)==null?void 0:L.user)||null),(b=d.session)!=null&&b.user){const w=await Ws(d.session.user.id);n(w)}}catch(d){console.error("Error initializing auth:",d)}finally{h(!1)}const{data:v}=ge.auth.onAuthStateChange(async(d,c)=>{if(console.log("Auth state changed:",d,c),i(c),t((c==null?void 0:c.user)||null),c!=null&&c.user){const w=await Ws(c.user.id);n(w)}else n(null)});return()=>{v.subscription.unsubscribe()}})();return()=>{y.then(v=>v&&v())}},[]);const g={user:a,session:r,profile:l,isLoading:f,signOut:p,refreshSession:N};return S.createElement(Qa.Provider,{value:g},s)};function ee(){return o.useContext(Qa)}function ai({className:s}){return e.jsx("div",{className:_("flex items-center justify-center",s),children:e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"})})}function ri({isAnimating:s}){const[a,t]=o.useState(0);return o.useEffect(()=>{if(!s){t(0);return}t(10);const r=setTimeout(()=>t(30),100),i=setTimeout(()=>t(60),500),l=setTimeout(()=>t(80),800),n=setTimeout(()=>t(100),1e3);return()=>{clearTimeout(r),clearTimeout(i),clearTimeout(l),clearTimeout(n)}},[s]),!s&&a===0?null:e.jsx("div",{className:"fixed top-0 left-0 right-0 z-50",children:e.jsx("div",{className:"h-1 bg-primary transition-all duration-300 ease-in-out",style:{width:`${a}%`,opacity:a===100?0:1}})})}const ni=rs("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),k=o.forwardRef(({className:s,variant:a,size:t,asChild:r=!1,...i},l)=>{const n=r?yr:"button";return e.jsx(n,{className:_(ni({variant:a,size:t,className:s})),ref:l,...i})});k.displayName="Button";const ss=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Kt,{ref:r,className:_("relative overflow-hidden",s),...t,children:[e.jsx(Nr,{className:"h-full w-full rounded-[inherit]",children:a}),e.jsx(sr,{}),e.jsx(br,{})]}));ss.displayName=Kt.displayName;const sr=o.forwardRef(({className:s,orientation:a="vertical",...t},r)=>e.jsx(Jt,{ref:r,orientation:a,className:_("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...t,children:e.jsx(wr,{className:"relative flex-1 rounded-full bg-border"})}));sr.displayName=Jt.displayName;function ii({isOpen:s,onClose:a,children:t}){return e.jsx(Sr,{children:s&&e.jsxs(e.Fragment,{children:[e.jsx(Ks.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm lg:hidden",onClick:a,style:{width:"100vw"}}),e.jsxs(Ks.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:20,stiffness:300},className:_("fixed inset-y-0 right-0 z-50 w-full max-w-xs bg-white shadow-2xl lg:hidden","flex flex-col"),children:[e.jsxs("div",{className:"flex h-16 items-center justify-between border-b px-6",children:[e.jsx("a",{href:"/",className:"hover:opacity-80 transition-opacity",children:e.jsx("img",{src:"https://i.postimg.cc/GpdY6N74/my-1920-x-1080-px-1.png",alt:"MyVGE",className:"h-8"})}),e.jsx(k,{variant:"ghost",size:"icon",className:"h-10 w-10 rounded-full hover:bg-muted",onClick:r=>{r.stopPropagation(),a()},children:e.jsx(nt,{className:"h-5 w-5"})})]}),e.jsx(ss,{className:"flex-1",children:e.jsxs("div",{className:"flex flex-col p-6 pb-16",children:[e.jsx("div",{className:"flex-1",children:t}),e.jsx("div",{className:"mt-auto pt-6",children:e.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:["© ",new Date().getFullYear()," MyVGE. All rights reserved."]})})]})})]})]})})}const tr=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Zt,{ref:r,className:_("relative z-10 flex max-w-max flex-1 items-center justify-center",s),...t,children:[a,e.jsx(rr,{})]}));tr.displayName=Zt.displayName;const ar=o.forwardRef(({className:s,...a},t)=>e.jsx(Xt,{ref:t,className:_("group flex flex-1 list-none items-center justify-center space-x-1",s),...a}));ar.displayName=Xt.displayName;const ls=kr,li=rs("group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"),et=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Qt,{ref:r,className:_(li(),"group",s),...t,children:[a," ",e.jsx(it,{className:"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180","aria-hidden":"true"})]}));et.displayName=Qt.displayName;const st=o.forwardRef(({className:s,...a},t)=>e.jsx(ea,{ref:t,className:_("left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ",s),...a}));st.displayName=ea.displayName;const _s=_r,rr=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{className:_("absolute left-0 top-full flex justify-center"),children:e.jsx(sa,{className:_("origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",s),ref:t,...a})}));rr.displayName=sa.displayName;const oi=o.forwardRef(({className:s,...a},t)=>e.jsx(ta,{ref:t,className:_("top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",s),...a,children:e.jsx("div",{className:"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md"})}));oi.displayName=ta.displayName;const Re=o.forwardRef(({className:s,...a},t)=>e.jsx(aa,{ref:t,className:_("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...a}));Re.displayName=aa.displayName;const Me=o.forwardRef(({className:s,...a},t)=>e.jsx(ra,{ref:t,className:_("aspect-square h-full w-full",s),...a}));Me.displayName=ra.displayName;const Ee=o.forwardRef(({className:s,...a},t)=>e.jsx(na,{ref:t,className:_("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a}));Ee.displayName=na.displayName;const ci=Ir,di=Rr,mi=o.forwardRef(({className:s,inset:a,children:t,...r},i)=>e.jsxs(ia,{ref:i,className:_("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",s),...r,children:[t,e.jsx(Cr,{className:"ml-auto h-4 w-4"})]}));mi.displayName=ia.displayName;const ui=o.forwardRef(({className:s,...a},t)=>e.jsx(la,{ref:t,className:_("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));ui.displayName=la.displayName;const nr=o.forwardRef(({className:s,sideOffset:a=4,...t},r)=>e.jsx(Pr,{children:e.jsx(oa,{ref:r,sideOffset:a,className:_("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})}));nr.displayName=oa.displayName;const es=o.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(ca,{ref:r,className:_("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",s),...t}));es.displayName=ca.displayName;const hi=o.forwardRef(({className:s,children:a,checked:t,...r},i)=>e.jsxs(da,{ref:i,className:_("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:t,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ma,{children:e.jsx(ua,{className:"h-4 w-4"})})}),a]}));hi.displayName=da.displayName;const xi=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(ha,{ref:r,className:_("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ma,{children:e.jsx(Ar,{className:"h-4 w-4 fill-current"})})}),a]}));xi.displayName=ha.displayName;const pi=o.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(xa,{ref:r,className:_("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s),...t}));pi.displayName=xa.displayName;const tt=o.forwardRef(({className:s,...a},t)=>e.jsx(pa,{ref:t,className:_("-mx-1 my-1 h-px bg-muted",s),...a}));tt.displayName=pa.displayName;const Ue=Tr,gi=Dr,fi=Mr,ir=o.forwardRef(({className:s,...a},t)=>e.jsx(ga,{ref:t,className:_("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a}));ir.displayName=ga.displayName;const Te=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(fi,{children:[e.jsx(ir,{}),e.jsxs(fa,{ref:r,className:_("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t,children:[a,e.jsxs(Er,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Te.displayName=fa.displayName;const De=({className:s,...a})=>e.jsx("div",{className:_("flex flex-col space-y-1.5 text-center sm:text-left",s),...a});De.displayName="DialogHeader";const dt=({className:s,...a})=>e.jsx("div",{className:_("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});dt.displayName="DialogFooter";const Le=o.forwardRef(({className:s,...a},t)=>e.jsx(ja,{ref:t,className:_("text-lg font-semibold leading-none tracking-tight",s),...a}));Le.displayName=ja.displayName;const as=o.forwardRef(({className:s,...a},t)=>e.jsx(va,{ref:t,className:_("text-sm text-muted-foreground",s),...a}));as.displayName=va.displayName;const q=o.forwardRef(({className:s,type:a,...t},r)=>e.jsx("input",{type:a,className:_("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:r,...t}));q.displayName="Input";const ji=rs("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),G=o.forwardRef(({className:s,...a},t)=>e.jsx(ya,{ref:t,className:_(ji(),s),...a}));G.displayName=ya.displayName;function vi({isOpen:s,onClose:a,onSuccess:t}){const[r,i]=o.useState(""),[l,n]=o.useState(""),[f,h]=o.useState(!1),{toast:N}=Ce(),p=async g=>{g.preventDefault(),h(!0);try{console.log("Attempting login with:",r);const{data:j,error:y}=await ge.auth.signInWithPassword({email:r,password:l});if(y)throw console.error("Supabase auth error:",y),y;console.log("Login successful:",j),N({title:"Success",description:"You have successfully logged in."}),a(),setTimeout(()=>{t&&t(),window.location.href=window.location.pathname},300)}catch(j){console.error("Login error:",j),N({variant:"destructive",title:"Login failed",description:j.message||"Please check your credentials and try again."})}finally{h(!1)}};return e.jsx(Ue,{open:s,onOpenChange:a,children:e.jsxs(Te,{className:"sm:max-w-[425px]",children:[e.jsxs(De,{children:[e.jsx(Le,{children:"Login"}),e.jsx(as,{children:"Enter your credentials to access your account."})]}),e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(G,{htmlFor:"email",children:"Email"}),e.jsx(q,{id:"email",type:"email",value:r,onChange:g=>i(g.target.value),placeholder:"your.email@example.com",autoComplete:"email",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(G,{htmlFor:"password",children:"Password"}),e.jsx(q,{id:"password",type:"password",value:l,onChange:g=>n(g.target.value),autoComplete:"current-password",required:!0})]})]}),e.jsx(dt,{children:e.jsx(k,{type:"submit",disabled:f,children:f?"Logging in...":"Login"})})]})]})})}const yi=[{title:"Investment Deals",href:"/deals",icon:"💼",requiresAuth:!0},{title:"Listings",href:"/listings",icon:"🏠",requiresAuth:!1},{title:"Market",items:[{title:"Market Trends",href:"/trends",description:"Stay updated with the latest real estate market trends",requiresAuth:!0},{title:"Market Insights",href:"/insights",description:"Deep dive into property market analytics",requiresAuth:!0},{title:"Research & Reports",href:"/research",description:"Access expert analysis and reports",requiresAuth:!1}],icon:"📊"},{title:"Services",items:[{title:"Property Management",href:"/property-management",description:"Let us take care of your property",requiresAuth:!0},{title:"Investment Opportunities",href:"/investment-opportunities",description:"Discover tailored investment strategies",requiresAuth:!0},{title:"Calculators",href:"/calculators",description:"Calculate your property investment",requiresAuth:!1}],icon:"🏠"},{title:"Messages",href:"/messages",icon:"💬",requiresAuth:!0},{title:"Pricing",href:"/pricing",icon:"💎",requiresAuth:!1},{title:"Support",href:"/help",icon:"❓",requiresAuth:!1},{title:"About Us",href:"/about-us",icon:"ℹ️",requiresAuth:!1}];function fs({isAuthenticated:s=!1,onSignIn:a,onSignUp:t,userProfile:r={},onSignOut:i}){var T,F;const[l,n]=S.useState(!1),[f,h]=S.useState(!1),[N,p]=S.useState(!1),g=ze(),j=ee(),y=s||!!j.user,v=r&&Object.keys(r).length>0?r:j.profile,L=i||j.signOut;S.useEffect(()=>{const P=()=>{h(window.scrollY>20)};return window.addEventListener("scroll",P),()=>window.removeEventListener("scroll",P)},[]);const b=P=>{P.preventDefault(),p(!0)},d=async()=>{console.log("Sign out button clicked");try{await L(),window.location.href="/"}catch(P){console.error("Error signing out:",P)}},c=(P,M,O)=>{M&&!y&&(P.preventDefault(),p(!0)),n(!1)},w=S.forwardRef(({className:P,title:M,children:O,...x},A)=>e.jsx("li",{children:e.jsx(_s,{asChild:!0,children:e.jsxs("a",{ref:A,className:_("block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",P??""),...x,children:[e.jsx("div",{className:"text-sm font-medium leading-none",children:M}),e.jsx("p",{className:"line-clamp-2 text-sm leading-snug text-muted-foreground",children:O})]})})}));return w.displayName="ListItem",e.jsxs(e.Fragment,{children:[e.jsx("header",{className:_("fixed top-0 left-0 right-0 z-50 transition-all duration-300",f?"py-2":"py-4"),children:e.jsx("div",{className:"px-4 mx-auto max-w-7xl",children:e.jsx("div",{className:_("rounded-full bg-white border transition-all duration-300",f?"shadow-md border-gray-200/50 backdrop-blur-md bg-white/90":"shadow-sm border-transparent"),children:e.jsxs("div",{className:"h-16 px-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx("a",{href:"/",className:"hover:opacity-80 transition-opacity",children:e.jsx("img",{src:"https://i.postimg.cc/GpdY6N74/my-1920-x-1080-px-1.png",alt:"MyVGE",className:"h-8"})}),e.jsx(tr,{className:"hidden lg:flex",children:e.jsxs(ar,{className:"gap-2",children:[e.jsxs(ls,{children:[e.jsx(et,{className:_("text-sm font-medium rounded-full px-4","bg-transparent hover:bg-gray-100 transition-colors","data-[state=open]:bg-gray-100"),children:"Market"}),e.jsx(st,{children:e.jsxs("ul",{className:"w-[400px] gap-3 p-4 rounded-2xl",children:[y?e.jsxs(e.Fragment,{children:[e.jsx(w,{href:"/trends",title:"Market Trends",children:"Stay updated with the latest real estate market trends."}),e.jsx(w,{href:"/insights",title:"Market Insights",children:"Deep dive into property market analytics and forecasts."})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{href:"#",onClick:b,title:"Market Trends",children:"Sign in to access market trends."}),e.jsx(w,{href:"#",onClick:b,title:"Market Insights",children:"Sign in to access market insights."})]}),e.jsx(w,{href:"/research",title:"Research & Reports",children:"Access expert analysis and reports."})]})})]}),e.jsx(ls,{children:e.jsx(_s,{className:_("text-sm font-medium rounded-full px-4 py-2","hover:bg-gray-100 transition-colors"),href:"/deals",children:"Deals"})}),e.jsx(ls,{children:e.jsx(_s,{className:_("text-sm font-medium rounded-full px-4 py-2","hover:bg-gray-100 transition-colors"),href:"/listings",children:"Listings"})}),e.jsxs(ls,{children:[e.jsx(et,{className:_("text-sm font-medium rounded-full px-4","bg-transparent hover:bg-gray-100 transition-colors","data-[state=open]:bg-gray-100"),children:"Services"}),e.jsx(st,{children:e.jsxs("ul",{className:"w-[400px] gap-3 p-4 rounded-2xl",children:[e.jsx(w,{href:"/property-management",title:"Property Management",children:"Let us take care of your property."}),e.jsx(w,{href:"/investment-opportunities",title:"Investment Opportunities",children:"Discover tailored investment strategies."}),e.jsx(w,{href:"/calculators",title:"Calculators",children:"Calculate different aspects of your property investment."})]})})]}),e.jsx(ls,{children:e.jsx(_s,{className:_("text-sm font-medium rounded-full px-4 py-2","hover:bg-gray-100 transition-colors"),href:"/pricing",children:"Pricing"})})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("nav",{className:"hidden lg:flex items-center gap-2",children:[e.jsx("a",{href:"/help",className:_("text-sm font-medium rounded-full px-4 py-2","hover:bg-gray-100 transition-colors"),children:"Support"}),e.jsx("a",{href:"/about-us",className:_("text-sm font-medium rounded-full px-4 py-2","hover:bg-gray-100 transition-colors"),children:"About Us"})]}),e.jsxs(k,{variant:"ghost",className:"hidden md:flex bg-gradient-to-r from-emerald-400 to-cyan-400 text-white hover:from-emerald-500 hover:to-cyan-500 rounded-full border border-emerald-500/20 shadow-lg hover:shadow-emerald-500/20 transition-all duration-300",onClick:()=>g("/pricing"),children:[e.jsx(Na,{className:"mr-2 h-4 w-4"}),"Upgrade"]}),e.jsxs("div",{className:"flex items-center",children:[y?e.jsxs(ci,{children:[e.jsx(di,{asChild:!0,children:e.jsx(k,{variant:"ghost",className:"relative h-10 w-10 rounded-full",children:e.jsxs(Re,{className:"h-10 w-10",children:[e.jsx(Me,{src:`https://ui-avatars.com/api/?name=${encodeURIComponent((v==null?void 0:v.full_name)||"")}&background=random`,alt:(v==null?void 0:v.full_name)||"User avatar"}),e.jsx(Ee,{className:"bg-primary/10",children:((T=v==null?void 0:v.full_name)==null?void 0:T.split(" ").filter(Boolean).map(P=>P[0]).slice(0,2).join("").toUpperCase())||"U"})]})})}),e.jsxs(nr,{className:"w-56 mt-2 bg-white border border-gray-200 rounded-2xl shadow-lg",align:"end",forceMount:!0,children:[e.jsxs(es,{className:"flex-col items-start",children:[e.jsx("div",{className:"font-medium",children:v==null?void 0:v.full_name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:v==null?void 0:v.email})]}),e.jsx(tt,{}),e.jsxs(es,{onClick:()=>g("/dashboard"),children:[e.jsx(Nt,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Dashboard"})]}),e.jsxs(es,{onClick:()=>g("/account"),children:[e.jsx(bt,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Account Settings"})]}),e.jsxs(es,{onClick:()=>g("/messages"),children:[e.jsx(gs,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Messages"})]}),e.jsx(tt,{}),e.jsxs(es,{className:"text-red-500 focus:text-red-500",onClick:d,children:[e.jsx(wt,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Log Out"})]})]})]}):e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs(k,{variant:"ghost",onClick:b,className:"rounded-full hover:bg-gray-100",children:[e.jsx(Js,{className:"mr-2 h-4 w-4"}),"Sign In"]}),e.jsxs(k,{onClick:()=>t==null?void 0:t(),className:"rounded-full bg-black text-white hover:bg-gray-800",children:[e.jsx(us,{className:"mr-2 h-4 w-4"}),"Sign Up"]})]}),e.jsx(k,{variant:"ghost",className:"lg:hidden p-2 ml-2",onClick:()=>n(!0),children:e.jsx(Lr,{className:"h-6 w-6"})})]})]})]})})})}),e.jsx(ii,{isOpen:l,onClose:()=>n(!1),children:e.jsxs("nav",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-2",children:[e.jsxs(Re,{className:"h-10 w-10",children:[e.jsx(Me,{src:`https://ui-avatars.com/api/?name=${encodeURIComponent((v==null?void 0:v.full_name)||"")}&background=random`,alt:(v==null?void 0:v.full_name)||"User avatar"}),e.jsx(Ee,{className:"bg-primary/10",children:((F=v==null?void 0:v.full_name)==null?void 0:F.split(" ").filter(Boolean).map(P=>P[0]).slice(0,2).join("").toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[e.jsx("p",{className:"text-sm font-medium leading-none truncate",children:v==null?void 0:v.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:v==null?void 0:v.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(k,{variant:"outline",className:"justify-center rounded-full",onClick:()=>{g("/dashboard"),n(!1)},children:[e.jsx(Nt,{className:"mr-2 h-4 w-4"}),"Dashboard"]}),e.jsxs(k,{variant:"outline",className:"justify-center rounded-full",onClick:()=>{g("/account"),n(!1)},children:[e.jsx(bt,{className:"mr-2 h-4 w-4"}),"Account"]})]}),e.jsx("div",{className:"border-b border-border"})]}),yi.map((P,M)=>{var O;return e.jsx("div",{className:"space-y-3",children:P.href?e.jsxs("a",{href:P.href,className:_("flex items-center space-x-3 text-lg font-medium transition-colors",!P.requiresAuth||y?"hover:text-primary":"text-muted-foreground hover:text-primary/70"),onClick:x=>c(x,P.requiresAuth,P.href),children:[e.jsx("span",{className:"text-xl",children:P.icon}),e.jsx("span",{children:P.title}),P.requiresAuth&&!y&&e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Sign in required)"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center space-x-3 text-lg font-medium",children:[e.jsx("span",{className:"text-xl",children:P.icon}),e.jsx("span",{children:P.title})]}),e.jsx("div",{className:"space-y-3 pl-9",children:(O=P.items)==null?void 0:O.map((x,A)=>e.jsxs("a",{href:x.href,className:_("block text-base transition-colors",!x.requiresAuth||y?"text-muted-foreground hover:text-primary":"text-muted-foreground/70 hover:text-primary/70"),onClick:I=>c(I,x.requiresAuth,x.href),children:[x.title,x.requiresAuth&&!y&&e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Sign in required)"})]},A))})]})},M)}),y?e.jsx("div",{className:"pt-6",children:e.jsxs(k,{variant:"outline",className:"w-full justify-center rounded-full text-red-500 hover:text-red-600 hover:bg-red-50",onClick:d,children:[e.jsx(wt,{className:"mr-2 h-4 w-4"}),"Log Out"]})}):e.jsxs("div",{className:"space-y-4 pt-6",children:[e.jsxs(k,{variant:"outline",className:"w-full justify-center rounded-full",onClick:b,children:[e.jsx(Js,{className:"mr-2 h-4 w-4"}),"Sign In"]}),e.jsxs(k,{className:"w-full justify-center rounded-full bg-gradient-to-r from-emerald-400 to-cyan-400 text-white hover:from-emerald-500 hover:to-cyan-500",onClick:()=>{t==null||t(),n(!1)},children:[e.jsx(us,{className:"mr-2 h-4 w-4"}),"Sign Up"]})]})]})}),e.jsx(vi,{isOpen:N,onClose:()=>p(!1),onSuccess:()=>{p(!1),window.location.reload()}})]})}const Ni=({text:s="",className:a="",delay:t=100,animationFrom:r={opacity:0,transform:"translate3d(0,40px,0)"},animationTo:i={opacity:1,transform:"translate3d(0,0,0)"},easing:l=p=>p,threshold:n=.1,rootMargin:f="-100px",textAlign:h="center",onLetterAnimationComplete:N})=>{const p=s.split(" ").map(d=>d.split("")),g=p.flat(),[j,y]=o.useState(!1),v=o.useRef(null),L=o.useRef(0);o.useEffect(()=>{const d=new IntersectionObserver(([c])=>{c.isIntersecting&&(y(!0),v.current&&d.unobserve(v.current))},{threshold:n,rootMargin:f});return v.current&&d.observe(v.current),()=>d.disconnect()},[n,f]);const b=Fr(g.length,g.map((d,c)=>({from:r,to:j?async w=>{await w(i),L.current+=1,L.current===g.length&&N&&N()}:r,delay:c*t,config:{easing:l}})));return e.jsx("p",{ref:v,className:`split-parent overflow-hidden inline ${a}`,style:{textAlign:h,whiteSpace:"normal",wordWrap:"break-word"},children:p.map((d,c)=>e.jsxs("span",{style:{display:"inline-block",whiteSpace:"nowrap"},children:[d.map((w,T)=>{const F=p.slice(0,c).reduce((P,M)=>P+M.length,0)+T;return e.jsx(Or.span,{style:b[F],className:"inline-block transform transition-opacity will-change-transform",children:w},F)}),e.jsx("span",{style:{display:"inline-block",width:"0.3em"},children:" "})]},c))})},bi=`#version 300 es
in vec2 position;
void main() {
  gl_Position = vec4(position, 0.0, 1.0);
}
`,wi=`#version 300 es
precision highp float;

uniform float uTime;
uniform float uAmplitude;
uniform vec3 uColorStops[3];
uniform vec2 uResolution;
uniform float uBlend;

out vec4 fragColor;

vec3 permute(vec3 x) {
  return mod(((x * 34.0) + 1.0) * x, 289.0);
}

float snoise(vec2 v){
  const vec4 C = vec4(
      0.211324865405187, 0.366025403784439,
      -0.577350269189626, 0.024390243902439
  );
  vec2 i  = floor(v + dot(v, C.yy));
  vec2 x0 = v - i + dot(i, C.xx);
  vec2 i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;
  i = mod(i, 289.0);

  vec3 p = permute(
      permute(i.y + vec3(0.0, i1.y, 1.0))
    + i.x + vec3(0.0, i1.x, 1.0)
  );

  vec3 m = max(
      0.5 - vec3(
          dot(x0, x0),
          dot(x12.xy, x12.xy),
          dot(x12.zw, x12.zw)
      ), 
      0.0
  );
  m = m * m;
  m = m * m;

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;
  m *= 1.79284291400159 - 0.85373472095314 * (a0*a0 + h*h);

  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}

struct ColorStop {
  vec3 color;
  float position;
};

#define COLOR_RAMP(colors, factor, finalColor) {                int index = 0;                                              for (int i = 0; i < 2; i++) {                                    ColorStop currentColor = colors[i];                         bool isInBetween = currentColor.position <= factor;         index = int(mix(float(index), float(i), float(isInBetween)));   }                                                           ColorStop currentColor = colors[index];                     ColorStop nextColor = colors[index + 1];                    float range = nextColor.position - currentColor.position;   float lerpFactor = (factor - currentColor.position) / range;   finalColor = mix(currentColor.color, nextColor.color, lerpFactor); }

void main() {
  vec2 uv = gl_FragCoord.xy / uResolution;
  
  ColorStop colors[3];
  colors[0] = ColorStop(uColorStops[0], 0.0);
  colors[1] = ColorStop(uColorStops[1], 0.5);
  colors[2] = ColorStop(uColorStops[2], 1.0);
  
  vec3 rampColor;
  COLOR_RAMP(colors, uv.x, rampColor);
  
  float height = snoise(vec2(uv.x * 2.0 + uTime * 0.1, uTime * 0.25)) * 0.5 * uAmplitude;
  height = exp(height);
  height = (uv.y * 2.0 - height + 0.2);
  float intensity = 0.6 * height;
  
  float midPoint = 0.20;
  float auroraAlpha = smoothstep(midPoint - uBlend * 0.5, midPoint + uBlend * 0.5, intensity);
  
  vec3 auroraColor = intensity * rampColor;
  
  fragColor = vec4(auroraColor * auroraAlpha, auroraAlpha);
}
`,Si=s=>{const{colorStops:a=["#00d8ff","#7cff67","#00d8ff"],amplitude:t=1,blend:r=.5}=s,i=o.useRef(s);i.current=s;const l=o.useRef(null);return o.useEffect(()=>{const n=l.current;if(!n)return;const f=new ba({alpha:!0,premultipliedAlpha:!0,antialias:!0}),h=f.gl;h.clearColor(0,0,0,0),h.enable(h.BLEND),h.blendFunc(h.ONE,h.ONE_MINUS_SRC_ALPHA),h.canvas.style.backgroundColor="transparent";let N;function p(){if(!n)return;const b=n.offsetWidth,d=n.offsetHeight;f.setSize(b,d),N&&(N.uniforms.uResolution.value=[b,d])}window.addEventListener("resize",p);const g=new wa(h);g.attributes.uv&&delete g.attributes.uv;const j=a.map(b=>{const d=new St(b);return[d.r,d.g,d.b]});N=new Sa(h,{vertex:bi,fragment:wi,uniforms:{uTime:{value:0},uAmplitude:{value:t},uColorStops:{value:j},uResolution:{value:[n.offsetWidth,n.offsetHeight]},uBlend:{value:r}}});const y=new _a(h,{geometry:g,program:N});n.appendChild(h.canvas);let v=0;const L=b=>{v=requestAnimationFrame(L);const{time:d=b*.01,speed:c=1}=i.current;if(N){N.uniforms.uTime.value=d*c*.1,N.uniforms.uAmplitude.value=i.current.amplitude??1,N.uniforms.uBlend.value=i.current.blend??r;const w=i.current.colorStops??a;N.uniforms.uColorStops.value=w.map(T=>{const F=new St(T);return[F.r,F.g,F.b]}),f.render({scene:y})}};return v=requestAnimationFrame(L),p(),()=>{var b;cancelAnimationFrame(v),window.removeEventListener("resize",p),n&&h.canvas.parentNode===n&&n.removeChild(h.canvas),(b=h.getExtension("WEBGL_lose_context"))==null||b.loseContext()}},[t]),e.jsx("div",{ref:l,className:"w-full h-full"})},Ne=({onSearch:s=()=>{},title:a="Find Your Next Investment Property",subtitle:t="Search through our curated selection of properties",showSearch:r=!0,showStats:i=!0,height:l="h-[500px]",image:n})=>{const[f,h]=S.useState(""),N=g=>{g.preventDefault(),s(f)},p=()=>{console.log("Hero text animation completed!")};return e.jsxs("div",{className:`relative w-full ${l} bg-gray-900 overflow-hidden`,children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx(Si,{colorStops:["#004F39","#FEFACA","#151513"],blend:.6,amplitude:1.2,speed:.3}),e.jsx("div",{className:"absolute inset-0 bg-black/30 backdrop-blur-[2px]"})]}),e.jsxs("div",{className:"relative h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col items-center justify-center text-center py-16 pt-24 animate-fade-in-up",children:[e.jsx(Ni,{text:a,className:"text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4",delay:50,animationFrom:{opacity:0,transform:"translate3d(0,50px,0)"},animationTo:{opacity:1,transform:"translate3d(0,0,0)"},easing:g=>1-Math.pow(1-g,3),threshold:.2,rootMargin:"-50px",onLetterAnimationComplete:p}),e.jsx("p",{className:"text-lg sm:text-xl text-gray-200 mb-6 sm:mb-8 max-w-3xl mx-auto",children:t}),r&&e.jsx("form",{onSubmit:N,className:"w-full max-w-2xl animate-fade-in-up",children:e.jsxs("div",{className:"relative",children:[e.jsx(q,{type:"text",placeholder:"Enter an address, neighbourhood, city, or postcode",value:f,onChange:g=>h(g.target.value),className:"w-full h-12 sm:h-14 pl-5 pr-14 text-base sm:text-lg bg-white/90 backdrop-blur-sm text-black border-2 border-transparent focus:border-primary"}),e.jsx(k,{type:"submit",size:"sm",variant:"ghost",className:"absolute right-2 top-1/2 -translate-y-1/2 hover:bg-transparent",children:e.jsx(ka,{className:"w-6 h-6 text-gray-500 hover:text-primary transition-colors"})})]})})]})]})},$=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:_("rounded-xl border bg-card text-card-foreground shadow",s),...a}));$.displayName="Card";const K=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:_("flex flex-col space-y-1.5 p-6",s),...a}));K.displayName="CardHeader";const ue=o.forwardRef(({className:s,...a},t)=>e.jsx("h3",{ref:t,className:_("font-semibold leading-none tracking-tight",s),...a}));ue.displayName="CardTitle";const at=o.forwardRef(({className:s,...a},t)=>e.jsx("p",{ref:t,className:_("text-sm text-muted-foreground",s),...a}));at.displayName="CardDescription";const z=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:_("p-6 pt-0",s),...a}));z.displayName="CardContent";const Os=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:_("flex items-center p-6 pt-0",s),...a}));Os.displayName="CardFooter";const _i=rs("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"bg-green-500/10 text-green-500 hover:bg-green-500/20",warning:"bg-yellow-500/10 text-yellow-500 hover:bg-yellow-500/20",premium:"bg-gradient-to-r from-amber-500 to-amber-600 text-white hover:from-amber-600 hover:to-amber-700"}},defaultVariants:{variant:"default"}});function oe({className:s,variant:a,...t}){return e.jsx("div",{className:_(_i({variant:a}),s),...t})}function Fs({id:s,address:a,price:t,squareFootage:r,bedrooms:i,bathrooms:l,isPremium:n=!1,propertyType:f="residential",description:h,createdAt:N,author:p,original_price:g,roi_percentage:j,investment_term:y,deal_type:v,isSubscriber:L=!1,type:b="listing",isDeal:d=!1,images:c=[],onClick:w,onMessageAuthor:T,currentUser:F,userProfile:P}){const M=!!F,[O,x]=S.useState(!1),A=X=>{X.stopPropagation(),x(!O)},I=X=>{X.stopPropagation(),console.log("Share property:",s)},U=X=>{X.stopPropagation(),p&&T&&T(p.id)},J=c&&c.length>0?c[0]:`https://source.unsplash.com/random/800x600?property,house&sig=${s}`;return e.jsxs($,{className:"overflow-hidden hover:shadow-md transition-shadow cursor-pointer",onClick:w,children:[e.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden bg-muted",children:[e.jsx("img",{src:J,alt:a,className:"object-cover w-full h-full",loading:"lazy"}),n&&e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx(oe,{variant:"secondary",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Featured"})}),d&&e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx(oe,{variant:"secondary",className:"bg-emerald-500 text-white hover:bg-emerald-600",children:"Investment Deal"})}),j&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsxs(oe,{className:"bg-emerald-500 text-white",children:[j,"% ROI"]})})]}),e.jsxs(K,{className:"p-4 pb-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:B(t)}),g&&e.jsx("div",{className:"text-sm text-muted-foreground line-through",children:B(g)})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:a})]}),e.jsxs(z,{className:"p-4 pt-2",children:[(i||l||r)&&e.jsxs("div",{className:"flex justify-between mb-3 text-sm",children:[i!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:i})," ",e.jsx("span",{className:"text-muted-foreground",children:i===1?"Bed":"Beds"})]}),l!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:l})," ",e.jsx("span",{className:"text-muted-foreground",children:l===1?"Bath":"Baths"})]}),r!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:Wa(r)})," ",e.jsx("span",{className:"text-muted-foreground",children:"sq ft"})]})]}),y&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Investment Term: "}),e.jsx("span",{className:"text-sm font-medium",children:y})]}),v&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Deal Type: "}),e.jsx("span",{className:"text-sm font-medium",children:v})]}),h&&e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-2",children:h}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:Rs(N)}),e.jsxs("div",{className:"flex space-x-1",children:[M&&e.jsxs(e.Fragment,{children:[e.jsx(k,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:A,children:e.jsx($r,{className:`h-4 w-4 ${O?"fill-red-500 text-red-500":""}`})}),p&&e.jsx(k,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:U,children:e.jsx(gs,{className:"h-4 w-4"})})]}),e.jsx(k,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:I,children:e.jsx(Ur,{className:"h-4 w-4"})})]})]})]})]})}const ki="https://zcuapuvvygahkzljuhyg.supabase.co",lr="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpjdWFwdXZ2eWdhaGt6bGp1aHlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc5MTQwMzcsImV4cCI6MjA1MzQ5MDAzN30.GIhphzkznmDXgrUApGW479uHHluqDWqy_9cfG5sU5Xc";console.log("Supabase Anon Key:",lr);const Y=Yt(ki,lr,{auth:{persistSession:!0,storage:window.localStorage,storageKey:"supabase.auth.token",autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"}}),Ci={BASIC:{name:"Basic",price:"£9.99",priceId:"price_1QnikACOhalwhG2QDocCWbQj",features:["Basic property search","Save up to 5 properties","Basic market trends","Email support"]},PRO:{name:"Pro",price:"£19.99",priceId:"price_1QnikPCOhalwhG2QVYfxwG5D",features:["Advanced property search","Save unlimited properties","Detailed market analysis","Premium property insights","Priority support"]},PREMIUM:{name:"Premium",price:"£49.99",priceId:"price_1QnikjCOhalwhG2QUgRtMAco",features:["All Pro features","AI-powered market predictions","Portfolio analytics","Investment ROI calculator","Dedicated account manager","24/7 phone support"]}};async function or(s,a){try{const t=await fetch("https://clever-chaplygin6-vbfae.dev.tempolabs.ai/.netlify/functions/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({priceId:s,userId:a})}),{sessionId:r}=await t.json(),i=await zr(void 0);i&&await i.redirectToCheckout({sessionId:r})}catch(t){throw console.error("Error creating checkout session:",t),t}}function mt({isOpen:s,onClose:a,defaultMode:t="signin"}){const[r,i]=S.useState(t);S.useEffect(()=>{i(t)},[t]);const[l,n]=S.useState(!1),[f,h]=S.useState(!1),{signIn:N,signUp:p,signInWithGoogle:g}=ee(),{toast:j}=Ce(),[y,v]=S.useState({email:"",password:"",firstName:"",lastName:""}),L=async b=>{b.preventDefault(),n(!0);try{if(r==="signin")await N(y.email,y.password)&&(j({title:"Welcome back!",description:"You have successfully signed in."}),setTimeout(()=>a(),500));else{const d=await p(y.email,y.password,y.firstName,y.lastName),c=localStorage.getItem("pending_subscription_price_id");c&&d&&"id"in d?(localStorage.removeItem("pending_subscription_price_id"),await or(c,d.id)):(h(!0),j({title:"Welcome to MyVGE Alpha!",description:"Thank you for joining us during our alpha testing phase."}))}}catch(d){j({title:"Error",description:d.message||"An error occurred",variant:"destructive"})}finally{n(!1)}};return f?e.jsx(Ue,{open:s,onOpenChange:a,children:e.jsxs(Te,{className:"sm:max-w-[425px]",children:[e.jsxs(De,{children:[e.jsx(Le,{children:"Welcome to MyVGE Alpha!"}),e.jsxs(as,{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-primary",children:"Thank you for joining MyVGE during our alpha testing phase!"}),e.jsx("p",{children:"We've sent a confirmation email to your inbox. Please click the verification link to activate your account and start exploring MyVGE."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Note: You must confirm your email before signing in. Please check your spam folder if you don't see the email."}),e.jsx("div",{className:"mt-4 p-4 bg-primary/10 rounded-lg",children:e.jsx("p",{className:"text-sm font-medium",children:"As an alpha tester, your feedback is invaluable to us. We're excited to have you on board and look forward to your insights as we continue to improve the platform."})})]})]}),e.jsx("div",{className:"flex flex-col space-y-4 pt-4",children:e.jsx(k,{onClick:()=>{h(!1),a()},children:"Close"})})]})}):e.jsx(Ue,{open:s,onOpenChange:a,children:e.jsxs(Te,{className:"sm:max-w-[425px]",children:[e.jsxs(De,{children:[e.jsx(Le,{children:r==="signin"?"Sign In":"Create Account"}),e.jsx(as,{children:r==="signin"?"Welcome back! Please sign in to continue.":"Join MyVGE and start exploring properties."})]}),e.jsxs("form",{onSubmit:L,className:"space-y-4 pt-4",children:[r==="signup"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"firstName",children:"First Name"}),e.jsx(q,{id:"firstName",value:y.firstName,onChange:b=>v(d=>({...d,firstName:b.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"lastName",children:"Last Name"}),e.jsx(q,{id:"lastName",value:y.lastName,onChange:b=>v(d=>({...d,lastName:b.target.value})),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"email",children:"Email"}),e.jsx(q,{id:"email",type:"email",value:y.email,onChange:b=>v(d=>({...d,email:b.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"password",children:"Password"}),e.jsx(q,{id:"password",type:"password",value:y.password,onChange:b=>v(d=>({...d,password:b.target.value})),required:!0})]}),e.jsxs("div",{className:"flex flex-col space-y-4 pt-4",children:[e.jsx(k,{type:"submit",disabled:l,children:l?"Loading...":r==="signin"?"Sign In":"Create Account"}),e.jsx(k,{type:"button",variant:"link",onClick:()=>g(),disabled:l,children:"Sign In with Google"}),e.jsx(k,{type:"button",variant:"link",onClick:()=>i(r==="signin"?"signup":"signin"),children:r==="signin"?"Don't have an account? Sign up":"Already have an account? Sign in"})]})]})]})})}const Ve=qr,He=o.forwardRef(({className:s,...a},t)=>e.jsx(Ca,{ref:t,className:_("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...a}));He.displayName=Ca.displayName;const ie=o.forwardRef(({className:s,...a},t)=>e.jsx(Pa,{ref:t,className:_("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...a}));ie.displayName=Pa.displayName;const ae=o.forwardRef(({className:s,...a},t)=>e.jsx(Aa,{ref:t,className:_("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));ae.displayName=Aa.displayName;function cr({isOpen:s,onClose:a,currentUser:t,userProfile:r}){const i=ze(),l=n=>{console.log(`Subscribing to ${n} tier`),i(`/checkout?tier=${n}`),a()};return e.jsx(Ue,{open:s,onOpenChange:a,children:e.jsxs(Te,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsx(De,{children:e.jsx(Le,{className:"text-2xl",children:"Upgrade Your Experience"})}),e.jsxs(Ve,{defaultValue:"monthly",className:"mt-4",children:[e.jsxs(He,{className:"grid w-full grid-cols-2 mb-6",children:[e.jsx(ie,{value:"monthly",children:"Monthly"}),e.jsxs(ie,{value:"yearly",children:["Yearly ",e.jsx("span",{className:"ml-2 text-emerald-500",children:"Save 20%"})]})]}),e.jsx(ae,{value:"monthly",children:e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2 mt-4",children:[e.jsxs("div",{className:"border rounded-lg p-6 space-y-4 relative overflow-hidden",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Basic"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Essential property insights for casual investors."}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-bold",children:"£9.99"}),e.jsx("span",{className:"text-muted-foreground",children:"/month"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Basic property data"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"5 saved properties"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Limited market insights"})]})]}),e.jsx(k,{className:"w-full",onClick:()=>l("basic"),children:(r==null?void 0:r.subscription_tier)==="basic"?"Current Plan":"Subscribe"})]}),e.jsxs("div",{className:"border rounded-lg p-6 space-y-4 relative overflow-hidden bg-gradient-to-b from-blue-50 to-white dark:from-blue-950 dark:to-background",children:[e.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 text-xs font-medium rounded-bl-lg",children:"POPULAR"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Pro"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Advanced tools for serious property investors."}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-bold",children:"£29.99"}),e.jsx("span",{className:"text-muted-foreground",children:"/month"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:e.jsx("span",{className:"font-medium",children:"Everything in Basic"})})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Detailed investment metrics"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"50 saved properties"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Full market insights access"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Priority customer support"})]})]}),e.jsx(k,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:()=>l("pro"),children:(r==null?void 0:r.subscription_tier)==="pro"?"Current Plan":"Subscribe"})]})]})}),e.jsx(ae,{value:"yearly",children:e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2 mt-4",children:[e.jsxs("div",{className:"border rounded-lg p-6 space-y-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute -top-1 -right-1 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100 px-3 py-1 text-xs font-medium transform rotate-12",children:"SAVE 20%"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Basic Annual"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Essential property insights for casual investors."}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-bold",children:"£95.90"}),e.jsx("span",{className:"text-muted-foreground",children:"/year"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Equivalent to £7.99/month"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Basic property data"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"5 saved properties"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Limited market insights"})]})]}),e.jsx(k,{className:"w-full",onClick:()=>l("basic-annual"),children:(r==null?void 0:r.subscription_tier)==="basic"&&(r==null?void 0:r.subscription_status)==="yearly"?"Current Plan":"Subscribe"})]}),e.jsxs("div",{className:"border rounded-lg p-6 space-y-4 relative overflow-hidden bg-gradient-to-b from-blue-50 to-white dark:from-blue-950 dark:to-background",children:[e.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 text-xs font-medium rounded-bl-lg",children:"BEST VALUE"}),e.jsx("div",{className:"absolute -top-1 -right-12 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100 px-3 py-1 text-xs font-medium transform rotate-12",children:"SAVE 20%"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Pro Annual"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Advanced tools for serious property investors."}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-bold",children:"£287.90"}),e.jsx("span",{className:"text-muted-foreground",children:"/year"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Equivalent to £23.99/month"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:e.jsx("span",{className:"font-medium",children:"Everything in Basic"})})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Detailed investment metrics"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"50 saved properties"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Full market insights access"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Priority customer support"})]})]}),e.jsx(k,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:()=>l("pro-annual"),children:(r==null?void 0:r.subscription_tier)==="pro"&&(r==null?void 0:r.subscription_status)==="yearly"?"Current Plan":"Subscribe"})]})]})})]}),e.jsx(dt,{className:"mt-6",children:e.jsx(k,{variant:"outline",onClick:a,children:"Cancel"})})]})})}const Pi=["badword1","badword2"];function Ai(s){let a=s.toLowerCase();return Pi.forEach(t=>{const r=new RegExp(t,"gi");a=a.replace(r,"*".repeat(t.length))}),a}async function dr(s,a,t){try{const{data:r,error:i}=await Y.auth.getUser();if(i||!r.user)throw console.error("Authentication error:",i),new Error("User not authenticated");console.log("Sending message:",{sender_id:r.user.id,receiver_id:s,deal_id:t,content:a.substring(0,20)+"..."});const{data:l,error:n}=await Y.from("messages").insert({sender_id:r.user.id,receiver_id:s,content:Ai(a),deal_id:t,is_read:!1}).select(`
        *,
        sender:profiles!sender_id(id, full_name, avatar_url),
        receiver:profiles!receiver_id(id, full_name, avatar_url),
        deal:deals(*)
      `).single();if(n)throw console.error("Database error:",n),n;if(!l)throw console.error("No data returned from insert"),new Error("Failed to send message");return console.log("Message sent successfully:",{messageId:l.id}),l}catch(r){return console.error("Error sending message:",r),null}}async function Ii(){try{const{data:{session:s},error:a}=await Y.auth.getSession();if(a)return console.error("Session error in getConversations:",a),[];if(!s){console.log("No active session found in getConversations - trying getUser fallback");const{data:r,error:i}=await Y.auth.getUser();if(i||!(r!=null&&r.user))return console.error("User not authenticated in getConversations:",i||"No user data"),[];const l=r.user.id;return console.log(`Found user via getUser: ${l}`),await It(l)}const t=s.user.id;return console.log(`Using session user for conversations: ${t}`),await It(t)}catch(s){return console.error("Error getting conversations:",s),[]}}async function It(s){const{data:a,error:t}=await Y.from("messages").select(`
      *,
      sender:profiles!sender_id(id, full_name, avatar_url),
      receiver:profiles!receiver_id(id, full_name, avatar_url),
      deal:deals(*)
    `).filter("sender_id","eq",s).filter("receiver_id","eq",s,{foreignTable:"or"}).order("created_at",{ascending:!1});if(t)return console.error("Error fetching conversations:",t),[];const r=new Map;return a==null||a.forEach(i=>{const l=i.sender_id===s?i.receiver:i.sender,n=l.id;if(!r.has(n))r.set(n,{user:l,lastMessage:i,unreadCount:i.receiver_id===s&&!i.is_read?1:0});else if(i.receiver_id===s&&!i.is_read){const f=r.get(n);f.unreadCount++}}),Array.from(r.values())}async function mr(s){try{const{data:a,error:t}=await Y.auth.getUser();if(t||!a.user)throw console.error("Authentication error:",t),new Error("User not authenticated");console.log("Fetching messages with user:",s);const{data:r,error:i}=await Y.from("messages").select(`
        *,
        sender:profiles!sender_id(id, full_name, avatar_url),
        receiver:profiles!receiver_id(id, full_name, avatar_url),
        deal:deals(*)
      `).or(`and(sender_id.eq.${a.user.id},receiver_id.eq.${s}),and(sender_id.eq.${s},receiver_id.eq.${a.user.id})`).order("created_at",{ascending:!0});if(i)throw console.error("Database error:",i),i;console.log(`Found ${(r==null?void 0:r.length)||0} messages`);const l=(r==null?void 0:r.filter(n=>n.receiver_id===a.user.id&&!n.is_read))||[];if(l.length>0){console.log(`Marking ${l.length} messages as read`);const{error:n}=await Y.from("messages").update({is_read:!0}).in("id",l.map(f=>f.id));n&&console.error("Error marking messages as read:",n)}return r||[]}catch(a){return console.error("Error getting messages:",a),[]}}function Ri(s){try{return Y.channel("messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},async t=>{const{data:r,error:i}=await Y.from("messages").select(`
              *,
              sender:profiles!sender_id(id, full_name, avatar_url),
              receiver:profiles!receiver_id(id, full_name, avatar_url),
              deal:deals(*)
            `).eq("id",t.new.id).single();!i&&r&&s(r)}).subscribe()}catch(a){return console.error("Error subscribing to messages:",a),null}}async function Mi(s){try{let a;const{data:{session:t}}=await Y.auth.getSession();if(t)a=t.user.id,console.log(`Using session user for search: ${a}`);else{const{data:n,error:f}=await Y.auth.getUser();if(f||!(n!=null&&n.user))throw console.error("Failed to get authenticated user:",f),new Error("Authentication required to search users");a=n.user.id,console.log(`Using getUser result for search: ${a}`)}let r=Y.from("profiles").select("id, full_name, email, avatar_url").neq("id",a);if(s&&s.trim()){const n=`%${s.trim()}%`;r=r.or(`full_name.ilike.${n},email.ilike.${n}`)}const{data:i,error:l}=await r;return l?(console.error("Database error in searchUsers:",l),[]):(console.log(`Search found ${(i==null?void 0:i.length)||0} users`),i||[])}catch(a){return console.error("Error in searchUsers:",a),[]}}function Qe({size:s="md",className:a}){const t={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"};return e.jsx("div",{className:_("animate-spin rounded-full border-2 border-current border-t-transparent",t[s],a)})}const ur=({isOpen:s,onClose:a,receiverId:t,dealId:r})=>{const{user:i}=ee(),[l,n]=o.useState([]),[f,h]=o.useState(""),[N,p]=o.useState(!1),[g,j]=o.useState(null),y=o.useRef(null);o.useEffect(()=>{s&&t?v():(n([]),h(""))},[s,t]),o.useEffect(()=>{b()},[l]);const v=async()=>{if(t)try{p(!0);const d=await mr(t);if(n(d),d.length>0){const c=d[0],w=c.sender_id===(i==null?void 0:i.id)?c.receiver:c.sender;j(w)}}catch(d){console.error("Error loading messages:",d)}finally{p(!1)}},L=async d=>{if(d.preventDefault(),!(!t||!f.trim()))try{const c=await dr(t,f.trim(),r);c&&(n(w=>[...w,c]),h(""))}catch(c){console.error("Error sending message:",c)}},b=()=>{var d;(d=y.current)==null||d.scrollIntoView({behavior:"smooth"})};return e.jsx(Ue,{open:s,onOpenChange:d=>!d&&a(),children:e.jsxs(Te,{className:"max-w-screen-md w-full",children:[e.jsx(De,{children:e.jsx(Le,{children:g?`Messages with ${g.full_name}`:"Messages"})}),e.jsxs("div",{className:"h-[400px] flex flex-col",children:[N?e.jsx("div",{className:"flex-1 flex justify-center items-center",children:e.jsx(Qe,{})}):e.jsxs(ss,{className:"flex-1 pr-4 mb-4",children:[l.length===0?e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:"No messages yet. Send a message to start the conversation."}):l.map(d=>e.jsxs("div",{className:`flex mb-4 ${d.sender_id===(i==null?void 0:i.id)?"justify-end":"justify-start"}`,children:[d.sender_id!==(i==null?void 0:i.id)&&e.jsxs(Re,{className:"mr-2 mt-1",children:[e.jsx(Me,{src:d.sender.avatar_url}),e.jsx(Ee,{children:d.sender.full_name.charAt(0)})]}),e.jsxs("div",{className:`max-w-[70%] ${d.sender_id===(i==null?void 0:i.id)?"bg-primary text-primary-foreground":"bg-muted"} rounded-lg p-3`,children:[e.jsx("p",{children:d.content}),e.jsx("p",{className:"text-xs mt-1 opacity-70",children:Zs(new Date(d.created_at),{addSuffix:!0})})]})]},d.id)),e.jsx("div",{ref:y})]}),e.jsxs("form",{onSubmit:L,className:"flex gap-2",children:[e.jsx(q,{value:f,onChange:d=>h(d.target.value),placeholder:"Type a message...",autoFocus:!0}),e.jsx(k,{type:"submit",size:"icon",children:e.jsx(cs,{className:"h-4 w-4"})})]})]})]})})};function Ei(){const[s,a]=S.useState("");return S.useEffect(()=>{fetch("https://uselessfacts.jsph.pl/api/v2/facts/random?language=en").then(t=>t.json()).then(t=>a(t.text)).catch(t=>console.error("Error fetching random fact:",t))},[]),s?e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[e.jsx(Br,{className:"w-4 h-4"}),e.jsx("p",{children:s})]}):null}function ut(){return e.jsx("footer",{className:"bg-gray-900 text-white py-8 sm:py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"About Us"}),e.jsx("p",{className:"text-gray-400",children:"Your trusted source for property search and market analysis."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Legal"}),e.jsxs("ul",{className:"space-y-2 text-gray-400",children:[e.jsx("li",{children:e.jsx("a",{href:"/terms",className:"hover:text-white",children:"Terms of Service"})}),e.jsx("li",{children:e.jsx("a",{href:"/privacy",className:"hover:text-white",children:"Privacy Policy"})}),e.jsx("li",{children:e.jsx("a",{href:"/disclaimer",className:"hover:text-white",children:"Legal Disclaimer"})}),e.jsx("li",{children:e.jsx("a",{href:"/gdpr",className:"hover:text-white",children:"GDPR Compliance"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Contact"}),e.jsxs("ul",{className:"space-y-2 text-gray-400",children:[e.jsx("li",{children:"info@myvge.com"}),e.jsx("li",{children:"Lytchett House, 13 Freeland Park, Poole, Dorset, England, BH16 6FA"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Compliance"}),e.jsx("ul",{className:"space-y-2 text-gray-400",children:e.jsx("li",{children:"Company No: 15271126"})})]})]}),e.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-800 space-y-4",children:[e.jsx(Ei,{}),e.jsxs("div",{className:"text-center text-gray-400 space-y-2",children:[e.jsx("p",{className:"text-xs",children:"MyVGE is registered in England and Wales. Registered office: Lytchett House, 13 Freeland Park, Poole, Dorset, England, BH16 6FA. Company No: 15271126"}),e.jsx("p",{className:"text-xs",children:"The information on this website is for general information purposes only and does not constitute financial advice."}),e.jsxs("p",{children:["© ",new Date().getFullYear()," MyVGE. All rights reserved."]})]})]})]})})}const Ti=rs("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),xs=o.forwardRef(({className:s,variant:a,...t},r)=>e.jsx("div",{ref:r,role:"alert",className:_(Ti({variant:a}),s),...t}));xs.displayName="Alert";const ht=o.forwardRef(({className:s,...a},t)=>e.jsx("h5",{ref:t,className:_("mb-1 font-medium leading-none tracking-tight",s),...a}));ht.displayName="AlertTitle";const ps=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:_("text-sm [&_p]:leading-relaxed",s),...a}));ps.displayName="AlertDescription";function hr(){return e.jsxs(xs,{className:"bg-muted/50 border-muted-foreground/20",children:[e.jsx(lt,{className:"h-4 w-4"}),e.jsx(ps,{className:"text-xs text-muted-foreground",children:"The information provided on this website is for general informational purposes only and should not be considered as financial or investment advice. Property investments carry risks and values can go down as well as up. Always seek professional advice before making investment decisions."})]})}async function Rt(s,a){try{const t=(s-1)*a;console.log("Production URL:","https://zcuapuvvygahkzljuhyg.supabase.co"),console.log("Fetching properties with params:",{page:s,perPage:a,start:t});const{data:r,error:i}=await ge.from("properties").select(`
        id,
        title,
        description,
        location,
        price,
        beds,
        baths,
        sqft,
        image_url,
        is_featured,
        created_at,
        updated_at
      `).eq("is_featured",!0).range(t,t+a-1).order("created_at",{ascending:!1});if(console.log("Raw Supabase response:",{data:r,error:i}),i)throw console.error("Supabase error:",i),i;if(!r||r.length===0)return console.log("No properties found"),[];const l=r.map(n=>({id:n.id||"",title:n.title||"",description:n.description||"",location:n.location||"",price:Number(n.price)||0,beds:Number(n.beds)||0,baths:Number(n.baths)||0,sqft:Number(n.sqft)||0,image_url:n.image_url||"",is_featured:!!n.is_featured,created_at:n.created_at||new Date().toISOString(),updated_at:n.updated_at||new Date().toISOString()}));return console.log("Mapped properties:",l),l}catch(t){return console.error("Error in getFeaturedProperties:",t),[]}}async function Di(s){try{const{data:a,error:t}=await ge.from("properties").select(`
        id,
        title,
        location,
        price,
        sqft,
        beds,
        baths,
        description,
        image_url,
        is_featured,
        created_at,
        updated_at
      `).or(`
        location.ilike.%${s}%,
        description.ilike.%${s}%,
        title.ilike.%${s}%
      `).order("created_at",{ascending:!1});if(t)throw t;return a||[]}catch(a){return console.error("Error searching properties:",a),[]}}async function Li(s){const{data:a,error:t}=await ge.from("saved_properties").select(`
      *,
      property:properties(*)
    `).eq("user_id",s);if(t)throw t;return a}async function Fi(s,a){try{const t=(s-1)*a;console.log("Fetching deals with params:",{page:s,perPage:a,start:t});const{data:r,error:i}=await ge.from("deals").select(`
        id,
        title,
        description,
        location,
        price,
        roi_percentage,
        investment_term,
        property_type,
        deal_type,
        image_url,
        created_at,
        updated_at
      `).range(t,t+a-1).order("created_at",{ascending:!1});if(console.log("Raw Supabase deals response:",{data:r,error:i}),i)throw console.error("Supabase error:",i),i;if(!r||r.length===0)return console.log("No deals found"),[];const l=r.map(n=>({id:n.id||"",title:n.title||"",description:n.description||"",location:n.location||"",price:Number(n.price)||0,roi_percentage:Number(n.roi_percentage)||0,investment_term:n.investment_term||"",property_type:n.property_type||"",deal_type:n.deal_type||"",image_url:n.image_url||"",created_at:n.created_at||new Date().toISOString(),updated_at:n.updated_at||new Date().toISOString()}));return console.log("Mapped deals:",l),l}catch(t){return console.error("Error in getDeals:",t),[]}}const Oi=(s=6)=>Gr({queryKey:["deals"],queryFn:({pageParam:a=1})=>Fi(a,s),getNextPageParam:(a,t)=>a.length===s?t.length+1:void 0,staleTime:5*60*1e3,cacheTime:30*60*1e3}),ks=({children:s,direction:a="left",pauseOnHover:t=!1,reverse:r=!1,fade:i=!1,className:l,vertical:n=!1})=>e.jsxs("div",{className:_("group flex gap-4 overflow-hidden",n?"flex-col":"flex-row",l),children:[e.jsx("div",{className:_("flex min-w-full shrink-0 animate-marquee items-center justify-around gap-4",n?"flex-col":"flex-row",t&&"group-hover:[animation-play-state:paused]",r&&"animate-marquee-reverse"),children:s}),e.jsx("div",{className:_("flex min-w-full shrink-0 animate-marquee items-center justify-around gap-4",n?"flex-col":"flex-row",t&&"group-hover:[animation-play-state:paused]",r&&"animate-marquee-reverse"),children:s})]}),$i=({baseColor:s=[.1,.1,.1],speed:a=.2,amplitude:t=.5,frequencyX:r=3,frequencyY:i=2,interactive:l=!0,...n})=>{const f=o.useRef(null);return o.useEffect(()=>{if(!f.current)return;const h=f.current,N=new ba({antialias:!0}),p=N.gl;p.clearColor(1,1,1,1);const g=`
      attribute vec2 position;
      attribute vec2 uv;
      varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = vec4(position, 0.0, 1.0);
      }
    `,j=`
      precision highp float;
      uniform float uTime;
      uniform vec3 uResolution;
      uniform vec3 uBaseColor;
      uniform float uAmplitude;
      uniform float uFrequencyX;
      uniform float uFrequencyY;
      uniform vec2 uMouse;
      varying vec2 vUv;

      vec4 renderImage(vec2 uvCoord) {
          vec2 fragCoord = uvCoord * uResolution.xy;
          vec2 uv = (2.0 * fragCoord - uResolution.xy) / min(uResolution.x, uResolution.y);

          for (float i = 1.0; i < 10.0; i++){
              uv.x += uAmplitude / i * cos(i * uFrequencyX * uv.y + uTime + uMouse.x * 3.14159);
              uv.y += uAmplitude / i * cos(i * uFrequencyY * uv.x + uTime + uMouse.y * 3.14159);
          }

          vec2 diff = (uvCoord - uMouse);
          float dist = length(diff);
          float falloff = exp(-dist * 20.0);
          float ripple = sin(10.0 * dist - uTime * 2.0) * 0.03;
          uv += (diff / (dist + 0.0001)) * ripple * falloff;

          vec3 color = uBaseColor / abs(sin(uTime - uv.y - uv.x));
          return vec4(color, 1.0);
      }

      void main() {
          vec4 col = vec4(0.0);
          int samples = 0;
          for (int i = -1; i <= 1; i++){
              for (int j = -1; j <= 1; j++){
                  vec2 offset = vec2(float(i), float(j)) * (1.0 / min(uResolution.x, uResolution.y));
                  col += renderImage(vUv + offset);
                  samples++;
              }
          }
          gl_FragColor = col / float(samples);
      }
    `,y=new wa(p),v=new Sa(p,{vertex:g,fragment:j,uniforms:{uTime:{value:0},uResolution:{value:new Float32Array([p.canvas.width,p.canvas.height,p.canvas.width/p.canvas.height])},uBaseColor:{value:new Float32Array(s)},uAmplitude:{value:t},uFrequencyX:{value:r},uFrequencyY:{value:i},uMouse:{value:new Float32Array([0,0])}}}),L=new _a(p,{geometry:y,program:v});function b(){N.setSize(h.offsetWidth*1,h.offsetHeight*1);const P=v.uniforms.uResolution.value;P[0]=p.canvas.width,P[1]=p.canvas.height,P[2]=p.canvas.width/p.canvas.height}window.addEventListener("resize",b),b();function d(F){const P=h.getBoundingClientRect(),M=(F.clientX-P.left)/P.width,O=1-(F.clientY-P.top)/P.height,x=v.uniforms.uMouse.value;x[0]=M,x[1]=O}function c(F){if(F.touches.length>0){const P=F.touches[0],M=h.getBoundingClientRect(),O=(P.clientX-M.left)/M.width,x=1-(P.clientY-M.top)/M.height,A=v.uniforms.uMouse.value;A[0]=O,A[1]=x}}l&&(h.addEventListener("mousemove",d),h.addEventListener("touchmove",c));let w;function T(F){w=requestAnimationFrame(T),v.uniforms.uTime.value=F*.001*a,N.render({scene:L})}return w=requestAnimationFrame(T),h.appendChild(p.canvas),()=>{var F;cancelAnimationFrame(w),window.removeEventListener("resize",b),l&&(h.removeEventListener("mousemove",d),h.removeEventListener("touchmove",c)),p.canvas.parentElement&&p.canvas.parentElement.removeChild(p.canvas),(F=p.getExtension("WEBGL_lose_context"))==null||F.loseContext()}},[s,a,t,r,i,l]),e.jsx("div",{ref:f,className:"w-full h-full",...n})};function Ui({isOpen:s,onClose:a,property:t,currentUser:r,userProfile:i}){var F,P;const l=!!r,n=(i==null?void 0:i.subscription_tier)==="pro";if(!t)return null;const f=t.price?B(Number(t.price)):"Price on application";let h=t.location||t.address||"Address not available",N=t.postcode||((P=(F=t.location)==null?void 0:F.match(/[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}/i))==null?void 0:P[0])||"";const p=t.property_type||"Residential",g=t.beds||t.bedrooms||0,j=t.baths||t.bathrooms||0,y=t.square_footage||t.sqft||0,v=t.tenure||"Freehold",L=t.description||"No description available",d=(t.sale_history||[]).filter(M=>M&&M.sale_price&&!isNaN(Number(M.sale_price))).sort((M,O)=>new Date(O.sale_date).getTime()-new Date(M.sale_date).getTime());let c=0;if(d.length>1){const M=Number(d[0].sale_price),O=Number(d[d.length-1].sale_price);c=(M-O)/O*100}const T=((M,O,x,A)=>{const I=M*(1-O/100),U=x/100/12,J=A*12,X=I*U*Math.pow(1+U,J)/(Math.pow(1+U,J)-1);return{monthlyPayment:X,totalInterest:X*J-I,totalCost:X*J}})(Number(t.price)||0,20,4.5,25);return e.jsx(Ue,{open:s,onOpenChange:a,children:e.jsxs(Te,{className:"max-w-4xl max-h-[90vh] overflow-y-auto p-0",children:[e.jsxs("div",{className:"relative h-72 overflow-hidden",children:[e.jsx("img",{src:t.image_url||`https://source.unsplash.com/random/1200x600?property,house&sig=${t.id}`,alt:h,className:"w-full h-full object-cover"}),e.jsxs("div",{className:"absolute top-4 left-4 flex gap-2",children:[e.jsx(oe,{className:"bg-primary text-white",children:p}),t.status&&e.jsx(oe,{variant:"secondary",children:t.status})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs(De,{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(Le,{className:"text-2xl font-bold",children:f}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{variant:"outline",size:"sm",className:"text-sm",onClick:M=>M.stopPropagation(),children:"Save"}),e.jsx(k,{variant:"outline",size:"sm",className:"text-sm",onClick:M=>M.stopPropagation(),children:"Share"})]})]}),e.jsx(as,{className:"text-base font-medium text-foreground mt-1",children:h})]}),e.jsxs(Ve,{defaultValue:"details",className:"mt-6",children:[e.jsxs(He,{className:"grid grid-cols-3 mb-6",children:[e.jsx(ie,{value:"details",children:"Property Details"}),e.jsx(ie,{value:"investment",children:"Investment Metrics"}),e.jsx(ie,{value:"history",children:"History & Area"})]}),e.jsxs(ae,{value:"details",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center p-3 bg-muted rounded-lg",children:[e.jsx(Ps,{className:"h-5 w-5 mb-1 text-muted-foreground"}),e.jsxs("span",{className:"text-sm font-medium",children:[g," Bedrooms"]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-3 bg-muted rounded-lg",children:[e.jsx(Vr,{className:"h-5 w-5 mb-1 text-muted-foreground"}),e.jsxs("span",{className:"text-sm font-medium",children:[j," Bathrooms"]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-3 bg-muted rounded-lg",children:[e.jsx(Ia,{className:"h-5 w-5 mb-1 text-muted-foreground"}),e.jsxs("span",{className:"text-sm font-medium",children:[Wa(y)," sq ft"]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-3 bg-muted rounded-lg",children:[e.jsx(Ra,{className:"h-5 w-5 mb-1 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:v})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center",children:[e.jsx(Ke,{className:"h-5 w-5 mr-2 text-muted-foreground"}),"Location"]}),e.jsxs("div",{className:"bg-muted rounded-lg p-4",children:[e.jsxs("p",{className:"text-sm mb-1",children:[e.jsx("span",{className:"font-medium",children:"Address:"})," ",h]}),N&&e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Postcode:"})," ",N]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center",children:[e.jsx(lt,{className:"h-5 w-5 mr-2 text-muted-foreground"}),"Description"]}),e.jsx("div",{className:"bg-muted rounded-lg p-4",children:e.jsx("p",{className:"text-sm whitespace-pre-line",children:L})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center",children:[e.jsx(We,{className:"h-5 w-5 mr-2 text-muted-foreground"}),"Property Documents"]}),e.jsx("div",{className:"bg-muted rounded-lg p-4",children:e.jsx("p",{className:"text-sm mb-2",children:l&&n?e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-center",children:[e.jsx(We,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-primary underline cursor-pointer",children:"Energy Performance Certificate (EPC)"})]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(We,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-primary underline cursor-pointer",children:"Floor Plan"})]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(We,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-primary underline cursor-pointer",children:"Property Brochure"})]})]}):e.jsxs("div",{className:"text-center py-2",children:[e.jsx("p",{className:"text-muted-foreground mb-2",children:"Upgrade to PRO to access property documents"}),e.jsx(k,{className:"text-sm",size:"sm",children:"Upgrade Now"})]})})})]})]}),e.jsxs(ae,{value:"investment",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx(je,{className:"h-5 w-5 mr-2 text-muted-foreground"}),"Investment Metrics"]}),e.jsxs("div",{className:"bg-muted rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Estimated Monthly Rent"}),e.jsx("span",{className:"font-medium",children:B(t.estimated_rent||t.price*.004)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Rental Yield"}),e.jsxs("span",{className:"font-medium",children:[t.rental_yield?t.rental_yield.toFixed(2):(t.price*.004*12/t.price*100).toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Estimated ROI (5yr)"}),e.jsxs("span",{className:"font-medium",children:[t.roi?t.roi.toFixed(2):(t.price*.25/t.price*100).toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Price per sq ft"}),e.jsx("span",{className:"font-medium",children:y>0?B(t.price/y):"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx(_t,{className:"h-5 w-5 mr-2 text-muted-foreground"}),"Area Insights"]}),e.jsxs("div",{className:"bg-muted rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Average Area Price"}),e.jsx("span",{className:"font-medium",children:B(t.area_avg_price||t.price*1.1)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Price vs. Area Average"}),e.jsx("div",{className:"flex items-center",children:t.price<(t.area_avg_price||t.price*1.1)?e.jsxs(e.Fragment,{children:[e.jsx(Ma,{className:"h-4 w-4 text-green-500 mr-1"}),e.jsxs("span",{className:"text-green-500 font-medium",children:[(((t.area_avg_price||t.price*1.1)-t.price)/(t.area_avg_price||t.price*1.1)*100).toFixed(1),"% below"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Xs,{className:"h-4 w-4 text-amber-500 mr-1"}),e.jsxs("span",{className:"text-amber-500 font-medium",children:[((t.price-(t.area_avg_price||t.price*.9))/(t.area_avg_price||t.price*.9)*100).toFixed(1),"% above"]})]})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"12-month Price Trend"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Xs,{className:"h-4 w-4 text-green-500 mr-1"}),e.jsx("span",{className:"text-green-500 font-medium",children:"+4.2%"})]})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx(je,{className:"h-5 w-5 mr-2 text-muted-foreground"}),"Mortgage Calculator"]}),e.jsxs("div",{className:"bg-muted rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm mb-1",children:"Property Price"}),e.jsx("p",{className:"text-lg font-medium",children:B(Number(t.price)||0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm mb-1",children:"Monthly Payment"}),e.jsx("p",{className:"text-lg font-medium",children:B(T.monthlyPayment)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm mb-1",children:"Total Interest"}),e.jsx("p",{className:"text-lg font-medium",children:B(T.totalInterest)})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center mt-2",children:"Based on 20% down payment, 4.5% interest rate, 25-year term"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx(je,{className:"h-5 w-5 mr-2 text-muted-foreground"}),"Cash Flow Analysis"]}),e.jsx("div",{className:"bg-muted rounded-lg p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Monthly Rental Income"}),e.jsx("span",{className:"font-medium",children:B(t.estimated_rent||t.price*.004)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Mortgage Payment"}),e.jsxs("span",{className:"font-medium text-red-500",children:["-",B(T.monthlyPayment)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Est. Maintenance (10%)"}),e.jsxs("span",{className:"font-medium text-red-500",children:["-",B((t.estimated_rent||t.price*.004)*.1)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Est. Management (5%)"}),e.jsxs("span",{className:"font-medium text-red-500",children:["-",B((t.estimated_rent||t.price*.004)*.05)]})]}),e.jsxs("div",{className:"border-t pt-2 mt-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Monthly Cash Flow"}),e.jsx("span",{className:"font-medium",children:B((t.estimated_rent||t.price*.004)-T.monthlyPayment-(t.estimated_rent||t.price*.004)*.15)})]})]})})]})]}),e.jsxs(ae,{value:"history",className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx($e,{className:"h-5 w-5 mr-2 text-muted-foreground"}),"Sale History"]}),d.length>0?e.jsxs("div",{className:"bg-muted rounded-lg p-4",children:[e.jsxs("div",{className:"mb-4",children:[c!==0&&e.jsxs("div",{className:"mb-3 text-sm",children:[e.jsx("span",{className:"font-medium",children:"Total price growth: "}),e.jsxs("span",{className:c>=0?"text-green-500":"text-red-500",children:[c>=0?"+":"",c.toFixed(2),"%"]})]}),e.jsx("div",{className:"relative h-24 mt-6 mb-2",children:d.map((M,O)=>{const x=Math.max(...d.map(J=>Number(J.sale_price))),A=Number(M.sale_price)/x*100,I=100/d.length,U=O*I;return e.jsx("div",{className:"absolute bottom-0 bg-primary hover:bg-primary/80 rounded-t transition-all cursor-pointer group",style:{height:`${A}%`,width:`${I-5}%`,left:`${U}%`},title:`${Rs(M.sale_date)}: ${B(Number(M.sale_price))}`,children:e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 absolute -top-10 left-1/2 transform -translate-x-1/2 bg-background border p-2 rounded text-xs whitespace-nowrap z-10",children:[Rs(M.sale_date),": ",B(Number(M.sale_price))]})},O)})})]}),e.jsx("div",{className:"space-y-3",children:d.map((M,O)=>e.jsxs("div",{className:"flex justify-between items-center py-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx($e,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:Rs(M.sale_date)})]}),e.jsx("span",{className:"font-medium",children:B(Number(M.sale_price))})]},O))})]}):e.jsx("div",{className:"bg-muted rounded-lg p-4 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No sale history available"})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx(_t,{className:"h-5 w-5 mr-2 text-muted-foreground"}),"Neighborhood Information"]}),l&&n?e.jsxs("div",{className:"bg-muted rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Local Schools"}),e.jsx(oe,{variant:"outline",children:"Good"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Transport Links"}),e.jsx(oe,{variant:"outline",children:"Excellent"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Local Amenities"}),e.jsx(oe,{variant:"outline",children:"Good"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Crime Rate"}),e.jsx(oe,{variant:"outline",children:"Low"})]}),e.jsx("div",{className:"mt-2 pt-2 border-t",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"This property is located in a well-established residential area with good local schools and excellent transport links. The neighborhood has seen steady property value growth over the past 5 years."})})]}):e.jsxs("div",{className:"bg-muted rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-2",children:"Upgrade to PRO to access detailed neighborhood information"}),e.jsx(k,{className:"text-sm",size:"sm",children:"Upgrade Now"})]})]})]})]})]})]})})}const Ge=[{name:"Savills",username:"@savills",body:"Leading the way in property investment and market analysis.",img:"https://avatar.vercel.sh/savills"},{name:"Knight Frank",username:"@knightfrank",body:"Exceptional platform for property investment insights.",img:"https://avatar.vercel.sh/knightfrank"},{name:"JLL",username:"@jll",body:"Revolutionary approach to property investment analytics.",img:"https://avatar.vercel.sh/jll"}],zi=Ge.slice(0,Ge.length/2),qi=Ge.slice(Ge.length/2),Bi=Ge.slice(0,Ge.length/2),Gi=Ge.slice(Ge.length/2),Cs=({img:s,name:a,username:t,body:r})=>e.jsxs("figure",{className:_("relative h-full w-36 cursor-pointer overflow-hidden rounded-xl border p-4","border-gray-950/[.1] bg-gray-950/[.01] hover:bg-gray-950/[.05]","dark:border-gray-50/[.1] dark:bg-gray-50/[.10] dark:hover:bg-gray-50/[.15]"),children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx("img",{className:"rounded-full",width:"32",height:"32",alt:"",src:s}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("figcaption",{className:"text-sm font-medium dark:text-white",children:a}),e.jsx("p",{className:"text-xs font-medium dark:text-white/40",children:t})]})]}),e.jsx("blockquote",{className:"mt-2 text-sm",children:r})]}),Vi=()=>{var D;const{user:s,profile:a,signOut:t}=ee(),[r,i]=S.useState(!0),[l,n]=S.useState([]),[f,h]=S.useState(!1),[N,p]=S.useState(!1),[g,j]=S.useState(!1),[y,v]=S.useState("signin"),[L,b]=S.useState(!1),[d]=S.useState(),[c,w]=S.useState(1),[T,F]=S.useState(!0),P=6,[M,O]=S.useState(!0),[x,A]=S.useState(!1),[I,U]=S.useState(null),[J,X]=S.useState(!1),he=S.useRef(null),de=S.useRef(!1),{data:se,isLoading:xe}=Oi(),be=async(m=1,R=!1)=>{if(!de.current){de.current=!0;try{R?A(!0):O(!0),console.log("Fetching page:",m);const V=await Rt(m,P);console.log("Received properties:",V),n(m===1?V:te=>[...te,...V]),F(V.length===P),w(m),i(!1)}catch(V){console.error("Error loading properties:",V)}finally{O(!1),A(!1),de.current=!1}}};S.useEffect(()=>{r&&be(1,!1)},[r]),S.useEffect(()=>{if(!he.current||r||f)return;const m=new IntersectionObserver(R=>{R[0].isIntersecting&&T&&!de.current&&be(c+1,!0)},{rootMargin:"200px",threshold:.1});return m.observe(he.current),()=>m.disconnect()},[T,c,r,f]);const Se=async m=>{if(!m.trim()){n([]),h(!1),w(1),F(!0),O(!0);try{const R=await Rt(1,P);n(R),F(R.length===P)}catch(R){console.error("Error loading properties:",R)}finally{O(!1)}return}h(!0),n([]);try{const V=(await Di(m)).map(te=>({id:te.id,title:te.title,location:te.location,price:te.price,sqft:te.sqft,beds:te.beds,baths:te.baths,description:te.description,image_url:te.image_url,is_featured:te.is_featured,created_at:te.created_at,updated_at:te.updated_at}));n(V),F(!1),w(1)}catch(R){console.error("Error searching properties:",R),n([])}finally{h(!1)}},ve=M,we=l&&l.length>0;return console.log("Render state:",{isLoading:M,searchResultsLength:l==null?void 0:l.length,showLoading:ve,showProperties:we}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(fs,{isAuthenticated:!!s,userProfile:a||void 0,onSignIn:()=>{v("signin"),p(!0)},onSignUp:()=>{v("signup"),p(!0)},onSignOut:async()=>{try{await t(),window.location.href="/"}catch(m){console.error("Error signing out:",m)}}}),e.jsxs("main",{children:[e.jsx(Ne,{onSearch:Se}),e.jsx("div",{className:"w-full bg-background py-8",children:e.jsxs("div",{className:"max-w-[1200px] mx-auto px-4 sm:px-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:f?"Search Results":"Featured Properties"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:ve?Array(3).fill(0).map((m,R)=>e.jsx("div",{className:"w-full h-[420px] bg-muted rounded-lg animate-pulse"},R)):we?l.map(m=>e.jsx("div",{onClick:()=>{U(m),X(!0)},className:"cursor-pointer hover:opacity-90 transition-opacity",children:e.jsx(Fs,{id:m.id,address:m.location||"Location not available",price:Number(m.price)||0,squareFootage:Number(m.sqft)||0,bedrooms:Number(m.beds)||0,bathrooms:Number(m.baths)||0,isPremium:!!m.is_featured,propertyType:"residential",description:m.description||"",createdAt:m.created_at||new Date().toISOString(),images:m.image_url?[m.image_url]:[],currentUser:s,userProfile:a})},m.id||Math.random().toString())):e.jsx("div",{className:"col-span-3 text-center py-8 text-muted-foreground",children:"No properties found"})}),T&&!M&&!f&&e.jsx("div",{ref:he,className:"h-24 flex items-center justify-center my-8",children:x?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(Qe,{}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading more properties..."})]}):e.jsx("div",{className:"h-8"})})]})}),e.jsx("div",{className:"w-full bg-background py-8",children:e.jsxs("div",{className:"max-w-[1200px] mx-auto px-4 sm:px-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Investment Deals"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:xe?Array(3).fill(0).map((m,R)=>e.jsx("div",{className:"w-full h-[420px] bg-muted rounded-lg animate-pulse"},R)):(D=se==null?void 0:se.pages)!=null&&D[0]&&Array.isArray(se.pages[0])?se.pages[0].map(m=>e.jsx(Fs,{id:m.id,address:m.location,price:m.price,description:m.description,propertyType:m.property_type,createdAt:m.created_at,images:[m.image_url],isDeal:!0,roi_percentage:m.roi_percentage,investment_term:m.investment_term,deal_type:m.deal_type,isPremium:!0,currentUser:s,userProfile:a},m.id)):e.jsx("div",{className:"col-span-3 text-center py-8 text-muted-foreground",children:"No investment deals available"})})]})}),e.jsxs("section",{className:"w-full py-12 bg-background",children:[e.jsx("div",{className:"container mx-auto text-center mb-8",children:e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Trusted by Industry Leaders"})}),e.jsxs("div",{className:"relative flex h-96 w-full flex-row items-center justify-center gap-4 overflow-hidden [perspective:300px]",children:[e.jsxs("div",{className:"flex flex-row items-center gap-4",style:{transform:"translateX(-100px) translateY(0px) translateZ(-100px) rotateX(20deg) rotateY(-10deg) rotateZ(20deg)"},children:[e.jsx(ks,{pauseOnHover:!0,vertical:!0,className:"[--duration:20s]",children:zi.map(m=>e.jsx(Cs,{...m},m.username))}),e.jsx(ks,{reverse:!0,pauseOnHover:!0,className:"[--duration:20s]",vertical:!0,children:qi.map(m=>e.jsx(Cs,{...m},m.username))}),e.jsx(ks,{reverse:!0,pauseOnHover:!0,className:"[--duration:20s]",vertical:!0,children:Bi.map(m=>e.jsx(Cs,{...m},m.username))}),e.jsx(ks,{pauseOnHover:!0,className:"[--duration:20s]",vertical:!0,children:Gi.map(m=>e.jsx(Cs,{...m},m.username))})]}),e.jsx("div",{className:"pointer-events-none absolute inset-x-0 top-0 h-1/4 bg-gradient-to-b from-background"}),e.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 h-1/4 bg-gradient-to-t from-background"}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 w-1/4 bg-gradient-to-r from-background"}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 w-1/4 bg-gradient-to-l from-background"})]})]}),e.jsx("div",{className:"w-full bg-background py-8",children:e.jsx("div",{className:"max-w-[1200px] mx-auto px-4 sm:px-8",children:e.jsx("div",{className:"mb-8",children:e.jsx(hr,{})})})}),(!a||a.subscription_tier==="free")&&e.jsx("div",{className:"w-full bg-background py-16",children:e.jsx("div",{className:"max-w-[1200px] mx-auto px-4 sm:px-8",children:e.jsxs("div",{className:"relative w-full rounded-3xl overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx($i,{baseColor:[.1,.1,.1],speed:1,amplitude:.6,interactive:!0})}),e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-[8px]"}),e.jsxs("div",{className:"relative z-10 text-center py-12 px-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 text-white",children:"Unlock Premium Property Insights"}),e.jsx("p",{className:"text-lg text-gray-300 mb-8 max-w-2xl mx-auto",children:"Get access to detailed property analysis, market comparisons, and investment metrics to make informed decisions."}),e.jsx("button",{onClick:()=>j(!0),className:"px-8 py-3 rounded-full bg-primary text-primary-foreground hover:bg-primary/90 transition-colors",children:"Upgrade Now"})]})]})})})]}),e.jsx(ut,{}),e.jsx(mt,{isOpen:N,onClose:()=>p(!1),defaultMode:y}),e.jsx(cr,{isOpen:g,onClose:()=>j(!1),currentUser:s,userProfile:a}),e.jsx(ur,{isOpen:L,onClose:()=>b(!1),receiverId:d,currentUser:s,userProfile:a}),e.jsx(Ui,{isOpen:J,onClose:()=>{X(!1),setTimeout(()=>U(null),300)},property:I,currentUser:s,userProfile:a})]})};function ce({children:s}){const{user:a,profile:t,signOut:r,isLoading:i}=ee(),[l,n]=S.useState(!1),[f,h]=S.useState("signin");return e.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[e.jsx(fs,{isAuthenticated:!!a,userProfile:t,onSignIn:()=>window.location.href="/login",onSignUp:()=>window.location.href="/signup",onSignOut:r}),e.jsx("main",{className:"flex-1",children:s}),e.jsx(ut,{}),e.jsx(mt,{isOpen:l,onClose:()=>n(!1),defaultMode:f})]})}function Hi(){const[s,a]=o.useState(null),[t,r]=o.useState(!0);return o.useEffect(()=>{const l=async()=>{try{const N=(await(await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:"What is the current Bitcoin price in GBP? Return ONLY the number, no text or currency symbols."}]}]})})).json()).candidates[0].content.parts[0].text,p=parseFloat(N.replace(/[^0-9.]/g,""));isNaN(p)||(a(p),r(!1))}catch(f){console.error("Error fetching Bitcoin price:",f)}};l();const n=setInterval(l,6e4);return()=>clearInterval(n)},[]),{btcPrice:s,loading:t,convertGBPtoBTC:l=>s?l/s:null}}function Wi({amount:s}){const{loading:a,convertGBPtoBTC:t}=Hi(),r=t(s);return a?e.jsx("span",{className:"text-muted-foreground",children:"Loading..."}):r?e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Ea,{className:"h-4 w-4 text-[#F7931A]"}),r.toFixed(2)]}):null}async function Yi(s,a){var t;try{console.log("Starting profile update for user:",s),console.log("Updates to apply:",a);const{data:r,error:i}=await Y.from("profiles").select("role").eq("id",(t=(await Y.auth.getUser()).data.user)==null?void 0:t.id);if(i)throw console.error("Admin check error:",i),i;if(!(r!=null&&r.length)||r[0].role!=="admin")throw new Error("Unauthorized: Only admins can update user profiles");const{data:l,error:n}=await Y.from("profiles").select("*").eq("id",s);if(n)throw console.error("User verification error:",n),n;if(!(l!=null&&l.length))throw new Error("User not found");console.log("Existing user:",l[0]);const f={...a,updated_at:new Date().toISOString()};console.log("Applying updates:",f);const{data:h,error:N}=await Y.from("profiles").update(f).eq("id",s).select();if(N)throw console.error("Profile update error:",N),N;if(!(h!=null&&h.length))throw console.error("No data returned from update"),new Error("Update failed - no data returned");if(console.log("Profile updated successfully:",h[0]),a.role)try{await Y.auth.admin.updateUserById(s,{user_metadata:{role:a.role}}),console.log("Auth metadata updated for role change")}catch(p){console.warn("Failed to update auth metadata (non-critical):",p)}return h[0]}catch(r){throw console.error("Error in updateUserProfile:",r),r}}async function Mt(){try{const{data:s,error:a}=await Y.from("profiles").select(`
        *,
        subscription_tier,
        subscription_status,
        role
      `).order("created_at",{ascending:!1});if(a)throw console.error("Profiles fetch error:",a),a;return s?s.map(t=>({...t,role:t.role||"user",subscription_tier:t.subscription_tier||"free",subscription_status:t.subscription_status||"active"})):[]}catch(s){throw console.error("Error fetching users:",s),s}}async function Ki(s,a){try{console.log("Importing properties:",{count:s.length,userId:a});const{data:t,error:r}=await Y.from("properties").insert(s.map(i=>({...i,added_by_user_id:a,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})));if(r)throw console.error("Supabase error:",r),r;return console.log("Import successful:",t),t}catch(t){throw console.error("Error importing properties:",t),t}}const xt=o.forwardRef(({className:s,...a},t)=>e.jsx("textarea",{className:_("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a}));xt.displayName="Textarea";function Ji({children:s}){const[a,t]=o.useState(!1),[r,i]=o.useState(!0);o.useEffect(()=>{l()},[]);const l=()=>{i(!0);try{const n=ee();t(!0)}catch(n){console.error("Auth context not available:",n),t(!1)}finally{i(!1)}};return r?e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Checking authentication..."})]})}):a?e.jsx(e.Fragment,{children:s}):e.jsx("div",{className:"flex items-center justify-center min-h-[300px]",children:e.jsxs("div",{className:"text-center max-w-md p-6 border rounded-lg bg-muted/50",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Authentication Error"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Unable to access authentication. This may be due to a temporary issue or your session has expired."}),e.jsxs(k,{variant:"outline",onClick:()=>{window.location.reload()},className:"inline-flex items-center gap-2",children:[e.jsx(As,{className:"h-4 w-4"})," Refresh Page"]})]})})}function Zi(){const[s,a]=o.useState(!1),[t,r]=o.useState(""),[i,l]=o.useState(!1),[n,f]=o.useState(!1),[h,N]=o.useState([]),[p,g]=o.useState(new Set),[j,y]=o.useState(1),[v,L]=o.useState(1),[b,d]=o.useState(0),[c,w]=o.useState(null),[T,F]=o.useState(""),[P,M]=o.useState(!1),[O,x]=o.useState("idle"),[A,I]=o.useState(""),{user:U}=ee(),{toast:J}=Ce();o.useEffect(()=>{s||(N([]),g(new Set),y(1),L(1),d(0),r(""))},[s]);const X=async()=>{if(!(!(U!=null&&U.id)||p.size===0))try{f(!0);const se=h.filter(xe=>p.has(xe.id));await Ki(se,U.id),J({title:"Success",description:`Imported ${p.size} properties successfully`}),a(!1)}catch{J({variant:"destructive",title:"Error",description:"Failed to import properties. Please try again."})}finally{f(!1)}},he=se=>{se.target.files&&se.target.files.length>0&&(w(se.target.files[0]),F(""))},de=se=>{F(se.target.value),w(null)};return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Property Importer"}),e.jsx("p",{className:"text-muted-foreground",children:"Import properties from external sources by uploading a JSON file or pasting JSON data."})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs($,{children:[e.jsxs(K,{children:[e.jsx(ue,{children:"Upload JSON File"}),e.jsx(at,{children:"Import properties from a JSON file"})]}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-6 text-center hover:bg-muted/50 transition-colors",children:[e.jsx(Hr,{className:"h-10 w-10 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Drag and drop a JSON file here, or click to browse"}),e.jsx(q,{type:"file",accept:".json",onChange:he,className:"hidden",id:"file-upload"}),e.jsx(G,{htmlFor:"file-upload",className:"cursor-pointer",children:e.jsx(k,{variant:"outline",type:"button",children:"Browse Files"})})]}),c&&e.jsxs("div",{className:"bg-muted p-3 rounded text-sm",children:[e.jsx("p",{className:"font-medium mb-1",children:"Selected file:"}),e.jsxs("p",{className:"text-muted-foreground",children:[c.name," (",Math.round(c.size/1024)," KB)"]})]})]})})]}),e.jsxs($,{children:[e.jsxs(K,{children:[e.jsx(ue,{children:"Paste JSON Data"}),e.jsx(at,{children:"Paste your JSON data directly"})]}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(xt,{placeholder:'{"properties": [{"address": "123 Main St", "price": 250000, ...}]}',rows:8,value:T,onChange:de,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"JSON must be properly formatted and contain property data."})]})})]})]}),e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsx(k,{onClick:X,disabled:P||!c&&!T,className:"px-8",children:P?"Importing...":"Import Properties"})}),O!=="idle"&&e.jsxs(xs,{variant:O==="success"?"default":"destructive",className:"mt-6",children:[O==="success"?e.jsx(Wr,{className:"h-4 w-4"}):e.jsx(Yr,{className:"h-4 w-4"}),e.jsx(ht,{children:O==="success"?"Import Successful":"Import Failed"}),e.jsx(ps,{children:A})]}),e.jsxs($,{className:"mt-8",children:[e.jsx(K,{children:e.jsxs(ue,{className:"flex items-center gap-2",children:[e.jsx(lt,{className:"h-5 w-5"}),"Import Format Guidelines"]})}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your JSON data should follow this structure:"}),e.jsx("pre",{className:"bg-muted p-4 rounded-md text-xs overflow-auto",children:`{
  "properties": [
    {
      "address": "123 Main Street, London, E1 6AN",
      "price": 450000,
      "type": "flat",
      "bedrooms": 2,
      "bathrooms": 1,
      "size_sqft": 750,
      "description": "A spacious 2 bedroom flat...",
      "images": ["image1.jpg", "image2.jpg"]
    },
    {
      // Additional properties...
    }
  ]
}`}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"You can also import a simple array of property objects."})]})})]})]})}function Xi(){return e.jsx(Ji,{children:e.jsx(Zi,{})})}function Qi(){const{user:s,profile:a}=ee(),t=ze(),[r,i]=S.useState([]),[l,n]=S.useState([]),[f,h]=S.useState([]),[N,p]=S.useState({totalProperties:0,totalValue:0,averagePrice:0,totalProfit:0,monthlyIncome:0}),[g,j]=S.useState(!0),[y,v]=S.useState(null),L=S.useCallback(async()=>{if(!(!s||(a==null?void 0:a.role)!=="admin"))try{const c=await Mt();h(c)}catch(c){console.error("Error loading users:",c),v("Failed to load users")}finally{j(!1)}},[s,a]),b=async(c,w)=>{try{j(!0),console.log("Attempting to update user:",c),console.log("Updates:",w);const T=await Yi(c,w);console.log("Update successful:",T);const F=await Mt();h(F),alert("User updated successfully")}catch(T){console.error("Error updating user:",T),alert(T.message||"Failed to update user. Please check console for details.")}finally{j(!1)}},d=S.useCallback(async()=>{if(s)try{const[c,{data:w}]=await Promise.all([Li(s.id),Y.from("properties").select(`*,
            assigned_user:profiles!properties_assigned_user_id_fkey(full_name, email),
            author:profiles!properties_created_by_fkey(full_name, email)`).eq("created_by",s.id)]);n(w||[]),i(c);const T=(w||[]).length+c.length,F=[...w||[],...c].reduce((x,A)=>x+(A.price||0),0),P=F/(T||1),M=[...w||[],...c].reduce((x,A)=>x+(A.potential_profit||0),0),O=[...w||[],...c].reduce((x,A)=>x+(A.monthly_income||0),0);p({totalProperties:T,totalValue:F,averagePrice:P,totalProfit:M,monthlyIncome:O})}catch(c){console.error("Error loading properties:",c)}},[s]);return S.useEffect(()=>{if(!s){t("/");return}d(),L()},[s,t,d,L]),s?e.jsx(ce,{children:e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsx(Xi,{})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx($,{children:e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Portfolio Value"}),e.jsx(je,{className:"w-5 h-5 text-primary"})]}),e.jsxs("p",{className:"text-3xl font-bold",children:["£",N.totalValue.toLocaleString()]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[N.totalProperties," properties"]})]})}),e.jsx($,{children:e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Average Price"}),e.jsx(Qs,{className:"w-5 h-5 text-primary"})]}),e.jsxs("p",{className:"text-3xl font-bold",children:["£",N.averagePrice.toLocaleString()]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Per property"})]})}),e.jsx($,{children:e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Total Profit"}),e.jsx(ts,{className:"w-5 h-5 text-primary"})]}),e.jsxs("p",{className:"text-3xl font-bold",children:["£",N.totalProfit.toLocaleString()]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Estimated profit"})]})}),e.jsx($,{children:e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"BTC Value"}),e.jsx(Ea,{className:"w-5 h-5 text-[#F7931A]"})]}),e.jsx(Wi,{amount:N.totalValue}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Portfolio in BTC"})]})})]}),(a==null?void 0:a.role)==="admin"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[e.jsx(ot,{className:"w-5 h-5"})," User Management"]})}),y&&e.jsx("div",{className:"text-red-500 mb-4",children:y}),g?e.jsx("div",{children:"Loading..."}):e.jsx("div",{className:"grid gap-4",children:f.map(c=>e.jsx("div",{className:"border p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:c.full_name}),e.jsx("p",{className:"text-sm text-gray-600",children:c.email})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:c.role,onChange:w=>b(c.id,{role:w.target.value}),className:"border rounded p-1",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"moderator",children:"Moderator"}),e.jsx("option",{value:"admin",children:"Admin"})]}),e.jsxs("select",{value:c.subscription_tier,onChange:w=>b(c.id,{subscription_tier:w.target.value}),className:"border rounded p-1",children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"basic",children:"Basic"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"premium",children:"Premium"})]})]})]})},c.id))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[e.jsx(Kr,{className:"w-5 h-5"})," Saved Properties"]}),e.jsx("div",{className:"space-y-4",children:r.map(c=>e.jsx(Fs,{...c.property,isSubscriber:(a==null?void 0:a.subscription_tier)!=="free"},c.property.id))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[e.jsx(Qs,{className:"w-5 h-5"})," Added Properties"]}),e.jsx("div",{className:"space-y-4",children:l.map(c=>e.jsx(Fs,{...c,isSubscriber:(a==null?void 0:a.subscription_tier)!=="free"},c.id))})]})]})]})})}):(t("/"),null)}function el({onSubscribe:s}){const{profile:a}=ee(),t=(a==null?void 0:a.subscription_tier)||"free";return e.jsx("div",{className:"py-16 bg-background",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Choose Your Plan"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Select the perfect plan for your property investment journey"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-7xl mx-auto",children:Object.entries(Ci).map(([r,i])=>e.jsxs($,{className:`relative ${r==="PRO"?"border-primary shadow-lg scale-105 bg-gradient-to-r from-emerald-400/10 to-cyan-400/10":""}`,children:[r==="PRO"&&e.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 bg-gradient-to-r from-emerald-400 to-cyan-400 text-white px-4 py-1 rounded-full text-sm font-medium border border-emerald-500/20 shadow-lg",children:"Most Popular"}),e.jsxs(K,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-2xl font-bold",children:i.name}),r==="PREMIUM"&&e.jsx(Na,{className:"h-6 w-6 text-yellow-500"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-4xl font-bold",children:i.price}),e.jsx("span",{className:"text-gray-600 ml-2",children:"/month"})]})]}),e.jsx(z,{children:e.jsx("ul",{className:"space-y-3",children:i.features.map((l,n)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(le,{className:"h-5 w-5 text-green-500 mt-0.5"}),e.jsx("span",{children:l})]},n))})}),e.jsx(Os,{children:e.jsx(k,{className:"w-full",variant:r==="PRO"?"default":"outline",onClick:()=>s(i.priceId),disabled:t===r.toLowerCase(),children:t===r.toLowerCase()?"Current Plan":"Subscribe"})})]},r))})]})})}function sl(){const{user:s,profile:a,signOut:t}=ee(),{toast:r}=Ce(),[i,l]=S.useState(!1),[n,f]=S.useState("signin"),h=async N=>{if(!s){localStorage.setItem("pending_subscription_price_id",N),f("signup"),l(!0);return}try{await or(N,s.id)}catch{r({title:"Error",description:"Failed to start subscription process. Please try again.",variant:"destructive"})}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(fs,{isAuthenticated:!!s,userProfile:a||void 0,onSignIn:()=>{f("signin"),l(!0)},onSignUp:()=>{f("signup"),l(!0)},onSignOut:async()=>{try{await t(),window.location.href="/"}catch(N){console.error("Error signing out:",N)}}}),e.jsx(Ne,{title:"Choose Your Perfect Plan",subtitle:"Select the perfect subscription plan to unlock premium features and detailed property insights",backgroundImage:"https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?ixlib=rb-4.0.3",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsxs("main",{children:[e.jsx(el,{onSubscribe:h}),e.jsxs("div",{className:"container mx-auto px-4 py-12",children:[e.jsxs("div",{className:"max-w-4xl mx-auto prose dark:prose-invert mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6",children:"Investment Plans for Every Property Investor"}),e.jsx("p",{children:"Choose from our range of subscription plans designed to meet the needs of property investors at every level. From market analysis to detailed property insights, our plans provide the tools you need to make informed investment decisions."}),e.jsx("h3",{className:"text-2xl font-semibold mt-8 mb-4",children:"Plan Benefits"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Access to comprehensive property market data and analytics"}),e.jsx("li",{children:"Real-time market insights and trend analysis"}),e.jsx("li",{children:"Advanced property search and filtering capabilities"}),e.jsx("li",{children:"Investment calculators and ROI projections"}),e.jsx("li",{children:"Portfolio tracking and management tools"})]}),e.jsx("h3",{className:"text-2xl font-semibold mt-8 mb-4",children:"Why Subscribe?"}),e.jsx("p",{children:"Our subscription plans give you access to premium features and insights that help you stay ahead in the property market. From basic market analysis to advanced AI-powered predictions, we provide the tools you need to make successful property investments."}),e.jsx("h3",{className:"text-2xl font-semibold mt-8 mb-4",children:"Money-Back Guarantee"}),e.jsx("p",{children:"We're confident in the value our platform provides. If you're not satisfied with your subscription within the first 30 days, we'll provide a full refund, no questions asked."})]}),e.jsx(hr,{})]})]}),e.jsx(ut,{}),e.jsx(mt,{isOpen:i,onClose:()=>l(!1),defaultMode:n})]})}function tl(s){const[a,t]=S.useState(0),[r,i]=S.useState(!1),{user:l}=ee(),{toast:n}=Ce(),[f,h]=S.useState({profileImage:"",bannerImage:"",selectedWidgets:[]}),N=async()=>{if(l){i(!0);try{const{error:g}=await Y.from("profiles").update({avatar_url:f.profileImage||`https://api.dicebear.com/7.x/avataaars/svg?seed=${l.email}`,banner_url:f.bannerImage||"https://images.unsplash.com/photo-1486406146926-c627a92ad1ab",dashboard_widgets:f.selectedWidgets,onboarding_completed:!0}).eq("id",l.id);if(g)throw g;n({title:"Setup Complete!",description:"Your profile has been updated successfully."}),s.onClose()}catch{n({title:"Error",description:"Failed to update profile. Please try again.",variant:"destructive"})}finally{i(!1)}}},p=[{title:"Profile Image",description:"Add a profile image to personalize your account",component:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{children:"Profile Image URL"}),e.jsx(q,{placeholder:"Enter image URL or leave blank for default avatar",value:f.profileImage,onChange:g=>h(j=>({...j,profileImage:g.target.value}))})]}),f.profileImage&&e.jsx("img",{src:f.profileImage,alt:"Profile Preview",className:"w-24 h-24 rounded-full object-cover mx-auto"})]})},{title:"Dashboard Banner",description:"Choose a banner image for your dashboard",component:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{children:"Banner Image URL"}),e.jsx(q,{placeholder:"Enter banner image URL or leave blank for default",value:f.bannerImage,onChange:g=>h(j=>({...j,bannerImage:g.target.value}))})]}),f.bannerImage&&e.jsx("img",{src:f.bannerImage,alt:"Banner Preview",className:"w-full h-32 object-cover rounded-md"})]})},{title:"Dashboard Widgets",description:"Select the widgets you want to see on your dashboard",component:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:["market_trends","property_news","saved_properties","price_alerts","market_insights","investment_calculator"].map(g=>e.jsx(k,{variant:f.selectedWidgets.includes(g)?"default":"outline",onClick:()=>h(j=>({...j,selectedWidgets:j.selectedWidgets.includes(g)?j.selectedWidgets.filter(y=>y!==g):[...j.selectedWidgets,g]})),className:"h-auto py-4 px-6 text-left flex flex-col items-start space-y-2",children:e.jsx("span",{className:"font-medium capitalize",children:g.replace("_"," ")})},g))})})}];return e.jsx(Ue,{open:s.isOpen,onOpenChange:s.onClose,children:e.jsxs(Te,{className:"sm:max-w-[600px]",children:[e.jsxs(De,{children:[e.jsx(Le,{children:p[a].title}),e.jsx(as,{children:p[a].description})]}),e.jsx("div",{className:"py-6",children:p[a].component}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(k,{variant:"outline",onClick:()=>t(g=>Math.max(0,g-1)),disabled:a===0,children:"Previous"}),e.jsx(k,{onClick:()=>{a===p.length-1?N():t(g=>Math.min(p.length-1,g+1))},disabled:r,children:a===p.length-1?"Complete Setup":"Next"})]})]})})}function al(){const s=ze(),[a]=Jr(),{toast:t}=Ce(),{user:r}=ee(),[i,l]=o.useState(!0);return o.useEffect(()=>{a.get("session_id")&&t({title:"Subscription Successful!",description:"Thank you for subscribing. Your premium features are now available."}),i||s("/dashboard")},[i,s,a,t]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"max-w-md w-full mx-auto p-8",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Subscription Successful!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Thank you for subscribing. Your premium features are now available."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Setting up your preferences..."})]})})}),e.jsx(tl,{isOpen:i,onClose:()=>{l(!1),s("/dashboard")}})]})}function rl(){const s=ze(),{toast:a}=Ce();return o.useEffect(()=>{a({title:"Subscription Cancelled",description:"Your subscription process was cancelled. Please try again if this was a mistake.",variant:"destructive"});const t=setTimeout(()=>{s("/")},3e3);return()=>clearTimeout(t)},[]),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"max-w-md w-full mx-auto p-8",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Subscription Cancelled"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Your subscription process was cancelled. Please try again if this was a mistake."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting you to the homepage..."})]})})})}const nl=5*1024*1024,Et=["image/jpeg","image/png","image/webp"];function il({currentAvatarUrl:s,onUpload:a,userInitials:t}){const[r,i]=o.useState(!1),{toast:l}=Ce(),n=S.useRef(null),f=async h=>{var p;const N=(p=h.target.files)==null?void 0:p[0];if(N){if(N.size>nl){l({title:"File too large",description:"Please select an image under 5MB",variant:"destructive"});return}if(!Et.includes(N.type)){l({title:"Invalid file type",description:"Please select a JPEG, PNG or WebP image",variant:"destructive"});return}try{i(!0),await a(N),l({title:"Success",description:"Profile picture updated successfully"})}catch(g){console.error("Error uploading avatar:",g),l({title:"Upload failed",description:"Failed to update profile picture. Please try again.",variant:"destructive"})}finally{i(!1)}}};return e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs(Re,{className:"h-24 w-24",children:[e.jsx(Me,{src:s}),e.jsx(Ee,{children:t})]}),e.jsx("input",{type:"file",ref:n,className:"hidden",accept:Et.join(","),onChange:f}),e.jsx(k,{variant:"outline",onClick:()=>{var h;return(h=n.current)==null?void 0:h.click()},disabled:r,children:r?"Uploading...":"Change Profile Picture"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Maximum file size: 5MB. Supported formats: JPEG, PNG, WebP"})]})}function Tt(){var p;const{user:s,profile:a}=ee(),{toast:t}=Ce(),[r,i]=o.useState(!1),[l,n]=o.useState({fullName:(a==null?void 0:a.full_name)||"",currentPassword:"",newPassword:"",confirmPassword:""}),f=async g=>{if(s)try{const j=g.name.split(".").pop(),y=`${s.id}-${Date.now()}.${j}`,v=`${s.id}/${y}`,{error:L,data:b}=await Y.storage.from("avatars").upload(v,g,{cacheControl:"3600",upsert:!0});if(L)throw console.error("Upload error:",L),L;const{data:{publicUrl:d}}=Y.storage.from("avatars").getPublicUrl(v);console.log("File uploaded, public URL:",d);const{error:c}=await Y.from("profiles").update({avatar_url:d,updated_at:new Date().toISOString()}).eq("id",s.id);if(c)throw console.error("Profile update error:",c),c;const{data:w,error:T}=await Y.from("profiles").select("avatar_url").eq("id",s.id).single();if(T)throw console.error("Verification error:",T),T;console.log("Profile updated with new avatar:",w),window.location.reload()}catch(j){throw console.error("Error in handleAvatarUpload:",j),j}},h=async g=>{if(g.preventDefault(),!!s)try{if(i(!0),l.fullName!==(a==null?void 0:a.full_name)){const{error:j}=await Y.from("profiles").update({full_name:l.fullName}).eq("id",s.id);if(j)throw j}if(l.newPassword){if(l.newPassword!==l.confirmPassword)throw new Error("New passwords do not match");const{error:j}=await Y.auth.updateUser({password:l.newPassword});if(j)throw j}t({title:"Success",description:"Profile updated successfully"}),n(j=>({...j,currentPassword:"",newPassword:"",confirmPassword:""}))}catch(j){console.error("Error updating profile:",j),t({title:"Update failed",description:j.message||"Failed to update profile",variant:"destructive"})}finally{i(!1)}},N=((p=a==null?void 0:a.full_name)==null?void 0:p.split(" ").map(g=>g[0]).join("").toUpperCase())||"??";return e.jsx(ce,{children:e.jsx("div",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-2xl mx-auto space-y-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Account Settings"}),e.jsxs($,{children:[e.jsx(K,{children:e.jsx(ue,{children:"Profile Picture"})}),e.jsx(z,{children:e.jsx(il,{currentAvatarUrl:a==null?void 0:a.avatar_url,onUpload:f,userInitials:N})})]}),e.jsxs($,{children:[e.jsx(K,{children:e.jsx(ue,{children:"Profile Information"})}),e.jsx(z,{children:e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(G,{htmlFor:"fullName",children:"Full Name"}),e.jsx(q,{id:"fullName",value:l.fullName,onChange:g=>n(j=>({...j,fullName:g.target.value}))})]}),e.jsxs("div",{children:[e.jsx(G,{htmlFor:"email",children:"Email"}),e.jsx(q,{id:"email",value:(s==null?void 0:s.email)||"",disabled:!0})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Change Password"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(G,{htmlFor:"currentPassword",children:"Current Password"}),e.jsx(q,{id:"currentPassword",type:"password",value:l.currentPassword,onChange:g=>n(j=>({...j,currentPassword:g.target.value}))})]}),e.jsxs("div",{children:[e.jsx(G,{htmlFor:"newPassword",children:"New Password"}),e.jsx(q,{id:"newPassword",type:"password",value:l.newPassword,onChange:g=>n(j=>({...j,newPassword:g.target.value}))})]}),e.jsxs("div",{children:[e.jsx(G,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsx(q,{id:"confirmPassword",type:"password",value:l.confirmPassword,onChange:g=>n(j=>({...j,confirmPassword:g.target.value}))})]})]})]}),e.jsx(k,{type:"submit",disabled:r,children:r?"Saving...":"Save Changes"})]})})]})]})})})}const ll=()=>e.jsx("div",{className:"flex flex-col items-center justify-center min-h-[80vh] px-4",children:e.jsxs("div",{className:"text-center space-y-6 max-w-2xl",children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tight sm:text-6xl text-primary",children:"404"}),e.jsx("h2",{className:"text-2xl font-semibold tracking-tight sm:text-3xl",children:"Page Not Found"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Sorry, we couldn't find the page you're looking for. The page might have been removed, renamed, or doesn't exist."}),e.jsx("div",{className:"flex justify-center gap-4 pt-4",children:e.jsx(k,{asChild:!0,children:e.jsxs(Zr,{to:"/",className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"h-4 w-4"}),"Back to Home"]})})})]})}),Dt=[{title:"UK House Prices Show Resilience Despite Economic Pressures",source:"Property News UK",published_at:new Date().toISOString(),url:"#",excerpt:"The latest data shows UK house prices maintaining stability with regional variations in growth rates."},{title:"New Rental Reforms Set to Transform Landlord-Tenant Relationships",source:"Real Estate Times",published_at:new Date(Date.now()-864e5).toISOString(),url:"#",excerpt:"The government's proposed rental reforms aim to provide greater security for tenants while maintaining landlord rights."},{title:"Property Investment Shifts: Where Buyers Are Looking in 2024",source:"Investment Quarterly",published_at:new Date(Date.now()-1728e5).toISOString(),url:"#",excerpt:"Investor focus is moving toward emerging regional hotspots as work patterns continue to evolve post-pandemic."},{title:"Interest Rate Forecast and Impact on Mortgage Market",source:"Financial Property Review",published_at:new Date(Date.now()-2592e5).toISOString(),url:"#",excerpt:"Analysts predict stabilizing interest rates may provide relief for mortgage holders in the coming quarters."},{title:"Green Homes Grant: What Property Owners Need to Know",source:"Sustainable Housing",published_at:new Date(Date.now()-3456e5).toISOString(),url:"#",excerpt:"The latest initiatives for improving energy efficiency in UK homes and the financial incentives available."}],ms=`
# UK Property Market Insights: July 2024

## Latest Tax Law Changes

The UK property market continues to adapt to recent regulatory changes. In April 2024, the government implemented adjustments to Capital Gains Tax (CGT) rates for property investors, with the higher rate increasing from 28% to 30% for residential property disposals. Buy-to-let landlords face additional reporting requirements for rental income above £10,000 annually.

The Stamp Duty Land Tax (SDLT) thresholds remain unchanged from last year's autumn statement, with first-time buyers enjoying relief up to £425,000 (down from £625,000 in 2023).

## Landlord Regulations

Licensing requirements have expanded to include mandatory electrical safety certificates (EICR) renewals every five years, and the new Decent Homes Standard now applies to the private rental sector. Tenant rights have strengthened with the Renters Reform Bill provisions now in effect, limiting no-fault evictions and establishing stronger grounds for possession.

Property safety regulations now include stricter rules for carbon monoxide alarms, with mandatory installation in all rooms with fixed combustion appliances.

## Government Policies

The Housing Ministry has announced a target of 300,000 new homes annually by 2026, with planning reforms to streamline development in designated growth zones. The Help to Buy equity loan scheme has been replaced with the First Homes initiative, offering 30-50% discounts on market value for first-time buyers.

Regional variations exist in Scotland's Private Housing (Tenancies) Act and Wales' Renting Homes Act, creating a patchwork regulatory landscape.

## Market Impact Analysis

These regulatory changes are creating downward pressure on rental yields, with the average UK yield dropping from 5.8% to 5.2% over the past year. Property values in commuter belts have shown greater resilience (+3.2%) compared to city centers (+1.7%).

Investment strategy adjustments should focus on regions with strong infrastructure investment and employment growth, particularly the Midlands and Northern England which offer better yields despite regulatory pressures.
`,Lt=`
# Market Risk Assessment: UK Property Sector

## Current Risk Level: Moderate

### Interest Rate Risk
The Bank of England's current base rate of 4.25% represents a stabilization after the peak of 5.25% in late 2023. While further cuts are anticipated, they are expected to be gradual, maintaining moderate pressure on mortgage affordability.

### Regulatory Risk
The implementation phase of the Renters Reform Bill creates temporary uncertainty for landlords adapting to new requirements. Compliance costs have increased approximately 12% year-over-year.

### Market Liquidity Risk
Transaction volumes remain 15% below pre-pandemic levels, extending the average time to sell from 45 to 63 days. Regional variations are significant, with London experiencing greater liquidity constraints than the North East.

### Recommendation
Investors should focus on properties with strong fundamentals that can weather short-term market fluctuations, particularly those in areas with diverse economic bases and strong rental demand.
`,Ft=[{area:"Manchester - Salford Quays",propertyType:"2-bedroom apartments",averagePrice:21e4,expectedYield:5.8,growthPotential:"High",keyFactors:["Tech industry expansion","Transport improvements","Regeneration projects"]},{area:"Birmingham - Jewellery Quarter",propertyType:"1-2 bedroom converted industrial",averagePrice:185e3,expectedYield:5.4,growthPotential:"Medium-High",keyFactors:["HS2 development impact","Growing young professional population","Cultural district revival"]},{area:"Leeds - South Bank",propertyType:"New build city apartments",averagePrice:195e3,expectedYield:5.9,growthPotential:"High",keyFactors:["Major regeneration area","Financial sector growth","University expansion"]}];async function ol(){try{const{error:s}=await ge.from("market_insights").select("id").limit(1);if(s&&s.code==="42P01"){console.log("Market insights table does not exist, attempting to create it...");const{error:a}=await ge.rpc("create_market_insights_table");return a?(console.error("Failed to create market_insights table:",a),!1):(console.log("Market insights table created successfully"),!0)}return!0}catch(s){return console.error("Error checking/creating market_insights table:",s),!1}}async function cl(){try{const s=await fetch("https://newsapi.org/v2/everything?q=uk+property+market&sortBy=publishedAt&apiKey=YOUR_API_KEY&pageSize=10");if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();return a.articles&&a.articles.length>0?a.articles.map(t=>({title:t.title,source:t.source.name,published_at:t.publishedAt,url:t.url,excerpt:t.description})):(console.log("No articles found in API response, using mock data"),Dt)}catch(s){return console.error("Error fetching property news:",s),Dt}}async function dl(s){try{const a="AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo";if(!a||a.includes("YOUR_API_KEY"))return console.warn("Using mock data: No valid API key provided for Gemini"),ms;const t=`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${a}`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:s}]}],generationConfig:{temperature:.7,maxOutputTokens:1024}})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const i=await r.json();let l="";return i.candidates&&i.candidates[0]&&i.candidates[0].content?l=i.candidates[0].content.parts.filter(f=>f.text).map(f=>f.text).join(`
`):i.text&&(l=i.text),l||(console.warn("Empty response from Gemini API, using mock data"),ms)}catch(a){return console.error("Error generating insights:",a),ms}}async function ml(){try{await ol();const{data:s,error:a}=await ge.from("market_insights").select("*").order("generated_at",{ascending:!1}).limit(1);return a?(console.error("Error fetching market insights:",a),{id:"mock-id",content:ms,generated_at:new Date().toISOString()}):s&&s.length>0?s[0]:null}catch(s){return console.error("Error in getLatestMarketInsights:",s),{id:"mock-id",content:ms,generated_at:new Date().toISOString()}}}async function ul(){try{return Lt}catch(s){return console.error("Error fetching risk assessment:",s),Lt}}async function hl(){try{return Ft}catch(s){return console.error("Error fetching personalized opportunities:",s),Ft}}async function xl(s="UK"){try{return{region:s,currentAveragePrice:29e4,predictedGrowthRate:3.8,confidenceScore:82,timeframe:"12 months",factors:["Interest rate stabilization","Housing supply constraints","Regional economic development"]}}catch(a){return console.error("Error fetching predictive analytics:",a),{region:s,currentAveragePrice:29e4,predictedGrowthRate:3.2,confidenceScore:75,timeframe:"12 months",factors:["Mock data - API unavailable","Contact administrator for actual predictions"]}}}function pl({user:s,profile:a,className:t,showHero:r=!0}){const[i,l]=S.useState([]),[n,f]=S.useState(""),[h,N]=S.useState("No risk assessment data available."),[p,g]=S.useState([]),[j,y]=S.useState(!0),[v,L]=S.useState(null);S.useEffect(()=>{(async()=>{try{const w=await cl();l(w.slice(0,5));const T=await ml();if(T)f(T.content);else{const O=await dl("Provide a concise analysis of the current UK property market trends, focusing on interest rates, price movements, and market sentiment. Include key statistics and recommendations for investors.");f(O)}const F=await ul();N(F);const P=await hl();g(P);const M=await xl()}catch(w){console.error("Error loading market data:",w),L("Failed to load market data.")}finally{y(!1)}})()},[]);const b=[{month:"Jan",price:32e4},{month:"Feb",price:325e3},{month:"Mar",price:329e3},{month:"Apr",price:335e3},{month:"May",price:34e4},{month:"Jun",price:345e3}],d=[{region:"London",price:5e5},{region:"Manchester",price:25e4},{region:"Birmingham",price:22e4},{region:"Leeds",price:2e5},{region:"Liverpool",price:18e4}];return e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"w-full",children:e.jsx(Ne,{title:"Property Market Insights & Analysis",subtitle:"Expert analysis, regional comparisons, and investment recommendations to guide your property decisions",showSearch:!1,showStats:!1,height:"h-[400px]"})}),e.jsx("div",{className:_("w-full",t),children:e.jsxs("div",{className:"container mx-auto px-4 py-12",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12",children:[e.jsxs($,{children:[e.jsx(K,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"Price Trends"})}),e.jsx(z,{className:"h-80",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(Ds,{data:b,children:[e.jsx(Je,{strokeDasharray:"3 3"}),e.jsx(Ze,{dataKey:"month"}),e.jsx(Xe,{}),e.jsx(Be,{formatter:c=>[`£${c.toLocaleString()}`,"Average Price"]}),e.jsx(hs,{type:"monotone",dataKey:"price",stroke:"hsl(var(--primary))",activeDot:{r:8}})]})})})]}),e.jsxs($,{children:[e.jsx(K,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"Regional Comparison"})}),e.jsx(z,{className:"h-80",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(Ds,{data:d,children:[e.jsx(Je,{strokeDasharray:"3 3"}),e.jsx(Ze,{dataKey:"region"}),e.jsx(Xe,{}),e.jsx(Be,{formatter:c=>[`£${c.toLocaleString()}`,"Average Price"]}),e.jsx(hs,{type:"monotone",dataKey:"price",stroke:"hsl(var(--primary))",activeDot:{r:8}})]})})})]})]}),e.jsxs($,{className:"mb-12",children:[e.jsx(K,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"Market Analysis"})}),e.jsxs(z,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"The UK property market continues to show resilience despite economic challenges. Regional variations are significant, with some areas experiencing rapid growth while others see more moderate changes."}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Key factors influencing the current market include:"}),e.jsxs("ul",{className:"list-disc pl-5 mb-4 text-muted-foreground",children:[e.jsx("li",{children:"Interest rate changes affecting mortgage affordability"}),e.jsx("li",{children:"Supply constraints in high-demand areas"}),e.jsx("li",{children:"Increasing preference for properties with outdoor space"}),e.jsx("li",{children:"Remote work influencing location decisions"})]}),e.jsx(k,{children:"Download Full Report"})]})]}),(a==null?void 0:a.subscription_tier)!=="free"&&e.jsxs($,{className:"mb-12 border-primary/20 bg-gradient-to-r from-primary/5 to-background",children:[e.jsx(K,{children:e.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:["Premium Market Insights",e.jsx("span",{className:"ml-2 px-2 py-1 text-xs rounded-full bg-primary/20 text-primary",children:"Premium"})]})}),e.jsxs(z,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Our exclusive analysis indicates emerging hotspots in the following areas:"}),e.jsxs("ul",{className:"list-disc pl-5 mb-4 text-muted-foreground",children:[e.jsx("li",{children:"Northwest Manchester - projected 8.3% growth over 12 months"}),e.jsx("li",{children:"East Birmingham suburbs - increasing demand from young professionals"}),e.jsx("li",{children:"Coastal towns in the Southwest - rising popularity for remote workers"})]}),e.jsx(k,{children:"View Detailed Forecast"})]})]})]})})]})}function gl({user:s,profile:a,className:t}){const[r,i]=S.useState("price"),l=[{year:"2018",price:28e4},{year:"2019",price:295e3},{year:"2020",price:305e3},{year:"2021",price:32e4},{year:"2022",price:335e3},{year:"2023",price:345e3},{year:"2024",price:358e3}],n=[{name:"London",value:38},{name:"South East",value:22},{name:"North West",value:16},{name:"Midlands",value:14},{name:"Scotland",value:10}],f=[{type:"Detached",count:420},{type:"Semi-Detached",count:580},{type:"Terraced",count:510},{type:"Flat",count:390},{type:"Bungalow",count:160}],h=[{region:"London",ppsqft:650},{region:"South East",ppsqft:410},{region:"East",ppsqft:380},{region:"South West",ppsqft:330},{region:"East Midlands",ppsqft:270},{region:"West Midlands",ppsqft:280},{region:"Yorkshire",ppsqft:240},{region:"North West",ppsqft:230},{region:"North East",ppsqft:190},{region:"Wales",ppsqft:210},{region:"Scotland",ppsqft:200}],N=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8"];return e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs($,{className:"mb-8",children:[e.jsxs(K,{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Data Visualization Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Interactive charts and graphs showing property market trends and statistics"})]}),e.jsxs(z,{children:[e.jsxs(Ve,{defaultValue:"price",value:r,onValueChange:i,children:[e.jsxs(He,{className:"mb-6",children:[e.jsxs(ie,{value:"price",className:"flex items-center",children:[e.jsx(Xr,{className:"mr-2 h-4 w-4"}),"Price Trends"]}),e.jsxs(ie,{value:"regional",className:"flex items-center",children:[e.jsx(Qr,{className:"mr-2 h-4 w-4"}),"Regional Distribution"]}),e.jsxs(ie,{value:"property-type",className:"flex items-center",children:[e.jsx(ct,{className:"mr-2 h-4 w-4"}),"Property Types"]}),e.jsxs(ie,{value:"price-per-sqft",className:"flex items-center",children:[e.jsx(Ke,{className:"mr-2 h-4 w-4"}),"Price per Sq Ft"]})]}),e.jsx(ae,{value:"price",className:"h-[500px]",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(Ds,{data:l,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(Je,{strokeDasharray:"3 3"}),e.jsx(Ze,{dataKey:"year"}),e.jsx(Xe,{tickFormatter:p=>`£${(p/1e3).toFixed(0)}k`,domain:["dataMin - 20000","dataMax + 20000"]}),e.jsx(Be,{formatter:p=>[`£${p.toLocaleString()}`,"Average Price"]}),e.jsx(Gs,{}),e.jsx(hs,{type:"monotone",dataKey:"price",name:"Average UK Property Price",stroke:"hsl(var(--primary))",activeDot:{r:8},strokeWidth:2})]})})}),e.jsx(ae,{value:"regional",className:"h-[500px]",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(en,{children:[e.jsx(sn,{data:n,cx:"50%",cy:"50%",labelLine:!0,outerRadius:180,fill:"#8884d8",dataKey:"value",label:({name:p,percent:g})=>`${p}: ${(g*100).toFixed(0)}%`,children:n.map((p,g)=>e.jsx(tn,{fill:N[g%N.length]},`cell-${g}`))}),e.jsx(Be,{formatter:p=>[`${p}%`,"Market Share"]}),e.jsx(Gs,{})]})})}),e.jsx(ae,{value:"property-type",className:"h-[500px]",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(kt,{data:f,margin:{top:20,right:30,left:20,bottom:10},children:[e.jsx(Je,{strokeDasharray:"3 3"}),e.jsx(Ze,{dataKey:"type"}),e.jsx(Xe,{}),e.jsx(Be,{formatter:p=>[`${p.toLocaleString()} properties`,"Count"]}),e.jsx(Gs,{}),e.jsx(Ct,{dataKey:"count",name:"Number of Properties",fill:"hsl(var(--primary))",barSize:60})]})})}),e.jsx(ae,{value:"price-per-sqft",className:"h-[500px]",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(kt,{data:h,margin:{top:20,right:30,left:20,bottom:10},layout:"vertical",children:[e.jsx(Je,{strokeDasharray:"3 3"}),e.jsx(Ze,{type:"number"}),e.jsx(Xe,{type:"category",dataKey:"region",width:100}),e.jsx(Be,{formatter:p=>[`£${p}/sq ft`,"Price"]}),e.jsx(Ct,{dataKey:"ppsqft",name:"Price per Square Foot",fill:"hsl(var(--primary))",barSize:20})]})})})]}),e.jsx("div",{className:"mt-6 flex items-center justify-end",children:(a==null?void 0:a.subscription_tier)!=="free"?e.jsx(k,{children:"Download Full Report"}):e.jsx(k,{variant:"outline",onClick:()=>window.location.href="/pricing",children:"Upgrade for Full Access"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs($,{children:[e.jsx(K,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"About the Data"})}),e.jsxs(z,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Our data is sourced from multiple reliable sources including Land Registry, Office for National Statistics, and major UK property portals. Data is updated monthly to provide the most accurate market insights."}),e.jsx("p",{className:"text-muted-foreground",children:"Premium subscribers have access to additional visualizations including predictive models, heat maps, and custom reporting tools."})]})]}),e.jsxs($,{children:[e.jsx(K,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"Data Interpretation Guide"})}),e.jsxs(z,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"These visualizations help identify property market trends and regional variations. When interpreting the data, consider:"}),e.jsxs("ul",{className:"list-disc pl-5 mb-4 text-muted-foreground",children:[e.jsx("li",{children:"Long-term trends rather than short-term fluctuations"}),e.jsx("li",{children:"Regional differences in property values and growth rates"}),e.jsx("li",{children:"Correlation with economic indicators like interest rates"}),e.jsx("li",{children:"Seasonality effects on the property market"})]})]})]})]})]})}const fl=({children:s})=>{try{return ee(),e.jsx(e.Fragment,{children:s})}catch{return e.jsx(ce,{children:e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:e.jsxs($,{className:"p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Authentication Error"}),e.jsx("p",{className:"text-muted-foreground mb-6 text-center",children:"Unable to load authentication. Please refresh the page or try again later."}),e.jsx(k,{className:"w-full",onClick:()=>window.location.reload(),children:"Refresh Page"})]})})})}};function jl(){const[s,a]=o.useState("insights"),{user:t,profile:r}=ee();return e.jsx(fl,{children:e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx(Ne,{title:"Property Market Insights & Analysis",subtitle:"Expert analysis, regional comparisons, and investment recommendations to guide your property decisions",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs(Ve,{defaultValue:"insights",value:s,onValueChange:a,className:"w-full",children:[e.jsxs(He,{className:"mb-6",children:[e.jsx(ie,{value:"insights",children:"Market Insights"}),e.jsx(ie,{value:"visualization",children:"Data Visualization"})]}),e.jsx(ae,{value:"insights",className:"mt-0",children:e.jsx(pl,{user:t,profile:r,className:"mt-0",showHero:!1})}),e.jsx(ae,{value:"visualization",className:"mt-0",children:e.jsx(gl,{user:t,profile:r})})]})})]})})}async function vl(s){var a,t,r,i,l;try{console.log("Calling chat API with prompt:",s);const h=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent?key=AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:s}]}],generationConfig:{temperature:.7,maxOutputTokens:1024}})});if(!h.ok)throw console.error("API error:",h.status,await h.text()),new Error(`API error: ${h.status} - ${await h.text()}`);return((l=(i=(r=(t=(a=(await h.json()).candidates)==null?void 0:a[0])==null?void 0:t.content)==null?void 0:r.parts)==null?void 0:i[0])==null?void 0:l.text)||"Sorry, I couldn't generate a response at this time."}catch(n){return console.error("Error getting chat response:",n),bl(s)}}async function yl(s){var a,t,r,i,l;try{console.log("Getting predictive analytics for location:",s);const n="AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo",f="https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent",h=`Generate predictive analytics for property investment in ${s} for the next 5 years. Include price growth predictions, rental yield trends, and market dynamics. Format as JSON with the following structure: {
      "priceGrowthPrediction": { "year1": 2.5, "year2": 3.1, "year3": 3.5, "year4": 2.8, "year5": 3.0 },
      "rentalYieldTrend": { "year1": 5.2, "year2": 5.3, "year3": 5.4, "year4": 5.3, "year5": 5.2 },
      "marketSummary": "Brief summary of market dynamics",
      "keyFactors": ["Factor 1", "Factor 2", "Factor 3"]
    }`,N=await fetch(`${f}?key=${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:h}]}],generationConfig:{temperature:.2,maxOutputTokens:1024}})});if(!N.ok)throw new Error("API response was not ok");const g=((l=(i=(r=(t=(a=(await N.json()).candidates)==null?void 0:a[0])==null?void 0:t.content)==null?void 0:r.parts)==null?void 0:i[0])==null?void 0:l.text)||null;if(!g)throw new Error("No content returned from API");let j=g.match(/```json\n([\s\S]*?)\n```/)||g.match(/```([\s\S]*?)```/)||g.match(/(\{[\s\S]*\})/);if(j&&j[1])return JSON.parse(j[1].trim());try{return JSON.parse(g)}catch(y){return console.error("Error parsing predictive analytics:",y),Ot(s)}}catch(n){return console.error("Error fetching predictive analytics:",n),Ot(s)}}async function Nl(s){var a,t,r,i,l;try{console.log("Getting investment hotspots for region:",s);const n="AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo",f="https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent",h=`Generate a list of emerging property investment hotspots in ${s} with reasons why they are promising. Format as JSON with the following structure: 
    {
      "hotspots": [
        {
          "area": "Area name",
          "growthPotential": 4.2,
          "reasons": ["Reason 1", "Reason 2"],
          "estimatedROI": 5.8,
          "investmentType": "Buy-to-let"
        }
      ]
    }
    Include 3-5 different hotspots.`,N=await fetch(`${f}?key=${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:h}]}],generationConfig:{temperature:.3,maxOutputTokens:1024}})});if(!N.ok)throw new Error("API response was not ok");const g=((l=(i=(r=(t=(a=(await N.json()).candidates)==null?void 0:a[0])==null?void 0:t.content)==null?void 0:r.parts)==null?void 0:i[0])==null?void 0:l.text)||null;if(!g)throw new Error("No content returned from API");let j=g.match(/```json\n([\s\S]*?)\n```/)||g.match(/```([\s\S]*?)```/)||g.match(/(\{[\s\S]*\})/);if(j&&j[1])return JSON.parse(j[1].trim());try{return JSON.parse(g)}catch(y){return console.error("Failed to parse hotspots:",y),$t(s)}}catch(n){return console.error("Failed to fetch hotspots:",n),$t(s)}}function bl(s){return s.includes("market insights")?"Based on recent data, the property market in this area has shown strong growth over the past 12 months. Average prices have increased by approximately 7.3%, which is above the national average of 4.5%. Rental yields remain competitive at around 5.2% for typical properties. The local economy is benefiting from new infrastructure projects and employment opportunities, which should provide continued stability. Demand currently exceeds supply, especially for 2-3 bedroom properties, creating a seller's market. Analysts predict continued but more moderate growth over the next 24 months.":s.includes("investment advice")?`For property investors looking at this market, there are several strategies worth considering:

1. Buy-to-let opportunities are particularly strong in the north and east neighborhoods, where rental demand from young professionals is high.

2. Properties requiring renovation can offer significant value-add opportunities, with potential for 15-20% equity gains after improvements.

3. The local council has approved new development zones which may present off-plan purchase opportunities with favorable terms.

4. Houses with potential for extension or conversion to multiple units can maximize returns in areas with strict planning constraints.

5. Consider the strong local university market for HMO investments, which typically yield 2-3% higher than standard rentals.`:"The current property market shows mixed signals. While some areas continue to see price growth, others have stabilized. Factors influencing the market include interest rate changes, supply constraints, and evolving work patterns affecting location preferences. For specific investment advice, consider local economic indicators, infrastructure developments, and demographic trends particular to your target area."}function Ot(s){return{priceGrowthPrediction:{year1:3.2,year2:3.5,year3:4.1,year4:3.8,year5:3.9},rentalYieldTrend:{year1:5.3,year2:5.4,year3:5.5,year4:5.4,year5:5.3},marketSummary:`The property market in ${s} shows promising growth potential over the next 5 years, supported by infrastructure development and increasing demand. While some volatility is expected in years 2-3, the overall trajectory remains positive.`,keyFactors:["New transportation links improving connectivity","Growing tech sector bringing high-income professionals to the area","Limited new housing supply in development pipeline","Strong rental demand from young professionals","Government stimulus for first-time buyers"]}}function $t(s){return{hotspots:[{area:`${s} - North District`,growthPotential:4.7,reasons:["New tech hub development creating employment","Improved transport links reducing commute times","Regeneration project transforming former industrial areas"],estimatedROI:6.2,investmentType:"Buy-to-let apartments"},{area:`${s} - Riverside`,growthPotential:5.1,reasons:["Waterfront development project nearing completion","Limited supply of premium properties","Growing demand from young professionals"],estimatedROI:5.8,investmentType:"Luxury apartments"},{area:`${s} - University Area`,growthPotential:3.9,reasons:["Consistent student housing demand","University expansion plans announced","Improving local amenities and nightlife"],estimatedROI:7.3,investmentType:"HMO for students"},{area:`${s} - Central Village`,growthPotential:4.5,reasons:["Character properties with renovation potential","Growing tourism supporting short-term rentals","New boutique retail and restaurant scene"],estimatedROI:6.5,investmentType:"Period conversions"}]}}const wl=["Calculate stamp duty for a £400,000 property","What are typical legal fees for property purchase?","Explain all costs involved in buying a property","How much should I budget for property maintenance?","What surveys do I need when buying a property?","Calculate monthly mortgage payments for £300,000"],Sl=s=>{if(s.success)return`<span class="block text-red-500">${s.message}</span>`;let t=(typeof s=="string"?s:s.message).replace(/\*\*(.*?)\*\*/g,'<span class="font-bold">$1</span>');return t=t.replace(/\*(.*?)\*/g,'<span class="italic">$1</span>'),t=t.replace(/^- (.+)$/gm,'<span class="block ml-2">• $1</span>'),t=t.replace(/^\d+\. (.+)$/gm,'<span class="block ml-2">$&</span>'),t.split(`
`).map((r,i)=>r?`<span class="block">${r}</span>`:'<span class="block h-2"></span>').join("")},_l=({trends:s=[{title:"Average Home Price",value:"£450,000",change:"+5.2%",isPositive:!0},{title:"Days on Market",value:"28",change:"-12%",isPositive:!0},{title:"Available Listings",value:"1,234",change:"-3.1%",isPositive:!1}],articles:a=[{title:"Understanding the Current Real Estate Market",excerpt:"Get insights into the latest trends and what they mean for buyers and sellers.",date:"2024-03-15"},{title:"Top 5 Investment Opportunities in Real Estate",excerpt:"Discover the most promising areas for property investment in the current market.",date:"2024-03-10"},{title:"Real Estate Market Forecast 2024",excerpt:"Expert predictions and analysis for the upcoming year in real estate.",date:"2024-03-05"}],user:t,profile:r})=>{const i=[{month:"Jan",price:45e4},{month:"Feb",price:455e3},{month:"Mar",price:458e3},{month:"Apr",price:462e3},{month:"May",price:47e4},{month:"Jun",price:475e3}],l=[{region:"London",price:5e5,growth:5.2},{region:"Manchester",price:25e4,growth:7.8},{region:"Birmingham",price:22e4,growth:6.5},{region:"Leeds",price:2e5,growth:8.1},{region:"Liverpool",price:18e4,growth:9.2}],n=[{name:"London",priceGrowth:5.2,averagePrice:5e5,transactions:1200},{name:"South East",priceGrowth:4.8,averagePrice:375e3,transactions:950},{name:"South West",priceGrowth:4.5,averagePrice:31e4,transactions:780},{name:"East of England",priceGrowth:4.2,averagePrice:325e3,transactions:820},{name:"West Midlands",priceGrowth:6.1,averagePrice:24e4,transactions:680},{name:"East Midlands",priceGrowth:5.8,averagePrice:225e3,transactions:650},{name:"Yorkshire",priceGrowth:7.2,averagePrice:195e3,transactions:720},{name:"North West",priceGrowth:8.1,averagePrice:205e3,transactions:850},{name:"North East",priceGrowth:6.5,averagePrice:155e3,transactions:480},{name:"Wales",priceGrowth:5.9,averagePrice:185e3,transactions:520},{name:"Scotland",priceGrowth:5.4,averagePrice:175e3,transactions:680}],f=({data:D})=>e.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:e.jsx("svg",{viewBox:"0 0 500 800",className:"w-full h-full max-h-[400px]",style:{maxWidth:"300px"},children:[{path:"M250,600 L300,550 L350,600 L300,650 Z",name:"London"},{path:"M200,500 L300,450 L350,500 L250,550 Z",name:"South East"},{path:"M150,450 L250,400 L300,450 L200,500 Z",name:"South West"},{path:"M300,450 L400,400 L450,450 L350,500 Z",name:"East of England"},{path:"M200,350 L300,300 L350,350 L250,400 Z",name:"West Midlands"},{path:"M300,350 L400,300 L450,350 L350,400 Z",name:"East Midlands"},{path:"M200,250 L300,200 L350,250 L250,300 Z",name:"Yorkshire"},{path:"M150,200 L250,150 L300,200 L200,250 Z",name:"North West"},{path:"M250,150 L350,100 L400,150 L300,200 Z",name:"North East"},{path:"M100,350 L200,300 L250,350 L150,400 Z",name:"Wales"},{path:"M150,100 L300,50 L350,100 L200,150 Z",name:"Scotland"}].map(m=>{const R=D.find(te=>te.name===m.name),V=(R==null?void 0:R.priceGrowth)||0;return e.jsxs("g",{children:[e.jsx("path",{d:m.path,fill:`hsl(${120*(V/10)}, 70%, 50%)`,stroke:"white",strokeWidth:"2",className:"transition-colors duration-300 hover:brightness-110 cursor-pointer"}),e.jsx("title",{children:`${m.name}: +${V}%`})]},m.name)})})}),[h,N]=o.useState(""),[p,g]=o.useState(!1),[j,y]=o.useState(!1),v=async D=>{g(!0);try{const m=await vl(`Provide a concise market insight for property investment in ${D} with recent price trends, rental yields, and future outlook. Keep it under 200 words.`);N(m)}catch(m){console.error("Error fetching market insights:",m),N("We're currently experiencing some issues retrieving market insights. Please try again later or contact support if the problem persists.")}finally{g(!1)}},[L,b]=o.useState([]),[d,c]=o.useState([]),[w,T]=o.useState(!1),[F,P]=o.useState(!1),[M,O]=o.useState(!1),[x,A]=o.useState(!1),I=async D=>{var m;T(!0);try{const R=await yl(D);if(Array.isArray(R))b(R);else if(R.regions&&Array.isArray(R.regions))b(R.regions);else{const V=[{region:D||"United Kingdom",currentValue:35e4,predictedValue:35e4*(1+(((m=R.priceGrowthPrediction)==null?void 0:m.year1)||3.2)/100),confidence:85,growthFactors:R.keyFactors||["Data temporarily unavailable"]}];b(V)}}catch(R){console.error("Error fetching predictive analytics:",R),b([{region:D,currentValue:35e4,predictedValue:361200,confidence:75,growthFactors:["Data temporarily unavailable","Please try again later"]}])}finally{T(!1)}},U=async D=>{A(!0);try{const m=await Nl(D);if(Array.isArray(m)){const R=m.map(V=>({...V,factors:V.factors||[]}));c(R)}else if(m.hotspots&&Array.isArray(m.hotspots)){const R=m.hotspots.map(V=>({...V,factors:V.factors||[]}));c(R)}else console.warn("Hotspots data is not in expected format:",m),c([])}catch(m){console.error("Error fetching hotspots:",m),c([{area:`${D} - North District`,score:75,predictedGrowth:4.2,factors:["Data currently unavailable","Try again later"],investmentType:"Residential"},{area:`${D} - Central Area`,score:68,predictedGrowth:3.8,factors:["Data currently unavailable","Try again later"],investmentType:"Commercial"}])}finally{A(!1)}},J=async()=>{y(!0),await v("United Kingdom"),y(!1)},X=async()=>{P(!0),await I("United Kingdom"),P(!1)},he=async()=>{O(!0),await U("United Kingdom"),O(!1)},[de,se]=o.useState(null),[xe,be]=o.useState(null),[Se,ve]=o.useState(!0),we=async()=>{try{ve(!0);const D=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=gbp");if(!D.ok)throw new Error("Failed to fetch Bitcoin price");const m=await D.json();se(m.bitcoin.gbp),be(null)}catch(D){console.error("Error fetching Bitcoin price:",D),be("Failed to load Bitcoin price"),se(null)}finally{ve(!1)}};return o.useEffect(()=>{v("United Kingdom"),I("United Kingdom"),U("United Kingdom"),we();const D=setInterval(()=>{we()},6e4);return()=>clearInterval(D)},[]),e.jsxs(e.Fragment,{children:[e.jsx(Ne,{title:"Property Market Trends & Insights",subtitle:"Discover the latest market data, price forecasts, and investment hotspots to make informed property decisions",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsxs("section",{className:"w-full py-8 sm:py-16 bg-background relative overflow-hidden",children:[e.jsx("div",{className:"container mx-auto px-4 mb-16",children:e.jsxs($,{className:"bg-card border-border",children:[e.jsx(K,{children:e.jsx("h2",{className:"text-2xl font-semibold",children:"Real Estate Trends Visualization"})}),e.jsx(z,{children:e.jsxs(Ve,{defaultValue:"overview",className:"w-full",children:[e.jsx(He,{className:"w-full mb-8",children:e.jsxs("div",{className:"grid w-full grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsx(ie,{value:"overview",className:"w-full",children:"Price Evolution"}),e.jsx(ie,{value:"regional",className:"w-full",children:"Regional Comparison"}),e.jsx(ie,{value:"heatmap",className:"w-full",children:"Growth Heatmap"})]})}),e.jsx(ae,{value:"overview",className:"h-[400px]",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(an,{data:i,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorPrice",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"hsl(var(--primary))",stopOpacity:.2}),e.jsx("stop",{offset:"95%",stopColor:"hsl(var(--primary))",stopOpacity:0})]})}),e.jsx(Je,{strokeDasharray:"3 3"}),e.jsx(Ze,{dataKey:"month"}),e.jsx(Xe,{}),e.jsx(Be,{}),e.jsx(rn,{type:"monotone",dataKey:"price",stroke:"hsl(var(--primary))",fillOpacity:1,fill:"url(#colorPrice)"})]})})}),e.jsx(ae,{value:"regional",className:"h-[400px]",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(Ds,{data:l,children:[e.jsx(Je,{strokeDasharray:"3 3"}),e.jsx(Ze,{dataKey:"region"}),e.jsx(Xe,{}),e.jsx(Be,{}),e.jsx(hs,{type:"monotone",dataKey:"price",stroke:"hsl(var(--primary))"}),e.jsx(hs,{type:"monotone",dataKey:"growth",stroke:"hsl(var(--chart-1))"})]})})}),e.jsx(ae,{value:"heatmap",className:"h-[400px] overflow-y-auto",children:e.jsxs("div",{className:"h-full grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4 min-h-[300px]",children:[e.jsx("h3",{className:"font-semibold text-lg sticky top-0 bg-background border-b py-2 px-2 rounded-t-lg",children:"Regional Price Growth"}),e.jsx("div",{className:"space-y-2 overflow-y-auto px-2",children:n.sort((D,m)=>m.priceGrowth-D.priceGrowth).map(D=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-8 rounded-full",style:{backgroundColor:`hsl(${120*(D.priceGrowth/10)}, 70%, 50%)`}}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:D.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["£",D.averagePrice.toLocaleString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-emerald-500",children:["+",D.priceGrowth,"%"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[D.transactions," sales"]})]})]},D.name))})]}),e.jsx("div",{className:"relative hidden lg:flex items-center justify-center bg-muted/30 rounded-xl min-h-[300px]",children:e.jsx(f,{data:n})})]})})]})})]})}),e.jsx("div",{className:"container mx-auto px-4 mb-16",children:e.jsxs($,{className:"bg-card border-border relative ai-border-animation",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"AI Market Analysis"}),e.jsx(k,{variant:"ghost",size:"icon",onClick:J,className:`h-8 w-8 ${j?"animate-spin":""}`,disabled:j||p,children:e.jsx(As,{className:"h-4 w-4"})})]}),e.jsx(z,{children:p?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:Sl(h)}})})]})}),e.jsxs("div",{className:"container mx-auto px-4 mb-16 grid gap-6 md:grid-cols-2",children:[e.jsxs($,{className:"bg-card border-border relative ai-border-animation",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Predictive Market Analytics"}),e.jsx(k,{variant:"ghost",size:"icon",onClick:X,className:`h-8 w-8 ${F?"animate-spin":""}`,disabled:F||w,children:e.jsx(As,{className:"h-4 w-4"})})]}),e.jsx(z,{children:w?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsx("div",{className:"space-y-4",children:L.map((D,m)=>e.jsxs("div",{className:"p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-lg",children:D.region}),e.jsxs("div",{className:"text-sm font-medium text-emerald-500",children:["+",((D.predictedValue-D.currentValue)/D.currentValue*100).toFixed(1),"%"]})]}),e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"w-full bg-background rounded-full h-2",children:e.jsx("div",{className:"bg-emerald-500 h-2 rounded-full",style:{width:`${D.confidence}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Confidence: ",D.confidence,"%"]})]})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:D.growthFactors&&Array.isArray(D.growthFactors)&&D.growthFactors.length>0?D.growthFactors[0]:"No growth factors available"})]},m))})})]}),e.jsxs($,{className:"bg-card border-border relative ai-border-animation",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Emerging Investment Hotspots"}),e.jsx(k,{variant:"ghost",size:"icon",onClick:he,className:`h-8 w-8 ${M?"animate-spin":""}`,disabled:M||x,children:e.jsx(As,{className:"h-4 w-4"})})]}),e.jsx(z,{children:x?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):d.length>0?e.jsx("div",{className:"space-y-4",children:d.map((D,m)=>e.jsxs("div",{className:"bg-card border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg mb-1",children:D.area}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium mr-2",children:"Investment Score:"}),e.jsx("div",{className:"h-2 w-24 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary",style:{width:`${D.score}%`}})}),e.jsxs("span",{className:"ml-2 text-sm font-medium",children:[D.score,"/100"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(oe,{className:"bg-primary/80",children:["+",D.predictedGrowth,"% Growth"]}),e.jsx(oe,{variant:"outline",children:D.investmentType})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-sm font-medium",children:"Why Invest:"}),e.jsx("ul",{className:"mt-1 space-y-1",children:D.factors&&Array.isArray(D.factors)?D.factors.map((R,V)=>e.jsxs("li",{className:"text-sm flex items-start",children:[e.jsx(Is,{className:"h-4 w-4 mr-1 mt-1 text-primary"}),R]},V)):e.jsxs("li",{className:"text-sm flex items-start",children:[e.jsx(Is,{className:"h-4 w-4 mr-1 mt-1 text-primary"}),"Data unavailable"]})})]})]},m))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No investment hotspots data available"})})]})]}),e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl",children:[e.jsxs("div",{className:"mb-12 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Market Trends & Insights"}),e.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Stay informed with the latest real estate market trends and expert insights to make better property decisions."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:s.map((D,m)=>e.jsx($,{className:`bg-card border-border hover:scale-[1.02] transition-all duration-300 ${m===0?"bg-gradient-to-r from-emerald-400/10 to-cyan-400/10":""}`,children:e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-foreground/80",children:D.title}),m===0?e.jsx(je,{className:"w-5 h-5 text-emerald-500"}):m===1?e.jsx(Ye,{className:"w-5 h-5 text-emerald-500"}):e.jsx(ts,{className:"w-5 h-5 text-emerald-500"})]}),e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-2xl font-bold text-foreground",children:D.value}),e.jsx("span",{className:`flex items-center ${D.isPositive?"text-emerald-500":"text-red-500"}`,children:D.change})]})]})},m))}),e.jsx("div",{className:"container mx-auto px-4 mb-16 grid gap-6 md:grid-cols-3",children:a.map((D,m)=>e.jsxs($,{className:"bg-card border-border hover:scale-[1.02] transition-all duration-300",children:[e.jsx(K,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:D.title}),e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(D.date).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]})}),e.jsxs(z,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:D.excerpt}),e.jsxs(k,{variant:"ghost",className:"group hover:text-emerald-500",onClick:()=>{window.location.href=`/article/${encodeURIComponent(D.title)}`},children:["Read More",e.jsx(Is,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})]})]},m))}),e.jsx("div",{className:"w-full bg-muted/50 py-12",children:e.jsxs("div",{className:"max-w-[1200px] mx-auto px-4 sm:px-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Market Trends"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:e.jsxs($,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Bitcoin Price (GBP)"}),Se?e.jsx("div",{className:"animate-pulse h-8 bg-muted rounded"}):xe?e.jsx("p",{className:"text-red-500",children:xe}):de?e.jsx("p",{className:"text-2xl font-bold",children:B(de)}):e.jsx("p",{className:"text-muted-foreground",children:"Price unavailable"})]})})]})})]})]})]})};function Fe({children:s}){return e.jsx(Ks.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3},children:s})}const kl=({children:s})=>{try{return ee(),e.jsx(e.Fragment,{children:s})}catch{return e.jsx(ce,{children:e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:e.jsxs($,{className:"p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Authentication Error"}),e.jsx("p",{className:"text-muted-foreground mb-6 text-center",children:"Unable to load authentication. Please refresh the page or try again later."}),e.jsx(k,{className:"w-full",onClick:()=>window.location.reload(),children:"Refresh Page"})]})})})}},Cl=()=>e.jsx(kl,{children:e.jsx(Pl,{})}),Pl=()=>{const{user:s,profile:a}=ee();return e.jsx(ce,{children:e.jsx(Fe,{children:e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx(_l,{user:s,profile:a})})})})};function Al({title:s="Understanding the Current Real Estate Market",content:a="Default content",date:t=new Date().toISOString(),readTime:r="5 min read"}){const{user:i,profile:l}=ee();return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(fs,{isAuthenticated:!!i,userProfile:l||void 0}),e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx($,{children:e.jsxs(z,{className:"p-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:s}),e.jsxs("div",{className:"flex items-center gap-4 text-muted-foreground mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(t).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ls,{className:"w-4 h-4"}),e.jsx("span",{children:r})]})]}),e.jsx("div",{className:"prose dark:prose-invert max-w-none",children:a.split(`

`).map((n,f)=>e.jsx("p",{className:"mb-4",children:n},f))})]})})})})]})}const Il=({user:s,profile:a})=>{const[t,r]=o.useState([]),[i,l]=o.useState(!0);o.useEffect(()=>{(async()=>{try{l(!0),setTimeout(()=>{r([{id:1,title:"UK Property Market Outlook 2024",summary:"Comprehensive analysis of the UK property market trends, investment opportunities, and forecasts for 2024.",date:"2024-05-15",author:"Property Analysis Team",category:"Market Analysis",isPremium:!0,downloadUrl:"#"},{id:2,title:"Regional Investment Hotspots",summary:"Detailed report on emerging regional investment opportunities across the UK, with focus on yields and growth potential.",date:"2024-04-22",author:"Investment Research Division",category:"Investment",isPremium:!0,downloadUrl:"#"},{id:3,title:"First-Time Buyer Guide 2024",summary:"Essential information and advice for first-time buyers navigating the property market in 2024.",date:"2024-03-10",author:"Homebuyer Advisory Team",category:"Guides",isPremium:!1,downloadUrl:"#"}]),l(!1)},1e3)}catch(h){console.error("Error fetching research reports:",h),l(!1)}})()},[]);const n=(a==null?void 0:a.subscription_tier)!=="free";return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i?Array(3).fill(0).map((f,h)=>e.jsx($,{className:"overflow-hidden",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"h-6 bg-muted rounded animate-pulse w-3/4"}),e.jsx("div",{className:"h-24 bg-muted rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-muted rounded animate-pulse w-1/2"})]})},h)):t.length>0?t.map(f=>e.jsxs($,{className:"overflow-hidden flex flex-col",children:[e.jsxs(K,{className:"flex flex-row items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-lg font-semibold",children:f.title}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx($e,{className:"h-4 w-4"}),e.jsx("span",{children:nn(new Date(f.date),new Date,{addSuffix:!0})})]})]}),f.isPremium&&e.jsx(oe,{variant:"outline",className:"bg-primary/10 text-primary border-primary/20",children:"Premium"})]}),e.jsxs(z,{className:"flex-grow",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:f.summary}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx(Ta,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:f.category})]})]}),e.jsx(Os,{className:"border-t pt-4",children:f.isPremium&&!n?e.jsxs(k,{variant:"outline",className:"w-full",onClick:()=>window.location.href="/pricing",children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Upgrade to Access"]}):e.jsx(k,{className:"w-full",asChild:!0,children:e.jsxs("a",{href:f.downloadUrl,download:!0,children:[e.jsx(ln,{className:"h-4 w-4 mr-2"}),"Download Report"]})})})]},f.id)):e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(We,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No reports available"}),e.jsx("p",{className:"text-muted-foreground",children:"There are currently no research reports available."})]})})})},xr=async(s=1,a=6)=>{try{const t=(s-1)*a;console.log("Fetching deals with params:",{page:s,limit:a,start:t});const{data:r,error:i}=await ge.from("deals").select(`
        id,
        title,
        description,
        location,
        price,
        roi_percentage,
        investment_term,
        property_type,
        deal_type,
        image_url,
        created_at,
        updated_at
      `).range(t,t+a-1).order("created_at",{ascending:!1});if(console.log("Raw Supabase response:",{data:r,error:i}),i)throw console.error("Supabase query error:",i.message,i),new Error(`Failed to fetch deals: ${i.message}`);if(!r||r.length===0)return console.log("No deals found in database"),[];const l=r.map(n=>({id:n.id,title:n.title,description:n.description,location:n.location,price:Number(n.price),roi_percentage:Number(n.roi_percentage),investment_term:n.investment_term,property_type:n.property_type,deal_type:n.deal_type,image_url:n.image_url,created_at:n.created_at,updated_at:n.updated_at}));return console.log("Transformed deals:",l),l}catch(t){throw console.error("Error in getDeals:",t instanceof Error?t.message:t),t}};function Oe({className:s,...a}){return e.jsx("div",{className:_("animate-pulse rounded-md bg-muted",s),...a})}function Rl(){return e.jsxs("div",{className:"overflow-hidden rounded-lg border bg-card",children:[e.jsx(Oe,{className:"aspect-video w-full"}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(Oe,{className:"h-6 w-3/4"}),e.jsx(Oe,{className:"h-4 w-1/2"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Oe,{className:"h-4 w-full"}),e.jsx(Oe,{className:"h-4 w-5/6"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Oe,{className:"h-4 w-20 mb-1"}),e.jsx(Oe,{className:"h-6 w-24"})]}),e.jsxs("div",{children:[e.jsx(Oe,{className:"h-4 w-20 mb-1"}),e.jsx(Oe,{className:"h-6 w-24"})]})]})]})]})}function rt({deal:s,isSubscriber:a,onClick:t,isLoading:r,user:i,showMessageButton:l=!0}){const n=ze(),[f,h]=o.useState(!1);if(r)return e.jsx(Rl,{});const N=p=>{if(p.stopPropagation(),!i){n("/login");return}h(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs($,{className:"overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",onClick:i?t:()=>n("/login"),children:[e.jsxs("div",{className:"relative aspect-video overflow-hidden bg-muted",children:[e.jsx("img",{src:s.image_url,alt:s.title,className:"object-cover w-full h-full",loading:"lazy"}),!i&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:e.jsx(oe,{variant:"secondary",children:"Sign in to View"})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[e.jsx(oe,{variant:"secondary",className:"bg-white/90 text-black hover:bg-white/75",children:s.property_type}),e.jsx(oe,{variant:"secondary",className:"bg-primary/90 text-white hover:bg-primary/75",children:s.deal_type})]})]}),e.jsx(K,{children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold line-clamp-2 mb-2",children:s.title}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{className:"line-clamp-1",children:s.location})]})]})}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Price"}),e.jsx("p",{className:"text-lg font-semibold",children:B(s.price)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"ROI"}),e.jsxs("p",{className:"text-lg font-semibold text-emerald-500",children:[s.roi_percentage,"%"]})]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Investment Term"}),e.jsx("p",{className:"font-medium",children:s.investment_term})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Expected Returns"}),e.jsx("p",{className:"font-medium text-emerald-500",children:"High Yield"})]})]})}),i&&l&&e.jsxs(k,{variant:"outline",className:"w-full",onClick:N,children:[e.jsx(gs,{className:"w-4 h-4 mr-2"}),"Enquire About This Deal"]})]})})]}),i&&e.jsx(ur,{isOpen:f,onClose:()=>h(!1),receiverId:"admin",dealId:s.id,deal:s})]})}const Ae=xn,Ie=pn,_e=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Da,{ref:r,className:_("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...t,children:[a,e.jsx(on,{asChild:!0,children:e.jsx(it,{className:"h-4 w-4 opacity-50"})})]}));_e.displayName=Da.displayName;const pr=o.forwardRef(({className:s,...a},t)=>e.jsx(La,{ref:t,className:_("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(cn,{className:"h-4 w-4"})}));pr.displayName=La.displayName;const gr=o.forwardRef(({className:s,...a},t)=>e.jsx(Fa,{ref:t,className:_("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(it,{className:"h-4 w-4"})}));gr.displayName=Fa.displayName;const ke=o.forwardRef(({className:s,children:a,position:t="popper",...r},i)=>e.jsx(dn,{children:e.jsxs(Oa,{ref:i,className:_("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...r,children:[e.jsx(pr,{}),e.jsx(mn,{className:_("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(gr,{})]})}));ke.displayName=Oa.displayName;const Ml=o.forwardRef(({className:s,...a},t)=>e.jsx($a,{ref:t,className:_("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a}));Ml.displayName=$a.displayName;const Z=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Ua,{ref:r,className:_("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(un,{children:e.jsx(le,{className:"h-4 w-4"})})}),e.jsx(hn,{children:a})]}));Z.displayName=Ua.displayName;const El=o.forwardRef(({className:s,...a},t)=>e.jsx(za,{ref:t,className:_("-mx-1 my-1 h-px bg-muted",s),...a}));El.displayName=za.displayName;const Tl=({user:s,profile:a})=>{const[t,r]=o.useState("property"),[i,l]=o.useState(""),[n,f]=o.useState("standard"),[h,N]=o.useState(!1),[p,g]=o.useState([{id:1,type:"Market Analysis",details:"Detailed analysis of the Leeds property market, focusing on rental yields and capital growth potential in different neighborhoods.",priority:"high",status:"in-progress",submittedAt:"2024-05-01T10:30:00Z",estimatedCompletion:"2024-05-08T10:30:00Z"},{id:2,type:"Property",details:"Research on the historical price trends and planning permissions for 123 High Street, Manchester, M1 1AA.",priority:"standard",status:"completed",submittedAt:"2024-04-15T14:45:00Z",completedAt:"2024-04-20T09:15:00Z"}]),j=c=>{c.preventDefault(),N(!0),setTimeout(()=>{const w={id:p.length+1,type:t==="property"?"Property":"Market Analysis",details:i,priority:n,status:"pending",submittedAt:new Date().toISOString(),estimatedCompletion:new Date(Date.now()+6048e5).toISOString()};g([w,...p]),l(""),N(!1)},1500)},y=(a==null?void 0:a.subscription_tier)!=="free",v=y,L=y?"Unlimited":"2 / 3",b=c=>{switch(c){case"completed":return e.jsx(le,{className:"h-5 w-5 text-green-500"});case"in-progress":return e.jsx(Ls,{className:"h-5 w-5 text-blue-500"});case"pending":return e.jsx(Ls,{className:"h-5 w-5 text-amber-500"});default:return e.jsx(gn,{className:"h-5 w-5 text-red-500"})}},d=c=>new Date(c).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"});return e.jsxs("div",{children:[e.jsxs($,{className:"mb-8",children:[e.jsx(K,{children:e.jsx("h3",{className:"text-lg font-semibold",children:"Request Custom Research"})}),e.jsx(z,{children:e.jsx("form",{onSubmit:j,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(G,{htmlFor:"request-type",children:"Request Type"}),e.jsxs(Ae,{value:t,onValueChange:r,children:[e.jsx(_e,{id:"request-type",children:e.jsx(Ie,{placeholder:"Select request type"})}),e.jsxs(ke,{children:[e.jsx(Z,{value:"property",children:"Property Research"}),e.jsx(Z,{value:"market",children:"Market Analysis"})]})]})]}),e.jsxs("div",{children:[e.jsx(G,{htmlFor:"request-details",children:"Details"}),e.jsx(xt,{id:"request-details",placeholder:"Please provide specific details about what you'd like us to research...",rows:5,value:i,onChange:c=>l(c.target.value)})]}),e.jsxs("div",{children:[e.jsx(G,{htmlFor:"request-priority",children:"Priority"}),e.jsxs(Ae,{value:n,onValueChange:f,disabled:!v&&n==="high",children:[e.jsx(_e,{id:"request-priority",children:e.jsx(Ie,{placeholder:"Select priority"})}),e.jsxs(ke,{children:[e.jsx(Z,{value:"standard",children:"Standard (7 days)"}),e.jsxs(Z,{value:"high",disabled:!v,children:["High Priority (3 days)",!v&&" - Premium Feature"]})]})]})]})]})})}),e.jsxs(Os,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between border-t pt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground mb-4 sm:mb-0",children:["Requests remaining this month: ",e.jsx("span",{className:"font-medium",children:L})]}),e.jsx(k,{type:"submit",onClick:j,disabled:!i.trim()||h,children:h?"Submitting...":"Submit Request"})]})]}),e.jsxs($,{children:[e.jsx(K,{children:e.jsx("h3",{className:"text-lg font-semibold",children:"Your Research Requests"})}),e.jsx(z,{children:p.length>0?e.jsx("div",{className:"space-y-4",children:p.map(c=>e.jsxs("div",{className:"p-4 border rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsxs("h4",{className:"font-medium",children:[c.type," Request"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:c.details}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Submitted: ",d(c.submittedAt)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[b(c.status),e.jsx("span",{className:"text-sm font-medium capitalize",children:c.status.replace("-"," ")})]})]}),c.status==="in-progress"&&e.jsxs("div",{className:"mt-4 pt-4 border-t text-xs text-muted-foreground",children:["Estimated completion: ",d(c.estimatedCompletion)]}),c.status==="completed"&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs(k,{variant:"outline",size:"sm",className:"w-full sm:w-auto",children:[e.jsx(Download,{className:"h-4 w-4 mr-2"}),"Download Report"]})})]},c.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Pt,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No requests yet"}),e.jsx("p",{className:"text-muted-foreground",children:"You haven't submitted any research requests yet."})]})})]})]})},Dl=({children:s})=>{try{return ee(),e.jsx(e.Fragment,{children:s})}catch{return e.jsx(ce,{children:e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:e.jsxs($,{className:"p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Authentication Error"}),e.jsx("p",{className:"text-muted-foreground mb-6 text-center",children:"Unable to load authentication. Please refresh the page or try again later."}),e.jsx(k,{className:"w-full",onClick:()=>window.location.reload(),children:"Refresh Page"})]})})})}},Ll=()=>e.jsx(Dl,{children:e.jsx(Fl,{})}),Fl=()=>{const{user:s,profile:a,isLoading:t}=ee(),r=ze(),[i,l]=o.useState([]),[n,f]=o.useState(!0),[h,N]=S.useState(!1),[p,g]=S.useState("reports");return o.useEffect(()=>{let j=!0;async function y(){try{const v=await xr();j&&(l(v),f(!1))}catch(v){console.error("Error loading deals:",v),j&&f(!1)}}return s&&!t?y():!t&&!s&&r("/login"),()=>{j=!1}},[s,t,r]),t?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{children:"Loading..."})}):s?e.jsx(ce,{children:e.jsx(Fe,{children:e.jsxs("div",{className:"min-h-screen bg-neutral",children:[e.jsx(Ne,{title:"Research & Analysis",subtitle:"Discover in-depth market insights and property analysis",showSearch:!1,showStats:!1,height:"h-[400px]",image:"/research-hero.jpg"}),e.jsxs("main",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4 text-primary",children:"Latest Research"}),e.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Stay informed with our comprehensive research reports and expert analysis"})]}),e.jsxs(Ve,{defaultValue:"reports",value:p,onValueChange:g,className:"mb-8",children:[e.jsxs(He,{className:"mb-4",children:[e.jsx(ie,{value:"reports",children:"Research Reports"}),e.jsx(ie,{value:"requests",children:"Research Requests"})]}),e.jsx(ae,{value:"reports",children:e.jsx(Il,{user:s,profile:a})}),e.jsx(ae,{value:"requests",children:e.jsx(Tl,{user:s,profile:a})})]})]}),n?e.jsx("div",{className:"text-center py-8",children:"Loading deals..."}):e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Latest Deals"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:i.map(j=>e.jsx(rt,{deal:j,isSubscriber:(a==null?void 0:a.subscription_tier)!=="free"},j.id))})]})]}),e.jsx(cr,{isOpen:h,onClose:()=>N(!1)})]})})}):null};function Ol(){const{user:s,profile:a}=ee(),t=[{title:"Understanding Property Market Cycles",excerpt:"A comprehensive guide to property market cycles and how to identify market phases for optimal investment timing.",category:"Market Analysis",date:"2024-03-20",readTime:"8 min read",image:"https://images.unsplash.com/photo-1460472178825-e5240623afd5?ixlib=rb-4.0.3"},{title:"Buy-to-Let Investment Strategy Guide",excerpt:"Expert insights into creating a successful buy-to-let investment strategy in today's market conditions.",category:"Investment",date:"2024-03-18",readTime:"10 min read",image:"https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3"},{title:"Property Tax Changes in 2024",excerpt:"Stay updated with the latest property tax regulations and how they affect property investors and homeowners.",category:"Legal",date:"2024-03-15",readTime:"6 min read",image:"https://images.unsplash.com/photo-1554224155-8d04cb21cd6c?ixlib=rb-4.0.3"}];return e.jsx(Fe,{children:e.jsxs(ce,{children:[e.jsx(Ne,{title:"Property Investment Blog",subtitle:"Expert insights and analysis on the UK property market",backgroundImage:"https://images.unsplash.com/photo-1542744173-8e7e53415bb0?ixlib=rb-4.0.3",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24 sm:pt-8",children:e.jsx("div",{className:"max-w-7xl mx-auto space-y-8",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((r,i)=>e.jsxs($,{className:"flex flex-col h-full hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"relative h-48 w-full overflow-hidden rounded-t-lg",children:e.jsx("img",{src:r.image,alt:r.title,className:"w-full h-full object-cover"})}),e.jsxs(K,{className:"flex flex-row items-center gap-2",children:[e.jsx(Ta,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:r.category})]}),e.jsxs(z,{className:"flex-1 flex flex-col",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:r.title}),e.jsx("p",{className:"text-muted-foreground mb-4 flex-1",children:r.excerpt}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($e,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(r.date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ls,{className:"w-4 h-4"}),e.jsx("span",{children:r.readTime})]})]}),e.jsxs(k,{variant:"ghost",className:"group hover:text-primary",onClick:()=>{window.location.href=`/blog/${r.title.toLowerCase().replace(/ /g,"-")}`},children:["Read More",e.jsx(Is,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})]})]})]},i))})})})]})})}function $l(){const s=[{title:"Getting Started",icon:e.jsx(fn,{className:"w-5 h-5"}),description:"Learn the basics of using our platform",content:["How to search for properties","Understanding market insights","Setting up your account","Subscription plans overview"]},{title:"Account & Billing",icon:e.jsx(We,{className:"w-5 h-5"}),description:"Manage your account and subscription",content:["Updating account details","Subscription management","Billing history","Payment methods"]},{title:"Technical Support",icon:e.jsx(jn,{className:"w-5 h-5"}),description:"Get help with technical issues",content:["Troubleshooting guide","System requirements","Known issues","Browser compatibility"]}],a=[{icon:e.jsx(vn,{className:"w-5 h-5"}),title:"Email Support",description:"Get help via email",action:"support@myvge.co.uk",buttonText:"Send Email",onClick:()=>window.location.href="mailto:support@myvge.co.uk"},{icon:e.jsx(yn,{className:"w-5 h-5"}),title:"Phone Support",description:"Speak to our team",action:"0800 123 4567",buttonText:"Call Now",onClick:()=>window.location.href="tel:08001234567"},{icon:e.jsx(gs,{className:"w-5 h-5"}),title:"Live Chat",description:"Chat with our support team",action:"Available 24/7",buttonText:"Start Chat",onClick:()=>{const t=new CustomEvent("open-messages",{detail:{receiverId:"support"}});window.dispatchEvent(t)}}];return e.jsx(Fe,{children:e.jsxs(ce,{children:[e.jsx(Ne,{title:"Help & Support Center",subtitle:"Get the assistance you need with our comprehensive support resources",backgroundImage:"https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?ixlib=rb-4.0.3",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsx("main",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-12",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:s.map((t,r)=>e.jsxs($,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(K,{className:"flex flex-row items-center gap-2",children:[t.icon,e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.description})]})]}),e.jsx(z,{children:e.jsx("ul",{className:"space-y-2",children:t.content.map((i,l)=>e.jsxs("li",{className:"text-sm",children:["• ",i]},l))})})]},r))}),e.jsxs("div",{className:"bg-card shadow rounded-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Contact Support"}),e.jsx("p",{className:"text-muted-foreground",children:"Choose your preferred method of contact"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:a.map((t,r)=>e.jsx($,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(z,{className:"p-6 text-center",children:[e.jsx("div",{className:"mb-4 flex justify-center",children:t.icon}),e.jsx("h3",{className:"font-semibold mb-2",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:t.description}),e.jsx("p",{className:"text-sm font-medium mb-4",children:t.action}),e.jsx(k,{onClick:t.onClick,className:"w-full",children:t.buttonText})]})},r))})]})]})})]})})}const Ul=s=>{let a=s.replace(/\*\*(.*?)\*\*/g,'<span class="font-bold">$1</span>');return a=a.replace(/\*(.*?)\*/g,'<span class="italic">$1</span>'),a=a.replace(/^- (.+)$/gm,'<span class="block ml-2">• $1</span>'),a=a.replace(/^\d+\. (.+)$/gm,'<span class="block ml-2">$&</span>'),a.split(`
`).map(t=>t?`<span class="block">${t}</span>`:'<span class="block h-2"></span>').join("")},zl="AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo",ql="https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent";function Bl(){const{user:s,profile:a}=ee(),[t,r]=S.useState(!1),[i,l]=S.useState("ai"),[n,f]=S.useState([]),[h,N]=S.useState([]),[p,g]=S.useState([]),[j,y]=S.useState(""),[v,L]=S.useState(!1),[b,d]=S.useState([]),[c,w]=S.useState(null),T=S.useRef(null),F=ze();S.useEffect(()=>{if(s){P();const x=A=>{r(!0),l("messages");const I=A.detail.receiverId,U=b.find(J=>J.id===I);U&&w(U)};return window.addEventListener("open-messages",x),()=>window.removeEventListener("open-messages",x)}},[s,b]);const P=async()=>{try{const{data:x}=await Y.from("messages").select(`
          *,
          sender:profiles!messages_sender_id_fkey(id, full_name, email),
          receiver:profiles!messages_receiver_id_fkey(id, full_name, email)
        `).or(`sender_id.eq.${s==null?void 0:s.id},receiver_id.eq.${s==null?void 0:s.id}`).order("created_at",{ascending:!1});if(!x)return;const A=new Map;x.forEach(I=>{const U=I.sender.id===(s==null?void 0:s.id)?I.receiver:I.sender;A.has(U.id)||A.set(U.id,{id:U.id,full_name:U.full_name,email:U.email,last_message:I.content,unread_count:I.receiver_id===(s==null?void 0:s.id)&&!I.is_read?1:0})}),d(Array.from(A.values()))}catch(x){console.error("Error loading contacts:",x)}},M=async x=>{if(x.trim())if(i==="ai"){f(A=>[...A,{text:x,isUser:!0}]),y(""),L(!0);try{const A=await fetch(`${ql}?key=${zl}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:x}]}]})});if(!A.ok)throw new Error(`AI API error: ${A.status}`);const U=(await A.json()).candidates[0].content.parts[0].text;if(s){const J=`ai_${s.id}_${Date.now()}`;await Y.from("messages").insert([{sender_id:s.id,receiver_id:s.id,content:x,is_support:!1,conversation_id:J},{sender_id:null,receiver_id:s.id,content:U,is_support:!0,conversation_id:J}])}f(J=>[...J,{text:U,isUser:!1}])}catch(A){console.error("Error in AI chat:",A),f(I=>[...I,{text:"Sorry, I encountered an error. Please try again.",isUser:!1}])}finally{L(!1)}}else if(s)if(i==="support"){N(A=>[...A,{text:x,isUser:!0}]),y("");try{const A=`support_${s.id}_${Date.now()}`,{error:I}=await Y.from("messages").insert({sender_id:s.id,receiver_id:"support",content:x,is_support:!0,conversation_id:A});if(I)throw I;const U="Thank you for your message. Our support team will get back to you soon.",{error:J}=await Y.from("messages").insert({sender_id:null,receiver_id:s.id,content:U,is_support:!0,conversation_id:A});if(J)throw J;N(X=>[...X,{text:U,isUser:!1}])}catch(A){console.error("Error handling support message:",A),N(I=>[...I,{text:"Sorry, there was an error sending your message. Please try again.",isUser:!1}])}}else{if(!s||!c)return;try{console.log("Sending message to Supabase:",{sender_id:s.id,receiver_id:c.id,content:x,is_support:i==="support"});const{data:A,error:I}=await Y.from("messages").insert([{sender_id:s.id,receiver_id:c.id,content:x,is_support:i==="support"}]);if(I)throw console.error("Supabase insert error:",I),I;console.log("Supabase insert success:",A),g(U=>[...U,{text:x,isUser:!0,sender:{full_name:(a==null?void 0:a.full_name)||"",email:(a==null?void 0:a.email)||""},timestamp:new Date().toISOString()}]),y("")}catch(A){console.error("Error sending message:",A)}}else{f(A=>[...A,{text:"Please sign in to use support and direct messaging features.",isUser:!1}]);return}},O=()=>{T.current&&(T.current.scrollTop=T.current.scrollHeight)};return S.useEffect(()=>{O()},[n,h,p]),S.useEffect(()=>{O()},[v]),S.useEffect(()=>{if(!s||!c)return;const x=Y.channel(`messages:${s.id}:${c.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`or(and(sender_id.eq.${s.id},receiver_id.eq.${c.id}),and(sender_id.eq.${c.id},receiver_id.eq.${s.id}))`},A=>{console.log("Realtime message received:",A);const I=A.new;I.sender_id!==s.id&&g(U=>[...U,{text:I.content,isUser:!1,sender:c,timestamp:I.created_at}])}).subscribe();return()=>{x.unsubscribe()}},[s,c]),e.jsx(e.Fragment,{children:e.jsx("div",{className:`fixed bottom-4 right-4 z-50 ${t?"w-96":"w-auto"}`,children:t?e.jsxs("div",{className:"bg-background border rounded-lg shadow-lg",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"font-semibold",children:"AI Assistant"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>F("/messages"),title:"Chat with Users",children:e.jsx(ot,{className:"h-4 w-4"})}),e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>r(!1),children:e.jsx(nt,{className:"h-4 w-4"})})]})]}),e.jsxs(Ve,{defaultValue:i,onValueChange:l,children:[e.jsxs(ae,{value:"ai",className:"m-0 bg-white",children:[e.jsxs("div",{ref:T,className:"h-96 p-4 space-y-4 overflow-y-auto",children:[n.length===0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hello! I'm your property assistant. Ask me anything about property investment, or try one of these popular questions:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:wl.map((x,A)=>e.jsx(k,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>M(x),children:x},A))})]}):n.map((x,A)=>e.jsx("div",{className:`flex ${x.isUser?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${x.isUser?"bg-primary text-primary-foreground":"bg-muted"}`,children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:x.isUser?x.text:Ul(x.text)}})})},A)),v&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"max-w-[80%] rounded-lg p-3 bg-muted",children:e.jsx("p",{className:"text-sm",children:"Typing..."})})})]}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{value:j,onChange:x=>y(x.target.value),placeholder:"Ask me anything about property...",onKeyPress:x=>{x.key==="Enter"&&M(j)}}),e.jsx(k,{onClick:()=>M(j),disabled:!j.trim(),children:e.jsx(cs,{className:"h-4 w-4"})})]})})]}),e.jsxs(ae,{value:"messages",className:"m-0 bg-white",children:[e.jsx("div",{ref:T,className:"h-96 p-4 space-y-4 overflow-y-auto",children:s?c?e.jsx("div",{className:"space-y-4",children:p.map((x,A)=>e.jsx("div",{className:`flex ${x.isUser?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${x.isUser?"bg-primary text-primary-foreground":"bg-muted"}`,children:e.jsx("p",{className:"text-sm",children:x.text})})},A))}):e.jsx("div",{className:"space-y-4",children:b.map(x=>{var A;return e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-muted rounded-lg cursor-pointer",onClick:()=>w(x),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Re,{className:"h-8 w-8",children:[e.jsx(Me,{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(x.full_name)}&background=random`,alt:x.full_name}),e.jsx(Ee,{children:(A=x.full_name)==null?void 0:A.split(" ").map(I=>I[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:x.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:x.last_message})]})]}),x.unread_count&&x.unread_count>0&&e.jsx("span",{className:"bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full",children:x.unread_count})]},x.id)})}):e.jsx("div",{className:"text-center p-4",children:e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Please sign in to view messages"})})}),c&&e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{value:j,onChange:x=>y(x.target.value),placeholder:"Type a message...",onKeyPress:x=>{x.key==="Enter"&&M(j)}}),e.jsx(k,{onClick:()=>M(j),disabled:!j.trim(),children:e.jsx(cs,{className:"h-4 w-4"})})]})})]}),e.jsxs(ae,{value:"support",className:"m-0 bg-white",children:[e.jsx("div",{ref:T,className:"h-96 p-4 space-y-4 overflow-y-auto",children:h.length===0?e.jsx("div",{className:"space-y-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Welcome to support! How can we help you today?"})}):h.map((x,A)=>e.jsx("div",{className:`flex ${x.isUser?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${x.isUser?"bg-primary text-primary-foreground":"bg-muted"}`,children:e.jsx("p",{className:"text-sm",children:x.text})})},A))}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{value:j,onChange:x=>y(x.target.value),placeholder:"Type your support question...",onKeyPress:x=>{x.key==="Enter"&&M(j)}}),e.jsx(k,{onClick:()=>M(j),disabled:!j.trim(),children:e.jsx(cs,{className:"h-4 w-4"})})]})})]})]})]}):e.jsx(k,{onClick:()=>r(!0),className:"rounded-full h-12 w-12 flex items-center justify-center",children:e.jsx(gs,{className:"h-6 w-6"})})})})}function Gl(){const s=ze();return o.useEffect(()=>{Y.auth.onAuthStateChange((t,r)=>{console.log("Auth state change:",t,r),t==="SIGNED_IN"&&s("/dashboard")}),(async()=>{const{data:{session:t}}=await Y.auth.getSession();console.log("Initial session:",t),s(t?"/dashboard":"/")})()},[s]),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Authenticating..."}),e.jsx("p",{className:"text-muted-foreground",children:"Please wait while we verify your credentials."})]})})}const Vl=[{title:"AI Property Analysis",description:"Advanced AI algorithms analyze market trends, rental rates, and property conditions to optimize your investment returns.",icon:qa,badge:"AI-Powered"},{title:"Smart Tenant Matching",description:"AI-driven tenant screening and matching system to find the perfect tenants for your properties.",icon:Ye,badge:"Smart Match"},{title:"Predictive Maintenance",description:"AI predicts maintenance needs before they become issues, saving you time and money.",icon:Qs,badge:"Predictive"},{title:"Automated Reporting",description:"AI-generated insights and reports on property performance, maintenance history, and financial metrics.",icon:ct,badge:"Automated"},{title:"AI Chat Support",description:"24/7 AI-powered chat support for tenants and property owners.",icon:os,badge:"24/7 Support"},{title:"Smart Security",description:"AI-enhanced security monitoring and access control systems.",icon:Nn,badge:"Enhanced"}],Hl=[{title:"Tenant Screening",description:"Comprehensive tenant screening with AI-powered background checks and risk assessment."},{title:"Rent Collection",description:"Smart rent collection with predictive payment analysis and automated reminders."},{title:"Property Maintenance",description:"AI-driven maintenance scheduling and vendor management."},{title:"Financial Reporting",description:"Advanced financial analytics with AI-powered forecasting and recommendations."}];function Wl(){return e.jsx(Fe,{children:e.jsxs(ce,{children:[e.jsx(Ne,{title:"AI-Powered Property Management",subtitle:"Experience the future of property management with our advanced AI solutions.",backgroundImage:"https://images.unsplash.com/photo-1568605114967-8130f3a36994?ixlib=rb-4.0.3",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-16",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Next-Generation Property Management"}),e.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Leveraging artificial intelligence to revolutionize property management and maximize your investment returns."})]}),e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-center",children:"AI-Powered Features"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Vl.map((s,a)=>e.jsxs($,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(K,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(s.icon,{className:"h-6 w-6 text-primary"}),e.jsx(oe,{variant:"secondary",children:s.badge})]}),e.jsx(ue,{className:"text-xl",children:s.title})]}),e.jsx(z,{children:e.jsx("p",{className:"text-muted-foreground",children:s.description})})]},a))})]}),e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-center",children:"Core Services Enhanced by AI"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Hl.map((s,a)=>e.jsxs($,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(K,{children:e.jsx(ue,{children:s.title})}),e.jsx(z,{children:e.jsx("p",{className:"text-muted-foreground",children:s.description})})]},a))})]}),e.jsxs("section",{className:"space-y-8 bg-muted p-8 rounded-lg",children:[e.jsx("h2",{className:"text-2xl font-semibold text-center",children:"Why Choose Our AI-Powered Management?"}),e.jsx("div",{className:"prose prose-lg max-w-none",children:e.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[e.jsx("li",{children:"Reduce operational costs by up to 30% with AI automation"}),e.jsx("li",{children:"Minimize vacancy rates with smart tenant matching"}),e.jsx("li",{children:"Prevent maintenance issues before they occur"}),e.jsx("li",{children:"Get real-time insights and predictive analytics"}),e.jsx("li",{children:"24/7 automated support for tenants"}),e.jsx("li",{children:"Enhanced security and risk management"})]})})]}),e.jsxs("section",{className:"text-center space-y-6",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Ready to Transform Your Property Management?"}),e.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Experience the power of AI-driven property management. Contact us to learn how we can help optimize your property portfolio."}),e.jsx(k,{size:"lg",className:"px-8",children:"Schedule a Demo"})]})]})})]})})}const fe=o.forwardRef(({className:s,...a},t)=>e.jsxs(Ba,{ref:t,className:_("relative flex w-full touch-none select-none items-center",s),...a,children:[e.jsx(bn,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(wn,{className:"absolute h-full bg-primary"})}),e.jsx(Sn,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));fe.displayName=Ba.displayName;let Ys;async function pt(){if(!Ys){const{GoogleGenerativeAI:s}=await _n(async()=>{const{GoogleGenerativeAI:a}=await import("./vendor-B-hfc2Y7.js").then(t=>t.c7);return{GoogleGenerativeAI:a}},[]);Ys=new s("AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo")}return Ys}function gt(s){const a=s.indexOf("{"),t=s.lastIndexOf("}")+1;if(a===-1||t===0)throw new Error("Invalid JSON response");return s.slice(a,t)}async function Yl(s,a){const r=(await pt()).getGenerativeModel({model:"gemini-pro"}),i=`
    You are a UK property investment expert. Analyze investment opportunities for ${s} properties with a budget of £${a}.
    Respond with a JSON object containing ONLY these exact fields:
    {
      "analysis": "Brief overview of the investment opportunity",
      "roi_range": "Expected ROI range as a percentage",
      "risks": ["Risk 1", "Risk 2", "Risk 3"],
      "opportunities": ["Opportunity 1", "Opportunity 2", "Opportunity 3"],
      "market_trends": ["Trend 1", "Trend 2", "Trend 3"]
    }
    Ensure each array has exactly 3 items and all fields are present.
  `;try{const n=await(await r.generateContent(i)).response,f=gt(n.text().trim());console.log("Raw Analysis Response:",f);const h=JSON.parse(f);if(!h.analysis||!h.roi_range||!Array.isArray(h.risks)||!Array.isArray(h.opportunities)||!Array.isArray(h.market_trends))throw new Error("Invalid response format");return{analysis:h.analysis,roi_range:h.roi_range,risks:h.risks.slice(0,3),opportunities:h.opportunities.slice(0,3),market_trends:h.market_trends.slice(0,3)}}catch(l){return console.error("Error in getInvestmentAnalysis:",l),{analysis:`Analysis for ${s} properties with £${a} budget is currently unavailable`,roi_range:"8-12%",risks:["Market volatility","Economic uncertainty","Property condition risks"],opportunities:["Value appreciation potential","Rental income opportunities","Development possibilities"],market_trends:["Rising demand in key areas","Stable price growth","Infrastructure development"]}}}async function Kl(s){const t=(await pt()).getGenerativeModel({model:"gemini-pro"}),r=`
    You are a UK property market expert. Predict property market trends for ${s} in the next 12 months.
    Respond ONLY with a JSON object in this exact format:
    {
      "price_prediction": "2-3 sentence prediction of price movements",
      "demand_factors": ["3 specific demand factors"],
      "recommendations": ["3 specific investment recommendations"]
    }
  `;try{const l=await(await t.generateContent(r)).response,n=gt(l.text().trim());return console.log("Raw Predictions Response:",n),JSON.parse(n)}catch(i){return console.error("Error in getMarketPredictions:",i),{price_prediction:"Market prediction currently unavailable",demand_factors:["Population growth","Economic development","Infrastructure improvements"],recommendations:["Research thoroughly","Consider long-term potential","Evaluate local amenities"]}}}async function Jl(s){const t=(await pt()).getGenerativeModel({model:"gemini-pro"}),r=`
    You are a UK property investment advisor. Create a strategy for a ${s.experience} investor with £${s.budget} budget and ${s.riskTolerance} risk tolerance.
    Respond ONLY with a JSON object in this exact format:
    {
      "strategy": "2-3 sentence overview of recommended strategy",
      "portfolio_allocation": "Suggested portfolio breakdown percentages",
      "timeline": "Recommended investment timeline",
      "expected_returns": "Projected returns overview"
    }
  `;try{const l=await(await t.generateContent(r)).response,n=gt(l.text().trim());return console.log("Raw Strategy Response:",n),JSON.parse(n)}catch(i){return console.error("Error in getInvestmentStrategy:",i),{strategy:"Investment strategy currently unavailable",portfolio_allocation:"Residential: 60%, Commercial: 30%, Cash: 10%",timeline:"5-10 years recommended holding period",expected_returns:"8-12% annual return potential"}}}function Zl(){const[s,a]=S.useState(!1),[t,r]=S.useState(null),[i,l]=S.useState("residential"),[n,f]=S.useState(25e4),[h,N]=S.useState("London"),[p,g]=S.useState(null),[j,y]=S.useState(null),[v,L]=S.useState(null),b={experience:"intermediate",budget:n,riskTolerance:"moderate"},d=async()=>{a(!0),r(null);try{const c=await Yl(i,n);if(!c||typeof c!="object")throw new Error("Invalid analysis data received");g(c);const w=await Kl(h);if(!w||typeof w!="object")throw new Error("Invalid predictions data received");y(w);const T=await Jl(b);if(!T||typeof T!="object")throw new Error("Invalid strategy data received");L(T)}catch(c){console.error("Error in analysis:",c),r(c instanceof Error?c.message:"Failed to generate analysis. Please try again."),g(null),y(null),L(null)}finally{a(!1)}};return e.jsx(Fe,{children:e.jsxs(ce,{children:[e.jsx(Ne,{title:"AI-Powered Investment Analysis",subtitle:"Make data-driven investment decisions with our advanced AI analytics",showSearch:!1,height:"h-[400px]",onSearch:()=>{}}),e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-12",children:[e.jsxs("section",{className:"bg-card p-6 rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Investment Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Property Type"}),e.jsxs(Ae,{defaultValue:i,onValueChange:c=>l(c),children:[e.jsx(_e,{className:"w-full",children:e.jsx(Ie,{placeholder:"Select property type"})}),e.jsxs(ke,{children:[e.jsx(Z,{value:"residential",children:"Residential"}),e.jsx(Z,{value:"commercial",children:"Commercial"}),e.jsx(Z,{value:"industrial",children:"Industrial"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Location"}),e.jsx(q,{type:"text",value:h,onChange:c=>N(c.target.value),placeholder:"Enter location"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Budget: £",n.toLocaleString()]}),e.jsx(fe,{value:[n],onValueChange:c=>f(c[0]),min:1e5,max:1e6,step:5e4})]})]}),e.jsx(k,{onClick:d,disabled:s,className:"mt-6",size:"lg",children:s?e.jsxs(e.Fragment,{children:[e.jsx(Ga,{className:"mr-2 h-4 w-4 animate-spin"}),"Analyzing..."]}):"Analyze Investment Opportunity"})]}),t&&e.jsx("div",{className:"bg-destructive/10 text-destructive p-4 rounded-lg",children:t}),p&&j&&v&&!t&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs($,{children:[e.jsxs(K,{children:[e.jsx(ts,{className:"h-6 w-6 text-primary mb-2"}),e.jsx(ue,{children:"Market Analysis"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Analysis"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:p.analysis||"Analysis not available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"ROI Range"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:p.roi_range||"ROI range not available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Risks"}),e.jsx("ul",{className:"list-disc pl-4 text-sm text-muted-foreground",children:Array.isArray(p.risks)?p.risks.map((c,w)=>e.jsx("li",{children:c},w)):e.jsx("li",{children:"Risks data not available"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Market Trends"}),e.jsx("ul",{className:"list-disc pl-4 text-sm text-muted-foreground",children:Array.isArray(p.market_trends)?p.market_trends.map((c,w)=>e.jsx("li",{children:c},w)):e.jsx("li",{children:"Market trends not available"})})]})]})]}),e.jsxs($,{children:[e.jsxs(K,{children:[e.jsx(qa,{className:"h-6 w-6 text-primary mb-2"}),e.jsx(ue,{children:"AI Predictions"})]}),e.jsxs(z,{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Price Trend"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:j.price_prediction||"Price prediction not available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Demand Factors"}),e.jsx("ul",{className:"list-disc pl-4 text-sm text-muted-foreground",children:Array.isArray(j.demand_factors)?j.demand_factors.map((c,w)=>e.jsx("li",{children:c},w)):e.jsx("li",{children:"Demand factors not available"})})]})]})]}),e.jsxs($,{children:[e.jsxs(K,{children:[e.jsx(ct,{className:"h-6 w-6 text-primary mb-2"}),e.jsx(ue,{children:"Recommended Strategy"})]}),e.jsxs(z,{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Portfolio Allocation"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v.portfolio_allocation||"Portfolio allocation not available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Expected Returns"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v.expected_returns||"Expected returns not available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Timeline"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v.timeline||"Timeline not available"})]})]})]})]})]})})]})})}function Xl(){return e.jsx(Fe,{children:e.jsxs(ce,{children:[e.jsx(Ne,{title:"About MyVGE",subtitle:"Learn more about our mission and our team",backgroundImage:"https://images.unsplash.com/photo-1507585495646-50c2b6dbd483?ixlib=rb-4.0.3",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Our Story"}),e.jsx("p",{className:"text-muted-foreground",children:"MyVGE is dedicated to providing property investors with the tools and insights they need to succeed."})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Our Mission"}),e.jsx("p",{children:"To empower property investors with comprehensive data, expert analysis, and innovative tools to make informed decisions and achieve their financial goals. We are committed to ethical practices, diversity, and transparency in all our operations."})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Our Values"}),e.jsxs("ul",{className:"list-disc list-inside",children:[e.jsx("li",{children:"**Ethical Practices:** We adhere to the highest ethical standards in all our dealings, ensuring fairness and integrity."}),e.jsx("li",{children:"**Diversity:** We embrace diversity and inclusion, fostering a welcoming environment for all."}),e.jsx("li",{children:"**Transparency:** We are committed to open and honest communication, providing clear and accurate information to our users."})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Our Team"}),e.jsx("p",{children:"Our team consists of experienced property professionals, data scientists, and technology experts who are passionate about helping investors navigate the complexities of the real estate market. We are a diverse group of individuals with a shared commitment to excellence."})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Contact Us"}),e.jsx("p",{children:"We'd love to hear from you! Contact us to learn more about our services or to discuss your investment needs."}),e.jsx(k,{children:"Contact Us"})]})]})})]})})}const Ql=({isOpen:s,onClose:a,deal:t,isSubscriber:r})=>t?e.jsx(Ue,{open:s,onOpenChange:a,children:e.jsxs(Te,{className:"max-w-3xl w-[95vw] max-h-[90vh] overflow-y-auto p-4 sm:p-6",children:[e.jsx(De,{children:e.jsxs(Le,{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 sm:gap-4",children:[e.jsx("span",{className:"text-lg sm:text-xl font-bold break-words pr-4",children:t.title}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(oe,{className:"text-xs",children:t.property_type}),e.jsx(oe,{variant:"secondary",className:"text-xs",children:t.deal_type})]})]})}),e.jsx("div",{className:"relative aspect-video mb-3 sm:mb-4 overflow-hidden rounded-lg",children:e.jsx("img",{src:t.image_url,alt:t.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex items-center gap-2 mb-3 sm:mb-4 text-sm sm:text-base text-muted-foreground",children:[e.jsx(Ke,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"break-words",children:t.location})]}),e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:t.description})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"Price"}),e.jsx("p",{className:"text-base sm:text-lg",children:B(t.price)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"ROI"}),e.jsxs("p",{className:"text-base sm:text-lg text-emerald-500",children:[t.roi_percentage,"%"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"Investment Term"}),e.jsx("p",{className:"text-base sm:text-lg",children:t.investment_term})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"Property Type"}),e.jsx("p",{className:"text-base sm:text-lg",children:t.property_type})]})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"Deal Type"}),e.jsx(oe,{variant:"outline",className:"text-xs sm:text-sm",children:t.deal_type})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"Location"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground break-words",children:t.location})]})]})]})}):null,eo=({children:s})=>{try{return ee(),e.jsx(e.Fragment,{children:s})}catch{return e.jsx(ce,{children:e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:e.jsxs($,{className:"p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Authentication Error"}),e.jsx("p",{className:"text-muted-foreground mb-6 text-center",children:"Unable to load authentication. Please refresh the page or try again later."}),e.jsx(k,{className:"w-full",onClick:()=>window.location.reload(),children:"Refresh Page"})]})})})}};function so({onSignIn:s,onSignUp:a}){return e.jsx(eo,{children:e.jsx(to,{onSignIn:s,onSignUp:a})})}function to({onSignIn:s,onSignUp:a}){const{user:t,profile:r,isLoading:i}=ee(),[l,n]=o.useState([]),[f,h]=o.useState(!0),[N,p]=o.useState(null);return o.useEffect(()=>{let g=!0;async function j(){try{const y=await xr();g&&(n(y),h(!1))}catch(y){console.error("Error loading deals:",y),g&&h(!1)}}return j(),()=>{g=!1}},[]),i?e.jsx(ce,{children:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{children:"Loading..."})})}):e.jsx(ce,{children:e.jsx(Fe,{children:e.jsxs("div",{className:"min-h-screen bg-neutral",children:[e.jsx(Ne,{title:"Property Deals",subtitle:"Discover exclusive property investment opportunities",showSearch:!0,showStats:!1,height:"h-[400px]",image:"/deals-hero.jpg"}),e.jsx("main",{className:"container mx-auto px-4 py-8",children:f?e.jsx("div",{className:"text-center py-8",children:"Loading deals..."}):t?e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:l.map(g=>e.jsx(rt,{deal:g,isSubscriber:(r==null?void 0:r.subscription_tier)!=="free",onClick:()=>p(g),user:t},g.id))}):e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs($,{className:"p-8 text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Sign in to View Full Deal Details"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Get access to exclusive property deals and investment opportunities. Create an account or sign in to view all available deals."}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsxs(k,{onClick:s,className:"flex items-center gap-2",children:[e.jsx(Js,{className:"w-4 w-4"}),"Sign In"]}),e.jsxs(k,{variant:"outline",onClick:a,className:"flex items-center gap-2",children:[e.jsx(us,{className:"w-4 w-4"}),"Create Account"]})]})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:l.map(g=>e.jsx(rt,{deal:g,isSubscriber:!1,onClick:s,user:null},g.id))})]})}),e.jsx(Ql,{isOpen:!!N,onClose:()=>p(null),deal:N,isSubscriber:(r==null?void 0:r.subscription_tier)!=="free"})]})})})}function ao(){var Se,ve,we,D;const{user:s}=ee(),[a,t]=o.useState([]),[r,i]=o.useState(null),[l,n]=o.useState([]),[f,h]=o.useState(""),[N,p]=o.useState(!0),[g,j]=o.useState(!1),[y,v]=o.useState(null),[L,b]=o.useState(""),[d,c]=o.useState([]),[w,T]=o.useState(!1),[F,P]=o.useState(!1),[M,O]=o.useState(!1),[x,A]=o.useState(!1),I=o.useRef(null),{data:U}=kn("session",async()=>{var R,V;const{data:m}=await Y.auth.getSession();return console.log("SWR session check:",{hasSession:!!m.session,sessionUser:(V=(R=m.session)==null?void 0:R.user)==null?void 0:V.id}),m.session}),J=!!s||!!U;o.useEffect(()=>{var m;console.log("Authentication state:",{authUser:!!s,authUserId:s==null?void 0:s.id,session:!!U,sessionUserId:(m=U==null?void 0:U.user)==null?void 0:m.id,isAuthenticated:J})},[s,U,J]),o.useEffect(()=>{const m=()=>{O(window.innerWidth<768)};return m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]),o.useEffect(()=>{M&&r&&A(!0)},[r,M]),o.useEffect(()=>{if(J){console.log("User is authenticated, loading conversations"),X();const m=Ri(R=>{(R.sender_id===r||R.receiver_id===r)&&n(V=>[...V,R]),X()});return()=>{m==null||m.unsubscribe()}}else console.log("User is not authenticated"),v("Please sign in to view your messages"),p(!1)},[J,r]),o.useEffect(()=>{const{data:m}=Y.auth.onAuthStateChange((R,V)=>{console.log("Auth state change detected:",R,!!V),V&&(R==="SIGNED_IN"||R==="INITIAL_SESSION")&&(console.log("Auth event triggered conversation loading"),v(null),X())});return()=>{m.subscription.unsubscribe()}},[]),o.useEffect(()=>{r&&he(r)},[r]),o.useEffect(()=>{se()},[l]),o.useEffect(()=>{F&&xe("")},[F]);const X=async()=>{try{p(!0);const m=(U==null?void 0:U.user)||s;if(!(m!=null&&m.id)){console.log("No active user found for loading conversations"),t([]);return}console.log(`Loading conversations for user: ${m.id}`);const R=await Ii();console.log("Loaded conversations:",R),t(R),v(null)}catch(m){console.error("Error getting conversations:",m),v("Failed to load conversations. Please try again.")}finally{p(!1)}},he=async m=>{try{j(!0);const R=await mr(m);n(R)}catch(R){console.error("Error loading messages:",R)}finally{j(!1)}},de=async m=>{if(m.preventDefault(),!(!r||!f.trim()))try{await dr(r,f.trim())&&h("")}catch(R){console.error("Error sending message:",R)}},se=()=>{var m;(m=I.current)==null||m.scrollIntoView({behavior:"smooth"})},xe=async m=>{T(!0);try{console.log(`Starting user search with term: "${m||"all users"}"`);const R=await Mi(m);console.log(`Search returned ${(R==null?void 0:R.length)||0} users:`,R),c(R||[])}catch(R){console.error("Error searching users:",R),c([])}finally{T(!1)}},be=()=>{A(!1)};return!J&&!N?e.jsx(ce,{children:e.jsx(Fe,{children:e.jsx("div",{className:"container mx-auto py-8 pt-24 px-4",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(xs,{variant:"destructive",className:"shadow-md",children:[e.jsx(ht,{className:"font-semibold",children:"Authentication Required"}),e.jsx(ps,{children:"Please sign in to view and send messages"})]})})})})}):e.jsx(ce,{children:e.jsx(Fe,{children:e.jsx("div",{className:"bg-gradient-to-b from-blue-50 to-white min-h-screen",children:e.jsxs("div",{className:"container mx-auto px-4 py-6 pt-20 md:pt-24",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Your Messages"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:gap-6 h-[calc(100vh-220px)] md:h-[calc(100vh-260px)]",children:[e.jsx("div",{className:_("md:w-1/3 lg:w-1/4 flex-shrink-0",M&&x?"hidden":"flex flex-col"),children:e.jsxs($,{className:"flex-1 flex flex-col overflow-hidden shadow-lg border-2 border-blue-100 rounded-xl",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-4 border-b bg-blue-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(os,{className:"h-5 w-5 text-blue-500"}),e.jsx(ue,{children:"Messages"})]}),e.jsxs(Ue,{open:F,onOpenChange:P,children:[e.jsx(gi,{asChild:!0,children:e.jsx(k,{size:"icon",variant:"outline",className:"rounded-full h-8 w-8 border-blue-200 bg-white",children:e.jsx(Cn,{className:"h-4 w-4 text-blue-500"})})}),e.jsxs(Te,{children:[e.jsx(De,{children:e.jsxs(Le,{className:"flex items-center gap-2",children:[e.jsx(us,{className:"h-5 w-5 text-blue-500"}),"New Conversation"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{placeholder:"Search users...",value:L,onChange:m=>{b(m.target.value)},onKeyDown:m=>{m.key==="Enter"&&xe(L)},className:"flex-1"}),e.jsx(k,{size:"icon",variant:"ghost",disabled:w,className:"shrink-0",onClick:()=>xe(L),children:w?e.jsx(Ga,{className:"h-4 w-4 animate-spin"}):e.jsx(ka,{className:"h-4 w-4"})})]}),e.jsxs(ss,{className:"h-[300px]",children:[w&&e.jsx("div",{className:"flex justify-center items-center h-[100px]",children:e.jsx(Qe,{})}),!w&&d.length===0&&e.jsxs("div",{className:"text-center text-muted-foreground p-4 bg-muted/30 rounded-lg",children:[e.jsx(ot,{className:"h-12 w-12 mx-auto mb-2 text-muted-foreground/50"}),e.jsx("p",{children:"No users found"}),e.jsx("p",{className:"text-sm mt-2",children:L?`No users match "${L}"`:"There are no other users in the system"}),e.jsxs("div",{className:"mt-4 text-sm",children:[e.jsx("p",{children:"Try the following:"}),e.jsxs("ul",{className:"list-disc text-left pl-8 mt-2 space-y-1",children:[e.jsx("li",{children:"Check if other users have registered"}),e.jsx("li",{children:"Make sure your internet connection is working"}),e.jsx("li",{children:"Try refreshing the page"}),e.jsx("li",{children:"Check your authentication status"})]})]})]}),!w&&d.map(m=>{var R,V;return e.jsxs("div",{className:"flex items-center gap-3 p-3 hover:bg-blue-50 rounded-lg cursor-pointer transition-colors",onClick:()=>{i(m.id),P(!1)},children:[e.jsxs(Re,{className:"h-10 w-10 border-2 border-blue-200",children:[e.jsx(Me,{src:m.avatar_url||void 0}),e.jsx(Ee,{className:"bg-blue-100 text-blue-600",children:((R=m.full_name)==null?void 0:R.charAt(0))||((V=m.email)==null?void 0:V.charAt(0))||"U"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m.full_name||m.email}),m.full_name&&m.email&&e.jsx("p",{className:"text-xs text-muted-foreground",children:m.email})]})]},m.id)})]})]})]})]})]}),e.jsxs(z,{className:"flex-1 p-0 overflow-hidden",children:[y&&e.jsx(xs,{variant:"destructive",className:"m-3 shadow-sm",children:e.jsx(ps,{children:y})}),N?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(Qe,{size:"lg"})}):a.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4 py-10 bg-blue-50/50",children:[e.jsx(os,{className:"h-16 w-16 mb-4 text-blue-200"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No conversations yet"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-xs",children:"Start a new conversation by clicking the plus icon above"}),e.jsxs(k,{onClick:()=>P(!0),className:"gap-2 bg-blue-500 hover:bg-blue-600",size:"sm",children:[e.jsx(us,{className:"h-4 w-4"}),"New Conversation"]})]}):e.jsx(ss,{className:"h-full",children:e.jsx("div",{className:"divide-y divide-blue-100",children:a.map(m=>e.jsx("div",{className:_("p-3 cursor-pointer hover:bg-blue-50 transition-colors",r===m.user.id?"bg-blue-100":""),onClick:()=>i(m.user.id),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Re,{className:"h-12 w-12 border-2 border-blue-200",children:[e.jsx(Me,{src:m.user.avatar_url||void 0}),e.jsx(Ee,{className:"bg-blue-100 text-blue-600",children:m.user.full_name.charAt(0)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-medium truncate",children:m.user.full_name}),e.jsx("p",{className:"text-xs text-muted-foreground whitespace-nowrap pl-2",children:Zs(new Date(m.lastMessage.created_at),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:[m.lastMessage.sender_id===s.id&&"You: ",m.lastMessage.content]}),m.unreadCount>0&&e.jsx("div",{className:"bg-blue-500 text-white rounded-full h-5 min-w-5 px-1.5 flex items-center justify-center text-xs ml-2",children:m.unreadCount})]})]})]})},m.user.id))})})]})]})}),e.jsx("div",{className:_("md:flex-1 flex flex-col overflow-hidden",M&&!x?"hidden":"flex flex-col"),children:e.jsxs($,{className:"flex-1 flex flex-col overflow-hidden shadow-lg border-2 border-blue-100 rounded-xl",children:[e.jsx(K,{className:"flex flex-row items-center justify-between space-y-0 px-4 py-3 border-b bg-blue-50",children:r?e.jsxs(e.Fragment,{children:[M&&e.jsx(k,{variant:"ghost",size:"icon",className:"mr-1 hover:bg-blue-100",onClick:be,children:e.jsx(Pn,{className:"h-5 w-5 text-blue-500"})}),((Se=a.find(m=>m.user.id===r))==null?void 0:Se.user)&&e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsxs(Re,{className:"h-8 w-8 border-2 border-blue-200",children:[e.jsx(Me,{src:((ve=a.find(m=>m.user.id===r))==null?void 0:ve.user.avatar_url)||void 0}),e.jsx(Ee,{className:"bg-blue-100 text-blue-600",children:((we=a.find(m=>m.user.id===r))==null?void 0:we.user.full_name.charAt(0))||"U"})]}),e.jsx("div",{className:"overflow-hidden",children:e.jsx("p",{className:"font-medium text-sm truncate",children:(D=a.find(m=>m.user.id===r))==null?void 0:D.user.full_name})})]})]}):e.jsx("div",{className:"font-medium",children:"Messages"})}),e.jsx(z,{className:"flex-1 p-0 overflow-hidden",children:r?e.jsxs("div",{className:"h-full flex flex-col",children:[g?e.jsx("div",{className:"flex-1 flex justify-center items-center",children:e.jsx(Qe,{size:"lg"})}):e.jsx(ss,{className:"flex-1 p-4",children:l.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center px-4 bg-blue-50/50",children:[e.jsx(os,{className:"h-16 w-16 mb-4 text-blue-200"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No messages yet"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-xs",children:"Send a message to start the conversation"})]}):e.jsxs("div",{className:"space-y-4",children:[l.map((m,R)=>{const V=m.sender_id===s.id,te=!V&&(R===0||l[R-1].sender_id!==m.sender_id);return e.jsxs("div",{className:_("flex",V?"justify-end":"justify-start"),children:[te?e.jsxs(Re,{className:"mr-2 mt-1 h-8 w-8 border-2 border-blue-200",children:[e.jsx(Me,{src:m.sender.avatar_url}),e.jsx(Ee,{className:"bg-blue-100 text-blue-600",children:m.sender.full_name.charAt(0)})]}):!V&&e.jsx("div",{className:"w-10"}),e.jsxs("div",{className:_("max-w-[75%] rounded-2xl px-4 py-2.5 break-words shadow-sm",V?"bg-blue-500 text-white rounded-tr-none":"bg-blue-100 rounded-tl-none"),children:[e.jsx("p",{className:"text-sm",children:m.content}),e.jsx("p",{className:_("text-xs mt-1",V?"text-blue-100":"text-blue-500"),children:Zs(new Date(m.created_at),{addSuffix:!0})})]})]},m.id)}),e.jsx("div",{ref:I})]})}),e.jsx("form",{onSubmit:de,className:"p-3 border-t bg-blue-50",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{value:f,onChange:m=>h(m.target.value),placeholder:"Type a message...",className:"flex-1 border-blue-200 bg-white"}),e.jsxs(k,{type:"submit",className:"shrink-0 bg-blue-500 hover:bg-blue-600",disabled:!f.trim(),children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"Send"]})]})})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center px-4 bg-blue-50/50",children:[e.jsx(os,{className:"h-16 w-16 mb-4 text-blue-200"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Select a conversation"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-xs",children:"Choose a conversation from the list or start a new one"})]})})]})})]})})]})})})})}const $s="3160af39c66686f66e595371584faa9d8087132c",Us="https://app.patma.co.uk",zs="/api/prospector/v1";async function ro(s){try{const a=new URLSearchParams;a.append("postcode",s.postcode),s.lat&&a.append("lat",s.lat.toString()),s.long&&a.append("long",s.long.toString()),s.bedrooms&&a.append("bedrooms",s.bedrooms.toString()),s.property_type&&a.append("property_type",s.property_type),s.min_data_points&&a.append("min_data_points",s.min_data_points.toString());const t=`${Us}${zs}/asking-prices/?${a.toString()}`;console.log("Fetching asking prices from:",t);const r=await fetch(t,{method:"GET",headers:{Authorization:`Token ${$s}`,"Content-Type":"application/json",Accept:"application/json"}});if(!r.ok){const i=await r.json();throw new Error(i.message||"Failed to fetch asking prices")}return await r.json()}catch(a){throw console.error("Error fetching asking prices:",a),a}}async function no(s){var a;try{const t=new URLSearchParams;t.append("postcode",s.postcode),s.location&&t.append("location",s.location),s.lat&&t.append("lat",s.lat.toString()),s.long&&t.append("long",s.long.toString()),t.append("property_type",s.property_type),s.tenure&&t.append("tenure",s.tenure),s.new_build&&t.append("new_build",s.new_build),s.max_age_months&&t.append("max_age_months",s.max_age_months.toString()),s.min_data_points&&t.append("min_data_points",s.min_data_points.toString()),s.apply_indexation!==void 0&&t.append("apply_indexation",s.apply_indexation.toString());const r=`${Us}${zs}/sold-prices/?${t.toString()}`;console.log("Fetching sold properties from:",r);const i=await fetch(r,{method:"GET",headers:{Authorization:`Token ${$s}`,"Content-Type":"application/json",Accept:"application/json"}});if(!i.ok){const n=await i.json().catch(()=>({errors:["Unknown error occurred"]}));throw new Error(((a=n.errors)==null?void 0:a[0])||`HTTP error! status: ${i.status}`)}const l=await i.json();if(console.log("Sold properties response:",l),l.status==="error"||l.errors){const n=Array.isArray(l.errors)?l.errors[0]:l.message||"Failed to fetch sold properties";throw new Error(n)}return l&&l.data&&Array.isArray(l.data.available_results)?{properties:l.data.available_results,total:l.data.total_results_count||l.data.available_results.length,totalPages:l.data.number_of_pages||Math.ceil(l.data.total_results_count/(s.page_size||12))}:l&&l.data&&Array.isArray(l.data.properties)?{properties:l.data.properties,total:l.data.total||l.data.properties.length,totalPages:l.data.total_pages||Math.ceil(l.data.properties.length/(s.page_size||10))}:(console.warn("Unexpected API response structure for sold properties:",l),{properties:[],total:0,totalPages:1})}catch(t){throw console.error("Error fetching sold properties:",t),t}}async function io(s){var a,t;try{const r=new URLSearchParams;r.append("postcode",s.postcode),s.location&&r.append("location",s.location),s.lat&&r.append("lat",s.lat.toString()),s.long&&r.append("long",s.long.toString()),s.radius&&r.append("radius",s.radius.toString()),s.polygon&&r.append("polygon",JSON.stringify(s.polygon)),s.property_type&&r.append("property_type",s.property_type),s.bedrooms&&r.append("bedrooms",s.bedrooms.toString()),s.require_sold_price!==void 0&&r.append("require_sold_price",s.require_sold_price.toString()),s.require_size!==void 0&&r.append("require_size",s.require_size.toString()),s.include_sold_history!==void 0&&r.append("include_sold_history",s.include_sold_history.toString()),s.include_indexation_based_value!==void 0&&r.append("include_indexation_based_value",s.include_indexation_based_value.toString()),s.sort_by&&r.append("sort_by",s.sort_by),s.page&&r.append("page",s.page.toString()),s.page_size&&r.append("page_size",s.page_size.toString()),s.records_after&&r.append("records_after",s.records_after);const i=`${Us}${zs}/list-property/?${r.toString()}`;console.log("Fetching listed properties from:",i);const n=await(await fetch(i,{method:"GET",headers:{Authorization:`Token ${$s}`,"Content-Type":"application/json",Accept:"application/json"}})).json();if(console.log("Listed properties response:",n),n.status==="error"||n.errors){const f=Array.isArray(n.errors)?n.errors[0]:n.message||"Failed to fetch listed properties";throw new Error(f)}return n&&n.data&&Array.isArray(n.data.available_results)?{properties:n.data.available_results,total:n.data.total_results_count||n.data.available_results.length,totalPages:n.data.number_of_pages||Math.ceil(n.data.total_results_count/(s.page_size||12))}:n&&n.properties?{properties:n.properties||[],total:n.total||((a=n.properties)==null?void 0:a.length)||0,totalPages:n.total_pages||Math.ceil((((t=n.properties)==null?void 0:t.length)||0)/(s.page_size||10))}:n&&n.data&&n.data.properties?{properties:n.data.properties,total:n.data.total||n.data.properties.length,totalPages:n.data.total_pages||Math.ceil(n.data.properties.length/(s.page_size||10))}:(console.warn("Unexpected API response structure:",n),{properties:[],total:0,totalPages:1})}catch(r){throw console.error("Error fetching listed properties:",r),r}}async function lo(s){try{const a=new URLSearchParams;a.append("postcode",s.postcode),s.property_type&&a.append("property_type",s.property_type);const t=`${Us}${zs}/price-history/?${a.toString()}`;console.log("Fetching price history from:",t);const r=await fetch(t,{method:"GET",headers:{Authorization:`Token ${$s}`,"Content-Type":"application/json",Accept:"application/json"}});if(!r.ok){const l=await r.json();throw new Error(l.message||"Failed to fetch price history")}return await r.json()}catch(a){throw console.error("Error fetching price history:",a),a}}function oo(){var ns,js,vs;const[s,a]=S.useState(""),[t,r]=S.useState(!1),[i,l]=S.useState([]),[n,f]=S.useState([]),[h,N]=S.useState({}),[p,g]=S.useState("listed"),[j,y]=S.useState(0),[v,L]=S.useState(1),{toast:b}=Ce(),[d,c]=S.useState({propertyType:"any",tenure:"any",minBeds:"0",radius:1,page:1,limit:12,newBuild:!1,maxAgeMonths:18,sortBy:"most_recent_sale_date"}),[w,T]=S.useState(!0),[F,P]=S.useState(!0),[M,O]=S.useState(!1),[x,A]=S.useState(null),[I,U]=S.useState(!1),J=S.useMemo(()=>p==="listed"?i:n,[p,i,n]),X=async u=>{try{const[C,E]=await Promise.all([ro({postcode:u,property_type:d.propertyType==="any"?void 0:d.propertyType,bedrooms:d.minBeds==="0"?void 0:parseInt(d.minBeds),radius:d.radius}),lo({postcode:u,property_type:d.propertyType==="any"?void 0:d.propertyType,max_age_months:d.maxAgeMonths})]);N({askingPrices:C,priceHistory:E})}catch(C){console.error("Error fetching area insights:",C)}},he=u=>{if(u.image_url&&typeof u.image_url=="string"&&u.image_url.trim()!=="")return console.log("Using direct image URL from API"),u.image_url;const C=["main_image","photo_url","thumbnail","image"];for(const E of C)if(u[E]&&typeof u[E]=="string"&&u[E].trim()!=="")return console.log(`Found image in property.${E}`),u[E];for(const E in u)if(typeof u[E]=="string"&&u[E].includes("property-software.uk")&&(u[E].endsWith(".jpg")||u[E].endsWith(".jpeg")||u[E].endsWith(".png")))return console.log(`Found PaTMa image URL in property.${E}`),u[E];if(u.images&&Array.isArray(u.images)&&u.images.length>0){const E=u.images.find(W=>typeof W=="string"&&W.includes("property-software.uk"));if(E)return console.log("Found PaTMa image URL in images array"),E;if(typeof u.images[0]=="string")return console.log("Using first image from images array"),u.images[0];if(u.images[0]&&typeof u.images[0]=="object"&&u.images[0].url)return console.log("Using URL from first image object in images array"),u.images[0].url}if(u.photos&&Array.isArray(u.photos)&&u.photos.length>0){const E=u.photos.find(W=>typeof W=="string"&&W.includes("property-software.uk"));if(E)return console.log("Found PaTMa image URL in photos array"),E;if(typeof u.photos[0]=="string")return console.log("Using first image from photos array"),u.photos[0];if(u.photos[0]&&typeof u.photos[0]=="object"&&u.photos[0].url)return console.log("Using URL from first image object in photos array"),u.photos[0].url}if(u.sold_history&&Array.isArray(u.sold_history)&&u.sold_history.length>0){for(const E of u.sold_history)if(E){for(const W of C)if(E[W]&&typeof E[W]=="string"&&E[W].trim()!=="")return console.log(`Found image in sold_history item.${W}`),E[W];for(const W in E)if(typeof E[W]=="string"&&E[W].includes("property-software.uk")&&(E[W].endsWith(".jpg")||E[W].endsWith(".jpeg")||E[W].endsWith(".png")))return console.log(`Found PaTMa image URL in sold_history item.${W}`),E[W];if(E.images&&Array.isArray(E.images)&&E.images.length>0){const W=E.images.find(ne=>typeof ne=="string"&&ne.includes("property-software.uk"));if(W)return console.log("Found PaTMa image URL in sold_history images array"),W;if(typeof E.images[0]=="string")return console.log("Using first image from sold_history images array"),E.images[0]}}}return console.log("No image found for property"),null},de=async()=>{if(!s){b({variant:"destructive",title:"Error",description:"Please enter a location or postcode"});return}try{r(!0);const u=/^[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}$/i.test(s.trim());if(X(s).catch(C=>{console.error("Error fetching area insights:",C),b({variant:"destructive",title:"Warning",description:"Could not fetch area insights. Some information may be missing."})}),p==="listed")try{const C=await io({postcode:s.trim(),location:u?void 0:s.trim(),radius:d.radius,property_type:d.propertyType==="any"?void 0:d.propertyType,tenure:d.tenure==="any"?void 0:d.tenure,bedrooms:d.minBeds==="0"?void 0:parseInt(d.minBeds),new_build:d.newBuild||void 0,page:d.page,page_size:d.limit,sort_by:d.sortBy,include_sold_history:!0,require_sold_price:!0,require_size:!0});console.log("COMPLETE API RESPONSE STRUCTURE:",JSON.stringify(C,null,2));const E=C.properties[0];E&&(console.log("COMPLETE SAMPLE PROPERTY STRUCTURE:",JSON.stringify(E,null,2)),console.log("KEY PROPERTY FIELDS FOR IMAGE LOOKUP:",{listing_url:E.listing_url,property_url:E.property_url,url:E.url,id:E.id,rightmove_id:E.rightmove_id,zoopla_id:E.zoopla_id,uprn:E.uprn,listing_detail_url:E.listing_detail_url}));const ne=C.properties.map((H,ye)=>{let me=JSON.parse(JSON.stringify(H));return H.uprn&&(me.uprn=String(H.uprn)),H.last_sold_price&&(me.price=H.last_sold_price),me.image_url=he(H),!me.property_type&&H.built_form?me.property_type=H.built_form:me.property_type||(me.property_type="House"),me}).map(H=>se(H));l(ne),y(C.total),L(C.totalPages),C.properties.length===0&&b({variant:"default",title:"No Results",description:"No listed properties found for this search criteria. Try adjusting your filters."})}catch(C){console.error("Error fetching listed properties:",C),b({variant:"destructive",title:"Error",description:C instanceof Error?C.message:"Could not fetch listed properties. Please check your search criteria and try again."}),l([]),y(0),L(1)}else try{const C=await no({postcode:s.trim(),location:u?void 0:s.trim(),radius:d.radius,property_type:d.propertyType==="any"?"flat":d.propertyType,tenure:d.tenure==="any"?void 0:d.tenure,max_age_months:d.maxAgeMonths,min_data_points:20,apply_indexation:!0,page:d.page,page_size:d.limit});console.log("Sold properties API response structure:",JSON.stringify(C,null,2).substring(0,500)+"..."),C.properties&&C.properties.length>0&&console.log("First sold property full object:",C.properties[0]);const W=C.properties.map(ne=>{var ye;let H=JSON.parse(JSON.stringify(ne));if(!H.price&&!H.sale_price){if((ye=ne.details)!=null&&ye.price)H.price=ne.details.price;else if(ne.price_paid)H.sale_price=ne.price_paid;else if(ne.sale_price)H.sale_price=ne.sale_price;else if(ne.latest_sold_price)H.sale_price=ne.latest_sold_price;else if(typeof ne.price=="string"){const me=ne.price.match(/[\d,]+/);me&&(H.price=parseInt(me[0].replace(/,/g,"")))}}if(H.sale_price&&typeof H.sale_price=="string"){const me=H.sale_price.match(/[\d,]+/);me&&(H.sale_price=parseInt(me[0].replace(/,/g,"")))}return H.image_url=he(ne),H}).map(ne=>se(ne));f(W),y(C.total),L(C.totalPages),C.properties.length===0&&b({variant:"default",title:"No Results",description:"No sold properties found for this search criteria. Try adjusting your filters."})}catch(C){console.error("Error fetching sold properties:",C),b({variant:"destructive",title:"Error",description:C instanceof Error?C.message:"Could not fetch sold properties. Please check your search criteria and try again."}),f([]),y(0),L(1)}}catch(u){console.error("Search error:",u),b({variant:"destructive",title:"Error",description:u instanceof Error?u.message:"An unexpected error occurred. Please try again."})}finally{r(!1)}},se=u=>{const C={...u},E=C.price||C.asking_price||C.sale_price||C.price_paid||C.latest_price||0;if(E>0&&(C.stamp_duty||(C.stamp_duty=xe(E)),C.size_sq_meters&&!C.price_per_sqft?C.price_per_sqft=be(E,C.size_sq_meters,!0):C.size_sq_feet&&!C.price_per_sqft&&(C.price_per_sqft=be(E,C.size_sq_feet,!1)),!C.estimated_rent)){let W=0;if(W=E*.04/12,C.bedrooms){const ye=1+(C.bedrooms-2)*.1;W*=Math.max(.8,Math.min(ye,1.5))}if(C.estimated_rent=Math.round(W),!C.rental_yield){const ye=C.estimated_rent*12;C.rental_yield=ye/E*100}if(!C.roi){const Pe=E*Math.pow(1.03,5),ys=C.estimated_rent*12*5,Ns=Pe-E+ys;C.roi=Ns/E*100}C.estimated_growth||(C.estimated_growth=3.5)}return C},xe=(u,C=!1,E=!1)=>{if(u<=0)return 0;let W=0;return E&&(u<=425e3?W=0:u<=625e3?W=(u-425e3)*.05:E=!1),E||(u<=25e4?W=0:u<=925e3?W=(u-25e4)*.05:u<=15e5?W=(u-925e3)*.1+675e3*.05:W=(u-15e5)*.12+575e3*.1+675e3*.05),C&&(W+=u*.03),Math.round(W)},be=(u,C,E=!1)=>{if(!u||!C||C<=0)return null;if(E)return Math.round(u/C);{const W=E?C*10.764:C;return Math.round(u/W)}};S.useEffect(()=>{s&&de()},[p,d.page]),S.useEffect(()=>{p==="sold"&&d.propertyType==="any"&&c(u=>({...u,propertyType:"flat"}))},[p,d.propertyType]);const Se=u=>{c(C=>({...C,propertyType:u,page:1}))},ve=u=>{c(C=>({...C,tenure:u,page:1}))},we=u=>{c(C=>({...C,minBeds:u,page:1}))},D=u=>{c(C=>({...C,radius:parseFloat(u),page:1}))},m=u=>{c(C=>({...C,sortBy:u,page:1}))},R=u=>{A(u),U(!0)},V=()=>{U(!1),setTimeout(()=>A(null),300)},te=()=>{var ys,Ns,ft,jt,vt;if(!x)return null;const u=x.price||x.asking_price||x.sale_price||x.price_paid||x.latest_price||0,C="date_of_transfer"in x,E=x.image_url,W=x.postcode||x.address&&((ys=x.address.match(/[A-Z]{1,2}[0-9][0-9A-Z]?\s?[0-9][A-Z]{2}/i))==null?void 0:ys[0])||"Not Available",ne=x.sold_history&&x.sold_history.length>0,H=ne?x.sold_history.filter(Q=>Q&&Q.date&&!isNaN(new Date(Q.date).getTime())&&Q.price&&!isNaN(parseFloat(String(Q.price)))).sort((Q,pe)=>new Date(Q.date).getTime()-new Date(pe.date).getTime()):[],ye=H.length>=2?(H[H.length-1].price-H[0].price)/H[0].price*100:null,me=(Q,pe=25,qs=4.5,Bs=25)=>{const bs=Q*(pe/100),ws=Q-bs,is=qs/100/12,Ss=Bs*12,yt=ws*(is*Math.pow(1+is,Ss))/(Math.pow(1+is,Ss)-1);return{downPayment:bs,loanAmount:ws,monthlyPayment:yt,totalPayments:Ss,totalRepayment:yt*Ss}},Pe=u>0?me(u):null;return e.jsxs("div",{className:`fixed inset-0 z-50 flex items-center justify-center p-4 ${I?"opacity-100":"opacity-0 pointer-events-none"} transition-opacity duration-300`,children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:V}),e.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("button",{onClick:V,className:"absolute top-4 right-4 z-10 bg-white/80 p-1 rounded-full hover:bg-white transition-colors",children:e.jsx(nt,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex flex-col md:flex-row h-full overflow-hidden",children:[e.jsxs("div",{className:"w-full md:w-2/5 h-64 md:h-auto relative bg-gray-100",children:[E?e.jsx("img",{src:E,alt:x.address||"Property",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"w-full h-full flex items-center justify-center",children:[e.jsx(Ye,{className:"h-16 w-16 text-gray-300"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"No image available"})]}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:"bg-white/90 text-black px-3 py-1 rounded-full text-sm font-medium",children:x.property_type})}),x.listing_url&&e.jsxs("a",{href:x.listing_url,target:"_blank",rel:"noopener noreferrer",className:"absolute bottom-4 left-4 bg-white/90 text-black px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1 hover:bg-white transition-colors",children:[e.jsx(An,{className:"h-4 w-4"}),"View Listing"]})]}),e.jsxs("div",{className:"w-full md:w-3/5 p-6 overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:x.address}),e.jsx("p",{className:"text-3xl font-bold mb-4 text-emerald-600",children:B(u)}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Property Type"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(Ra,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:x.property_type||"N/A"})]})]}),x.bedrooms&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Bedrooms"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(Ps,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:x.bedrooms})]})]}),x.bathrooms&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Bathrooms"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx("div",{className:"h-4 w-4 text-gray-600 flex items-center justify-center",children:"🛁"}),e.jsx("span",{className:"font-medium",children:x.bathrooms})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Postcode"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(Ke,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:W})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Tenure"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(In,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:x.tenure||"N/A"})]})]}),C&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Sold Date"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx($e,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:new Date(x.date_of_transfer).toLocaleDateString()})]})]}),(x.size_sq_feet||x.size_sq_meters)&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Size"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(Ia,{className:"h-4 w-4 text-gray-600"}),e.jsxs("span",{className:"font-medium",children:[x.size_sq_feet?`${x.size_sq_feet} sq.ft`:"",x.size_sq_meters?`${x.size_sq_meters} m²`:""]})]})]}),x.price_per_sqft&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Price per sq.ft"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(je,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:B(x.price_per_sqft)})]})]})]}),e.jsxs("div",{className:"mb-6 bg-gray-50 p-4 rounded-lg border border-gray-100",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx(ts,{className:"h-5 w-5 mr-2 text-emerald-600"}),"Investment Dashboard"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[x.estimated_rent&&e.jsxs("div",{className:"bg-blue-50 p-3 rounded",children:[e.jsx("p",{className:"text-blue-800 text-sm font-medium",children:"Estimated Monthly Rent"}),e.jsxs("p",{className:"text-blue-600 text-lg font-bold mt-1",children:[B(x.estimated_rent),"/month"]}),x.rental_yield&&e.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[x.rental_yield.toFixed(1),"% yield"]})]}),x.roi&&e.jsxs("div",{className:"bg-purple-50 p-3 rounded",children:[e.jsx("p",{className:"text-purple-800 text-sm font-medium",children:"5-Year ROI Estimate"}),e.jsxs("p",{className:"text-purple-600 text-lg font-bold mt-1",children:[x.roi.toFixed(1),"%"]}),x.estimated_growth&&e.jsxs("p",{className:"text-purple-600 text-sm mt-1",children:[x.estimated_growth.toFixed(1),"% annual growth"]})]})]}),Pe&&e.jsxs("div",{className:"bg-emerald-50 p-3 rounded",children:[e.jsx("p",{className:"text-emerald-800 text-sm font-medium",children:"Mortgage Estimate (25% deposit)"}),e.jsxs("p",{className:"text-emerald-600 text-lg font-bold mt-1",children:[B(Pe.monthlyPayment),"/month"]}),e.jsxs("div",{className:"mt-2 text-sm text-emerald-700 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Deposit (25%):"}),e.jsx("span",{children:B(Pe.downPayment)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Loan amount:"}),e.jsx("span",{children:B(Pe.loanAmount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Term:"}),e.jsx("span",{children:"25 years at 4.5%"})]})]})]})]}),x.estimated_rent&&Pe&&e.jsxs("div",{className:"mt-4 bg-white p-3 rounded border border-gray-100",children:[e.jsx("p",{className:"text-gray-800 text-sm font-medium",children:"Monthly Cash Flow Analysis"}),e.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Rental Income:"}),e.jsxs("span",{className:"text-emerald-600",children:["+",B(x.estimated_rent)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Mortgage Payment:"}),e.jsxs("span",{className:"text-red-600",children:["-",B(Pe.monthlyPayment)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Management (10%):"}),e.jsxs("span",{className:"text-red-600",children:["-",B(x.estimated_rent*.1)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Maintenance (5%):"}),e.jsxs("span",{className:"text-red-600",children:["-",B(x.estimated_rent*.05)]})]}),e.jsxs("div",{className:"flex justify-between font-bold pt-2 border-t border-gray-100 mt-2",children:[e.jsx("span",{children:"Net Cash Flow:"}),e.jsx("span",{className:`${x.estimated_rent-Pe.monthlyPayment-x.estimated_rent*.15>0?"text-emerald-600":"text-red-600"}`,children:B(x.estimated_rent-Pe.monthlyPayment-x.estimated_rent*.15)})]})]})]})]}),x.stamp_duty!==void 0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Purchase Costs"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-amber-50 p-3 rounded",children:[e.jsx("p",{className:"text-amber-800 text-sm font-medium",children:"Stamp Duty"}),e.jsx("p",{className:"text-amber-600 text-lg font-bold mt-1",children:B(x.stamp_duty)}),e.jsx("p",{className:"text-amber-700 text-xs mt-2",children:"First-time buyer? You may qualify for lower rates."})]}),e.jsxs("div",{className:"bg-emerald-50 p-3 rounded",children:[e.jsx("p",{className:"text-emerald-800 text-sm font-medium",children:"Total Purchase Cost"}),e.jsx("p",{className:"text-emerald-600 text-lg font-bold mt-1",children:B(u+(x.stamp_duty||0))}),e.jsxs("div",{className:"mt-2 text-sm text-emerald-700 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Property price:"}),e.jsx("span",{children:B(u)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Stamp duty:"}),e.jsx("span",{children:B(x.stamp_duty||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Legal fees (est.):"}),e.jsx("span",{children:B(1500)})]})]})]})]})]}),((ft=(Ns=h.priceHistory)==null?void 0:Ns.data)==null?void 0:ft.trend_percentage)!==void 0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx(Rn,{className:"h-5 w-5 mr-2 text-blue-600"}),"Area Insights"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-cyan-50 p-3 rounded",children:[e.jsx("p",{className:"text-cyan-800 text-sm font-medium",children:"Area Price Trend"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[h.priceHistory.data.trend_percentage>0?e.jsx(Xs,{className:"h-5 w-5 text-emerald-600"}):e.jsx(Ma,{className:"h-5 w-5 text-red-600"}),e.jsxs("p",{className:`text-lg font-bold ${h.priceHistory.data.trend_percentage>0?"text-emerald-600":"text-red-600"}`,children:[h.priceHistory.data.trend_percentage.toFixed(1),"%"]})]}),e.jsx("p",{className:"text-cyan-600 text-sm mt-1",children:"Last 12 months"}),e.jsx("div",{className:"mt-3 h-10 bg-white rounded overflow-hidden",children:e.jsx("div",{className:`h-full ${h.priceHistory.data.trend_percentage>0?"bg-emerald-500":"bg-red-500"}`,style:{width:`${Math.min(Math.abs(h.priceHistory.data.trend_percentage)*3,100)}%`}})})]}),((vt=(jt=h.askingPrices)==null?void 0:jt.data)==null?void 0:vt.mean)&&e.jsxs("div",{className:"bg-teal-50 p-3 rounded",children:[e.jsx("p",{className:"text-teal-800 text-sm font-medium",children:"Average Area Price"}),e.jsx("p",{className:"text-teal-600 text-lg font-bold mt-1",children:B(h.askingPrices.data.mean)}),u>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-teal-600 text-sm mt-1",children:["This property is ",e.jsx("strong",{children:u<h.askingPrices.data.mean?"below":"above"})," average"]}),e.jsxs("div",{className:"mt-3 relative h-10 bg-gray-100 rounded overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 flex",children:[e.jsx("div",{className:"h-full bg-teal-200",style:{width:"50%"}}),e.jsx("div",{className:"h-full bg-teal-300",style:{width:"50%"}})]}),e.jsx("div",{className:"absolute top-0 h-full w-1 bg-black",style:{left:"50%",transform:"translateX(-50%)"}}),e.jsx("div",{className:"absolute top-0 h-full w-2 bg-emerald-600 rounded",style:{left:`${Math.min(Math.max(u/h.askingPrices.data.mean*50,10),90)}%`,transform:"translateX(-50%)"}})]}),e.jsxs("div",{className:"flex justify-between text-xs mt-1 text-gray-600",children:[e.jsx("span",{children:"-50%"}),e.jsx("span",{children:"Average"}),e.jsx("span",{children:"+50%"})]})]})]})]})]}),x.description&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-gray-600",children:x.description})]}),ne&&H.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx(ts,{className:"h-5 w-5 mr-2 text-amber-600"}),"Sale History"]}),ye!==null&&e.jsxs("div",{className:"mb-3 p-3 rounded bg-amber-50",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-amber-800 text-sm mr-2",children:"Total Price Growth:"}),e.jsxs("span",{className:`font-bold ${ye>=0?"text-emerald-600":"text-red-600"}`,children:[ye>=0?"+":"",ye.toFixed(1),"%"]})]}),H.length>=2&&e.jsxs("div",{className:"text-xs text-amber-700 mt-1",children:["Over ",Math.round((new Date(H[H.length-1].date).getTime()-new Date(H[0].date).getTime())/(1e3*60*60*24*365))," years (",new Date(H[0].date).getFullYear()," to ",new Date(H[H.length-1].date).getFullYear(),")"]})]}),H.length>=2&&e.jsxs("div",{className:"mb-4 bg-white p-3 rounded border border-gray-100",children:[e.jsx("div",{className:"h-32 relative",children:e.jsx("div",{className:"absolute bottom-0 left-0 right-0 flex items-end h-full",children:H.map((Q,pe)=>{const qs=Math.max(...H.map(is=>is.price)),Bs=Q.price/qs*100,bs=`${100/H.length}%`,ws=pe>0?"0 0 0 1px":"0";return e.jsx("div",{className:"bg-emerald-500 hover:bg-emerald-600 transition-colors relative group",style:{height:`${Bs}%`,width:bs,margin:ws},children:e.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 bg-black text-white text-xs rounded px-2 py-1 whitespace-nowrap",children:[e.jsx("div",{children:B(Q.price)}),e.jsx("div",{children:new Date(Q.date).toLocaleDateString()})]})},pe)})})}),e.jsx("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:H.map((Q,pe)=>e.jsx("div",{children:new Date(Q.date).getFullYear()},pe))})]}),e.jsx("div",{className:"space-y-2",children:H.map((Q,pe)=>e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{children:new Date(Q.date).toLocaleDateString()})]}),e.jsx("span",{className:"font-medium",children:typeof Q.price=="number"&&!isNaN(Q.price)?B(Q.price):"Price not available"})]},pe))})]}),x.nearby_stations&&x.nearby_stations.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Nearby Transport"}),e.jsx("div",{className:"space-y-2",children:x.nearby_stations.map((Q,pe)=>e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{children:Q.name}),e.jsxs("span",{className:"text-gray-600",children:[Q.distance," miles"]})]},pe))})]}),x.nearby_schools&&x.nearby_schools.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Nearby Schools"}),e.jsx("div",{className:"space-y-2",children:x.nearby_schools.map((Q,pe)=>e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{children:Q.name}),e.jsxs("span",{className:"text-gray-600",children:[Q.distance," miles"]})]},pe))})]})]})]})]})]})};return e.jsxs(ce,{children:[e.jsx("div",{className:"bg-background",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-500 to-cyan-500 mix-blend-multiply"})}),e.jsxs("div",{className:"relative px-4 py-24 sm:px-6 sm:py-32 lg:py-40 lg:px-8",children:[e.jsx("h1",{className:"text-center text-4xl font-extrabold tracking-tight text-white sm:text-5xl lg:text-6xl",children:"Property Search"}),e.jsx("p",{className:"mx-auto mt-6 max-w-lg text-center text-xl text-white sm:max-w-3xl",children:"Search through thousands of properties, compare market prices, and make informed decisions with our comprehensive property data."})]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-8 -mt-16 relative z-10",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Find Properties"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{variant:p==="listed"?"default":"outline",onClick:()=>g("listed"),className:"min-w-[120px]",children:"Listed Properties"}),e.jsx(k,{variant:p==="sold"?"default":"outline",onClick:()=>g("sold"),className:"min-w-[120px]",children:"Sold Properties"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(Ae,{value:d.propertyType,onValueChange:Se,children:[e.jsx(_e,{className:"w-full",children:e.jsx(Ie,{placeholder:"Property Type"})}),e.jsxs(ke,{children:[p==="listed"&&e.jsx(Z,{value:"any",children:"Any Type"}),e.jsx(Z,{value:"flat",children:"Flat"}),e.jsx(Z,{value:"terraced",children:"Terraced"}),e.jsx(Z,{value:"semi-detached",children:"Semi-Detached"}),e.jsx(Z,{value:"detached",children:"Detached"}),e.jsx(Z,{value:"bungalow",children:"Bungalow"})]})]}),e.jsxs(Ae,{value:d.tenure,onValueChange:ve,children:[e.jsx(_e,{className:"w-full",children:e.jsx(Ie,{placeholder:"Tenure"})}),e.jsxs(ke,{children:[e.jsx(Z,{value:"any",children:"Any Tenure"}),e.jsx(Z,{value:"freehold",children:"Freehold"}),e.jsx(Z,{value:"leasehold",children:"Leasehold"})]})]}),e.jsxs(Ae,{value:d.minBeds,onValueChange:we,children:[e.jsx(_e,{className:"w-full",children:e.jsx(Ie,{placeholder:"Min Bedrooms"})}),e.jsxs(ke,{children:[e.jsx(Z,{value:"0",children:"Any"}),[1,2,3,4,5].map(u=>e.jsxs(Z,{value:u.toString(),children:[u,"+ beds"]},u))]})]}),e.jsxs(Ae,{value:d.radius.toString(),onValueChange:D,children:[e.jsx(_e,{className:"w-full",children:e.jsx(Ie,{placeholder:"Search Radius"})}),e.jsx(ke,{children:[.25,.5,1,2,5,10].map(u=>e.jsxs(Z,{value:u.toString(),children:[u," miles"]},u))})]}),p==="listed"&&e.jsxs(Ae,{value:d.sortBy,onValueChange:m,children:[e.jsx(_e,{className:"w-full",children:e.jsx(Ie,{placeholder:"Sort By"})}),e.jsxs(ke,{children:[e.jsx(Z,{value:"most_recent_sale_date",children:"Most Recent Sale"}),e.jsx(Z,{value:"distance",children:"Distance"})]})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx(q,{type:"text",placeholder:"Enter location (postcode, city, street, etc.)",value:s,onChange:u=>a(u.target.value),className:"flex-1 h-12"}),e.jsx(k,{onClick:de,className:"h-12 px-8 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white hover:from-emerald-600 hover:to-cyan-600",disabled:t,children:t?e.jsx(Qe,{size:"sm"}):"Search"})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:u=>T(u.target.checked),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),"Show price per sq.ft"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:F,onChange:u=>P(u.target.checked),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),"Show stamp duty"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:M,onChange:u=>O(u.target.checked),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),"Show planning applications"]})]})]})]}),t?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(Qe,{size:"lg"})}):J.length>0?e.jsxs(e.Fragment,{children:[((ns=h.askingPrices)==null?void 0:ns.data)&&e.jsxs("div",{className:"mb-8 bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Area Insights for ",s]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-emerald-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-emerald-800 text-sm font-medium mb-2",children:"Average Asking Price"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-700",children:B(h.askingPrices.data.mean||0)})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-blue-800 text-sm font-medium mb-2",children:"Median Asking Price"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:B(h.askingPrices.data.median||0)})]}),((vs=(js=h.priceHistory)==null?void 0:js.data)==null?void 0:vs.trend_percentage)!==void 0&&e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-purple-800 text-sm font-medium mb-2",children:"Price Trend (12 months)"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:[h.priceHistory.data.trend_percentage.toFixed(1),"%"]})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("h3",{className:"text-lg text-gray-600",children:["Found ",j," ",p==="listed"?"listed":"sold"," properties"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:J.map((u,C)=>e.jsx($,{className:"overflow-hidden hover:shadow-lg transition-shadow duration-200 cursor-pointer",onClick:()=>R(u),children:p==="listed"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"aspect-video relative bg-gray-100",children:[u.image_url?e.jsx("img",{src:u.image_url,alt:u.address||"Property",className:"w-full h-full object-cover",loading:"lazy"}):e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center",children:[e.jsx(Ye,{className:"h-12 w-12 text-gray-300"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"No image available"})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[e.jsx("span",{className:"bg-white/90 text-black px-3 py-1 rounded-full text-sm font-medium",children:u.property_type}),u.new_build&&e.jsx("span",{className:"bg-emerald-500/90 text-white px-3 py-1 rounded-full text-sm font-medium",children:"New Build"})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg line-clamp-2 mb-2",children:u.address}),e.jsx("p",{className:"text-2xl font-bold mb-3 text-emerald-600",children:B(u.price||u.asking_price||u.last_sold_price||u.price_paid||u.latest_price||0)}),w&&u.price_per_sqft&&e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[B(u.price_per_sqft),"/sq.ft",u.size_sq_feet&&` · ${u.size_sq_feet} sq.ft`,u.size_sq_meters&&` · ${u.size_sq_meters} m²`]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ps,{className:"h-4 w-4"}),e.jsx("span",{children:u.bedrooms||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{children:u.postcode})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"h-4 w-4"}),e.jsx("span",{children:u.tenure||"N/A"})]})]}),F&&u.stamp_duty!==void 0&&e.jsx("div",{className:"mt-2 mb-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Stamp Duty:"}),e.jsx("span",{className:"font-medium",children:B(u.stamp_duty)})]})}),(u.estimated_rent||u.rental_yield||u.roi||u.estimated_growth)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Investment Potential"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[u.estimated_rent&&e.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[e.jsx("p",{className:"text-blue-800 font-medium",children:"Est. Rent"}),e.jsxs("p",{className:"text-blue-600 font-bold",children:[B(u.estimated_rent),"/mo"]})]}),u.rental_yield&&e.jsxs("div",{className:"bg-emerald-50 p-2 rounded",children:[e.jsx("p",{className:"text-emerald-800 font-medium",children:"Yield"}),e.jsxs("p",{className:"text-emerald-600 font-bold",children:[u.rental_yield.toFixed(1),"%"]})]}),u.roi&&e.jsxs("div",{className:"bg-purple-50 p-2 rounded",children:[e.jsx("p",{className:"text-purple-800 font-medium",children:"5yr ROI"}),e.jsxs("p",{className:"text-purple-600 font-bold",children:[u.roi.toFixed(1),"%"]})]}),u.estimated_growth&&e.jsxs("div",{className:"bg-amber-50 p-2 rounded",children:[e.jsx("p",{className:"text-amber-800 font-medium",children:"Growth"}),e.jsxs("p",{className:"text-amber-600 font-bold",children:[u.estimated_growth.toFixed(1),"%"]})]})]})]})]})]}):e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg line-clamp-2 mb-2",children:u.address}),e.jsx("p",{className:"text-2xl font-bold mb-3 text-emerald-600",children:B(u.sale_price||u.price||u.price_paid||0)}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{children:u.postcode})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"h-4 w-4"}),e.jsx("span",{children:u.property_type})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($e,{className:"h-4 w-4"}),e.jsxs("span",{children:["Sold: ",new Date(u.date_of_transfer).toLocaleDateString()]})]}),u.bedrooms&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ps,{className:"h-4 w-4"}),e.jsxs("span",{children:[u.bedrooms," beds"]})]})]}),F&&u.stamp_duty!==void 0&&e.jsx("div",{className:"mt-2 mb-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Stamp Duty:"}),e.jsx("span",{className:"font-medium",children:B(u.stamp_duty)})]})}),(u.estimated_rent||u.rental_yield||u.roi||u.estimated_growth)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Investment Potential"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[u.estimated_rent&&e.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[e.jsx("p",{className:"text-blue-800 font-medium",children:"Est. Rent"}),e.jsxs("p",{className:"text-blue-600 font-bold",children:[B(u.estimated_rent),"/mo"]})]}),u.rental_yield&&e.jsxs("div",{className:"bg-emerald-50 p-2 rounded",children:[e.jsx("p",{className:"text-emerald-800 font-medium",children:"Yield"}),e.jsxs("p",{className:"text-emerald-600 font-bold",children:[u.rental_yield.toFixed(1),"%"]})]}),u.roi&&e.jsxs("div",{className:"bg-purple-50 p-2 rounded",children:[e.jsx("p",{className:"text-purple-800 font-medium",children:"5yr ROI"}),e.jsxs("p",{className:"text-purple-600 font-bold",children:[u.roi.toFixed(1),"%"]})]}),u.estimated_growth&&e.jsxs("div",{className:"bg-amber-50 p-2 rounded",children:[e.jsx("p",{className:"text-amber-800 font-medium",children:"Growth"}),e.jsxs("p",{className:"text-amber-600 font-bold",children:[u.estimated_growth.toFixed(1),"%"]})]})]})]})]})},`${u.address}-${C}`))}),v>1&&e.jsxs("div",{className:"mt-8 flex justify-center gap-2",children:[e.jsx(k,{variant:"outline",onClick:()=>c(u=>({...u,page:Math.max(1,u.page-1)})),disabled:d.page===1,children:"Previous"}),e.jsxs("span",{className:"flex items-center px-4",children:["Page ",d.page," of ",v]}),e.jsx(k,{variant:"outline",onClick:()=>c(u=>({...u,page:Math.min(v,u.page+1)})),disabled:d.page===v,children:"Next"})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-600",children:["No ",p," properties found. Try adjusting your search criteria."]})})]}),e.jsx(te,{})]})}const co=()=>{const[s,a]=o.useState(25e4),[t,r]=o.useState(5e4),[i,l]=o.useState(4.5),[n,f]=o.useState(25),[h,N]=o.useState(null),[p,g]=o.useState(null),[j,y]=o.useState(null),v=()=>{const b=s-t,d=i/100/12,c=n*12,w=Math.pow(1+d,c),T=b*w*d/(w-1),F=T*c,P=F-b;N(T),g(F),y(P)},L=(s-t)/s*100;return e.jsxs($,{className:"w-full",children:[e.jsx(K,{children:e.jsxs(ue,{className:"flex items-center text-xl font-semibold",children:[e.jsx(Va,{className:"mr-2 h-5 w-5"}),"Mortgage Payment Calculator"]})}),e.jsx(z,{className:"grid gap-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"property-value",children:"Property Value"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",s.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(je,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(fe,{id:"property-value",min:5e4,max:2e6,step:5e3,defaultValue:[s],onValueChange:b=>a(b[0])})]}),e.jsx(q,{type:"number",value:s,onChange:b=>a(Number(b.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"deposit",children:"Deposit"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",t.toLocaleString()," (",L.toFixed(1),"% LTV)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(je,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(fe,{id:"deposit",min:0,max:s,step:5e3,defaultValue:[t],onValueChange:b=>r(b[0])})]}),e.jsx(q,{type:"number",value:t,onChange:b=>r(Number(b.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"interest-rate",children:"Interest Rate"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[i,"%"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Mn,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(fe,{id:"interest-rate",min:.1,max:15,step:.1,defaultValue:[i],onValueChange:b=>l(b[0])})]}),e.jsx(q,{type:"number",value:i,onChange:b=>l(Number(b.target.value)),className:"mt-2",step:.1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"mortgage-term",children:"Mortgage Term"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[n," years"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(fe,{id:"mortgage-term",min:5,max:40,step:1,defaultValue:[n],onValueChange:b=>f(b[0])})]}),e.jsx(q,{type:"number",value:n,onChange:b=>f(Number(b.target.value)),className:"mt-2"})]}),e.jsx(k,{onClick:v,className:"w-full mt-4",children:"Calculate"})]}),e.jsxs("div",{className:"space-y-6",children:[h!==null&&e.jsxs("div",{className:"rounded-lg border p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Mortgage Summary"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Loan Amount:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",(s-t).toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Monthly Payment:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",h.toFixed(2)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Total Repayment:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",p==null?void 0:p.toFixed(2)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Total Interest:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",j==null?void 0:j.toFixed(2)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-4 border-t",children:[e.jsx("div",{className:"text-muted-foreground",children:"Loan to Value (LTV):"}),e.jsxs("div",{className:"text-right font-medium",children:[L.toFixed(1),"%"]})]})]})]}),e.jsx($,{children:e.jsxs(z,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Tips"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground list-disc pl-5",children:[e.jsx("li",{children:"A higher deposit lowers your monthly payments and improves rates."}),e.jsx("li",{children:"Shorter mortgage terms have higher monthly payments but less total interest."}),e.jsx("li",{children:"Most lenders offer better rates for LTV under 75%."}),e.jsx("li",{children:"Consider fees and early repayment charges when comparing mortgages."})]})]})})]})]})})]})},Ts=o.forwardRef(({className:s,...a},t)=>e.jsx(Ha,{ref:t,className:_("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...a,children:e.jsx(En,{className:_("flex items-center justify-center text-current"),children:e.jsx(ua,{className:"h-4 w-4"})})}));Ts.displayName=Ha.displayName;const mo=()=>{const[s,a]=o.useState(3e5),[t,r]=o.useState(!1),[i,l]=o.useState(!1),[n,f]=o.useState(!1),[h,N]=o.useState(null),[p,g]=o.useState([]),j=()=>{let y=[],v=0,L=[];t?y=[{start:0,end:425e3,rate:0},{start:425e3,end:625e3,rate:.05},{start:625e3,end:null,rate:.05}]:y=[{start:0,end:25e4,rate:0},{start:25e4,end:925e3,rate:.05},{start:925e3,end:15e5,rate:.1},{start:15e5,end:null,rate:.12}];const b=i?.03:0,d=n?.02:0;let c=s;y.forEach(w=>{if(c>0){const T=w.end?w.end-w.start:c,F=Math.min(c,T),P=w.rate+b+d,M=F*P;if(M>0){const O=w.end?`£${w.start.toLocaleString()} - £${w.end.toLocaleString()}`:`Over £${w.start.toLocaleString()}`;L.push({band:`${O} @ ${(P*100).toFixed(1)}%`,tax:M})}v+=M,c-=F}}),N(v),g(L)};return e.jsxs($,{className:"w-full",children:[e.jsx(K,{children:e.jsxs(ue,{className:"flex items-center text-xl font-semibold",children:[e.jsx(Va,{className:"mr-2 h-5 w-5"}),"Stamp Duty Land Tax Calculator"]})}),e.jsx(z,{className:"grid gap-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"property-value",children:"Property Value"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",s.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(je,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(fe,{id:"property-value",min:4e4,max:2e6,step:5e3,defaultValue:[s],onValueChange:y=>a(y[0])})]}),e.jsx(q,{type:"number",value:s,onChange:y=>a(Number(y.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-3 pt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ts,{id:"first-time-buyer",checked:t,onCheckedChange:y=>{r(y===!0),y&&l(!1)}}),e.jsx(G,{htmlFor:"first-time-buyer",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"First-time buyer"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ts,{id:"additional-property",checked:i,onCheckedChange:y=>{l(y===!0),y&&r(!1)},disabled:t}),e.jsx(G,{htmlFor:"additional-property",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Additional property (3% surcharge)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ts,{id:"non-uk-resident",checked:n,onCheckedChange:y=>f(y===!0)}),e.jsx(G,{htmlFor:"non-uk-resident",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Non-UK resident (2% surcharge)"})]})]}),e.jsx(k,{onClick:j,className:"w-full mt-4",children:"Calculate Stamp Duty"})]}),e.jsxs("div",{className:"space-y-6",children:[h!==null&&e.jsxs("div",{className:"rounded-lg border p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Stamp Duty Summary"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-2",children:e.jsxs("div",{className:"text-lg font-semibold text-center",children:["Total Stamp Duty: £",h.toFixed(2)]})}),p.length>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Breakdown:"}),p.map((y,v)=>e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsx("div",{className:"text-muted-foreground",children:y.band}),e.jsxs("div",{className:"text-right",children:["£",y.tax.toFixed(2)]})]},v))]})]})]}),e.jsx($,{children:e.jsxs(z,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Notes"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground list-disc pl-5",children:[e.jsx("li",{children:"First-time buyers get relief on properties up to £625,000."}),e.jsx("li",{children:"Additional properties incur a 3% surcharge on all bands."}),e.jsx("li",{children:"Non-UK residents pay an additional 2% on all bands."}),e.jsx("li",{children:"This is for standard residential property in England and Northern Ireland."}),e.jsx("li",{children:"Different rates apply in Scotland and Wales."})]})]})})]})]})})]})},uo=()=>{const[s,a]=o.useState(25e4),[t,r]=o.useState(1200),[i,l]=o.useState(2e3),[n,f]=o.useState(null),[h,N]=o.useState(null),p=()=>{const g=t*12,j=g/s*100,y=(g-i)/s*100;f(j),N(y)};return e.jsxs($,{className:"w-full",children:[e.jsx(K,{children:e.jsxs(ue,{className:"flex items-center text-xl font-semibold",children:[e.jsx(Tn,{className:"mr-2 h-5 w-5"}),"Rental Yield Calculator"]})}),e.jsx(z,{className:"grid gap-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"property-value",children:"Property Value"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",s.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(je,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(fe,{id:"property-value",min:5e4,max:1e6,step:5e3,defaultValue:[s],onValueChange:g=>a(g[0])})]}),e.jsx(q,{type:"number",value:s,onChange:g=>a(Number(g.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"monthly-rent",children:"Monthly Rent"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",t]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(je,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(fe,{id:"monthly-rent",min:200,max:5e3,step:50,defaultValue:[t],onValueChange:g=>r(g[0])})]}),e.jsx(q,{type:"number",value:t,onChange:g=>r(Number(g.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"annual-expenses",children:"Annual Expenses"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",i]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(je,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(fe,{id:"annual-expenses",min:0,max:1e4,step:100,defaultValue:[i],onValueChange:g=>l(g[0])})]}),e.jsx(q,{type:"number",value:i,onChange:g=>l(Number(g.target.value)),className:"mt-2"})]}),e.jsx(k,{onClick:p,className:"w-full mt-4",children:"Calculate Yield"})]}),e.jsxs("div",{className:"space-y-6",children:[n!==null&&e.jsxs("div",{className:"rounded-lg border p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Yield Results"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Annual Rental Income:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",(t*12).toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Annual Expenses:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",i.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-4 border-t",children:[e.jsx("div",{className:"text-muted-foreground",children:"Gross Yield:"}),e.jsxs("div",{className:"text-right font-medium",children:[n.toFixed(2),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Net Yield:"}),e.jsxs("div",{className:"text-right font-medium",children:[h.toFixed(2),"%"]})]})]})]}),e.jsx($,{children:e.jsxs(z,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"What Makes a Good Yield?"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground list-disc pl-5",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Below 3%:"})," Generally considered low yield"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"3-5%:"})," Average yield in expensive areas like London"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"5-7%:"})," Good yield for most UK locations"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Above 7%:"})," Excellent yield, but check location quality"]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:[e.jsx("p",{children:"Remember to include all expenses when calculating net yield:"}),e.jsxs("ul",{className:"list-disc pl-5 mt-2",children:[e.jsx("li",{children:"Management fees"}),e.jsx("li",{children:"Maintenance costs"}),e.jsx("li",{children:"Insurance"}),e.jsx("li",{children:"Service charges"}),e.jsx("li",{children:"Void periods"})]})]})]})})]})]})})]})},ho=()=>{const[s,a]=o.useState(25e4),[t,r]=o.useState(25e3),[i,l]=o.useState(2500),[n,f]=o.useState(3e3),[h,N]=o.useState(1200),[p,g]=o.useState(2400),[j,y]=o.useState(5),[v,L]=o.useState(3),[b,d]=o.useState("cash"),[c,w]=o.useState(62500),[T,F]=o.useState(4.5),[P,M]=o.useState(25),[O,x]=o.useState(null),A=()=>{const I=b==="cash"?s+t+i+n:c+t+i+n,U=h*12;let J=0;if(b==="mortgage"){const D=s-c,m=T/100/12,R=P*12,V=Math.pow(1+m,R);J=D*V*m/(V-1)*12}const X=U-p-J,he=X/I*100,de=s*Math.pow(1+v/100,j);let se=0;if(b==="mortgage"){const D=s-c,m=T/100/12,R=P*12,V=D*Math.pow(1+m,R)*m/(Math.pow(1+m,R)-1);let te=D;for(let ns=0;ns<j*12;ns++){const js=te*m,vs=V-js;te-=vs}se=Math.max(0,te)}const xe=X*j,be=de-s-se,Se=xe+be,ve=Se/I*100,we=Math.pow(1+ve/100,1/j)-1;x({totalInvestment:I,cashFlow:X,cashOnCashReturn:he,estimatedSalePrice:de,totalProfit:Se,totalROI:ve,annualizedROI:we*100})};return e.jsxs($,{className:"w-full",children:[e.jsx(K,{children:e.jsxs(ue,{className:"flex items-center text-xl font-semibold",children:[e.jsx(ts,{className:"mr-2 h-5 w-5"}),"Return on Investment (ROI) Calculator"]})}),e.jsx(z,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Property Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"purchase-price",children:"Purchase Price"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"purchase-price",type:"number",value:s,onChange:I=>a(Number(I.target.value)),className:"rounded-l-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"renovation-cost",children:"Renovation Cost"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"renovation-cost",type:"number",value:t,onChange:I=>r(Number(I.target.value)),className:"rounded-l-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"stamp-duty",children:"Stamp Duty"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"stamp-duty",type:"number",value:i,onChange:I=>l(Number(I.target.value)),className:"rounded-l-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"other-costs",children:"Other Costs (Legal, Survey, etc.)"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"other-costs",type:"number",value:n,onChange:I=>f(Number(I.target.value)),className:"rounded-l-none"})]})]}),e.jsx("h3",{className:"text-lg font-medium pt-4",children:"Rental Income & Expenses"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"monthly-rent",children:"Monthly Rent"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"monthly-rent",type:"number",value:h,onChange:I=>N(Number(I.target.value)),className:"rounded-l-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"annual-expenses",children:"Annual Expenses"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"annual-expenses",type:"number",value:p,onChange:I=>g(Number(I.target.value)),className:"rounded-l-none"})]})]}),e.jsx("h3",{className:"text-lg font-medium pt-4",children:"Investment Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"financing-method",children:"Financing Method"}),e.jsxs(Ae,{defaultValue:b,onValueChange:I=>d(I),children:[e.jsx(_e,{id:"financing-method",children:e.jsx(Ie,{placeholder:"Select financing method"})}),e.jsxs(ke,{children:[e.jsx(Z,{value:"cash",children:"Cash Purchase"}),e.jsx(Z,{value:"mortgage",children:"Mortgage"})]})]})]}),b==="mortgage"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"mortgage-deposit",children:"Mortgage Deposit"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"mortgage-deposit",type:"number",value:c,onChange:I=>w(Number(I.target.value)),className:"rounded-l-none"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[(c/s*100).toFixed(1),"% of purchase price"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"interest-rate",children:"Interest Rate (%)"}),e.jsx(q,{id:"interest-rate",type:"number",value:T,onChange:I=>F(Number(I.target.value)),step:.1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"mortgage-term",children:"Mortgage Term (years)"}),e.jsx(q,{id:"mortgage-term",type:"number",value:P,onChange:I=>M(Number(I.target.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"holding-period",children:"Investment Holding Period (years)"}),e.jsx(q,{id:"holding-period",type:"number",value:j,onChange:I=>y(Number(I.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"annual-appreciation",children:"Annual Property Appreciation (%)"}),e.jsx(q,{id:"annual-appreciation",type:"number",value:v,onChange:I=>L(Number(I.target.value)),step:.1})]}),e.jsx(k,{onClick:A,className:"w-full mt-4",children:"Calculate ROI"})]}),e.jsxs("div",{className:"space-y-6",children:[O&&e.jsxs("div",{className:"rounded-lg border p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium",children:"ROI Summary"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Total Investment:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",O.totalInvestment.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Annual Cash Flow:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",O.cashFlow.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Cash-on-Cash Return:"}),e.jsxs("div",{className:"text-right font-medium",children:[O.cashOnCashReturn.toFixed(2),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-4 border-t",children:[e.jsx("div",{className:"text-muted-foreground",children:"Estimated Sale Price:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",O.estimatedSalePrice.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Total Profit:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",O.totalProfit.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-4 border-t font-bold",children:[e.jsx("div",{children:"Total ROI:"}),e.jsxs("div",{className:"text-right",children:[O.totalROI.toFixed(2),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 font-bold",children:[e.jsx("div",{children:"Annualized ROI:"}),e.jsxs("div",{className:"text-right",children:[O.annualizedROI.toFixed(2),"%"]})]})]})]}),e.jsx($,{children:e.jsxs(z,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"ROI Explained"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground list-disc pl-5",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Cash-on-Cash Return:"})," Annual cash flow divided by your initial investment."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Total ROI:"})," Total profit (cash flow + equity gain) as a percentage of your investment."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Annualized ROI:"})," The yearly rate of return that would give you the total ROI over the holding period."]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:[e.jsx("p",{children:"For buy-to-let investments, aim for:"}),e.jsxs("ul",{className:"list-disc pl-5 mt-2",children:[e.jsx("li",{children:"Cash-on-Cash Return: 5-8%"}),e.jsx("li",{children:"Total ROI: 40%+ over 5 years"}),e.jsx("li",{children:"Annualized ROI: 7%+"})]})]})]})})]})]})})]})},xo=()=>{const[s,a]=o.useState(6e4),[t,r]=o.useState(0),[i,l]=o.useState(4e4),[n,f]=o.useState(500),[h,N]=o.useState(4.5),[p,g]=o.useState(25),[j,y]=o.useState(4.5),[v,L]=o.useState(null),b=()=>{const d=s+t,c=d*j,w=c+i,T=h/100/12,F=p*12,P=Math.pow(1+T,F),M=c*P*T/(P-1),O=d/12,x=M/O*100,A=(h+3)/100/12,I=Math.pow(1+A,F),U=c*I*A/(I-1);L({maxMortgage:c,maxPropertyPrice:w,monthlyPayment:M,affordabilityRatio:x,stressTestedPayment:U})};return e.jsxs($,{className:"w-full",children:[e.jsx(K,{children:e.jsxs(ue,{className:"flex items-center text-xl font-semibold",children:[e.jsx(Dn,{className:"mr-2 h-5 w-5"}),"Mortgage Affordability Calculator"]})}),e.jsx(z,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Income Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"annual-income",children:"Your Annual Income"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",s.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(je,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(fe,{id:"annual-income",min:1e4,max:2e5,step:1e3,defaultValue:[s],onValueChange:d=>a(d[0])})]}),e.jsx(q,{type:"number",value:s,onChange:d=>a(Number(d.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"additional-income",children:"Additional Annual Income (e.g., partner)"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"additional-income",type:"number",value:t,onChange:d=>r(Number(d.target.value)),className:"rounded-l-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"deposit",children:"Deposit Available"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",i.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(je,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(fe,{id:"deposit",min:0,max:2e5,step:5e3,defaultValue:[i],onValueChange:d=>l(d[0])})]}),e.jsx(q,{type:"number",value:i,onChange:d=>l(Number(d.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"monthly-debts",children:"Monthly Debt Payments"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"monthly-debts",type:"number",value:n,onChange:d=>f(Number(d.target.value)),className:"rounded-l-none"})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Include credit cards, loans, car finance, etc."})]}),e.jsx("h3",{className:"text-lg font-medium pt-4",children:"Mortgage Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"interest-rate",children:"Interest Rate (%)"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h,"%"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(fe,{id:"interest-rate",min:1,max:10,step:.1,defaultValue:[h],onValueChange:d=>N(d[0])})}),e.jsx(q,{type:"number",value:h,onChange:d=>N(Number(d.target.value)),className:"mt-2",step:.1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"mortgage-term",children:"Mortgage Term (years)"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[p," years"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(fe,{id:"mortgage-term",min:5,max:40,step:1,defaultValue:[p],onValueChange:d=>g(d[0])})}),e.jsx(q,{type:"number",value:p,onChange:d=>g(Number(d.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"loan-to-income",children:"Loan to Income Multiple"}),e.jsxs(Ae,{defaultValue:j.toString(),onValueChange:d=>y(Number(d)),children:[e.jsx(_e,{id:"loan-to-income",children:e.jsx(Ie,{placeholder:"Select loan to income multiple"})}),e.jsxs(ke,{children:[e.jsx(Z,{value:"4",children:"4.0x income"}),e.jsx(Z,{value:"4.5",children:"4.5x income"}),e.jsx(Z,{value:"5",children:"5.0x income"}),e.jsx(Z,{value:"5.5",children:"5.5x income"}),e.jsx(Z,{value:"6",children:"6.0x income"})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Lenders typically offer between 4-6x your annual income"})]}),e.jsx(k,{onClick:b,className:"w-full mt-4",children:"Calculate Affordability"})]}),e.jsxs("div",{className:"space-y-6",children:[v&&e.jsxs("div",{className:"rounded-lg border p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Affordability Results"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-col items-center py-4 border-b",children:[e.jsx("div",{className:"text-muted-foreground text-sm",children:"Maximum Property Price"}),e.jsxs("div",{className:"text-3xl font-bold mt-1",children:["£",v.maxPropertyPrice.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Maximum Mortgage:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",v.maxMortgage.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Monthly Payment:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",v.monthlyPayment.toFixed(2)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Affordability Ratio:"}),e.jsxs("div",{className:"text-right font-medium",children:[v.affordabilityRatio.toFixed(1),"%",e.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${v.affordabilityRatio<=35?"bg-green-100 text-green-800":v.affordabilityRatio<=45?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:v.affordabilityRatio<=35?"Good":v.affordabilityRatio<=45?"Moderate":"High"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-4 border-t",children:[e.jsx("div",{className:"text-muted-foreground",children:"Stress Tested Payment:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",v.stressTestedPayment.toFixed(2)]}),e.jsx("div",{className:"col-span-2 text-xs text-muted-foreground",children:"(Monthly payment if rates increase by 3%)"})]})]})]}),e.jsx($,{children:e.jsxs(z,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Lender Requirements"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground list-disc pl-5",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Affordability Ratio:"})," Most lenders prefer this to be below 35% of your gross monthly income."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Debt-to-Income Ratio:"})," Your total debt payments (including mortgage) should ideally be below 45% of income."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Stress Testing:"})," Lenders will check if you can afford payments if interest rates rise by 3%."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Deposit:"})," Higher deposits (15%+) typically secure better interest rates."]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium",children:"Additional costs to consider:"}),e.jsxs("ul",{className:"list-disc pl-5 mt-2",children:[e.jsx("li",{children:"Stamp Duty Land Tax"}),e.jsx("li",{children:"Legal fees (typically £1,000-£1,500)"}),e.jsx("li",{children:"Surveyor fees (£400-£1,500)"}),e.jsx("li",{children:"Mortgage arrangement fees (£0-£2,000)"}),e.jsx("li",{children:"Moving costs"})]})]})]})})]})]})})]})},po=()=>(o.useEffect(()=>{console.log("Calculators page mounted - HeroSection should render")},[]),e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx("div",{className:"w-full",children:e.jsx(Ne,{title:"Property Investment Calculators",subtitle:"Powerful tools to analyze investments, calculate mortgage payments, and estimate potential returns",showSearch:!1,showStats:!1,height:"h-[400px]"})}),e.jsx("div",{className:"container mx-auto px-4 py-12 mt-6",children:e.jsxs(Ve,{defaultValue:"mortgage",className:"w-full",children:[e.jsx(He,{className:"w-full mb-8",children:e.jsxs("div",{className:"grid w-full grid-cols-1 sm:grid-cols-3 md:grid-cols-5 gap-2",children:[e.jsx(ie,{value:"mortgage",className:"w-full",children:"Mortgage"}),e.jsx(ie,{value:"stampduty",className:"w-full",children:"Stamp Duty"}),e.jsx(ie,{value:"yield",className:"w-full",children:"Rental Yield"}),e.jsx(ie,{value:"roi",className:"w-full",children:"ROI"}),e.jsx(ie,{value:"affordability",className:"w-full",children:"Affordability"})]})}),e.jsx(ae,{value:"mortgage",className:"mt-6",children:e.jsx(co,{})}),e.jsx(ae,{value:"stampduty",className:"mt-6",children:e.jsx(mo,{})}),e.jsx(ae,{value:"yield",className:"mt-6",children:e.jsx(uo,{})}),e.jsx(ae,{value:"roi",className:"mt-6",children:e.jsx(ho,{})}),e.jsx(ae,{value:"affordability",className:"mt-6",children:e.jsx(xo,{})})]})})]}));function Ut(){const{title:s}=$n();return e.jsx(Al,{title:s||"Loading...",content:"Content is loading...",date:new Date().toISOString().split("T")[0]})}function go(){const[s,a]=o.useState(!0),t=Ln(),{user:r,profile:i,signOut:l,refreshSession:n}=ee();return o.useEffect(()=>{console.log("Auth state in App:",{user:r,profile:i}),n()},[]),o.useEffect(()=>{const f=()=>a(!0),h=()=>a(!1);f();const N=setTimeout(h,100);return()=>clearTimeout(N)},[t.pathname]),o.useEffect(()=>{document.documentElement.classList.remove("dark")},[]),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(fs,{isAuthenticated:!!r,userProfile:i||void 0,onSignIn:()=>{},onSignUp:()=>{},onSignOut:l}),e.jsx("main",{children:e.jsxs(Fn,{children:[e.jsx(re,{path:"/",element:e.jsx(Vi,{})}),e.jsx(re,{path:"/listings",element:e.jsx(oo,{})}),e.jsx(re,{path:"/deals",element:e.jsx(so,{})}),e.jsx(re,{path:"/trends",element:e.jsx(Cl,{})}),e.jsx(re,{path:"/insights",element:e.jsx(jl,{})}),e.jsx(re,{path:"/calculators",element:e.jsx(po,{})}),e.jsx(re,{path:"/profile",element:e.jsx(Tt,{})}),e.jsx(re,{path:"/login",element:e.jsx(On,{to:"/",replace:!0})}),e.jsx(re,{path:"/dashboard",element:e.jsx(Qi,{})}),e.jsx(re,{path:"/pricing",element:e.jsx(sl,{})}),e.jsx(re,{path:"/subscription/success",element:e.jsx(al,{})}),e.jsx(re,{path:"/subscription/cancel",element:e.jsx(rl,{})}),e.jsx(re,{path:"/account",element:e.jsx(Tt,{})}),e.jsx(re,{path:"/research",element:e.jsx(Ll,{})}),e.jsx(re,{path:"/blog",element:e.jsx(Ol,{})}),e.jsx(re,{path:"/article/:title",element:e.jsx(Ut,{})}),e.jsx(re,{path:"/blog/:slug",element:e.jsx(Ut,{})}),e.jsx(re,{path:"/help",element:e.jsx($l,{})}),e.jsx(re,{path:"/auth/callback",element:e.jsx(Gl,{})}),e.jsx(re,{path:"/property-management",element:e.jsx(Wl,{})}),e.jsx(re,{path:"/investment-opportunities",element:e.jsx(Zl,{})}),e.jsx(re,{path:"/about-us",element:e.jsx(Xl,{})}),e.jsx(re,{path:"/messages",element:e.jsx(ao,{})}),!1,e.jsx(re,{path:"*",element:e.jsx(ll,{})})]})}),e.jsx(Bl,{}),e.jsx(ei,{}),e.jsx(ri,{isAnimating:s})]})}function fo(){return e.jsx(er,{children:e.jsx(o.Suspense,{fallback:e.jsx(ai,{}),children:e.jsx(go,{})})})}Un.TempoDevtools.init();zn.init("phc_Pg1VGdZoazG7KyDNxnUXNZZz6zPVrGNSRtFlDnlZCcA",{api_host:"https://eu.i.posthog.com",person_profiles:"identified_only"});const jo=new qn;Bn.createRoot(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(Gn,{client:jo,children:e.jsx(Vn,{children:e.jsx(er,{children:e.jsx(fo,{})})})})}));
//# sourceMappingURL=index-D7ybNxYK.js.map
