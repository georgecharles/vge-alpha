{"version":3,"mappings":"o1EAGO,SAASA,KAAMC,EAAsB,CACnC,OAAAC,GAAQC,GAAKF,CAAM,CAAC,CAC7B,CAEO,SAASG,EAAeC,EAAwB,CAC9C,WAAI,KAAK,aAAa,QAAS,CACpC,MAAO,WACP,SAAU,MACV,sBAAuB,EACvB,sBAAuB,EACxB,EAAE,OAAOA,CAAM,CAClB,CAGO,SAASC,GAAWC,EAA6B,CAC/C,WAAI,KAAK,eAAe,QAAS,CACtC,IAAK,UACL,MAAO,OACP,KAAM,SACP,GAAE,OAAO,IAAI,KAAKA,CAAI,CAAC,CAC1B,CAEO,SAASC,GAAaC,EAAwB,CACnD,OAAO,IAAI,KAAK,aAAa,OAAO,EAAE,OAAOA,CAAM,CACrD,CCpBA,MAAMC,GAAgBC,GAEhBC,GAAgBC,EAGpB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACC,GAAA,CACC,IAAAF,EACA,UAAWhB,EACT,oIACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACDH,GAAc,YAAcM,GAAyB,YAErD,MAAMC,GAAgBC,GACpB,4lBACA,CACE,SAAU,CACR,QAAS,CACP,QAAS,uCACT,YACE,kFAEN,EACA,gBAAiB,CACf,QAAS,UACX,CAEJ,EAEMC,GAAQR,EAAM,WAIlB,CAAC,CAAE,UAAAC,EAAW,QAAAQ,EAAS,GAAGP,CAAM,EAAGC,IAEjCC,EAAA,IAACM,GAAA,CACC,IAAAP,EACA,UAAWhB,EAAGmB,GAAc,CAAE,QAAAG,CAAS,GAAGR,CAAS,EAClD,GAAGC,CAAA,CACN,CAEH,EACDM,GAAM,YAAcE,GAAqB,YAEzC,MAAMC,GAAcX,EAGlB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACQ,GAAA,CACC,IAAAT,EACA,UAAWhB,EACT,0dACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACDS,GAAY,YAAcC,GAAuB,YAEjD,MAAMC,GAAab,EAGjB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACU,GAAA,CACC,IAAAX,EACA,UAAWhB,EACT,wVACAc,CACF,EACA,cAAY,GACX,GAAGC,EAEJ,SAAAE,MAACW,GAAW,WAAU,SAAU,GAClC,CACD,EACDF,GAAW,YAAcC,GAAsB,YAE/C,MAAME,GAAahB,EAGjB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACa,GAAA,CACC,IAAAd,EACA,UAAWhB,EAAG,wCAAyCc,CAAS,EAC/D,GAAGC,CAAA,CACN,CACD,EACDc,GAAW,YAAcC,GAAsB,YAE/C,MAAMC,GAAmBlB,EAGvB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACe,GAAA,CACC,IAAAhB,EACA,UAAWhB,EAAG,qBAAsBc,CAAS,EAC5C,GAAGC,CAAA,CACN,CACD,EACDgB,GAAiB,YAAcC,GAA4B,YCtG3D,MAAMC,GAAc,EACdC,GAAqB,IAgB3B,IAAIC,GAAQ,EAEZ,SAASC,IAAQ,CACN,OAAAD,OAAQ,GAAK,OAAO,iBACtBA,GAAM,SAAS,CACxB,CA0BA,MAAME,OAAoB,IAEpBC,GAAoBC,GAAoB,CACxC,GAAAF,GAAc,IAAIE,CAAO,EAC3B,OAGI,MAAAC,EAAU,WAAW,IAAM,CAC/BH,GAAc,OAAOE,CAAO,EACnBE,GAAA,CACP,KAAM,eACN,QAAAF,CAAA,CACD,GACAL,EAAkB,EAEPG,GAAA,IAAIE,EAASC,CAAO,CACpC,EAEaE,GAAU,CAACC,EAAcC,IAA0B,CAC9D,OAAQA,EAAO,KAAM,CACnB,IAAK,YACI,OACL,GAAGD,EACH,OAAQ,CAACC,EAAO,MAAO,GAAGD,EAAM,MAAM,EAAE,MAAM,EAAGV,EAAW,CAC9D,EAEF,IAAK,eACI,OACL,GAAGU,EACH,OAAQA,EAAM,OAAO,IAAK,GACxB,EAAE,KAAOC,EAAO,MAAM,GAAK,CAAE,GAAG,EAAG,GAAGA,EAAO,OAAU,EAE3D,EAEF,IAAK,gBAAiB,CACd,MAAE,QAAAL,GAAYK,EAIpB,OAAIL,EACFD,GAAiBC,CAAO,EAElBI,EAAA,OAAO,QAASE,GAAU,CAC9BP,GAAiBO,EAAM,EAAE,EAC1B,EAGI,CACL,GAAGF,EACH,OAAQA,EAAM,OAAO,IAAKG,GACxBA,EAAE,KAAOP,GAAWA,IAAY,OAC5B,CACE,GAAGO,EACH,KAAM,IAERA,CAAA,CAER,EAEF,IAAK,eACC,OAAAF,EAAO,UAAY,OACd,CACL,GAAGD,EACH,OAAQ,EACV,EAEK,CACL,GAAGA,EACH,OAAQA,EAAM,OAAO,OAAQ,GAAM,EAAE,KAAOC,EAAO,OAAO,CAC5D,EAEN,EAEMG,GAA2C,CAAC,EAElD,IAAIC,GAAqB,CAAE,OAAQ,EAAG,EAEtC,SAASP,GAASG,EAAgB,CAClBI,GAAAN,GAAQM,GAAaJ,CAAM,EAC/BG,GAAA,QAASE,GAAa,CAC9BA,EAASD,EAAW,EACrB,CACH,CAIA,SAASH,GAAM,CAAE,GAAG9B,GAAgB,CAClC,MAAMmC,EAAKd,GAAM,EAEXe,EAAUpC,GACd0B,GAAS,CACP,KAAM,eACN,MAAO,CAAE,GAAG1B,EAAO,GAAAmC,CAAG,EACvB,EACGE,EAAU,IAAMX,GAAS,CAAE,KAAM,gBAAiB,QAASS,EAAI,EAE5D,OAAAT,GAAA,CACP,KAAM,YACN,MAAO,CACL,GAAG1B,EACH,GAAAmC,EACA,KAAM,GACN,aAAeG,GAAS,CACjBA,GAAcD,EAAA,EACrB,CACF,CACD,EAEM,CACL,GAAAF,EACA,QAAAE,EACA,OAAAD,CACF,CACF,CAEA,SAASG,IAAW,CAClB,KAAM,CAACX,EAAOY,CAAQ,EAAIC,WAAsBR,EAAW,EAE3DS,mBAAgB,KACdV,GAAU,KAAKQ,CAAQ,EAChB,IAAM,CACL,MAAAG,EAAQX,GAAU,QAAQQ,CAAQ,EACpCG,EAAQ,IACAX,GAAA,OAAOW,EAAO,CAAC,CAE7B,GACC,CAACf,CAAK,CAAC,EAEH,CACL,GAAGA,EACH,MAAAE,GACA,QAAUN,GAAqBE,GAAS,CAAE,KAAM,gBAAiB,QAAAF,CAAS,EAC5E,CACF,CCnLO,SAASoB,IAAU,CAClB,MAAE,OAAAC,CAAO,EAAIN,GAAS,EAE5B,cACG5C,GACE,WAAOkD,EAAA,IAAI,SAAU,CAAE,GAAAV,EAAI,MAAAW,EAAO,YAAAC,EAAa,OAAAlB,EAAQ,GAAG7B,GAAS,CAEhE,OAAAgD,EAAA,KAAC1C,GAAgB,IAAGN,EAClB,UAACgD,OAAA,OAAI,UAAU,aACZ,UAASF,GAAA5C,MAACY,IAAY,SAAMgC,CAAA,GAC5BC,GACE7C,MAAAc,GAAA,CAAkB,SAAY+B,CAAA,IAEnC,EACClB,QACAlB,GAAW,MARFwB,CASZ,EAEH,QACAtC,GAAc,KACjB,CAEJ,CC7BA,MAAMoD,GAAc,2CACdC,GAAc,mNAQPC,GAAWC,GAAaH,GAAaC,EAAW,ECiBvDG,GAAcC,gBAA+B,CACjD,KAAM,KACN,QAAS,KACT,QAAS,KACT,UAAW,GACX,QAAS,SAAY,CAAC,EACtB,eAAgB,SAAY,EAC9B,CAAC,EAGKC,GAAe,MAAOC,GAAgD,CACtE,IACF,KAAM,CAAE,KAAAC,EAAM,MAAAC,CAAA,EAAU,MAAMP,GAC3B,KAAK,UAAU,EACf,OAAO,GAAG,EACV,GAAG,KAAMK,CAAM,EACf,OAAO,EAEV,OAAIE,GACM,cAAM,0BAA2BA,CAAK,EACvC,OAGD,YAAI,wBAAyBD,CAAI,EAClCA,SACAC,EAAO,CACN,qBAAM,yBAA0BA,CAAK,EACtC,KAEX,EAGaC,GAAe,CAAC,CAAE,SAAAC,KAAwC,CACrE,KAAM,CAACC,EAAMC,CAAO,EAAIC,WAAsB,IAAI,EAC5C,CAACC,EAASC,CAAU,EAAIF,WAAyB,IAAI,EACrD,CAACG,EAASC,CAAU,EAAIJ,WAA6B,IAAI,EACzD,CAACK,EAAWC,CAAY,EAAIN,WAAS,EAAI,EAGzCO,EAAiB,SAAY,SAC7B,IACFD,EAAa,EAAI,EACjB,QAAQ,IAAI,uBAAuB,EAEnC,KAAM,CAAE,KAAAZ,EAAM,MAAAC,CAAA,EAAU,MAAMP,GAAS,KAAK,WAAW,EAEvD,GAAIO,EACI,MAAAA,EAOJ,GAJI,YAAI,gBAAiBD,CAAI,EACjCQ,EAAWR,EAAK,OAAO,EACfK,IAAAS,EAAAd,EAAK,UAAL,YAAAc,EAAc,OAAQ,IAAI,GAE9BC,EAAAf,EAAK,UAAL,MAAAe,EAAc,KAAM,CACtB,MAAMN,EAAU,MAAMX,GAAaE,EAAK,QAAQ,KAAK,EAAE,EACvDU,EAAWD,CAAO,OAElBC,EAAW,IAAI,QAEVT,EAAO,CACN,cAAM,4BAA6BA,CAAK,EAChDI,EAAQ,IAAI,EACZK,EAAW,IAAI,EACfF,EAAW,IAAI,SACf,CACAI,EAAa,EAAK,EAEtB,EAGMI,EAAU,SAAY,CACtB,IACFJ,EAAa,EAAI,EACjB,KAAM,CAAE,MAAAX,CAAM,EAAI,MAAMP,GAAS,KAAK,QAAQ,EAC9C,GAAIO,EACI,MAAAA,EAERI,EAAQ,IAAI,EACZK,EAAW,IAAI,EACfF,EAAW,IAAI,QACRP,EAAO,CACN,cAAM,qBAAsBA,CAAK,SACzC,CACAW,EAAa,EAAK,EAEtB,EAGAK,YAAU,IAAM,CA+Cd,MAAMC,GA7CiB,SAAY,SACjCN,EAAa,EAAI,EACjB,QAAQ,IAAI,sBAAsB,EAE9B,IACI,MAAE,KAAAZ,EAAM,MAAAC,GAAU,MAAMP,GAAS,KAAK,WAAW,EAEvD,GAAIO,EACI,MAAAA,EAOJD,GAJI,YAAI,wBAAyBA,CAAI,EACzCQ,EAAWR,EAAK,OAAO,EACfA,QAAK,UAALA,cAAc,OAAQ,IAAI,GAE9BA,IAAK,UAALA,QAAc,KAAM,CACtB,MAAMS,EAAU,MAAMX,GAAaE,EAAK,QAAQ,KAAK,EAAE,EACvDU,EAAWD,CAAO,SAEbR,EAAO,CACN,cAAM,2BAA4BA,CAAK,SAC/C,CACAW,EAAa,EAAK,EAId,MAAE,KAAAZ,GAASN,GAAS,KAAK,kBAAkB,MAAOyB,EAAOZ,IAAY,CAKzE,GAJQ,YAAI,sBAAuBY,EAAOZ,CAAO,EACjDC,EAAWD,CAAO,EACVA,oBAAS,OAAQ,IAAI,EAEzBA,WAAS,KAAM,CACjB,MAAME,EAAU,MAAMX,GAAaS,EAAQ,KAAK,EAAE,EAClDG,EAAWD,CAAO,OAElBC,EAAW,IAAI,CACjB,CACD,EAGD,MAAO,IAAM,CACXV,EAAK,aAAa,YAAY,CAChC,CACF,GAEmC,EAGnC,MAAO,IAAM,CACXkB,EAAY,KAAKE,GAAMA,GAAMA,EAAA,CAAI,CACnC,CACF,EAAG,EAAE,EAGL,MAAMC,EAAe,CACnB,KAAAjB,EACA,QAAAG,EACA,QAAAE,EACA,UAAAE,EACA,QAAAK,EACA,eAAAH,CACF,EAEO,OAAAS,EAAM,cAAc1B,GAAY,SAAU,CAAE,MAAOyB,GAAgBlB,CAAQ,CACpF,EAGO,SAASoB,IAAU,CACxB,OAAOC,aAAW5B,EAAW,CAC/B,CC1LgB,SAAA6B,GAAQ,CAAE,UAAAnF,GAAqC,CAE3D,OAAAG,MAAC,MAAI,WAAWjB,EAAG,mCAAoCc,CAAS,EAC9D,SAACG,MAAA,OAAI,UAAU,iFAAiF,CAClG,EAEJ,CCKgB,SAAAiF,GAAY,CAAE,YAAAC,GAAiC,CAC7D,KAAM,CAACC,EAAUC,CAAW,EAAIvB,WAAS,CAAC,EAwB1C,OAtBAW,YAAU,IAAM,CACd,GAAI,CAACU,EAAa,CAChBE,EAAY,CAAC,EACb,OAIFA,EAAY,EAAE,EAEd,MAAMC,EAAS,WAAW,IAAMD,EAAY,EAAE,EAAG,GAAG,EAC9CE,EAAS,WAAW,IAAMF,EAAY,EAAE,EAAG,GAAG,EAC9CG,EAAS,WAAW,IAAMH,EAAY,EAAE,EAAG,GAAG,EAC9CI,EAAS,WAAW,IAAMJ,EAAY,GAAG,EAAG,GAAI,EAEtD,MAAO,IAAM,CACX,aAAaC,CAAM,EACnB,aAAaC,CAAM,EACnB,aAAaC,CAAM,EACnB,aAAaC,CAAM,CACrB,GACC,CAACN,CAAW,CAAC,EAEZ,CAACA,GAAeC,IAAa,EAAU,KAGzCnF,MAAC,MAAI,WAAU,kCACb,SAAAA,EAAA,IAAC,OACC,UAAU,yDACV,MAAO,CACL,MAAO,GAAGmF,CAAQ,IAClB,QAASA,IAAa,IAAM,EAAI,EAClC,GAEJ,CAEJ,CC9CA,MAAMM,GAAiBtF,GACrB,yRACA,CACE,SAAU,CACR,QAAS,CACP,QAAS,yDACT,YACE,qEACF,QACE,iFACF,UACE,+DACF,MAAO,+CACP,KAAM,iDACR,EACA,KAAM,CACJ,QAAS,iBACT,GAAI,sBACJ,GAAI,uBACJ,KAAM,YAEV,EACA,gBAAiB,CACf,QAAS,UACT,KAAM,UACR,CAEJ,EAQMuF,EAAS9F,EAAM,WACnB,CAAC,CAAE,UAAAC,EAAW,QAAAQ,EAAS,KAAAsF,EAAM,QAAAC,EAAU,GAAO,GAAG9F,CAAM,EAAGC,IAAQ,CAC1D,MAAA8F,EAAOD,EAAUE,GAAO,SAE5B,OAAA9F,EAAA,IAAC6F,EAAA,CACC,UAAW9G,EAAG0G,GAAe,CAAE,QAAApF,EAAS,KAAAsF,EAAM,UAAA9F,CAAA,CAAW,CAAC,EAC1D,IAAAE,EACC,GAAGD,CAAA,CACN,EAGN,EACA4F,EAAO,YAAc,SChDrB,MAAMK,GAAanG,aAGjB,CAAC,CAAE,UAAAC,EAAW,SAAA6D,EAAU,GAAG5D,CAAM,EAAGC,IACpC+C,EAAA,KAACkD,GAAA,CACC,IAAAjG,EACA,UAAWhB,EAAG,2BAA4Bc,CAAS,EAClD,GAAGC,EAEJ,UAAAE,MAACiG,GAAA,CAA6B,UAAU,kCACrC,SAAAvC,CACH,SACCwC,GAAU,IACXlG,EAAA,IAACmG,GAAA,CAA2B,IAC9B,CACD,EACDJ,GAAW,YAAcC,GAAyB,YAElD,MAAME,GAAYtG,aAGhB,CAAC,CAAE,UAAAC,EAAW,YAAAuG,EAAc,WAAY,GAAGtG,GAASC,IACpDC,EAAA,IAACqG,GAAA,CACC,IAAAtG,EACA,YAAAqG,EACA,UAAWrH,EACT,gDACAqH,IAAgB,YACd,qDACFA,IAAgB,cACd,uDACFvG,CACF,EACC,GAAGC,EAEJ,SAACE,MAAAsG,GAAA,CAAoC,UAAU,wCAAyC,GAC1F,CACD,EACDJ,GAAU,YAAcG,GAAwC,YCpCzD,SAASE,GAAU,CAAE,OAAAC,EAAQ,QAAAC,EAAS,SAAA/C,GAAY,CAErD,OAAA1D,EAAA,IAAC0G,GACE,UAAAF,GAEG1D,OAAA6D,WAAA,WAAA3G,EAAA,IAAC4G,GAAO,IAAP,CACC,QAAS,CAAE,QAAS,CAAE,EACtB,QAAS,CAAE,QAAS,CAAE,EACtB,KAAM,CAAE,QAAS,CAAE,EACnB,WAAY,CAAE,SAAU,EAAI,EAC5B,UAAU,4DACV,QAASH,EACT,MAAO,CAAE,MAAO,OAAQ,EAC1B,EACA3D,EAAA,KAAC8D,GAAO,IAAP,CACC,QAAS,CAAE,EAAG,MAAO,EACrB,QAAS,CAAE,EAAG,CAAE,EAChB,KAAM,CAAE,EAAG,MAAO,EAClB,WAAY,CAAE,KAAM,SAAU,QAAS,GAAI,UAAW,GAAI,EAC1D,UAAW7H,EACT,6EACA,eACF,EAEA,UAAC+D,OAAA,OAAI,UAAU,uDACb,UAAA9C,EAAA,IAAC,IAAE,MAAK,IAAI,UAAU,sCACpB,SAAAA,EAAA,IAAC,OACC,IAAI,wDACJ,IAAI,QACJ,UAAU,QAEd,EACAA,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,KAAK,OACL,UAAU,wCACV,QAAUmB,GAAM,CACdA,EAAE,gBAAgB,EACVJ,EAAA,CACV,EAEA,SAAAzG,MAAC8G,GAAE,WAAU,SAAU,IACzB,EACF,QACCf,GAAW,WAAU,SACpB,SAACjD,EAAA,YAAI,UAAU,0BACb,UAAC9C,MAAA,OAAI,UAAU,SAAU,SAAA0D,CAAS,SACjC,MAAI,WAAU,eACb,SAACZ,EAAA,UAAE,UAAU,4CAA4C,eACpD,IAAI,KAAK,EAAE,YAAY,EAAE,gCAC9B,CACF,IACF,CACF,KACF,EACF,CAEJ,EAEJ,CC3DA,MAAMiE,GAAiBnH,aAGrB,CAAC,CAAE,UAAAC,EAAW,SAAA6D,EAAU,GAAG5D,CAAM,EAAGC,IACpC+C,EAAA,KAACkE,GAAA,CACC,IAAAjH,EACA,UAAWhB,EACT,kEACAc,CACF,EACC,GAAGC,EAEH,UAAA4D,QACAuD,GAAuB,KAC1B,CACD,EACDF,GAAe,YAAcC,GAA6B,YAE1D,MAAME,GAAqBtH,EAGzB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACmH,GAAA,CACC,IAAApH,EACA,UAAWhB,EACT,oEACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACDoH,GAAmB,YAAcC,GAA6B,YAE9D,MAAMC,GAAqBC,GAErBC,GAA6BnH,GACjC,2VACF,EAEMoH,GAAwB3H,aAG5B,CAAC,CAAE,UAAAC,EAAW,SAAA6D,EAAU,GAAG5D,CAAM,EAAGC,IACpC+C,EAAA,KAAC0E,GAAA,CACC,IAAAzH,EACA,UAAWhB,EAAGuI,KAA8B,QAASzH,CAAS,EAC7D,GAAGC,EAEH,UAAA4D,EAAU,IACX1D,EAAA,IAACyH,GAAA,CACC,UAAU,6FACV,cAAY,QACd,EACF,CACD,EACDF,GAAsB,YAAcC,GAAgC,YAEpE,MAAME,GAAwB9H,EAG5B,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC2H,GAAA,CACC,IAAA5H,EACA,UAAWhB,EACT,yVACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACD4H,GAAsB,YAAcC,GAAgC,YAEpE,MAAMC,GAAqBC,GAErBZ,GAAyBrH,EAG7B,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IACzBC,EAAA,WAAI,UAAWjB,EAAG,8CAA8C,EAC/D,SAAAiB,EAAA,IAAC8H,GAAA,CACC,UAAW/I,EACT,wVACAc,CACF,EACA,IAAAE,EACC,GAAGD,CAAA,CACN,EACF,CACD,EACDmH,GAAuB,YACrBa,GAAiC,YAEnC,MAAMC,GAA0BnI,EAG9B,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACgI,GAAA,CACC,IAAAjI,EACA,UAAWhB,EACT,+LACAc,CACF,EACC,GAAGC,EAEJ,SAAAE,MAAC,MAAI,WAAU,wEAAyE,GAC1F,CACD,EACD+H,GAAwB,YACtBC,GAAkC,YC9GpC,MAAMC,GAASrI,EAGb,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACkI,GAAA,CACC,IAAAnI,EACA,UAAWhB,EACT,gEACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACDmI,GAAO,YAAcC,GAAqB,YAE1C,MAAMC,GAAcvI,EAGlB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACoI,GAAA,CACC,IAAArI,EACA,UAAWhB,EAAG,8BAA+Bc,CAAS,EACrD,GAAGC,CAAA,CACN,CACD,EACDqI,GAAY,YAAcC,GAAsB,YAEhD,MAAMC,GAAiBzI,EAGrB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACsI,GAAA,CACC,IAAAvI,EACA,UAAWhB,EACT,uEACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACDuI,GAAe,YAAcC,GAAyB,YCnCtD,MAAMC,GAAeC,GAEfC,GAAsBC,GAUtBC,GAAyB/I,aAK7B,CAAC,CAAE,UAAAC,EAAW,MAAA+I,EAAO,SAAAlF,EAAU,GAAG5D,GAASC,IAC3C+C,EAAA,KAAC+F,GAAA,CACC,IAAA9I,EACA,UAAWhB,EACT,uIACA6J,GAAS,OACT/I,CACF,EACC,GAAGC,EAEH,UAAA4D,EACD1D,MAAC8I,GAAiB,WAAU,iBAAkB,IAChD,CACD,EACDH,GAAuB,YACrBE,GAAiC,YAEnC,MAAME,GAAyBnJ,EAG7B,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACgJ,GAAA,CACC,IAAAjJ,EACA,UAAWhB,EACT,wbACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACDiJ,GAAuB,YACrBC,GAAiC,YAEnC,MAAMC,GAAsBrJ,aAG1B,CAAC,CAAE,UAAAC,EAAW,WAAAqJ,EAAa,EAAG,GAAGpJ,GAASC,IACzCC,MAAAmJ,GAAA,CACC,SAAAnJ,EAAA,IAACoJ,GAAA,CACC,IAAArJ,EACA,WAAAmJ,EACA,UAAWnK,EACT,uGACA,mVACAc,CACF,EACC,GAAGC,CAAA,CACN,EACF,CACD,EACDmJ,GAAoB,YAAcG,GAA8B,YAEhE,MAAMC,GAAmBzJ,aAKvB,CAAC,CAAE,UAAAC,EAAW,MAAA+I,EAAO,GAAG9I,CAAM,EAAGC,IACjCC,EAAA,IAACsJ,GAAA,CACC,IAAAvJ,EACA,UAAWhB,EACT,kOACA6J,GAAS,OACT/I,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACDuJ,GAAiB,YAAcC,GAA2B,YAE1D,MAAMC,GAA2B3J,aAG/B,CAAC,CAAE,UAAAC,EAAW,SAAA6D,EAAU,QAAA8F,EAAS,GAAG1J,GAASC,IAC7C+C,EAAA,KAAC2G,GAAA,CACC,IAAA1J,EACA,UAAWhB,EACT,uOACAc,CACF,EACA,QAAA2J,EACC,GAAG1J,EAEJ,UAAAE,EAAA,IAAC,OAAK,WAAU,+DACd,SAAAA,MAAC0J,GAAA,CACC,SAAA1J,MAAC2J,GAAU,WAAU,SAAU,EACjC,GACF,EACCjG,CAAA,EACH,CACD,EACD6F,GAAyB,YACvBE,GAAmC,YAErC,MAAMG,GAAwBhK,aAG5B,CAAC,CAAE,UAAAC,EAAW,SAAA6D,EAAU,GAAG5D,CAAM,EAAGC,IACpC+C,EAAA,KAAC+G,GAAA,CACC,IAAA9J,EACA,UAAWhB,EACT,uOACAc,CACF,EACC,GAAGC,EAEJ,UAAAE,EAAA,IAAC,OAAK,WAAU,+DACd,SAAAA,MAAC0J,GAAA,CACC,SAAA1J,MAAC8J,GAAc,WAAU,sBAAuB,EAClD,GACF,EACCpG,CAAA,EACH,CACD,EACDkG,GAAsB,YAAcC,GAAgC,YAEpE,MAAME,GAAoBnK,aAKxB,CAAC,CAAE,UAAAC,EAAW,MAAA+I,EAAO,GAAG9I,CAAM,EAAGC,IACjCC,EAAA,IAACgK,GAAA,CACC,IAAAjK,EACA,UAAWhB,EACT,oCACA6J,GAAS,OACT/I,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACDiK,GAAkB,YAAcC,GAA4B,YAE5D,MAAMC,GAAwBrK,EAG5B,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACkK,GAAA,CACC,IAAAnK,EACA,UAAWhB,EAAG,2BAA4Bc,CAAS,EAClD,GAAGC,CAAA,CACN,CACD,EACDmK,GAAsB,YAAcC,GAAgC,YCrKpE,MAAMC,GAASC,GAETC,GAAgBC,GAEhBC,GAAeC,GAIfC,GAAgB7K,EAGpB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC0K,GAAA,CACC,IAAA3K,EACA,UAAWhB,EACT,0JACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACD2K,GAAc,YAAcC,GAAwB,YAEpD,MAAMC,GAAgB/K,EAGpB,YAAC,CAAE,UAAAC,EAAW,SAAA6D,EAAU,GAAG5D,CAAM,EAAGC,IACpC+C,OAACyH,GACC,WAAAvK,EAAA,IAACyK,GAAc,IACf3H,EAAA,KAAC8H,GAAA,CACC,IAAA7K,EACA,UAAWhB,EACT,8fACAc,CACF,EACC,GAAGC,EAEH,UAAA4D,EACAZ,OAAA+H,GAAA,CAAsB,UAAU,gRAC/B,UAAC7K,MAAAW,GAAA,CAAW,UAAU,SAAU,GAC/BX,EAAA,YAAK,UAAU,UAAU,SAAK,UACjC,KACF,EACF,CACD,EACD2K,GAAc,YAAcC,GAAwB,YAEpD,MAAME,GAAe,CAAC,CACpB,UAAAjL,EACA,GAAGC,CACL,IACEE,EAAA,IAAC,OACC,UAAWjB,EACT,qDACAc,CACF,EACC,GAAGC,CAAA,CACN,EAEFgL,GAAa,YAAc,eAE3B,MAAMC,GAAe,CAAC,CACpB,UAAAlL,EACA,GAAGC,CACL,IACEE,EAAA,IAAC,OACC,UAAWjB,EACT,gEACAc,CACF,EACC,GAAGC,CAAA,CACN,EAEFiL,GAAa,YAAc,eAE3B,MAAMC,GAAcpL,EAGlB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACiL,GAAA,CACC,IAAAlL,EACA,UAAWhB,EACT,oDACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACDkL,GAAY,YAAcC,GAAsB,YAEhD,MAAMC,GAAoBtL,EAGxB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACmL,GAAA,CACC,IAAApL,EACA,UAAWhB,EAAG,gCAAiCc,CAAS,EACvD,GAAGC,CAAA,CACN,CACD,EACDoL,GAAkB,YAAcC,GAA4B,YCnG5D,MAAMC,EAAQxL,EAAM,WAClB,CAAC,CAAE,UAAAC,EAAW,KAAAwL,EAAM,GAAGvL,CAAA,EAASC,IAE5BC,EAAA,IAAC,SACC,KAAAqL,EACA,UAAWtM,EACT,wUACAc,CACF,EACA,IAAAE,EACC,GAAGD,CAAA,CACN,CAGN,EACAsL,EAAM,YAAc,QChBpB,MAAME,GAAgBnL,GACpB,4FACF,EAEMoL,EAAQ3L,EAIZ,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACwL,GAAA,CACC,IAAAzL,EACA,UAAWhB,EAAGuM,GAAc,EAAGzL,CAAS,EACvC,GAAGC,CAAA,CACN,CACD,EACDyL,EAAM,YAAcC,GAAoB,YCPjC,SAASC,GAAW,CAAE,OAAAjF,EAAQ,QAAAC,EAAS,UAAAiF,GAA8B,CAC1E,KAAM,CAACC,EAAOC,CAAQ,EAAI/H,WAAS,EAAE,EAC/B,CAACgI,EAAUC,CAAW,EAAIjI,WAAS,EAAE,EACrC,CAACK,EAAWC,CAAY,EAAIN,WAAS,EAAK,EAC1C,CAAE,MAAAjC,CAAM,EAAIS,GAAS,EAErB0J,EAAc,MAAOlF,GAAuB,CAChDA,EAAE,eAAe,EACjB1C,EAAa,EAAI,EAEb,IACM,YAAI,yBAA0BwH,CAAK,EAG3C,KAAM,CAAE,KAAApI,EAAM,MAAAC,CAAA,EAAU,MAAMP,GAAS,KAAK,mBAAmB,CAC7D,MAAA0I,EACA,SAAAE,CAAA,CACD,EAED,GAAIrI,EACM,oBAAM,uBAAwBA,CAAK,EACrCA,EAGA,YAAI,oBAAqBD,CAAI,EAE/B3B,EAAA,CACJ,MAAO,UACP,YAAa,mCACd,EAGO6E,EAAA,EAGR,WAAW,IAAM,CACXiF,GACQA,EAAA,EAIL,gBAAS,KAAO,OAAO,SAAS,UACtC,GAAG,QAEClI,EAAY,CACX,cAAM,eAAgBA,CAAK,EAC7B5B,EAAA,CACJ,QAAS,cACT,MAAO,eACP,YAAa4B,EAAM,SAAW,+CAC/B,SACD,CACAW,EAAa,EAAK,EAEtB,EAGE,OAAAnE,EAAA,IAACmK,IAAO,KAAM3D,EAAQ,aAAcC,EAClC,SAAA3D,EAAA,KAAC6H,GAAc,WAAU,mBACvB,UAAA7H,OAACgI,GACC,WAAA9K,MAACgL,IAAY,SAAK,UAClBhL,MAACkL,IAAkB,SAEnB,oDACF,EACApI,OAAC,OAAK,UAAUiJ,EACd,UAACjJ,OAAA,OAAI,UAAU,kBACb,UAACA,OAAA,OAAI,UAAU,aACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,QAAQ,SAAK,UAC5BvL,EAAA,IAACoL,EAAA,CACC,GAAG,QACH,KAAK,QACL,MAAOO,EACP,SAAW9E,GAAM+E,EAAS/E,EAAE,OAAO,KAAK,EACxC,YAAY,yBACZ,aAAa,QACb,SAAQ,IACV,EACF,EACA/D,OAAC,MAAI,WAAU,aACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,WAAW,SAAQ,aAClCvL,EAAA,IAACoL,EAAA,CACC,GAAG,WACH,KAAK,WACL,MAAOS,EACP,SAAWhF,GAAMiF,EAAYjF,EAAE,OAAO,KAAK,EAC3C,aAAa,mBACb,SAAQ,IACV,CACF,IACF,EACA7G,EAAA,IAAC+K,GACC,UAAA/K,MAAC0F,EAAO,MAAK,SAAS,SAAUxB,EAC7B,SAAAA,EAAY,gBAAkB,QACjC,CACF,GACF,IACF,CACF,EAEJ,CChEA,MAAM8H,GAAiB,CACrB,CACE,MAAO,mBACP,KAAM,SACN,KAAM,KACN,aAAc,EAChB,EACA,CACE,MAAO,WACP,KAAM,YACN,KAAM,KACN,aAAc,EAChB,EACA,CACE,MAAO,SACP,MAAO,CACL,CAAE,MAAO,gBAAiB,KAAM,UAAW,YAAa,yDAA0D,aAAc,EAAK,EACrI,CAAE,MAAO,kBAAmB,KAAM,YAAa,YAAa,2CAA4C,aAAc,EAAK,EAC3H,CAAE,MAAO,qBAAsB,KAAM,YAAa,YAAa,qCAAsC,aAAc,EAAM,CAC3H,EACA,KAAM,IACR,EACA,CACE,MAAO,WACP,MAAO,CACL,CAAE,MAAO,sBAAuB,KAAM,uBAAwB,YAAa,oCAAqC,aAAc,EAAK,EACnI,CAAE,MAAO,2BAA4B,KAAM,4BAA6B,YAAa,0CAA2C,aAAc,EAAK,EACnJ,CAAE,MAAO,cAAe,KAAM,eAAgB,YAAa,qCAAsC,aAAc,EAAM,CACvH,EACA,KAAM,IACR,EACA,CACE,MAAO,WACP,KAAM,YACN,KAAM,KACN,aAAc,EAChB,EACA,CACE,MAAO,UACP,KAAM,WACN,KAAM,KACN,aAAc,EAChB,EACA,CACE,MAAO,UACP,KAAM,QACN,KAAM,IACN,aAAc,EAChB,EACA,CACE,MAAO,WACP,KAAM,YACN,KAAM,KACN,aAAc,GAElB,EAEA,SAAwBC,GAAO,CAC7B,gBAAAC,EAAkB,GAClB,SAAAC,EACA,SAAAC,EACA,YAAAC,EAAc,CAAC,EACf,UAAAC,CACF,EAAgB,SACd,KAAM,CAACC,EAAgBC,CAAiB,EAAI3H,EAAM,SAAS,EAAK,EAC1D,CAAC4H,EAAYC,CAAa,EAAI7H,EAAM,SAAS,EAAK,EAClD,CAAC8H,EAAgBC,CAAiB,EAAI/H,EAAM,SAAS,EAAK,EAC1DgI,EAAWC,GAAY,EACvBC,EAAOjI,GAAQ,EAGfkI,EAAwBd,GAAmB,CAAC,CAACa,EAAK,KAClDE,EAAoBZ,GAAe,OAAO,KAAKA,CAAW,EAAE,OAAS,EAAIA,EAAcU,EAAK,QAC5FG,EAAgBZ,GAAaS,EAAK,QAGxClI,EAAM,UAAU,IAAM,CACpB,MAAMsI,EAAe,IAAM,CACXT,EAAA,OAAO,QAAU,EAAE,CACnC,EACO,+BAAiB,SAAUS,CAAY,EACvC,IAAM,OAAO,oBAAoB,SAAUA,CAAY,CAChE,EAAG,EAAE,EAGC,MAAAC,EAAoBvG,GAAwB,CAChDA,EAAE,eAAe,EACjB+F,EAAkB,EAAI,CACxB,EAGMS,EAAgB,SAAY,CAChC,QAAQ,IAAI,yBAAyB,EACjC,IACF,MAAMH,EAAc,EAEpB,OAAO,SAAS,KAAO,UAChB1J,EAAO,CACN,cAAM,qBAAsBA,CAAK,EAE7C,EAGM8J,EAA2B,CAACzG,EAAwC0G,EAAuBC,IAAiB,CAE5GD,GAAgB,CAACP,IACnBnG,EAAE,eAAe,EACjB+F,EAAkB,EAAI,GACtBJ,EAAkB,EAAK,CAK3B,EAEMiB,EAAW5I,EAAM,WAKrB,CAAC,CAAE,UAAAhF,EAAW,MAAA+C,EAAO,SAAAc,EAAU,GAAG5D,CAAM,EAAGC,IAExCC,EAAA,UACC,SAACA,MAAA4H,GAAA,CAAmB,QAAO,GACzB,SAAA9E,EAAA,KAAC,KACC,IAAA/C,EACA,UAAWhB,EACT,gMACAc,GAAa,EACf,EACC,GAAGC,EAEJ,UAACE,EAAA,WAAI,UAAU,mCAAoC,SAAM4C,EAAA,EACxD5C,MAAA,KAAE,UAAU,0DACV,SAAA0D,CACH,MAEJ,CACF,EAEH,EACD,OAAA+J,EAAS,YAAc,WAInB3K,EAAA,KAAA6D,WAAA,WAAA3G,EAAA,IAAC,UACC,UAAWjB,EACT,8DACA0N,EAAa,OAAS,MACxB,EAEA,eAAC,MAAI,WAAU,yBACb,SAAAzM,MAAC,OAAI,UAAWjB,EACd,2DACA0N,EACI,4DACA,gCAEJ,SAAA3J,OAAC,MAAI,WAAU,8CAEb,UAACA,OAAA,OAAI,UAAU,0BACb,UAAA9C,EAAA,IAAC,IAAE,MAAK,IAAI,UAAU,sCACpB,SAAAA,EAAA,IAAC,OACC,IAAI,wDACJ,IAAI,QACJ,UAAU,QAEd,QAGC+G,GAAe,WAAU,iBACxB,SAACjE,EAAA,KAAAoE,GAAA,CAAmB,UAAU,QAC5B,UAAApE,OAACsE,GACC,WAAApH,EAAA,IAACuH,GAAA,CACC,UAAWxI,EACT,wCACA,qDACA,+BACF,EACD,kBAEH,EACCiB,MAAA0H,GAAA,CACG,SAAC5E,OAAA,MAAG,UAAU,kCACX,UAAAkK,EAEHlK,EAAA,KAAA6D,WAAA,WAAA3G,MAACyN,EAAS,MAAK,UAAU,MAAM,gBAAgB,SAE/C,kEACCA,EAAS,MAAK,YAAY,MAAM,kBAAkB,SAEnD,6DACI,EAGE3K,OAAA6D,EAAA,oBAAA3G,EAAA,IAACyN,EAAA,CACC,KAAK,IACL,QAASL,EACT,MAAM,gBACP,4CAED,EACApN,EAAA,IAACyN,EAAA,CACC,KAAK,IACL,QAASL,EACT,MAAM,kBACP,+CAED,EACF,QAEHK,EAAS,MAAK,YAAY,MAAM,qBAAqB,SAEtD,yCACF,CACF,IACF,QAECrG,GACC,UAAApH,EAAA,IAAC4H,GAAA,CACG,UAAW7I,EACT,6CACA,qCACF,EACF,KAAK,SACN,mBAGH,QAECqI,GACG,UAAApH,EAAA,IAAC4H,GAAA,CACC,UAAW7I,EACT,6CACA,qCACF,EACA,KAAK,YACN,sBAGH,SAECqI,GACC,WAAApH,EAAA,IAACuH,GAAA,CACC,UAAWxI,EACT,wCACA,qDACA,+BACF,EACD,oBAEH,EACCiB,MAAA0H,GAAA,CACG,SAAC5E,OAAA,MAAG,UAAU,kCACd,UAAA9C,MAACyN,EAAS,MAAK,uBAAuB,MAAM,sBAAsB,SAElE,6CACCA,EAAS,MAAK,4BAA4B,MAAM,2BAA2B,SAE5E,mDACCA,EAAS,MAAK,eAAe,MAAM,cAAc,SAElD,8DACF,CACF,IACF,QAECrG,GACC,UAAApH,EAAA,IAAC4H,GAAA,CACG,UAAW7I,EACT,6CACA,qCACF,EACF,KAAK,WACN,oBAGH,IACF,CACF,IACA,EAGA+D,OAAC,MAAI,WAAU,0BAEb,UAACA,OAAA,OAAI,UAAU,oCACb,UAAA9C,EAAA,IAAC,KACC,KAAK,QACL,UAAWjB,EACT,6CACA,qCACF,EACD,mBAED,EACAiB,EAAA,IAAC,KACC,KAAK,YACL,UAAWjB,EACT,6CACA,qCACF,EACD,qBAED,EACF,EAGA+D,EAAA,KAAC4C,EAAA,CACC,QAAQ,QACR,UAAU,+NACV,QAAS,IAAMmH,EAAS,UAAU,EAElC,UAAC7M,MAAA0N,GAAA,CAAM,UAAU,cAAe,GAAE,WAEpC,EAGA5K,OAAC,MAAI,WAAU,oBACZ,UAACkK,SAmBCzE,GACC,WAACvI,MAAAyI,GAAA,CAAoB,QAAO,GAC1B,SAAAzI,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,UAAU,kCAEV,SAAA5C,EAAA,KAACmF,GAAO,WAAU,YAChB,UAAAjI,EAAA,IAACmI,GAAA,CACC,IAAK,oCAAoC,oBAAmB8E,GAAA,YAAAA,EAAmB,YAAa,EAAE,CAAC,qBAC/F,KAAKA,GAAA,YAAAA,EAAmB,YAAa,cACvC,EACCjN,MAAAqI,GAAA,CAAe,UAAU,gBACvB,WAAmBhE,EAAA4I,GAAA,YAAAA,EAAA,wBAAA5I,EAChB,MAAM,KACP,OAAO,SACP,IAAKsJ,GAAMA,EAAE,CAAC,GACd,MAAM,EAAG,GACT,KAAK,IACL,gBAAiB,GACtB,GACF,KAEJ,EACA7K,EAAA,KAACmG,GAAA,CACC,UAAU,kEACV,MAAM,MACN,WAAU,GAEV,UAACnG,OAAAuG,GAAA,CAAiB,UAAU,uBAC1B,UAAArJ,EAAA,IAAC,MAAI,WAAU,cACZ,SAAAiN,GAAA,YAAAA,EAAmB,UACtB,EACCjN,EAAA,WAAI,UAAU,gCACZ,0BAAmB,KACtB,IACF,QACCiK,GAAsB,WACtBZ,GAAiB,SAAS,IAAMwD,EAAS,YAAY,EACpD,UAAC7M,MAAA4N,GAAA,CAAgB,UAAU,cAAe,GAC1C5N,MAAC,QAAK,SAAS,eACjB,SACCqJ,GAAiB,SAAS,IAAMwD,EAAS,UAAU,EAClD,UAAC7M,MAAA6N,GAAA,CAAS,UAAU,cAAe,GACnC7N,MAAC,QAAK,SAAgB,sBACxB,SACCqJ,GAAiB,SAAS,IAAMwD,EAAS,WAAW,EACnD,UAAC7M,MAAA8N,GAAA,CAAc,UAAU,cAAe,GACxC9N,MAAC,QAAK,SAAQ,cAChB,QACCiK,GAAsB,IACvBnH,EAAA,KAACuG,GAAA,CACC,UAAU,kCACV,QAASgE,EAET,UAACrN,MAAA+N,GAAA,CAAO,UAAU,cAAe,GACjC/N,MAAC,QAAK,SAAO,cACf,GACF,EACF,EA5EA8C,OAAC,MAAI,WAAU,oCACb,UAAAA,EAAA,KAAC4C,EAAA,CACC,QAAQ,QACR,QAAS0H,EACT,UAAU,iCAEV,UAACpN,MAAAgO,GAAA,CAAM,UAAU,cAAe,GAAE,WAEpC,EACAlL,EAAA,KAAC4C,EAAA,CACC,QAAS,IAAM0G,GAAA,YAAAA,IACf,UAAU,qDAEV,UAACpM,MAAAiO,GAAA,CAAS,UAAU,cAAe,GAAE,YAGzC,IAgEFjO,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,UAAU,qBACV,QAAS,IAAM8G,EAAkB,EAAI,EAErC,SAAAxM,MAACkO,GAAK,WAAU,SAAU,IAC5B,CACF,GACF,GACF,EACF,EACF,GACF,EAGAlO,EAAA,IAACuG,GAAA,CACC,OAAQgG,EACR,QAAS,IAAMC,EAAkB,EAAK,EAEtC,SAAA1J,EAAA,KAAC,MAAI,WAAU,YACZ,UACCkK,GAAAlK,EAAA,KAAC,MAAI,WAAU,iBACb,UAACA,OAAA,OAAI,UAAU,mCACb,UAACA,OAAAmF,GAAA,CAAO,UAAU,YAChB,UAAAjI,EAAA,IAACmI,GAAA,CACC,IAAK,oCAAoC,oBAAmB8E,GAAA,YAAAA,EAAmB,YAAa,EAAE,CAAC,qBAC/F,KAAKA,GAAA,YAAAA,EAAmB,YAAa,cACvC,EACCjN,MAAAqI,GAAA,CAAe,UAAU,gBACvB,WAAmB/D,EAAA2I,GAAA,YAAAA,EAAA,wBAAA3I,EAChB,MAAM,KACP,OAAO,SACP,IAAKqJ,GAAMA,EAAE,CAAC,GACd,MAAM,EAAG,GACT,KAAK,IACL,gBAAiB,GACtB,IACF,EACA7K,OAAC,MAAI,WAAU,yBACb,UAAA9C,EAAA,IAAC,IAAE,WAAU,4CACV,SAAAiN,GAAA,YAAAA,EAAmB,UACtB,EACCjN,EAAA,SAAE,UAAU,yCACV,0BAAmB,KACtB,GACF,IACF,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAAA,EAAA,KAAC4C,EAAA,CACC,QAAQ,UACR,UAAU,8BACV,QAAS,IAAM,CACbmH,EAAS,YAAY,EACrBL,EAAkB,EAAK,CACzB,EAEA,UAACxM,MAAA4N,GAAA,CAAgB,UAAU,cAAe,GAAE,aAE9C,EACA9K,EAAA,KAAC4C,EAAA,CACC,QAAQ,UACR,UAAU,8BACV,QAAS,IAAM,CACbmH,EAAS,UAAU,EACnBL,EAAkB,EAAK,CACzB,EAEA,UAACxM,MAAA6N,GAAA,CAAS,UAAU,cAAe,GAAE,YAEvC,EACF,EACA7N,MAAC,MAAI,WAAU,wBAAyB,IAC1C,EAGDgM,GAAe,IAAI,CAACmC,EAAM1L,wBACxB,MAAgB,WAAU,YACxB,SAAA0L,EAAK,KACJrL,EAAA,KAAC,KACC,KAAMqL,EAAK,KACX,UAAWpP,EACT,oEACC,CAACoP,EAAK,cAAgBnB,EACnB,qBACA,6CACN,EACA,QAAUnG,GAAMyG,EAAyBzG,EAAGsH,EAAK,aAAcA,EAAK,IAAI,EAExE,UAAAnO,EAAA,IAAC,OAAK,WAAU,UAAW,SAAAmO,EAAK,KAAK,EACrCnO,MAAC,OAAM,UAAAmO,EAAK,KAAM,GACjBA,EAAK,cAAgB,CAACnB,SACpB,OAAK,WAAU,qCAAqC,SAAkB,0BAKzElK,EAAA,KAAA6D,WAAA,WAAC7D,OAAA,OAAI,UAAU,kDACb,UAAA9C,EAAA,IAAC,OAAK,WAAU,UAAW,SAAAmO,EAAK,KAAK,EACrCnO,MAAC,OAAM,UAAAmO,EAAK,KAAM,IACpB,EACAnO,MAAC,OAAI,UAAU,iBACZ,cAAK,sBAAO,IAAI,CAACoO,EAASC,IACzBvL,EAAA,KAAC,KAEC,KAAMsL,EAAQ,KACd,UAAWrP,EACT,oCACC,CAACqP,EAAQ,cAAgBpB,EACtB,2CACA,gDACN,EACA,QAAUnG,GAAMyG,EAAyBzG,EAAGuH,EAAQ,aAAcA,EAAQ,IAAI,EAE7E,UAAQA,EAAA,MACRA,EAAQ,cAAgB,CAACpB,SACvB,OAAK,WAAU,qCAAqC,SAAkB,yBAZpEqB,CAAA,EAgBX,IACF,GA5CM5L,CA8CV,EACD,EAECuK,EAsBAhN,MAAC,MAAI,WAAU,OACb,SAAA8C,EAAA,KAAC4C,EAAA,CACC,QAAQ,UACR,UAAU,qFACV,QAAS2H,EAET,UAACrN,MAAA+N,GAAA,CAAO,UAAU,cAAe,GAAE,YAGvC,GA9BCjL,OAAA,OAAI,UAAU,iBACb,UAAAA,EAAA,KAAC4C,EAAA,CACC,QAAQ,UACR,UAAU,qCACV,QAAS0H,EAET,UAACpN,MAAAgO,GAAA,CAAM,UAAU,cAAe,GAAE,WAEpC,EACAlL,EAAA,KAAC4C,EAAA,CACC,UAAU,uIACV,QAAS,IAAM,CACF0G,GAAA,MAAAA,IACXI,EAAkB,EAAK,CACzB,EAEA,UAACxM,MAAAiO,GAAA,CAAS,UAAU,cAAe,GAAE,YAEvC,CACF,EAWA,CAEJ,GACF,EAEAjO,EAAA,IAACyL,GAAA,CACC,OAAQkB,EACR,QAAS,IAAMC,EAAkB,EAAK,EACtC,UAAW,IAAM,CACfA,EAAkB,EAAK,EAEvB,OAAO,SAAS,OAAO,EACzB,EACF,EACF,CAEJ,CC7lBA,MAAM0B,GAAsC,CAAC,CACzC,KAAAC,EAAO,GACP,UAAA1O,EAAY,GACZ,MAAA2O,EAAQ,IACR,cAAAC,EAAgB,CAAE,QAAS,EAAG,UAAW,uBAAwB,EACjE,YAAAC,EAAc,CAAE,QAAS,EAAG,UAAW,oBAAqB,EAC5D,OAAAC,EAAU9M,GAAcA,EACxB,UAAA+M,EAAY,GACZ,WAAAC,EAAa,SACb,UAAAC,EAAY,SACZ,0BAAAC,CACJ,IAAM,CACI,MAAAC,EAAQT,EAAK,MAAM,GAAG,EAAE,IAAYU,KAAK,MAAM,EAAE,CAAC,EAClDC,EAAUF,EAAM,KAAK,EACrB,CAACG,EAAQC,CAAS,EAAIvL,WAAS,EAAK,EACpC9D,EAAMsP,SAA6B,IAAI,EACvCC,EAAgBD,SAAO,CAAC,EAE9B7K,YAAU,IAAM,CACZ,MAAM+K,EAAW,IAAI,qBACjB,CAAC,CAACC,CAAK,IAAM,CACLA,EAAM,iBACNJ,EAAU,EAAI,EACVrP,EAAI,SACKwP,EAAA,UAAUxP,EAAI,OAAO,EAG1C,EACA,CAAE,UAAA6O,EAAW,WAAAC,CAAW,CAC5B,EAEA,OAAI9O,EAAI,SACKwP,EAAA,QAAQxP,EAAI,OAAO,EAGzB,IAAMwP,EAAS,WAAW,GAClC,CAACX,EAAWC,CAAU,CAAC,EAE1B,MAAMY,EAAUC,GACZR,EAAQ,OACRA,EAAQ,IAAI,CAACS,EAAGC,KAAO,CACnB,KAAMnB,EACN,GAAIU,EACE,MAAOU,GAAwC,CAC7C,MAAMA,EAAKnB,CAAW,EACtBY,EAAc,SAAW,EACrBA,EAAc,UAAYJ,EAAQ,QAAUH,GAClBA,EAAA,CAC9B,EAEFN,EACN,MAAOmB,EAAIpB,EACX,OAAQ,CAAE,OAAAG,CAAO,GACnB,CACN,EAGI,OAAA3O,EAAA,IAAC,KACG,IAAAD,EACA,UAAW,uCAAuCF,CAAS,GAC3D,MAAO,CAAE,UAAAiP,EAAW,WAAY,SAAU,SAAU,YAAa,EAEhE,SAAME,EAAA,IAAI,CAACC,EAAMa,IACdhN,OAAC,OAAqB,OAAO,CAAE,QAAS,eAAgB,WAAY,QAC/D,YAAKmM,EAAA,IAAI,CAACc,EAAQC,IAAgB,CAC/B,MAAMvN,EAAQuM,EACT,MAAM,EAAGc,CAAS,EAClB,OAAO,CAACG,EAAKC,IAAMD,EAAMC,EAAE,OAAQ,CAAC,EAAIF,EAGzC,OAAAhQ,EAAA,IAACmQ,GAAS,KAAT,CAEG,MAAOV,EAAQhN,CAAK,EACpB,UAAU,kEAET,SAAAsN,CAAA,EAJItN,CAKT,EAEP,EACDzC,MAAC,QAAK,MAAO,CAAE,QAAS,eAAgB,MAAO,OAAQ,EAAG,SAAM,QAhBzD8P,CAiBX,CACH,EACL,CAER,ECjGMM,GAAO;AAAA;AAAA;AAAA;AAAA;AAAA,EAOPC,GAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA2GPC,GAAUxQ,GAAuB,CAC/B,MACJ,WAAAyQ,EAAa,CAAC,UAAW,UAAW,SAAS,EAC7C,UAAAC,EAAY,EACZ,MAAAC,EAAQ,IACN3Q,EACE4Q,EAAWrB,SAAoBvP,CAAK,EAC1C4Q,EAAS,QAAU5Q,EAEb,MAAA6Q,EAAStB,SAAuB,IAAI,EAE1C7K,mBAAU,IAAM,CACd,MAAMoM,EAAMD,EAAO,QACnB,GAAI,CAACC,EAAK,OAEJ,MAAAC,EAAW,IAAIC,GAAS,CAC5B,MAAO,GACP,mBAAoB,GACpB,UAAW,GACZ,EACKC,EAAKF,EAAS,GACpBE,EAAG,WAAW,EAAG,EAAG,EAAG,CAAC,EACrBA,EAAA,OAAOA,EAAG,KAAK,EAClBA,EAAG,UAAUA,EAAG,IAAKA,EAAG,mBAAmB,EACxCA,EAAA,OAAO,MAAM,gBAAkB,cAE9B,IAAAC,EAEJ,SAASC,GAAS,CAChB,GAAI,CAACL,EAAK,OACV,MAAMM,EAAQN,EAAI,YACZO,EAASP,EAAI,aACVC,EAAA,QAAQK,EAAOC,CAAM,EAC1BH,IACFA,EAAQ,SAAS,YAAY,MAAQ,CAACE,EAAOC,CAAM,EACrD,CAEK,wBAAiB,SAAUF,CAAM,EAElC,MAAAG,EAAW,IAAIC,GAASN,CAAE,EAC5BK,EAAS,WAAW,IACtB,OAAQA,EAAS,WAAmB,GAGtC,MAAME,EAAkBf,EAAW,IAAKgB,GAAQ,CACxC,MAAAC,EAAI,IAAIC,GAAMF,CAAG,EACvB,MAAO,CAACC,EAAE,EAAGA,EAAE,EAAGA,EAAE,CAAC,EACtB,EAESR,EAAA,IAAIU,GAAQX,EAAI,CACxB,OAAQX,GACR,SAAUC,GACV,SAAU,CACR,MAAO,CAAE,MAAO,CAAE,EAClB,WAAY,CAAE,MAAOG,CAAU,EAC/B,YAAa,CAAE,MAAOc,CAAgB,EACtC,YAAa,CAAE,MAAO,CAACV,EAAI,YAAaA,EAAI,YAAY,CAAE,EAC1D,OAAQ,CAAE,MAAOH,CAAM,EACzB,CACD,EAED,MAAMkB,EAAO,IAAIC,GAAKb,EAAI,CAAE,SAAAK,EAAU,QAAAJ,EAAS,EAC3CJ,EAAA,YAAYG,EAAG,MAAM,EAEzB,IAAIc,EAAY,EACV,MAAA3P,EAAUL,GAAc,CAC5BgQ,EAAY,sBAAsB3P,CAAM,EACxC,KAAM,CAAE,KAAA4P,EAAOjQ,EAAI,IAAM,MAAAkQ,EAAQ,GAAQrB,EAAS,QAClD,GAAIM,EAAS,CACXA,EAAQ,SAAS,MAAM,MAAQc,EAAOC,EAAQ,GAC9Cf,EAAQ,SAAS,WAAW,MAAQN,EAAS,QAAQ,WAAa,EAClEM,EAAQ,SAAS,OAAO,MAAQN,EAAS,QAAQ,OAASD,EACpD,MAAAuB,EAAQtB,EAAS,QAAQ,YAAcH,EAC7CS,EAAQ,SAAS,YAAY,MAAQgB,EAAM,IAAKT,GAAgB,CACxD,MAAAC,EAAI,IAAIC,GAAMF,CAAG,EACvB,MAAO,CAACC,EAAE,EAAGA,EAAE,EAAGA,EAAE,CAAC,EACtB,EACDX,EAAS,OAAO,CAAE,MAAOc,CAAA,CAAM,EAEnC,EACA,OAAAE,EAAY,sBAAsB3P,CAAM,EAEjC+O,EAAA,EAEA,IAAM,OACX,qBAAqBY,CAAS,EACvB,2BAAoB,SAAUZ,CAAM,EACvCL,GAAOG,EAAG,OAAO,aAAeH,GAC9BA,EAAA,YAAYG,EAAG,MAAM,GAExB1M,EAAA0M,EAAA,aAAa,oBAAoB,IAAjC,MAAA1M,EAAoC,aACzC,GACC,CAACmM,CAAS,CAAC,EAENxQ,MAAA,OAAI,IAAK2Q,EAAQ,UAAU,gBAAgB,CACrD,ECnMMsB,GAA0C,CAAC,CAC/C,SAAAC,EAAW,IAAM,CAAC,EAClB,MAAAtP,EAAQ,qCACR,SAAAuP,EAAW,qDACX,WAAAC,EAAa,GACb,UAAAC,EAAY,GACZ,OAAAlB,EAAS,YACT,MAAAmB,CACF,IAAwB,CACtB,KAAM,CAACC,EAAYC,CAAa,EAAI3N,EAAM,SAAS,EAAE,EAE/C4N,EAAgB5L,GAAuB,CAC3CA,EAAE,eAAe,EACjBqL,EAASK,CAAU,CACrB,EAEMG,EAA0B,IAAM,CACpC,QAAQ,IAAI,gCAAgC,CAC9C,EAEA,OACG5P,EAAA,YAAI,UAAW,mBAAmBqO,CAAM,+BAEvC,UAACrO,OAAA,OAAI,UAAU,mBACb,UAAA9C,EAAA,IAACsQ,GAAA,CACC,WAAY,CAAC,UAAW,UAAW,SAAS,EAC5C,MAAO,GACP,UAAW,IACX,MAAO,GACT,EACAtQ,MAAC,MAAI,WAAU,kDAAmD,IACpE,EAGA8C,OAAC,MAAI,WAAU,8IACb,UAAA9C,EAAA,IAACsO,GAAA,CACC,KAAM1L,EACN,UAAU,6DACV,MAAO,GACP,cAAe,CAAE,QAAS,EAAG,UAAW,uBAAwB,EAChE,YAAa,CAAE,QAAS,EAAG,UAAW,oBAAqB,EAC3D,OAASf,GAAc,EAAI,KAAK,IAAI,EAAIA,EAAG,CAAC,EAC5C,UAAW,GACX,WAAW,QACX,0BAA2B6Q,CAAA,CAC7B,EACC1S,EAAA,SAAE,UAAU,kEACV,SACHmS,EAAA,EAGCC,GACCpS,EAAA,IAAC,QACC,SAAUyS,EACV,UAAU,sCAEV,SAAA3P,EAAA,KAAC,MAAI,WAAU,WACb,UAAA9C,EAAA,IAACoL,EAAA,CACC,KAAK,OACL,YAAY,qDACZ,MAAOmH,EACP,SAAW1L,GAAM2L,EAAc3L,EAAE,OAAO,KAAK,EAC7C,UAAU,+IACZ,EACA7G,EAAA,IAAC0F,EAAA,CACC,KAAK,SACL,KAAK,KACL,QAAQ,QACR,UAAU,iEAEV,SAAA1F,MAAC2S,GAAO,WAAU,4DAA6D,IACjF,CACF,IACF,CAEJ,IACF,CAEJ,EC3FMC,EAAOhT,EAGX,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC,OACC,IAAAD,EACA,UAAWhB,EACT,wDACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACD8S,EAAK,YAAc,OAEnB,MAAMC,EAAajT,EAGjB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC,OACC,IAAAD,EACA,UAAWhB,EAAG,gCAAiCc,CAAS,EACvD,GAAGC,CAAA,CACN,CACD,EACD+S,EAAW,YAAc,aAEzB,MAAMC,GAAYlT,EAGhB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC,MACC,IAAAD,EACA,UAAWhB,EAAG,4CAA6Cc,CAAS,EACnE,GAAGC,CAAA,CACN,CACD,EACDgT,GAAU,YAAc,YAExB,MAAMC,GAAkBnT,EAGtB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC,KACC,IAAAD,EACA,UAAWhB,EAAG,gCAAiCc,CAAS,EACvD,GAAGC,CAAA,CACN,CACD,EACDiT,GAAgB,YAAc,kBAE9B,MAAMC,EAAcpT,EAGlB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAS,EAAAC,UACzB,MAAI,KAAAA,EAAU,UAAWhB,EAAG,WAAYc,CAAS,EAAI,GAAGC,EAAO,CACjE,EACDkT,EAAY,YAAc,cAE1B,MAAMC,GAAarT,EAGjB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC,OACC,IAAAD,EACA,UAAWhB,EAAG,6BAA8Bc,CAAS,EACpD,GAAGC,CAAA,CACN,CACD,EACDmT,GAAW,YAAc,aCpEzB,MAAMC,GAAgB/S,GACpB,yKACA,CACE,SAAU,CACR,QAAS,CACP,QACE,4EACF,UACE,kFACF,YACE,wFACF,QAAS,kBACT,QAAS,uDACT,QAAS,0DACT,QAAS,kGAEb,EACA,gBAAiB,CACf,QAAS,UACX,CAEJ,EAMA,SAASgT,GAAM,CAAE,UAAAtT,EAAW,QAAAQ,EAAS,GAAGP,GAAqB,CAC3D,OACGE,MAAA,OAAI,UAAWjB,EAAGmU,GAAc,CAAE,QAAA7S,CAAS,GAAGR,CAAS,EAAI,GAAGC,CAAO,EAE1E,CCsBO,SAASsT,GAAa,CAC3B,GAAAnR,EACA,QAAAoR,EACA,MAAAC,EACA,cAAAC,EACA,SAAAC,EACA,UAAAC,EACA,UAAAC,EAAY,GACZ,aAAAC,EAAe,cACf,YAAA9Q,EACA,UAAA+Q,EACA,OAAAC,EACA,eAAAC,EACA,eAAAC,EACA,gBAAAC,EACA,UAAAC,EACA,aAAAC,EAAe,GACf,KAAA7I,EAAO,UACP,OAAA8I,EAAS,GACT,OAAAC,EAAS,CAAC,EACV,QAAAC,EACA,gBAAAC,EACA,YAAAC,EACA,YAAAlI,CACF,EAAsB,CACd,MAAAH,EAAkB,CAAC,CAACqI,EAEpB,CAACC,EAASC,CAAU,EAAI5P,EAAM,SAAS,EAAK,EAE5C6P,EAAoB7N,GAAwB,CAChDA,EAAE,gBAAgB,EAClB4N,EAAW,CAACD,CAAO,CACrB,EAEMG,EAAe9N,GAAwB,CAC3CA,EAAE,gBAAgB,EACV,YAAI,kBAAmB5E,CAAE,CACnC,EAEM2S,EAAuB/N,GAAwB,CACnDA,EAAE,gBAAgB,EACdgN,GAAUS,GACZA,EAAgBT,EAAO,EAAE,CAE7B,EAEMgB,EAAWT,GAAUA,EAAO,OAAS,EACvCA,EAAO,CAAC,EACR,iEAAiEnS,CAAE,GAGrE,OAAAa,EAAA,KAAC8P,EAAA,CACC,UAAU,mEACV,QAAAyB,EAEA,UAACvR,OAAA,OAAI,UAAU,iDACb,UAAA9C,EAAA,IAAC,OACC,IAAK6U,EACL,IAAKxB,EACL,UAAU,6BACV,QAAQ,OACV,EACCK,GACC1T,EAAA,IAAC,MAAI,WAAU,wBACb,SAAAA,MAACmT,GAAM,SAAQ,YAAY,UAAU,yDAAyD,mBAE9F,GACF,EAEDgB,GACCnU,EAAA,IAAC,MAAI,WAAU,wBACb,SAAAA,MAACmT,GAAM,SAAQ,YAAY,UAAU,iDAAiD,0BAEtF,GACF,EAEDY,SACE,MAAI,WAAU,yBACb,SAACjR,OAAAqQ,GAAA,CAAM,UAAU,4BACd,UAAAY,EAAe,SAClB,CACF,IAEJ,EAEAjR,OAAC+P,EAAW,WAAU,WACpB,UAAC/P,OAAA,OAAI,UAAU,wCACb,UAAA9C,MAAC,KAAG,WAAU,wBAAyB,SAAAb,EAAemU,CAAK,EAAE,EAC5DQ,GACE9T,MAAA,OAAI,UAAU,6CACZ,SAAAb,EAAe2U,CAAc,CAChC,IAEJ,EACC9T,EAAA,SAAE,UAAU,qCAAsC,SAAQqT,CAAA,IAC7D,EAEAvQ,OAACkQ,EAAY,WAAU,WACnB,WAAAQ,GAAYC,GAAaF,IACxBzQ,OAAA,OAAI,UAAU,oCACZ,UAAa0Q,IAAA,eACX,MACC,WAACxT,EAAA,YAAK,UAAU,cAAe,SAASwT,EAAA,EAAQ,UAC/C,OAAK,WAAU,wBACb,SAAaA,IAAA,EAAI,MAAQ,MAC5B,IACF,EAEDC,IAAc,QACb3Q,OAAC,MACC,WAAC9C,EAAA,YAAK,UAAU,cAAe,SAAUyT,EAAA,EAAQ,UAChD,OAAK,WAAU,wBACb,SAAcA,IAAA,EAAI,OAAS,OAC9B,IACF,EAEDF,IAAkB,QACjBzQ,OAAC,MACC,WAAA9C,MAAC,OAAK,WAAU,cAAe,SAAAT,GAAagU,CAAa,EAAE,EAAQ,IAClEvT,EAAA,YAAK,UAAU,wBAAwB,SAAK,UAC/C,IAEJ,EAGDgU,GACClR,EAAA,KAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,gCAAgC,SAAiB,sBAChEA,EAAA,YAAK,UAAU,sBAAuB,SAAgBgU,CAAA,IACzD,EAGDC,GACCnR,EAAA,KAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,gCAAgC,SAAW,gBAC1DA,EAAA,YAAK,UAAU,sBAAuB,SAAUiU,CAAA,IACnD,EAGDpR,GACC7C,EAAA,IAAC,IAAE,WAAU,kDACV,SACH6C,EAAA,EAGFC,OAAC,MAAI,WAAU,yCACb,UAAA9C,MAAC,MAAI,WAAU,gCACZ,SAAAX,GAAWuU,CAAS,EACvB,EACA9Q,OAAC,MAAI,WAAU,iBACZ,UAAAoJ,GAEGpJ,EAAA,KAAA6D,WAAA,WAAA3G,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,KAAK,OACL,UAAU,UACV,QAASgP,EAET,SAAA1U,EAAA,IAAC8U,GAAA,CACC,UAAW,WACTN,EAAU,4BAA8B,EAC1C,IACF,CACF,EACCX,GACC7T,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,KAAK,OACL,UAAU,UACV,QAASkP,EAET,SAAA5U,MAAC8N,GAAc,WAAU,SAAU,IACrC,EAEJ,EAEF9N,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,KAAK,OACL,UAAU,UACV,QAASiP,EAET,SAAA3U,MAAC+U,GAAM,WAAU,SAAU,IAC7B,CACF,GACF,GACF,IACF,CAEJ,CCrPA,MAAMhS,GAAc,2CACdiS,GAAkB,mNAExB,QAAQ,IAAI,qBAAsBA,EAAe,EAMpC,MAAA/R,EAAWC,GAAaH,GAAaiS,GAAiB,CACjE,KAAM,CACJ,eAAgB,GAChB,QAAS,OAAO,aAChB,WAAY,sBACZ,iBAAkB,GAClB,mBAAoB,GACpB,SAAU,OAEd,CAAC,ECjBYC,GAAqB,CAChC,MAAO,CACL,KAAM,QACN,MAAO,QACP,QAAS,iCACT,SAAU,CACR,wBACA,0BACA,sBACA,gBAEJ,EACA,IAAK,CACH,KAAM,MACN,MAAO,SACP,QAAS,iCACT,SAAU,CACR,2BACA,4BACA,2BACA,4BACA,mBAEJ,EACA,QAAS,CACP,KAAM,UACN,MAAO,SACP,QAAS,iCACT,SAAU,CACR,mBACA,gCACA,sBACA,4BACA,4BACA,qBACF,CAEJ,EAEsB,eAAAC,GAAsBC,EAAiB7R,EAAgB,CACvE,IACF,MAAM8R,EAAW,MAAM,MACrB,8FACA,CACE,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,QAAAD,EACA,OAAA7R,CACD,GAEL,EAEM,CAAE,UAAA+R,CAAA,EAAc,MAAMD,EAAS,KAAK,EACpCE,EAAS,MAAMC,GAAW,MAAsC,EAElED,GACF,MAAMA,EAAO,mBAAmB,CAAE,UAAAD,EAAW,QAExC7R,EAAO,CACN,oBAAM,mCAAoCA,CAAK,EACjDA,CAAA,CAEV,CC7CO,SAASgS,GAAU,CACxB,OAAAhP,EACA,QAAAC,EACA,YAAAgP,EAAc,QAChB,EAAmB,CACjB,KAAM,CAACC,EAAMC,CAAO,EAAI9Q,EAAM,SAAmB4Q,CAAW,EAC5D5Q,EAAM,UAAU,IAAM,CACpB8Q,EAAQF,CAAW,GAClB,CAACA,CAAW,CAAC,EAChB,KAAM,CAACG,EAAcC,CAAe,EAAIhR,EAAM,SAAS,EAAK,EACtD,CAACiR,EAAkBC,CAAmB,EAAIlR,EAAM,SAAS,EAAK,EAC9D,CAAE,OAAAmR,EAAQ,OAAAC,EAAQ,iBAAAC,CAAA,EAAqBpR,GAAQ,EAC/C,CAAE,MAAAlD,CAAM,EAAIS,GAAS,EAErB,CAAC8T,EAAUC,CAAW,EAAIvR,EAAM,SAAS,CAC7C,MAAO,GACP,SAAU,GACV,UAAW,GACX,SAAU,GACX,EAEK4N,EAAe,MAAO5L,GAAuB,CACjDA,EAAE,eAAe,EACjBgP,EAAgB,EAAI,EAEhB,IACF,GAAIH,IAAS,SACE,MAAMM,EAAOG,EAAS,MAAOA,EAAS,QAAQ,IAEnDvU,EAAA,CACJ,MAAO,gBACP,YAAa,mCACd,EACU,eAAM6E,EAAQ,EAAG,GAAG,OAE5B,CACL,MAAM9C,EAAO,MAAMsS,EACjBE,EAAS,MACTA,EAAS,SACTA,EAAS,UACTA,EAAS,QACX,EAGME,EAAiB,aAAa,QAClC,+BACF,EACIA,GAAkB1S,GAAQ,OAAQA,GACpC,aAAa,WAAW,+BAA+B,EACjD,MAAAuR,GAAsBmB,EAAgB1S,EAAK,EAAE,IAEnDoS,EAAoB,EAAI,EAClBnU,EAAA,CACJ,MAAO,0BACP,YACE,2DACH,EACH,QAEK4B,EAAY,CACb5B,EAAA,CACJ,MAAO,QACP,YAAa4B,EAAM,SAAW,oBAC9B,QAAS,cACV,SACD,CACAqS,EAAgB,EAAK,EAEzB,EAEA,OAAIC,EAEA9V,EAAA,IAACmK,IAAO,KAAM3D,EAAQ,aAAcC,EAClC,SAAA3D,EAAA,KAAC6H,GAAc,WAAU,mBACvB,UAAA7H,OAACgI,GACC,WAAA9K,MAACgL,IAAY,SAAuB,4BACpClI,OAACoI,GAAkB,WAAU,YAC3B,UAAClL,EAAA,SAAE,UAAU,mCAAmC,SAEhD,gEACAA,MAAC,KAAE,SAIH,0IACCA,EAAA,SAAE,UAAU,gCAAgC,SAG7C,mHACAA,MAAC,OAAI,UAAU,oCACb,eAAC,IAAE,WAAU,sBAAsB,8KAInC,EACF,GACF,IACF,EACAA,MAAC,MAAI,WAAU,+BACb,SAAAA,EAAA,IAAC0F,EAAA,CACC,QAAS,IAAM,CACbqQ,EAAoB,EAAK,EACjBtP,EAAA,CACV,EACD,kBAGH,IACF,CACF,GAKFzG,EAAA,IAACmK,IAAO,KAAM3D,EAAQ,aAAcC,EAClC,SAAA3D,EAAA,KAAC6H,GAAc,WAAU,mBACvB,UAAA7H,OAACgI,GACC,WAAA9K,EAAA,IAACgL,GACE,UAAA0K,IAAS,SAAW,UAAY,iBACnC,EACC1V,EAAA,IAAAkL,GAAA,CACE,SAASwK,IAAA,SACN,4CACA,4CACN,IACF,EAEC5S,EAAA,aAAK,SAAU2P,EAAc,UAAU,iBACrC,UAAAiD,IAAS,UACR5S,OAAC,MAAI,WAAU,yBACb,UAACA,OAAA,OAAI,UAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,YAAY,SAAU,eACrCvL,EAAA,IAACoL,EAAA,CACC,GAAG,YACH,MAAO+K,EAAS,UAChB,SAAWtP,GACTuP,EAAaE,IAAU,CACrB,GAAGA,EACH,UAAWzP,EAAE,OAAO,OACpB,EAEJ,SAAQ,IACV,EACF,EACA/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,WAAW,SAAS,cACnCvL,EAAA,IAACoL,EAAA,CACC,GAAG,WACH,MAAO+K,EAAS,SAChB,SAAWtP,GACTuP,EAAaE,IAAU,CACrB,GAAGA,EACH,SAAUzP,EAAE,OAAO,OACnB,EAEJ,SAAQ,IACV,CACF,IACF,EAGF/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,QAAQ,SAAK,UAC5BvL,EAAA,IAACoL,EAAA,CACC,GAAG,QACH,KAAK,QACL,MAAO+K,EAAS,MAChB,SAAWtP,GACTuP,EAAaE,IAAU,CAAE,GAAGA,EAAM,MAAOzP,EAAE,OAAO,KAAQ,IAE5D,SAAQ,IACV,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,WAAW,SAAQ,aAClCvL,EAAA,IAACoL,EAAA,CACC,GAAG,WACH,KAAK,WACL,MAAO+K,EAAS,SAChB,SAAWtP,GACTuP,EAAaE,IAAU,CAAE,GAAGA,EAAM,SAAUzP,EAAE,OAAO,KAAQ,IAE/D,SAAQ,IACV,EACF,EAEA/D,OAAC,MAAI,WAAU,+BACb,UAAC9C,MAAA0F,EAAA,CAAO,KAAK,SAAS,SAAUkQ,EAC7B,WACG,aACAF,IAAS,SACP,UACA,gBACR,GAEC1V,MAAA0F,EAAA,CAAO,KAAK,SAAS,QAAQ,OAAO,QAAS,IAAMwQ,EAAiB,EAAG,SAAUN,EAAc,SAEhG,wBAEA5V,EAAA,IAAC0F,EAAA,CACC,KAAK,SACL,QAAQ,OACR,QAAS,IAAMiQ,EAAQD,IAAS,SAAW,SAAW,QAAQ,EAE7D,SAAAA,IAAS,SACN,iCACA,oCACN,CACF,GACF,IACF,CACF,EAEJ,CCxOA,MAAMa,GAAOC,GAEPC,GAAW7W,EAGf,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC0W,GAAA,CACC,IAAA3W,EACA,UAAWhB,EACT,4FACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACD2W,GAAS,YAAcC,GAAmB,YAE1C,MAAMC,GAAc/W,EAGlB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC4W,GAAA,CACC,IAAA7W,EACA,UAAWhB,EACT,iYACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACD6W,GAAY,YAAcC,GAAsB,YAEhD,MAAMC,GAAcjX,EAGlB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC8W,GAAA,CACC,IAAA/W,EACA,UAAWhB,EACT,kIACAc,CACF,EACC,GAAGC,CAAA,CACN,CACD,EACD+W,GAAY,YAAcC,GAAsB,YC5BzC,SAASC,GAAkB,CAAE,OAAAvQ,EAAQ,QAAAC,EAAS,YAAA8N,EAAa,YAAAlI,GAAuC,CACvG,MAAMQ,EAAWC,GAAY,EAEvBkK,EAAmBC,GAAiB,CAChC,YAAI,kBAAkBA,CAAI,OAAO,EAChCpK,EAAA,kBAAkBoK,CAAI,EAAE,EACvBxQ,EAAA,CACZ,EAGE,OAAAzG,EAAA,IAACmK,IAAO,KAAM3D,EAAQ,aAAcC,EAClC,SAAA3D,EAAA,KAAC6H,GAAc,WAAU,gDACvB,UAAA3K,MAAC8K,IACC,SAAC9K,EAAA,IAAAgL,GAAA,CAAY,UAAU,WAAW,mCAElC,CACF,GAEClI,EAAA,KAAAyT,GAAA,CAAK,aAAa,UAAU,UAAU,OACrC,UAACzT,OAAA2T,GAAA,CAAS,UAAU,+BAClB,UAACzW,EAAA,IAAA2W,GAAA,CAAY,MAAM,UAAU,SAAO,YACpC7T,OAAC6T,GAAY,OAAM,SAAS,oBAClB3W,EAAA,YAAK,UAAU,wBAAwB,SAAQ,aACzD,IACF,QAEC6W,GAAY,OAAM,UACjB,SAAC/T,EAAA,YAAI,UAAU,iCACb,UAACA,OAAA,OAAI,UAAU,2DACb,UAACA,OAAA,OAAI,UAAU,YACb,UAAC9C,EAAA,UAAG,UAAU,wBAAwB,SAAK,UAC1CA,EAAA,SAAE,UAAU,gCAAgC,SAE7C,sDACA8C,OAAC,MAAI,WAAU,4BACb,UAAC9C,EAAA,YAAK,UAAU,qBAAqB,SAAK,UACzCA,EAAA,YAAK,UAAU,wBAAwB,SAAM,WAChD,IACF,EAEA8C,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAAmB,yBAC/C,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAAkB,wBAC9C,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAAuB,4BACnD,IACF,EAEAA,EAAA,IAAC0F,EAAA,CACC,UAAU,SACV,QAAS,IAAMsR,EAAgB,OAAO,EAErC,UAAA3K,GAAA,YAAAA,EAAa,qBAAsB,QAAU,eAAiB,aACjE,EACF,EAEAvJ,OAAC,MAAI,WAAU,wIACb,UAAC9C,EAAA,WAAI,UAAU,4FAA4F,SAE3G,YACA8C,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,UAAG,UAAU,wBAAwB,SAAG,QACxCA,EAAA,SAAE,UAAU,gCAAgC,SAE7C,mDACA8C,OAAC,MAAI,WAAU,4BACb,UAAC9C,EAAA,YAAK,UAAU,qBAAqB,SAAM,WAC1CA,EAAA,YAAK,UAAU,wBAAwB,SAAM,WAChD,IACF,EAEA8C,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC9D3J,MAAC,QAAK,UAAU,UACd,eAAC,OAAK,WAAU,cAAc,8BAAmB,EACnD,IACF,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAA2B,iCACvD,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAAmB,yBAC/C,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAA2B,iCACvD,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAAyB,8BACrD,IACF,EAEAA,EAAA,IAAC0F,EAAA,CACC,UAAU,uCACV,QAAS,IAAMsR,EAAgB,KAAK,EAEnC,UAAA3K,GAAA,YAAAA,EAAa,qBAAsB,MAAQ,eAAiB,aAC/D,CACF,IACF,CACF,SAECwK,GAAY,OAAM,SACjB,SAAC/T,EAAA,YAAI,UAAU,iCACb,UAACA,OAAA,OAAI,UAAU,2DACb,UAAC9C,EAAA,WAAI,UAAU,2IAA2I,SAE1J,aACA8C,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,UAAG,UAAU,wBAAwB,SAAY,iBACjDA,EAAA,SAAE,UAAU,gCAAgC,SAE7C,sDACA8C,OAAC,MAAI,WAAU,4BACb,UAAC9C,EAAA,YAAK,UAAU,qBAAqB,SAAM,WAC1CA,EAAA,YAAK,UAAU,wBAAwB,SAAK,WAC/C,EACCA,EAAA,SAAE,UAAU,gCAAgC,SAE7C,+BACF,EAEA8C,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAAmB,yBAC/C,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAAkB,wBAC9C,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAAuB,4BACnD,IACF,EAEAA,EAAA,IAAC0F,EAAA,CACC,UAAU,SACV,QAAS,IAAMsR,EAAgB,cAAc,EAE5C,2BAAa,qBAAsB,UAAW3K,GAAA,YAAAA,EAAa,uBAAwB,SAChF,eACA,aACN,EACF,EAEAvJ,OAAC,MAAI,WAAU,wIACb,UAAC9C,EAAA,WAAI,UAAU,4FAA4F,SAE3G,eACCA,EAAA,WAAI,UAAU,4IAA4I,SAE3J,aACA8C,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,UAAG,UAAU,wBAAwB,SAAU,eAC/CA,EAAA,SAAE,UAAU,gCAAgC,SAE7C,mDACA8C,OAAC,MAAI,WAAU,4BACb,UAAC9C,EAAA,YAAK,UAAU,qBAAqB,SAAO,YAC3CA,EAAA,YAAK,UAAU,wBAAwB,SAAK,WAC/C,EACCA,EAAA,SAAE,UAAU,gCAAgC,SAE7C,gCACF,EAEA8C,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC9D3J,MAAC,QAAK,UAAU,UACd,eAAC,OAAK,WAAU,cAAc,8BAAmB,EACnD,IACF,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAA2B,iCACvD,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAAmB,yBAC/C,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAA2B,iCACvD,EACA8C,OAAC,MAAI,WAAU,yBACb,UAAC9C,MAAA2J,GAAA,CAAU,UAAU,wCAAyC,GAC7D3J,EAAA,YAAK,UAAU,UAAU,SAAyB,8BACrD,IACF,EAEAA,EAAA,IAAC0F,EAAA,CACC,UAAU,uCACV,QAAS,IAAMsR,EAAgB,YAAY,EAE1C,2BAAa,qBAAsB,QAAS3K,GAAA,YAAAA,EAAa,uBAAwB,SAC9E,eACA,aACN,CACF,IACF,CACF,IACF,EAEArM,EAAA,IAAC+K,GAAa,WAAU,OACtB,SAAA/K,MAAC0F,EAAO,SAAQ,UAAU,QAASe,EAAS,kBAE5C,CACF,IACF,CACF,EAEJ,CCnPA,MAAMyQ,GAAgB,CACpB,WACA,UAEF,EAEA,SAASC,GAAgB5I,EAAsB,CACzC,IAAA6I,EAAe7I,EAAK,YAAY,EACtB,OAAA2I,GAAA,QAASjI,GAAS,CAC9B,MAAMoI,EAAQ,IAAI,OAAOpI,EAAM,IAAI,EACnCmI,EAAeA,EAAa,QAAQC,EAAO,IAAI,OAAOpI,EAAK,MAAM,CAAC,EACnE,EACMmI,CACT,CA0CsB,eAAAE,GAAYC,EAAoBC,EAAiBC,EAAsD,CACvH,IACI,MAAE,KAAM9T,EAAM,MAAO+T,GAAc,MAAMzU,EAAS,KAAK,QAAQ,EACjE,GAAAyU,GAAa,CAAC/T,EAAK,KACb,oBAAM,wBAAyB+T,CAAS,EAC1C,IAAI,MAAM,wBAAwB,EAG1C,QAAQ,IAAI,mBAAoB,CAC9B,UAAW/T,EAAK,KAAK,GACrB,YAAa4T,EACb,QAASE,EACT,QAASD,EAAQ,UAAU,EAAG,EAAE,EAAI,MACrC,EAEK,MAAE,KAAAjU,EAAM,MAAAC,GAAU,MAAMP,EAC3B,KAAK,UAAU,EACf,OAAO,CACN,UAAWU,EAAK,KAAK,GACrB,YAAa4T,EACb,QAASJ,GAAgBK,CAAO,EAChC,QAASC,EACT,QAAS,EACV,GACA,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA,OAKP,EACA,OAAO,EAEV,GAAIjU,EACM,oBAAM,kBAAmBA,CAAK,EAChCA,EAGR,GAAI,CAACD,EACH,cAAQ,MAAM,8BAA8B,EACtC,IAAI,MAAM,wBAAwB,EAG1C,eAAQ,IAAI,6BAA8B,CAAE,UAAWA,EAAK,GAAI,EACzDA,QACAC,EAAO,CACN,qBAAM,yBAA0BA,CAAK,EACtC,KAEX,CAGA,eAAsBmU,IAA4C,CAC5D,IAEI,MAAE,KAAM,CAAE,QAAA7T,GAAW,MAAO8T,CAAA,EAAiB,MAAM3U,EAAS,KAAK,WAAW,EAElF,GAAI2U,EACM,qBAAM,qCAAsCA,CAAY,EACzD,CAAC,EAIV,GAAI,CAAC9T,EAAS,CACZ,QAAQ,IAAI,uEAAuE,EAC7E,MAAE,KAAM+T,EAAU,MAAOH,GAAc,MAAMzU,EAAS,KAAK,QAAQ,EAErE,GAAAyU,GAAa,EAACG,GAAA,MAAAA,EAAU,MAClB,qBAAM,8CAA+CH,GAAa,cAAc,EACjF,CAAC,EAGJpU,QAASuU,EAAS,KAAK,GACrB,mBAAI,2BAA2BvU,CAAM,EAAE,EAExC,MAAMwU,GAA0BxU,CAAM,EAIzC,MAAAA,EAASQ,EAAQ,KAAK,GACpB,mBAAI,yCAAyCR,CAAM,EAAE,EAEtD,MAAMwU,GAA0BxU,CAAM,QACtCE,EAAO,CACN,qBAAM,+BAAgCA,CAAK,EAC5C,CAAC,EAEZ,CAGA,eAAesU,GAA0BxU,EAAyC,CAE1E,MAAE,KAAAC,EAAM,MAAAC,GAAU,MAAMP,EAC3B,KAAK,UAAU,EACf,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA,KAKP,EACA,OAAO,YAAa,KAAMK,CAAM,EAChC,OAAO,cAAe,KAAMA,EAAQ,CAAE,aAAc,KAAM,EAC1D,MAAM,aAAc,CAAE,UAAW,GAAO,EAE3C,GAAIE,EACM,qBAAM,gCAAiCA,CAAK,EAC7C,CAAC,EAIJ,MAAAuU,MAAuB,IAEvB,OAAAxU,GAAA,MAAAA,EAAA,QAASyU,GAAiC,CAC9C,MAAMC,EAAYD,EAAQ,YAAc1U,EAAS0U,EAAQ,SAAWA,EAAQ,OACtEE,EAAiBD,EAAU,GAEjC,GAAI,CAACF,EAAiB,IAAIG,CAAc,EACtCH,EAAiB,IAAIG,EAAgB,CACnC,KAAMD,EACN,YAAaD,EACb,YAAaA,EAAQ,cAAgB1U,GAAU,CAAC0U,EAAQ,QAAU,EAAI,EACvE,UACQA,EAAQ,cAAgB1U,GAAU,CAAC0U,EAAQ,QAAS,CACvD,MAAAG,EAAeJ,EAAiB,IAAIG,CAAc,EAC3CC,EAAA,cACf,GAGK,MAAM,KAAKJ,EAAiB,QAAQ,CAC7C,CAGA,eAAsBK,GAAYC,EAAqD,CACjF,IACI,MAAE,KAAM1U,EAAM,MAAO+T,GAAc,MAAMzU,EAAS,KAAK,QAAQ,EACjE,GAAAyU,GAAa,CAAC/T,EAAK,KACb,oBAAM,wBAAyB+T,CAAS,EAC1C,IAAI,MAAM,wBAAwB,EAGlC,YAAI,+BAAgCW,CAAW,EAEjD,MAAE,KAAA9U,EAAM,MAAAC,GAAU,MAAMP,EAC3B,KAAK,UAAU,EACf,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA,OAKP,EACA,GAAG,oBAAoBU,EAAK,KAAK,EAAE,mBAAmB0U,CAAW,sBAAsBA,CAAW,mBAAmB1U,EAAK,KAAK,EAAE,GAAG,EACpI,MAAM,aAAc,CAAE,UAAW,GAAM,EAE1C,GAAIH,EACM,oBAAM,kBAAmBA,CAAK,EAChCA,EAGR,QAAQ,IAAI,UAASD,GAAA,YAAAA,EAAM,SAAU,CAAC,WAAW,EAGjD,MAAM+U,GAAiB/U,GAAA,YAAAA,EAAM,OAC1ByU,GAAYA,EAAQ,cAAgBrU,EAAK,KAAK,IAAM,CAACqU,EAAQ,WAC3D,CAAC,EAEF,GAAAM,EAAe,OAAS,EAAG,CAC7B,QAAQ,IAAI,WAAWA,EAAe,MAAM,mBAAmB,EACzD,MAAE,MAAOC,GAAgB,MAAMtV,EAClC,KAAK,UAAU,EACf,OAAO,CAAE,QAAS,GAAM,EACxB,GAAG,KAAMqV,EAAe,IAAKE,GAAMA,EAAE,EAAE,CAAC,EAEvCD,GACM,cAAM,kCAAmCA,CAAW,CAC9D,CAGF,OAAOhV,GAAQ,CAAC,QACTC,EAAO,CACN,qBAAM,0BAA2BA,CAAK,EACvC,CAAC,EAEZ,CAGO,SAASiV,GAAoBC,EAAkD,CAChF,IA8BK,OA7BczV,EAClB,QAAQ,UAAU,EAClB,GACC,mBACA,CACE,MAAO,SACP,OAAQ,SACR,MAAO,UACT,EACA,MAAO0V,GAAY,CAEX,MAAE,KAAApV,EAAM,MAAAC,GAAU,MAAMP,EAC3B,KAAK,UAAU,EACf,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA,aAKP,EACA,GAAG,KAAM0V,EAAQ,IAAI,EAAE,EACvB,OAAO,EAEN,CAACnV,GAASD,GACZmV,EAASnV,CAAI,CACf,GAGH,UAAU,QAGNC,EAAO,CACN,qBAAM,iCAAkCA,CAAK,EAC9C,KAEX,CAmBA,eAAsBoV,GAAYrG,EAAoB,CAChD,IACE,IAAAjP,EAGE,MAAE,KAAM,CAAE,QAAAQ,CAAA,CAAc,QAAMb,EAAS,KAAK,WAAW,EAE7D,GAAIa,EACFR,EAASQ,EAAQ,KAAK,GACd,YAAI,kCAAkCR,CAAM,EAAE,MACjD,CAEC,MAAE,KAAMuU,EAAU,MAAOH,GAAc,MAAMzU,EAAS,KAAK,QAAQ,EAErE,GAAAyU,GAAa,EAACG,GAAA,MAAAA,EAAU,MAClB,oBAAM,oCAAqCH,CAAS,EACtD,IAAI,MAAM,yCAAyC,EAG3DpU,EAASuU,EAAS,KAAK,GACf,YAAI,oCAAoCvU,CAAM,EAAE,EAItD,IAAAuV,EAAQ5V,EACT,KAAK,UAAU,EACf,OAAO,kCAAkC,EACzC,IAAI,KAAMK,CAAM,EAGf,GAAAiP,GAAcA,EAAW,OAAQ,CACnC,MAAMuG,EAAgB,IAAIvG,EAAW,MAAM,IAG3CsG,EAAQA,EAAM,GACZ,mBAAmBC,CAAa,gBAAgBA,CAAa,EAC/D,EAIF,KAAM,CAAE,KAAAvV,EAAM,MAAAC,CAAM,EAAI,MAAMqV,EAE9B,OAAIrV,GACM,cAAM,iCAAkCA,CAAK,EAC9C,CAAC,IAGV,QAAQ,IAAI,iBAAgBD,GAAA,YAAAA,EAAM,SAAU,CAAC,QAAQ,EAC9CA,GAAQ,CAAC,SACTC,EAAO,CACN,qBAAM,wBAAyBA,CAAK,EACrC,CAAC,EAEZ,CCvVO,SAASuV,GAAe,CAAE,KAAApT,EAAO,KAAM,UAAA9F,GAAkC,CAC9E,MAAMmZ,EAAc,CAClB,GAAI,UACJ,GAAI,UACJ,GAAI,SACN,EAGE,OAAAhZ,EAAA,IAAC,OACC,UAAWjB,EACT,yEACAia,EAAYrT,CAAI,EAChB9F,CAAA,CACF,CACF,CAEJ,CCLO,MAAMoZ,GAA8C,CAAC,CAC1D,OAAAzS,EACA,QAAAC,EACA,WAAA8Q,EACA,OAAAE,CACF,IAAM,CACE,MAAE,KAAA9T,CAAK,EAAImB,GAAQ,EACnB,CAACoU,EAAUC,CAAW,EAAItV,WAAgC,EAAE,EAC5D,CAACuV,EAAYC,CAAa,EAAIxV,WAAS,EAAE,EACzC,CAACK,EAAWC,CAAY,EAAIN,WAAS,EAAK,EAC1C,CAACyV,EAAUC,CAAW,EAAI1V,WAAc,IAAI,EAC5C2V,EAAiBnK,SAAuB,IAAI,EAElD7K,YAAU,IAAM,CACVgC,GAAU+Q,EACCkC,EAAA,GAEbN,EAAY,EAAE,EACdE,EAAc,EAAE,EAClB,EACC,CAAC7S,EAAQ+Q,CAAU,CAAC,EAEvB/S,YAAU,IAAM,CACCkV,EAAA,GACd,CAACR,CAAQ,CAAC,EAEb,MAAMO,EAAe,SAAY,CAC/B,GAAKlC,EAED,IACFpT,EAAa,EAAI,EACX,MAAAZ,EAAO,MAAM6U,GAAYb,CAAU,EAIrC,GAHJ4B,EAAY5V,CAAI,EAGZA,EAAK,OAAS,EAAG,CACb,MAAAoW,EAAMpW,EAAK,CAAC,EACZqW,EAAeD,EAAI,aAAchW,GAAA,YAAAA,EAAM,IAAKgW,EAAI,SAAWA,EAAI,OACrEJ,EAAYK,CAAY,SAEnBpW,EAAO,CACN,cAAM,0BAA2BA,CAAK,SAC9C,CACAW,EAAa,EAAK,EAEtB,EAEM0V,EAAoB,MAAOhT,GAAuB,CAEtD,GADAA,EAAE,eAAe,EACb,GAAC0Q,GAAc,CAAC6B,EAAW,QAE3B,IACF,MAAMpB,EAAU,MAAMV,GAAYC,EAAY6B,EAAW,OAAQ3B,CAAM,EACnEO,IACFmB,EAAoB7C,GAAA,CAAC,GAAGA,EAAM0B,CAAO,CAAC,EACtCqB,EAAc,EAAE,SAEX7V,EAAO,CACN,cAAM,yBAA0BA,CAAK,EAEjD,EAEMkW,EAAiB,IAAM,QAC3BrV,EAAAmV,EAAe,UAAf,MAAAnV,EAAwB,eAAe,CAAE,SAAU,UACrD,EAEA,OACGrE,MAAAmK,GAAA,CAAO,KAAM3D,EAAQ,aAAepE,GAAS,CAACA,GAAQqE,EAAQ,EAC7D,SAAC3D,EAAA,KAAA6H,GAAA,CAAc,UAAU,yBACvB,UAAC3K,EAAA,IAAA8K,GAAA,CACC,eAACE,GACE,UAAAsO,EAAW,iBAAiBA,EAAS,SAAS,GAAK,UACtD,GACF,EAEAxW,OAAC,MAAI,WAAU,0BACZ,UACCoB,EAAAlE,EAAA,IAAC,MAAI,WAAU,0CACb,SAAAA,MAAC+Y,GAAe,IAClB,EAEAjW,OAACiD,GAAW,WAAU,mBACnB,UAASmT,EAAA,SAAW,EACnBlZ,EAAA,IAAC,MAAI,WAAU,gEAAgE,SAE/E,+DAEAkZ,EAAS,IACPlB,GAAAlV,EAAA,KAAC,OAEC,UAAW,aACTkV,EAAQ,aAAcrU,GAAA,YAAAA,EAAM,IAAK,cAAgB,eACnD,GAEC,UAAAqU,EAAQ,aAAcrU,GAAA,YAAAA,EAAM,KAC1Bb,OAAAmF,GAAA,CAAO,UAAU,YAChB,UAAAjI,EAAA,IAACmI,GAAY,KAAK6P,EAAQ,OAAO,WAAY,QAC5C3P,GACE,UAAA2P,EAAQ,OAAO,UAAU,OAAO,CAAC,CACpC,IACF,EAEFlV,EAAA,KAAC,OACC,UAAW,eACTkV,EAAQ,aAAcrU,GAAA,YAAAA,EAAM,IACxB,qCACA,UACN,kBAEA,UAAC3D,MAAA,KAAG,WAAQ,OAAQ,GACnBA,MAAA,KAAE,UAAU,0BACV,YAAoB,IAAI,KAAKgY,EAAQ,UAAU,EAAG,CAAE,UAAW,EAAM,EACxE,KACF,GAxBKA,EAAQ,GA0BhB,EAEHhY,MAAC,MAAI,KAAKwZ,CAAgB,IAC5B,EAGD1W,EAAA,aAAK,SAAU+W,EAAmB,UAAU,aAC3C,UAAA7Z,EAAA,IAACoL,EAAA,CACC,MAAOgO,EACP,SAAUvS,GAAKwS,EAAcxS,EAAE,OAAO,KAAK,EAC3C,YAAY,oBACZ,UAAS,GACX,EACA7G,MAAC0F,EAAO,MAAK,SAAS,KAAK,OACzB,SAAC1F,EAAA,IAAA8Z,GAAA,CAAK,UAAU,SAAU,EAC5B,GACF,GACF,IACF,CACF,EAEJ,ECxJO,SAASC,IAAa,CAC3B,KAAM,CAACC,EAAMC,CAAO,EAAIpV,EAAM,SAAiB,EAAE,EAS7C,OAPJA,EAAM,UAAU,IAAM,CACd,oEAA8D,EACjE,KAAMuQ,GAAaA,EAAS,KAAM,GAClC,KAAM7R,GAAS0W,EAAQ1W,EAAK,IAAI,CAAC,EACjC,MAAOC,GAAU,QAAQ,MAAM,8BAA+BA,CAAK,CAAC,CACzE,EAAG,EAAE,EAEAwW,EAGHlX,EAAA,KAAC,MAAI,WAAU,gDACb,UAAC9C,MAAAka,GAAA,CAAU,UAAU,SAAU,GAC/Bla,MAAC,KAAG,SAAKga,CAAA,IACX,EANgB,IAQpB,CCnBO,SAASG,IAAS,CACvB,aACG,SAAO,WAAU,uCAChB,SAACrX,EAAA,YAAI,UAAU,yBACb,UAACA,OAAA,OAAI,UAAU,wCACb,UAAAA,OAAC,MACC,WAAC9C,EAAA,UAAG,UAAU,6BAA6B,SAAQ,aAClDA,EAAA,SAAE,UAAU,gBAAgB,SAE7B,kEACF,SACC,MACC,WAACA,EAAA,UAAG,UAAU,6BAA6B,SAAK,UAChD8C,OAAC,KAAG,WAAU,0BACZ,UAAC9C,MAAA,MACC,eAAC,IAAE,MAAK,SAAS,UAAU,mBAAmB,4BAE9C,CACF,GACAA,MAAC,MACC,SAACA,EAAA,SAAE,KAAK,WAAW,UAAU,mBAAmB,0BAEhD,CACF,GACAA,MAAC,MACC,SAACA,EAAA,SAAE,KAAK,cAAc,UAAU,mBAAmB,4BAEnD,CACF,GACAA,MAAC,MACC,SAACA,MAAA,KAAE,KAAK,QAAQ,UAAU,mBAAmB,0BAE7C,EACF,GACF,IACF,SACC,MACC,WAACA,EAAA,UAAG,UAAU,6BAA6B,SAAO,YAClD8C,OAAC,KAAG,WAAU,0BACZ,UAAA9C,MAAC,MAAG,SAAc,mBAClBA,MAAC,MAAG,SAAkE,uEACxE,IACF,SACC,MACC,WAACA,EAAA,UAAG,UAAU,6BAA6B,SAAU,qBACpD,KAAG,WAAU,0BACZ,SAACA,EAAA,UAAG,+BAAoB,EAC1B,GACF,IACF,EACA8C,OAAC,MAAI,WAAU,+CACb,UAAA9C,EAAA,IAAC+Z,GAAW,IACZjX,OAAC,MAAI,WAAU,sCACb,UAAC9C,EAAA,SAAE,UAAU,UAAU,SAEvB,0JACCA,EAAA,SAAE,UAAU,UAAU,SAGvB,8HACC,IAAE,gBAAQ,IAAI,KAAK,EAAE,YAAY,EAAE,+BAA4B,GAClE,GACF,IACF,CACF,EAEJ,CC/DA,MAAMoa,GAAgBja,GACpB,0KACA,CACE,SAAU,CACR,QAAS,CACP,QAAS,gCACT,YACE,0FAEN,EACA,gBAAiB,CACf,QAAS,UACX,CAEJ,EAEMka,GAAQza,aAGZ,CAAC,CAAE,UAAAC,EAAW,QAAAQ,EAAS,GAAGP,CAAM,EAAGC,IACnCC,EAAA,IAAC,OACC,IAAAD,EACA,KAAK,QACL,UAAWhB,EAAGqb,GAAc,CAAE,QAAA/Z,CAAS,GAAGR,CAAS,EAClD,GAAGC,CAAA,CACN,CACD,EACDua,GAAM,YAAc,QAEpB,MAAMC,GAAa1a,EAGjB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC,MACC,IAAAD,EACA,UAAWhB,EAAG,+CAAgDc,CAAS,EACtE,GAAGC,CAAA,CACN,CACD,EACDwa,GAAW,YAAc,aAEzB,MAAMC,GAAmB3a,EAGvB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC,OACC,IAAAD,EACA,UAAWhB,EAAG,gCAAiCc,CAAS,EACvD,GAAGC,CAAA,CACN,CACD,EACDya,GAAiB,YAAc,mBCpDxB,SAASC,IAAkB,CAE9B,OAAA1X,EAAA,KAACuX,GAAM,WAAU,yCACf,UAACra,MAAAya,GAAA,CAAK,UAAU,SAAU,GACzBza,EAAA,IAAAua,GAAA,CAAiB,UAAU,gCAAgC,SAM5D,oSACF,CAEJ,CCwBsB,eAAAG,GAAsBC,EAAcC,EAAiB,CACrE,IACI,MAAAC,GAASF,EAAO,GAAKC,EAEnB,YAAI,kBAAmB,0CAAiC,EAChE,QAAQ,IAAI,mCAAoC,CAAE,KAAAD,EAAM,QAAAC,EAAS,MAAAC,EAAO,EAElE,MAAE,KAAAtX,EAAM,MAAAC,GAAU,MAAMP,GAC3B,KAAK,YAAY,EACjB,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAaP,EACA,GAAG,cAAe,EAAI,EACtB,MAAM4X,EAAOA,EAAQD,EAAU,CAAC,EAChC,MAAM,aAAc,CAAE,UAAW,GAAO,EAI3C,GAFA,QAAQ,IAAI,yBAA0B,CAAE,KAAArX,EAAM,MAAAC,EAAO,EAEjDA,EACM,oBAAM,kBAAmBA,CAAK,EAChCA,EAGR,GAAI,CAACD,GAAQA,EAAK,SAAW,EAC3B,eAAQ,IAAI,qBAAqB,EAC1B,CAAC,EAIJ,MAAAuX,EAAavX,EAAK,IAAUwX,IAAA,CAChC,GAAIA,EAAE,IAAM,GACZ,MAAOA,EAAE,OAAS,GAClB,YAAaA,EAAE,aAAe,GAC9B,SAAUA,EAAE,UAAY,GACxB,MAAO,OAAOA,EAAE,KAAK,GAAK,EAC1B,KAAM,OAAOA,EAAE,IAAI,GAAK,EACxB,MAAO,OAAOA,EAAE,KAAK,GAAK,EAC1B,KAAM,OAAOA,EAAE,IAAI,GAAK,EACxB,UAAWA,EAAE,WAAa,GAC1B,YAAa,EAAQA,EAAE,YACvB,WAAYA,EAAE,YAAkB,WAAO,YAAY,EACnD,WAAYA,EAAE,YAAkB,WAAO,YAAY,GACnD,EAEM,mBAAI,qBAAsBD,CAAU,EACrCA,QAEAtX,EAAO,CACN,qBAAM,kCAAmCA,CAAK,EAC/C,CAAC,EAEZ,CAcA,eAAsBwX,GAAiBzI,EAAyC,CAC1E,IACI,MAAE,KAAAhP,EAAM,MAAAC,GAAU,MAAMP,GAC3B,KAAK,YAAY,EACjB,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAaP,EACA,GAAG;AAAA,0BACgBsP,CAAU;AAAA,6BACPA,CAAU;AAAA,uBAChBA,CAAU;AAAA,OAC1B,EACA,MAAM,aAAc,CAAE,UAAW,GAAO,EAE3C,GAAI/O,EAAa,MAAAA,EACjB,OAAOD,GAAQ,CAAC,QACTC,EAAO,CACN,qBAAM,8BAA+BA,CAAK,EAC3C,CAAC,EAEZ,CA+CA,eAAsByX,GAAmB3X,EAAgB,CACjD,MAAE,KAAAC,EAAM,MAAAC,CAAM,EAAI,MAAMP,GAC3B,KAAK,kBAAkB,EACvB,OACC;AAAA;AAAA;AAAA,OAKD,GAAG,UAAWK,CAAM,EAEvB,GAAIE,EAAa,MAAAA,EACV,OAAAD,CACT,CAEsB,eAAA2X,GAASP,EAAcC,EAAiB,CACxD,IACI,MAAAC,GAASF,EAAO,GAAKC,EAE3B,QAAQ,IAAI,8BAA+B,CAAE,KAAAD,EAAM,QAAAC,EAAS,MAAAC,EAAO,EAE7D,MAAE,KAAAtX,EAAM,MAAAC,GAAU,MAAMP,GAC3B,KAAK,OAAO,EACZ,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAaP,EACA,MAAM4X,EAAOA,EAAQD,EAAU,CAAC,EAChC,MAAM,aAAc,CAAE,UAAW,GAAO,EAI3C,GAFA,QAAQ,IAAI,+BAAgC,CAAE,KAAArX,EAAM,MAAAC,EAAO,EAEvDA,EACM,oBAAM,kBAAmBA,CAAK,EAChCA,EAGR,GAAI,CAACD,GAAQA,EAAK,SAAW,EAC3B,eAAQ,IAAI,gBAAgB,EACrB,CAAC,EAIJ,MAAA4X,EAAQ5X,EAAK,IAAU6X,IAAA,CAC3B,GAAIA,EAAE,IAAM,GACZ,MAAOA,EAAE,OAAS,GAClB,YAAaA,EAAE,aAAe,GAC9B,SAAUA,EAAE,UAAY,GACxB,MAAO,OAAOA,EAAE,KAAK,GAAK,EAC1B,eAAgB,OAAOA,EAAE,cAAc,GAAK,EAC5C,gBAAiBA,EAAE,iBAAmB,GACtC,cAAeA,EAAE,eAAiB,GAClC,UAAWA,EAAE,WAAa,GAC1B,UAAWA,EAAE,WAAa,GAC1B,WAAYA,EAAE,YAAkB,WAAO,YAAY,EACnD,WAAYA,EAAE,YAAkB,WAAO,YAAY,GACnD,EAEM,mBAAI,gBAAiBD,CAAK,EAC3BA,QAEA3X,EAAO,CACN,qBAAM,qBAAsBA,CAAK,EAClC,CAAC,EAEZ,CAEa,MAAA6X,GAAW,CAACC,EAAQ,IACxBC,GAAiB,CACtB,SAAU,CAAC,OAAO,EAClB,QAAS,CAAC,CAAE,UAAAC,EAAY,CAAQ,IAAAN,GAASM,EAAWF,CAAK,EACzD,iBAAkB,CAACG,EAAUC,IACpBD,EAAS,SAAWH,EAAQI,EAAS,OAAS,EAAI,OAE3D,UAAW,EAAI,GAAK,IACpB,UAAW,GAAK,GAAK,IACtB,EC5QUC,GAAU,CAAC,CACtB,SAAAjY,EACA,UAAAkY,EAAY,OACZ,aAAAC,EAAe,GACf,QAAAC,EAAU,GACV,KAAAC,EAAO,GACP,UAAAlc,EACA,SAAAmc,EAAW,EACb,IAEIlZ,EAAA,KAAC,OACC,UAAW/D,EACT,mCACAid,EAAW,WAAa,WACxBnc,CACF,EAEA,UAAAG,EAAA,IAAC,OACC,UAAWjB,EACT,6EACAid,EAAW,WAAa,WACxBH,GAAgB,4CAChBC,GAAW,yBACb,EAEC,SAAApY,CAAA,CACH,EACA1D,EAAA,IAAC,OACC,UAAWjB,EACT,6EACAid,EAAW,WAAa,WACxBH,GAAgB,4CAChBC,GAAW,yBACb,EAEC,SAAApY,CAAA,EACH,EACF,ECtCSuY,GAA4C,CAAC,CACxD,UAAAC,EAAY,CAAC,GAAK,GAAK,EAAG,EAC1B,MAAAnK,EAAQ,GACR,UAAAvB,EAAY,GACZ,WAAA2L,EAAa,EACb,WAAAC,EAAa,EACb,YAAAC,EAAc,GACd,GAAGvc,CACL,IAAM,CACE,MAAAwc,EAAejN,SAA8B,IAAI,EAEvD7K,mBAAU,IAAM,CACV,IAAC8X,EAAa,QAAS,OAE3B,MAAMC,EAAYD,EAAa,QACzBzL,EAAW,IAAIC,GAAS,CAAE,UAAW,GAAM,EAC3CC,EAAKF,EAAS,GACpBE,EAAG,WAAW,EAAG,EAAG,EAAG,CAAC,EAExB,MAAMyL,EAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUfC,EAAiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA4CjBrL,EAAW,IAAIC,GAASN,CAAE,EAC1BC,EAAU,IAAIU,GAAQX,EAAI,CAC9B,OAAQyL,EACR,SAAUC,EACV,SAAU,CACR,MAAO,CAAE,MAAO,CAAE,EAClB,YAAa,CACX,MAAO,IAAI,aAAa,CACtB1L,EAAG,OAAO,MACVA,EAAG,OAAO,OACVA,EAAG,OAAO,MAAQA,EAAG,OAAO,MAC7B,EACH,EACA,WAAY,CAAE,MAAO,IAAI,aAAamL,CAAS,CAAE,EACjD,WAAY,CAAE,MAAO1L,CAAU,EAC/B,YAAa,CAAE,MAAO2L,CAAW,EACjC,YAAa,CAAE,MAAOC,CAAW,EACjC,OAAQ,CAAE,MAAO,IAAI,aAAa,CAAC,EAAG,CAAC,CAAC,CAAE,EAC5C,CACD,EACKzK,EAAO,IAAIC,GAAKb,EAAI,CAAE,SAAAK,EAAU,QAAAJ,EAAS,EAE/C,SAASC,GAAS,CAEPJ,EAAA,QACP0L,EAAU,YAAc,EACxBA,EAAU,aAAe,CAC3B,EACM,MAAAG,EAAa1L,EAAQ,SAAS,YAAY,MACrC0L,EAAA,CAAC,EAAI3L,EAAG,OAAO,MACf2L,EAAA,CAAC,EAAI3L,EAAG,OAAO,OAC1B2L,EAAW,CAAC,EAAI3L,EAAG,OAAO,MAAQA,EAAG,OAAO,OAEvC,wBAAiB,SAAUE,CAAM,EACjCA,EAAA,EAEP,SAAS0L,EAAgBjY,EAAmB,CACpC,MAAAkY,EAAOL,EAAU,sBAAsB,EACvCM,GAAKnY,EAAM,QAAUkY,EAAK,MAAQA,EAAK,MACvCE,EAAI,GAAKpY,EAAM,QAAUkY,EAAK,KAAOA,EAAK,OAC1CG,EAAe/L,EAAQ,SAAS,OAAO,MAC7C+L,EAAa,CAAC,EAAIF,EAClBE,EAAa,CAAC,EAAID,CAAA,CAGpB,SAASE,EAAgBtY,EAAmB,CACtC,GAAAA,EAAM,QAAQ,OAAS,EAAG,CACtB,MAAAuY,EAAQvY,EAAM,QAAQ,CAAC,EACvBkY,EAAOL,EAAU,sBAAsB,EACvCM,GAAKI,EAAM,QAAUL,EAAK,MAAQA,EAAK,MACvCE,EAAI,GAAKG,EAAM,QAAUL,EAAK,KAAOA,EAAK,OAC1CG,EAAe/L,EAAQ,SAAS,OAAO,MAC7C+L,EAAa,CAAC,EAAIF,EAClBE,EAAa,CAAC,EAAID,CAAA,CACpB,CAGET,IACQE,EAAA,iBAAiB,YAAaI,CAAe,EAC7CJ,EAAA,iBAAiB,YAAaS,CAAe,GAGrD,IAAAE,EACJ,SAAShb,EAAOL,EAAW,CACzBqb,EAAc,sBAAsBhb,CAAM,EAC1C8O,EAAQ,SAAS,MAAM,MAAQnP,EAAI,KAAQkQ,EAC3ClB,EAAS,OAAO,CAAE,MAAOc,CAAA,CAAM,EAEjC,OAAAuL,EAAc,sBAAsBhb,CAAM,EAEhCqa,EAAA,YAAYxL,EAAG,MAAM,EAExB,IAAM,OACX,qBAAqBmM,CAAW,EACzB,2BAAoB,SAAUjM,CAAM,EACvCoL,IACQE,EAAA,oBAAoB,YAAaI,CAAe,EAChDJ,EAAA,oBAAoB,YAAaS,CAAe,GAExDjM,EAAG,OAAO,eACZA,EAAG,OAAO,cAAc,YAAYA,EAAG,MAAM,GAE5C1M,EAAA0M,EAAA,aAAa,oBAAoB,IAAjC,MAAA1M,EAAoC,aACzC,GACC,CAAC6X,EAAWnK,EAAOvB,EAAW2L,EAAYC,EAAYC,CAAW,CAAC,EAGnErc,EAAA,IAAC,OACC,IAAKsc,EACL,UAAU,gBACT,GAAGxc,CAAA,CACN,CAEJ,ECvIO,SAASqd,GAAc,CAC5B,OAAA3W,EACA,QAAAC,EACA,SAAA2W,EACA,YAAA7I,EACA,YAAAlI,CACF,EAAuB,SAGf,MAAAH,EAAkB,CAAC,CAACqI,EAEpBL,GAAe7H,GAAA,YAAAA,EAAa,qBAAsB,MAEpD,IAAC+Q,EAAiB,YAGhB,MAAA9J,EAAQ8J,EAAS,MACnBje,EAAe,OAAOie,EAAS,KAAK,CAAC,EACrC,uBAGJ,IAAI/J,EAAU+J,EAAS,UAAYA,EAAS,SAAW,wBACnDC,EAAWD,EAAS,YAAY9Y,GAAAD,EAAA+Y,EAAS,WAAT,YAAA/Y,EAAmB,MAAM,8CAAzB,YAAAC,EAAuE,KAAM,GAG3G,MAAAqP,EAAeyJ,EAAS,eAAiB,cACzC5J,EAAW4J,EAAS,MAAQA,EAAS,UAAY,EACjD3J,EAAY2J,EAAS,OAASA,EAAS,WAAa,EACpD7J,EAAgB6J,EAAS,gBAAkBA,EAAS,MAAQ,EAC5DE,EAASF,EAAS,QAAU,WAC5Bva,EAAcua,EAAS,aAAe,2BAMtCG,GAHcH,EAAS,cAAgB,CAAC,GAI3C,OAAQI,GAAcA,GAAQA,EAAK,YAAc,CAAC,MAAM,OAAOA,EAAK,UAAU,CAAC,CAAC,EAChF,KAAK,CAACC,EAAQC,IAAW,IAAI,KAAKA,EAAE,SAAS,EAAE,QAAQ,EAAI,IAAI,KAAKD,EAAE,SAAS,EAAE,SAAS,EAG7F,IAAIE,EAAwB,EACxB,GAAAJ,EAAiB,OAAS,EAAG,CAC/B,MAAMK,EAAkB,OAAOL,EAAiB,CAAC,EAAE,UAAU,EACvDM,EAAc,OAAON,EAAiBA,EAAiB,OAAS,CAAC,EAAE,UAAU,EACzDI,GAAAC,EAAkBC,GAAeA,EAAe,IAoB5E,MAAMC,GAhBoB,CAACxK,EAAeyK,EAA4BC,EAAsBC,IAAsB,CAC1G,MAAAC,EAAa5K,GAAS,EAAIyK,EAAqB,KAC/CI,EAAcH,EAAe,IAAM,GACnCI,EAAcH,EAAY,GAE1BI,EAAkBH,EAAaC,EAAc,KAAK,IAAI,EAAIA,EAAaC,CAAW,GACjE,KAAK,IAAI,EAAID,EAAaC,CAAW,EAAI,GAEzD,OACL,eAAAC,EACA,cAAgBA,EAAiBD,EAAeF,EAChD,UAAWG,EAAiBD,CAC9B,CACF,GAIE,OAAOhB,EAAS,KAAK,GAAK,EAC1B,GACA,IACA,EACF,EAGE,OAAApd,EAAA,IAACmK,IAAO,KAAM3D,EAAQ,aAAcC,EAClC,SAAA3D,EAAA,KAAC6H,GAAc,WAAU,6CACvB,UAAC7H,OAAA,OAAI,UAAU,gCACb,UAAA9C,EAAA,IAAC,OACC,IACEod,EAAS,WACT,kEAAkEA,EAAS,EAAE,GAE/E,IAAK/J,EACL,UAAU,6BACZ,EACAvQ,OAAC,MAAI,WAAU,mCACb,UAAC9C,EAAA,IAAAmT,GAAA,CAAM,UAAU,wBACd,SACHQ,EAAA,EACCyJ,EAAS,QACRpd,EAAA,IAACmT,IAAM,QAAQ,YAAa,WAAS,MAAO,GAEhD,IACA,EAEFrQ,OAAC,MAAI,WAAU,MACb,UAACA,OAAAgI,GAAA,CAAa,UAAU,OACtB,UAAChI,OAAA,OAAI,UAAU,mCACb,UAAC9C,EAAA,IAAAgL,GAAA,CAAY,UAAU,qBACpB,SACHsI,EAAA,EACAxQ,OAAC,MAAI,WAAU,0BACb,UAAA9C,EAAA,IAAC0F,EAAA,CACC,QAAQ,UACR,KAAK,KACL,UAAU,UACV,QAAUmB,GAAMA,EAAE,gBAAgB,EACnC,gBAED,EACA7G,EAAA,IAAC0F,EAAA,CACC,QAAQ,UACR,KAAK,KACL,UAAU,UACV,QAAUmB,GAAMA,EAAE,gBAAgB,EACnC,kBAED,CACF,IACF,EACC7G,EAAA,IAAAkL,GAAA,CAAkB,UAAU,6CAC1B,SACHmI,CAAA,IACF,EAECvQ,EAAA,KAAAyT,GAAA,CAAK,aAAa,UAAU,UAAU,OACrC,UAACzT,OAAA2T,GAAA,CAAS,UAAU,wBAClB,UAACzW,EAAA,IAAA2W,GAAA,CAAY,MAAM,UAAU,SAAgB,qBAC5C3W,EAAA,IAAA2W,GAAA,CAAY,MAAM,aAAa,SAAkB,uBACjD3W,EAAA,IAAA2W,GAAA,CAAY,MAAM,UAAU,SAAc,oBAC7C,EAEC7T,EAAA,KAAA+T,GAAA,CAAY,MAAM,UAAU,UAAU,YACrC,UAAC/T,OAAA,OAAI,UAAU,wCACb,UAACA,OAAA,OAAI,UAAU,oEACb,UAAC9C,MAAAse,GAAA,CAAI,UAAU,oCAAqC,GACpDxb,OAAC,OAAK,WAAU,sBAAuB,UAAA0Q,EAAS,YAAS,IAC3D,EACA1Q,OAAC,MAAI,WAAU,oEACb,UAAC9C,MAAAue,GAAA,CAAK,UAAU,oCAAqC,GACrDzb,OAAC,OAAK,WAAU,sBAAuB,UAAA2Q,EAAU,aAAU,IAC7D,EACA3Q,OAAC,MAAI,WAAU,oEACb,UAAC9C,MAAAwe,GAAA,CAAO,UAAU,oCAAqC,GACvD1b,OAAC,OAAK,WAAU,sBAAuB,UAAAvD,GAAagU,CAAa,EAAE,SAAM,IAC3E,EACAzQ,OAAC,MAAI,WAAU,oEACb,UAAC9C,MAAAye,GAAA,CAAS,UAAU,oCAAqC,GACxDze,EAAA,YAAK,UAAU,sBAAuB,SAAOsd,CAAA,GAChD,IACF,SAEC,MACC,WAACxa,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAA0e,GAAA,CAAO,UAAU,oCAAqC,GAAE,YAE3D,EACA5b,OAAC,MAAI,WAAU,0BACb,UAACA,OAAA,KAAE,UAAU,eACX,UAAC9C,EAAA,YAAK,UAAU,cAAc,SAAQ,aAAO,IAAEqT,CAAA,EACjD,EACCgK,GACCva,EAAA,KAAC,IAAE,WAAU,UACX,UAAC9C,EAAA,YAAK,UAAU,cAAc,SAAS,cAAO,IAAEqd,CAAA,CAClD,GAEJ,IACF,SAEC,MACC,WAACva,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAAya,GAAA,CAAK,UAAU,oCAAqC,GAAE,eAEzD,EACAza,MAAC,OAAI,UAAU,0BACb,eAAC,IAAE,WAAU,8BAA+B,SAAA6C,CAAY,EAC5D,IACF,SAEC,MACG,WAACC,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAA2e,GAAA,CAAS,UAAU,oCAAqC,GAAE,sBAE7D,EACC3e,MAAA,OAAI,UAAU,0BACb,SAACA,EAAA,SAAE,UAAU,eACV,SAAmBkM,GAAAgI,EACjBpR,EAAA,WAAG,UAAU,YACZ,UAACA,OAAA,MAAG,UAAU,oBACZ,UAAC9C,MAAA2e,GAAA,CAAS,UAAU,oCAAqC,GACxD3e,EAAA,YAAK,UAAU,wCAAwC,SAExD,0CACF,EACA8C,OAAC,KAAG,WAAU,oBACZ,UAAC9C,MAAA2e,GAAA,CAAS,UAAU,oCAAqC,GACxD3e,EAAA,YAAK,UAAU,wCAAwC,SAExD,gBACF,EACA8C,OAAC,KAAG,WAAU,oBACZ,UAAC9C,MAAA2e,GAAA,CAAS,UAAU,oCAAqC,GACxD3e,EAAA,YAAK,UAAU,wCAAwC,SAExD,sBACF,GACF,GAEA8C,OAAC,MAAI,WAAU,mBACb,UAAC9C,EAAA,SAAE,UAAU,6BAA6B,SAE1C,sDACC0F,EAAO,WAAU,UAAU,KAAK,KAAK,SAEtC,gBACZ,EAEE,EACF,GACF,IACE,EAEC5C,EAAA,KAAA+T,GAAA,CAAY,MAAM,aAAa,UAAU,YACxC,UAAC/T,OAAA,OAAI,UAAU,wCACb,UAAAA,OAAC,MACC,WAACA,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,oCAAqC,GAAE,sBAElE,EACA9b,OAAC,MAAI,WAAU,oCACb,UAACA,OAAA,OAAI,UAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAsB,2BAChDA,MAAC,OAAK,WAAU,cACb,SAAAb,EAAeie,EAAS,gBAAkBA,EAAS,MAAQ,IAAK,CACnE,IACF,EACAta,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAY,iBACtC8C,OAAC,OAAK,WAAU,cACb,UAAAsa,EAAS,aAAeA,EAAS,aAAa,QAAQ,CAAC,GAAMA,EAAS,MAAQ,KAAQ,GAAMA,EAAS,MAAQ,KAAK,QAAQ,CAAC,EAAE,IAChI,IACF,EACAta,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAmB,wBAC7C8C,OAAC,OAAK,WAAU,cACb,UAAAsa,EAAS,IAAMA,EAAS,IAAI,QAAQ,CAAC,GAAMA,EAAS,MAAQ,IAAQA,EAAS,MAAQ,KAAK,QAAQ,CAAC,EAAE,IACxG,IACF,EACAta,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAe,oBACzCA,MAAC,OAAK,WAAU,cACb,SAAAuT,EAAgB,EAAIpU,EAAeie,EAAS,MAAQ7J,CAAa,EAAI,KACxE,GACF,GACF,IACF,SAEC,MACC,WAACzQ,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAA6e,GAAA,CAAQ,UAAU,oCAAqC,GAAE,iBAE5D,EACA/b,OAAC,MAAI,WAAU,oCACb,UAACA,OAAA,OAAI,UAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAkB,uBAC5CA,MAAC,OAAK,WAAU,cACb,SAAAb,EAAeie,EAAS,gBAAkBA,EAAS,MAAQ,GAAG,CACjE,IACF,EACAta,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAsB,2BAChDA,EAAA,IAAC,MAAI,WAAU,oBACZ,SAAAod,EAAS,OAASA,EAAS,gBAAkBA,EAAS,MAAQ,KAE3Dta,OAAA6D,WAAA,WAAC3G,MAAA8e,GAAA,CAAe,UAAU,6BAA8B,GACxDhc,OAAC,OAAK,WAAU,6BACV,aAAAsa,EAAS,gBAAkBA,EAAS,MAAQ,KAAOA,EAAS,QAAUA,EAAS,gBAAkBA,EAAS,MAAQ,KAAO,KAAK,QAAQ,CAAC,EAAE,UAC/I,IACF,EAGEta,OAAA6D,EAAA,oBAAC3G,MAAA+e,GAAA,CAAa,UAAU,6BAA8B,GACtDjc,OAAC,OAAK,WAAU,6BACX,YAAAsa,EAAS,OAASA,EAAS,gBAAkBA,EAAS,MAAQ,MAASA,EAAS,gBAAkBA,EAAS,MAAQ,IAAO,KAAK,QAAQ,CAAC,EAAE,UAC/I,IACF,CAEJ,IACF,EACAta,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAoB,yBAC9C8C,OAAC,MAAI,WAAU,oBACb,UAAC9C,MAAA+e,GAAA,CAAa,UAAU,6BAA8B,GACrD/e,EAAA,YAAK,UAAU,6BAA6B,SAAK,UACpD,GACF,GACF,GACF,IACA,SAED,MACC,WAAC8C,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,oCAAqC,GAAE,uBAElE,EACA9b,OAAC,MAAI,WAAU,0BACb,UAACA,OAAA,OAAI,UAAU,6CACb,UAAAA,OAAC,MACC,WAAC9C,EAAA,SAAE,UAAU,eAAe,SAAc,mBAC1CA,MAAC,IAAE,WAAU,sBAAuB,SAAAb,EAAe,OAAOie,EAAS,KAAK,GAAK,CAAC,CAAE,IAClF,SACC,MACC,WAACpd,EAAA,SAAE,UAAU,eAAe,SAAe,0BAC1C,IAAE,WAAU,sBAAuB,SAAeb,EAAA2e,EAAS,cAAc,CAAE,IAC9E,SACH,MACK,WAAC9d,EAAA,SAAE,UAAU,eAAe,SAAc,yBACzC,IAAE,WAAU,sBAAuB,SAAeb,EAAA2e,EAAS,aAAa,CAAE,GAC7E,IACF,EACC9d,EAAA,SAAE,UAAU,iDAAiD,SAE9D,gEACF,IACA,SAEC,MACD,WAAC8C,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,oCAAqC,GAAE,sBAElE,QACC,MAAI,WAAU,0BACb,SAAC9b,EAAA,YAAI,UAAU,YACb,UAACA,OAAA,OAAI,UAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAqB,0BAC/CA,MAAC,OAAK,WAAU,cACb,SAAAb,EAAeie,EAAS,gBAAkBA,EAAS,MAAQ,IAAK,CACnE,IACF,EACAta,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAgB,qBAC1C8C,OAAC,OAAK,WAAU,2BAA2B,cACvC3D,EAAe2e,EAAS,cAAc,EAC1C,IACF,EACAhb,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAsB,2BAChD8C,OAAC,OAAK,WAAU,2BAA2B,cACvC3D,GAAgBie,EAAS,gBAAkBA,EAAS,MAAQ,MAAS,EAAG,EAC5E,IACF,EACAta,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAoB,yBAC9C8C,OAAC,OAAK,WAAU,2BAA2B,cACvC3D,GAAgBie,EAAS,gBAAkBA,EAAS,MAAQ,MAAS,GAAI,EAC7E,IACF,EACAta,OAAC,MAAI,WAAU,uDACb,UAAC9C,EAAA,YAAK,UAAU,sBAAsB,SAAiB,sBACvDA,MAAC,OAAK,WAAU,cACb,SAAAb,GACEie,EAAS,gBAAkBA,EAAS,MAAQ,MAC7CU,EAAS,gBACRV,EAAS,gBAAkBA,EAAS,MAAQ,MAAS,IAE1D,GACF,IACF,CACF,GACF,IACF,EAECta,EAAA,KAAA+T,GAAA,CAAY,MAAM,UAAU,UAAU,YACrC,UAAA/T,OAAC,MACC,WAACA,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAAgf,GAAA,CAAS,UAAU,oCAAqC,GAAE,gBAE7D,EACCzB,EAAiB,OAAS,EACxBza,EAAA,YAAI,UAAU,0BACb,UAACA,OAAA,OAAI,UAAU,OACZ,UAAA6a,IAA0B,GACzB7a,OAAC,MAAI,WAAU,eACb,UAAC9C,EAAA,YAAK,UAAU,cAAc,SAAoB,gCACjD,OAAK,WAAW2d,GAAyB,EAAI,iBAAmB,eAC9D,UAAAA,GAAyB,EAAI,IAAM,GAAIA,EAAsB,QAAQ,CAAC,EAAE,IAC3E,IACF,EAIF3d,MAAC,OAAI,UAAU,0BACZ,WAAiB,IAAI,CAACwd,EAAW/a,IAAkB,CAClD,MAAMwc,EAAW,KAAK,IAAI,GAAG1B,EAAiB,IAAK2B,GAAW,OAAOA,EAAE,UAAU,CAAC,CAAC,EAC7E/N,EAAU,OAAOqM,EAAK,UAAU,EAAIyB,EAAY,IAChD/N,EAAQ,IAAMqM,EAAiB,OAC/B4B,EAAW1c,EAAQyO,EAGvB,OAAAlR,EAAA,IAAC,OAEC,UAAU,iGACV,MAAO,CACL,OAAQ,GAAGmR,CAAM,IACjB,MAAO,GAAGD,EAAQ,CAAC,IACnB,KAAM,GAAGiO,CAAQ,GACnB,EACA,MAAO,GAAG9f,GAAWme,EAAK,SAAS,CAAC,KAAKre,EAAe,OAAOqe,EAAK,UAAU,CAAC,CAAC,GAEhF,SAAA1a,EAAA,KAAC,MAAI,WAAU,yJACZ,UAAAzD,GAAWme,EAAK,SAAS,EAAE,KAAGre,EAAe,OAAOqe,EAAK,UAAU,CAAC,EACvE,IAXK/a,CAYP,EAEH,CACH,IACF,EAECzC,EAAA,WAAI,UAAU,YACZ,SAAiBud,EAAA,IAAI,CAACC,EAAW/a,IAChCK,OAAC,MAAgB,WAAU,yCACzB,UAACA,OAAA,OAAI,UAAU,oBACb,UAAC9C,MAAAgf,GAAA,CAAS,UAAU,oCAAqC,SACxD,OAAK,WAAU,UAAW,SAAW3f,GAAAme,EAAK,SAAS,CAAE,IACxD,EACAxd,MAAC,QAAK,UAAU,cAAe,WAAe,OAAOwd,EAAK,UAAU,CAAC,CAAE,GAL/D,EAAA/a,CAMV,CACD,CACH,GACF,GAECzC,MAAA,OAAI,UAAU,sCACb,eAAC,IAAE,WAAU,wBAAwB,oCAAyB,EAChE,IAEJ,SAEC,MACC,WAAC8C,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAA6e,GAAA,CAAQ,UAAU,oCAAqC,GAAE,4BAE5D,EACC3S,GAAmBgI,EACjBpR,OAAA,OAAI,UAAU,oCACb,UAACA,OAAA,OAAI,UAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAa,kBACtCA,EAAA,IAAAmT,GAAA,CAAM,QAAQ,UAAU,SAAI,UAC/B,EACArQ,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAe,oBACxCA,EAAA,IAAAmT,GAAA,CAAM,QAAQ,UAAU,SAAS,eACpC,EACArQ,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAe,oBACxCA,EAAA,IAAAmT,GAAA,CAAM,QAAQ,UAAU,SAAI,UAC/B,EACArQ,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,UAAU,SAAU,eACnCA,EAAA,IAAAmT,GAAA,CAAM,QAAQ,UAAU,SAAG,SAC9B,EACAnT,MAAC,OAAI,UAAU,qBACb,eAAC,IAAE,WAAU,gCAAgC,+MAI7C,EACF,GACF,GAEA8C,OAAC,MAAI,WAAU,sCACb,UAAC9C,EAAA,SAAE,UAAU,6BAA6B,SAE1C,qEACC0F,EAAO,WAAU,UAAU,KAAK,KAAK,SAEtC,gBACF,GAER,GACE,GACF,GACF,IACF,CACF,EAEJ,CC5fA,MAAM0Z,GAAU,CACd,CACE,KAAM,UACN,SAAU,WACV,KAAM,8DACN,IAAK,kCACP,EACA,CACE,KAAM,eACN,SAAU,eACV,KAAM,yDACN,IAAK,sCACP,EACA,CACE,KAAM,MACN,SAAU,OACV,KAAM,2DACN,IAAK,+BAET,EAEMC,GAAWD,GAAQ,MAAM,EAAGA,GAAQ,OAAS,CAAC,EAC9CE,GAAYF,GAAQ,MAAMA,GAAQ,OAAS,CAAC,EAC5CG,GAAWH,GAAQ,MAAM,EAAGA,GAAQ,OAAS,CAAC,EAC9CI,GAAYJ,GAAQ,MAAMA,GAAQ,OAAS,CAAC,EAE5CK,GAAa,CAAC,CAClB,IAAAC,EACA,KAAAC,EACA,SAAAC,EACA,KAAAC,CACF,IAOI/c,EAAA,KAAC,UACC,UAAW/D,EACT,4EACA,iEACA,4EACF,EAEA,UAAC+D,OAAA,OAAI,UAAU,mCACb,UAAC9C,MAAA,OAAI,UAAU,eAAe,MAAM,KAAK,OAAO,KAAK,IAAI,GAAG,IAAK0f,CAAK,GACtE5c,OAAC,MAAI,WAAU,gBACb,UAAC9C,EAAA,kBAAW,UAAU,sCACnB,SACH2f,EAAA,EACC3f,EAAA,SAAE,UAAU,yCAA0C,SAAS4f,CAAA,GAClE,IACF,EACC5f,EAAA,kBAAW,UAAU,eAAgB,SAAK6f,CAAA,IAC7C,EAIEC,GAAO,IAAM,OACjB,KAAM,CAAE,KAAAnc,EAAM,QAAAK,EAAS,QAAAO,CAAA,EAAYO,GAAQ,EACrC,CAACib,EAAeC,CAAgB,EAAInb,EAAM,SAAS,EAAI,EACvD,CAACob,EAAeC,CAAgB,EAAIrb,EAAM,SAAqB,EAAE,EACjE,CAACsb,EAAaC,CAAc,EAAIvb,EAAM,SAAS,EAAK,EACpD,CAACwb,EAAiBC,CAAkB,EAAIzb,EAAM,SAAS,EAAK,EAC5D,CAAC0b,EAAyBC,CAA0B,EACxD3b,EAAM,SAAS,EAAK,EAChB,CAAC4b,EAAUC,CAAW,EAAI7b,EAAM,SAAS,QAAQ,EACjD,CAAC8b,EAAqBC,CAAsB,EAAI/b,EAAM,SAAS,EAAK,EACpE,CAACgc,CAAkB,EAAIhc,EAAM,SAAS,EACtC,CAAC8V,EAAMmG,CAAO,EAAIjc,EAAM,SAAS,CAAC,EAClC,CAACkc,EAASC,CAAU,EAAInc,EAAM,SAAS,EAAI,EAC3Coc,EAAsB,EACtB,CAAC/c,EAAWC,CAAY,EAAIU,EAAM,SAAS,EAAI,EAC/C,CAACqc,EAAgBC,CAAiB,EAAItc,EAAM,SAAS,EAAK,EAC1D,CAACuc,EAAkBC,CAAmB,EAAIxc,EAAM,SAA0B,IAAI,EAC9E,CAACyc,EAAqBC,CAAsB,EAAI1c,EAAM,SAAS,EAAK,EACpE2c,GAAiB3c,EAAM,OAAuB,IAAI,EAClD4c,GAAa5c,EAAM,OAAO,EAAK,EAC/B,CAAE,KAAM6c,GAAW,UAAWC,EAAA,EAAmBtG,GAAS,EAE1DuG,GAAyB,MAAOC,EAAU,EAAGC,EAAgB,KAAU,CAC3E,GAAI,CAAAL,GAAW,QACf,CAAAA,GAAW,QAAU,GAEjB,IACGK,EAGHX,EAAkB,EAAI,EAFtBhd,EAAa,EAAI,EAKX,YAAI,iBAAkB0d,CAAO,EACrC,MAAM/G,EAAa,MAAMJ,GAAsBmH,EAASZ,CAAmB,EACnE,YAAI,uBAAwBnG,CAAU,EAG5CoF,EADE2B,IAAY,EACG/G,MAEQ,CAAC,GAAGxE,GAAM,GAAGwE,CAAU,CAFrB,EAKlBkG,EAAAlG,EAAW,SAAWmG,CAAmB,EACpDH,EAAQe,CAAO,EACf7B,EAAiB,EAAK,QACfxc,EAAO,CACN,cAAM,4BAA6BA,CAAK,SAChD,CACAW,EAAa,EAAK,EAClBgd,EAAkB,EAAK,EACvBM,GAAW,QAAU,IAEzB,EAEA5c,EAAM,UAAU,IAAM,CAChBkb,GACF6B,GAAuB,EAAG,EAAK,CACjC,EACC,CAAC7B,CAAa,CAAC,EAElBlb,EAAM,UAAU,IAAM,CACpB,GAAI,CAAC2c,GAAe,SAAWzB,GAAiBI,EAAa,OAE7D,MAAM5Q,EAAW,IAAI,qBACRwS,GAAA,CACLA,EAAQ,CAAC,EAAE,gBAAkBhB,GAAW,CAACU,GAAW,SAC/BG,GAAAjH,EAAO,EAAG,EAAI,CAEzC,EACA,CACE,WAAY,QACZ,UAAW,GAEf,EAES,OAAApL,EAAA,QAAQiS,GAAe,OAAO,EAChC,IAAMjS,EAAS,WAAW,GAChC,CAACwR,EAASpG,EAAMoF,EAAeI,CAAW,CAAC,EAExC,MAAA6B,GAAe,MAAOC,GAAiB,CACvC,IAACA,EAAK,OAAQ,CAEhB/B,EAAiB,EAAE,EACnBE,EAAe,EAAK,EACpBU,EAAQ,CAAC,EACTE,EAAW,EAAI,EACf7c,EAAa,EAAI,EACb,IACF,MAAM2W,EAAa,MAAMJ,GAAsB,EAAGuG,CAAmB,EACrEf,EAAiBpF,CAAU,EAChBkG,EAAAlG,EAAW,SAAWmG,CAAmB,QAC7Czd,EAAO,CACN,cAAM,4BAA6BA,CAAK,SAChD,CACAW,EAAa,EAAK,EAEpB,OAGFic,EAAe,EAAI,EACnBF,EAAiB,EAAE,EACf,IAGI,MAAAgC,GAFU,MAAMlH,GAAiBiH,CAAI,GAEb,IAAUlH,KAAA,CACtC,GAAIA,GAAE,GACN,MAAOA,GAAE,MACT,SAAUA,GAAE,SACZ,MAAOA,GAAE,MACT,KAAMA,GAAE,KACR,KAAMA,GAAE,KACR,MAAOA,GAAE,MACT,YAAaA,GAAE,YACf,UAAWA,GAAE,UACb,YAAaA,GAAE,YACf,WAAYA,GAAE,WACd,WAAYA,GAAE,YACd,EAEFmF,EAAiBgC,CAAa,EAC9BlB,EAAW,EAAK,EAChBF,EAAQ,CAAC,QACFtd,EAAO,CACN,cAAM,8BAA+BA,CAAK,EAClD0c,EAAiB,EAAE,SACnB,CACAE,EAAe,EAAK,EAExB,EAGM+B,GAAcje,EACdke,GAAiBnC,GAAiBA,EAAc,OAAS,EAC/D,eAAQ,IAAI,gBAAiB,CAC3B,UAAA/b,EACA,oBAAqB+b,GAAA,YAAAA,EAAe,OACpC,YAAAkC,GACA,eAAAC,EAAA,CACD,EAGCtf,EAAA,KAAC,MAAI,WAAU,6BACb,UAAA9C,EAAA,IAACiM,GAAA,CACC,gBAAiB,CAAC,CAACtI,EACnB,YAAaK,GAAW,OACxB,SAAU,IAAM,CACd0c,EAAY,QAAQ,EACpBJ,EAAmB,EAAI,CACzB,EACA,SAAU,IAAM,CACdI,EAAY,QAAQ,EACpBJ,EAAmB,EAAI,CACzB,EACA,UAAW,SAAY,CACjB,IACF,MAAM/b,EAAQ,EACd,OAAO,SAAS,KAAO,UAChBf,EAAO,CACN,cAAM,qBAAsBA,CAAK,EAC3C,CACF,CACF,SAEC,OACC,WAACxD,MAAAiS,GAAA,CAAY,SAAU+P,EAAc,SAEpC,MAAI,WAAU,4BACb,SAAClf,EAAA,YAAI,UAAU,sCACb,UAAA9C,MAAC,KAAG,WAAU,0BACX,SAAAmgB,EAAc,iBAAmB,sBACpC,EAECngB,EAAA,WAAI,UAAU,4DACZ,YACC,MAAM,CAAC,EAAE,KAAK,CAAC,EAAE,IAAI,CAAC2P,EAAGC,IACvB5P,EAAA,IAAC,OAEC,UAAU,sDADL4P,CAGR,GACCwS,GACFnC,EAAc,IAAK7C,GACjBpd,EAAA,IAAC,OAEC,QAAS,IAAM,CACbqhB,EAAoBjE,CAAQ,EAC5BmE,EAAuB,EAAI,CAC7B,EACA,UAAU,qDAEV,SAAAvhB,EAAA,IAACoT,GAAA,CACC,GAAIgK,EAAS,GACb,QAASA,EAAS,UAAY,yBAC9B,MAAO,OAAOA,EAAS,KAAK,GAAK,EACjC,cAAe,OAAOA,EAAS,IAAI,GAAK,EACxC,SAAU,OAAOA,EAAS,IAAI,GAAK,EACnC,UAAW,OAAOA,EAAS,KAAK,GAAK,EACrC,UAAW,EAAQA,EAAS,YAC5B,aAAa,cACb,YAAaA,EAAS,aAAe,GACrC,UAAWA,EAAS,YAAkB,WAAO,YAAY,EACzD,OAAQA,EAAS,UAAY,CAACA,EAAS,SAAS,EAAI,CAAC,EACrD,YAAazZ,EACb,YAAaK,CAAA,EACf,EArBKoZ,EAAS,IAAM,KAAK,SAAS,SAAS,EAuB9C,EAEDpd,MAAC,OAAI,UAAU,oDAAoD,8BAEnE,GAEJ,EAEC+gB,GAAW,CAAC7c,GAAa,CAACic,GACzBngB,EAAA,IAAC,OACC,IAAKwhB,GACL,UAAU,6CAET,SACCN,EAAApe,OAAC,MAAI,WAAU,mCACb,UAAA9C,EAAA,IAAC+Y,GAAe,IACf/Y,EAAA,SAAE,UAAU,gCAAgC,SAA0B,gCACzE,EAEAA,EAAA,IAAC,MAAI,WAAU,KAAM,IAEzB,EAEJ,CACF,SAGC,MAAI,WAAU,4BACb,SAAC8C,EAAA,YAAI,UAAU,sCACb,UAAC9C,EAAA,UAAG,UAAU,0BAA0B,SAAgB,2BACvD,MAAI,WAAU,uDACZ,SAAA2hB,GACC,MAAM,CAAC,EAAE,KAAK,CAAC,EAAE,IAAI,CAAChS,EAAGC,IACvB5P,EAAA,IAAC,OAAY,UAAU,sDAAb4P,CAAkE,CAC7E,GACCvL,EAAAqd,IAAA,YAAAA,GAAW,QAAX,MAAArd,EAAmB,IAAM,MAAM,QAAQqd,GAAU,MAAM,CAAC,CAAC,EAC3DA,GAAU,MAAM,CAAC,EAAE,IAAKW,GACtBriB,EAAA,IAACoT,GAAA,CAEC,GAAIiP,EAAK,GACT,QAASA,EAAK,SACd,MAAOA,EAAK,MACZ,YAAaA,EAAK,YAClB,aAAcA,EAAK,cACnB,UAAWA,EAAK,WAChB,OAAQ,CAACA,EAAK,SAAS,EACvB,OAAQ,GACR,eAAgBA,EAAK,eACrB,gBAAiBA,EAAK,gBACtB,UAAWA,EAAK,UAChB,UAAW,GACX,YAAa1e,EACb,YAAaK,CAAA,EAdRqe,EAAK,GAgBb,EAEDriB,MAAC,OAAI,UAAU,oDAAoD,yCAEnE,CAEJ,IACF,CACF,GAGA8C,OAAC,UAAQ,WAAU,6BACjB,UAAC9C,MAAA,OAAI,UAAU,qCACb,SAAAA,EAAA,IAAC,MAAG,UAAU,0BAA0B,uCAA2B,CAErE,GACA8C,OAAC,MAAI,WAAU,2GACb,UAAAA,EAAA,KAAC,OACC,UAAU,mCACV,MAAO,CACL,UACE,qGACJ,EAEA,UAAA9C,MAAC2b,IAAQ,aAAY,GAAC,SAAQ,GAAC,UAAU,mBACtC,SAAS0D,GAAA,IAAKiD,SACZ7C,GAAkC,IAAG6C,GAArBA,EAAO,QAAsB,CAC/C,EACH,EACAtiB,MAAC2b,IAAQ,QAAO,GAAC,aAAY,GAAC,UAAU,mBAAmB,SAAQ,GAChE,YAAU,IAAK2G,GACbtiB,MAAAyf,GAAA,CAAkC,GAAG6C,GAArBA,EAAO,QAAsB,CAC/C,CACH,GACAtiB,MAAC2b,IAAQ,QAAO,GAAC,aAAY,GAAC,UAAU,mBAAmB,SAAQ,GAChE,YAAS,IAAK2G,GACZtiB,MAAAyf,GAAA,CAAkC,GAAG6C,GAArBA,EAAO,QAAsB,CAC/C,CACH,SACC3G,GAAQ,cAAY,GAAC,UAAU,mBAAmB,SAAQ,GACxD,SAAA6D,GAAU,IAAK8C,SACb7C,GAAkC,IAAG6C,GAArBA,EAAO,QAAsB,CAC/C,CACH,IACF,EAEAtiB,MAAC,MAAI,WAAU,qFAAsF,GACrGA,MAAC,MAAI,WAAU,wFAAyF,GACxGA,MAAC,MAAI,WAAU,sFAAuF,GACtGA,MAAC,MAAI,WAAU,uFAAwF,GACzG,IACF,QAEC,MAAI,WAAU,4BACb,SAAAA,EAAA,IAAC,OAAI,UAAU,sCACb,SAACA,MAAA,OAAI,UAAU,OACb,SAAAA,MAACwa,GAAgB,IACnB,CACF,GACF,GAEE,CAACxW,GAAWA,EAAQ,oBAAsB,eACzC,MAAI,WAAU,6BACb,SAAAhE,EAAA,IAAC,OAAI,UAAU,sCACb,SAAC8C,OAAA,OAAI,UAAU,8CAEb,UAAC9C,MAAA,OAAI,UAAU,mBACb,SAAAA,EAAA,IAACic,GAAA,CACC,UAAW,CAAC,GAAK,GAAK,EAAG,EACzB,MAAO,EACP,UAAW,GACX,YAAa,KAEjB,EAGAjc,MAAC,MAAI,WAAU,kDAAmD,GAGlE8C,OAAC,MAAI,WAAU,uCACb,UAAC9C,EAAA,UAAG,UAAU,qCAAqC,SAEnD,qCACCA,EAAA,SAAE,UAAU,+CAA+C,SAE5D,qHACAA,EAAA,IAAC,UACC,QAAS,IAAMwgB,EAA2B,EAAI,EAC9C,UAAU,kGACX,wBAED,CACF,GACF,EACF,EACF,IAGJ,QAECrG,GAAO,IAERna,EAAA,IAACwV,GAAA,CACC,OAAQ6K,EACR,QAAS,IAAMC,EAAmB,EAAK,EACvC,YAAaG,CAAA,CACf,EAEAzgB,EAAA,IAAC+W,GAAA,CACC,OAAQwJ,EACR,QAAS,IAAMC,EAA2B,EAAK,EAC/C,YAAa7c,EACb,YAAaK,CAAA,CACf,EAEAhE,EAAA,IAACiZ,GAAA,CACC,OAAQ0H,EACR,QAAS,IAAMC,EAAuB,EAAK,EAC3C,WAAYC,EACZ,YAAald,EACb,YAAaK,CAAA,CACf,EAEAhE,EAAA,IAACmd,GAAA,CACC,OAAQmE,EACR,QAAS,IAAM,CACbC,EAAuB,EAAK,EAC5B,WAAW,IAAMF,EAAoB,IAAI,EAAG,GAAG,CACjD,EACA,SAAUD,EACV,YAAazd,EACb,YAAaK,CAAA,EACf,EACF,CAEJ,EChdgB,SAAAue,GAAO,CAAE,SAAA7e,GAAyB,CAChD,KAAM,CAAE,KAAAC,EAAM,QAAAK,EAAS,QAAAO,EAAS,UAAAL,CAAA,EAAcY,GAAQ,EAChD,CAACub,EAAiBC,CAAkB,EAAIzb,EAAM,SAAS,EAAK,EAC5D,CAAC4b,EAAUC,CAAW,EAAI7b,EAAM,SAA8B,QAAQ,EAG1E,OAAA/B,EAAA,KAAC,MAAI,WAAU,2CACb,UAAA9C,EAAA,IAACiM,GAAA,CACC,gBAAiB,CAAC,CAACtI,EACnB,YAAaK,EACb,SAAU,IAAM,OAAO,SAAS,KAAO,SACvC,SAAU,IAAM,OAAO,SAAS,KAAO,UACvC,UAAWO,CAAA,CACb,EAECvE,MAAA,QAAK,UAAU,SACb,SAAA0D,CACH,SAECyW,GAAO,IAERna,EAAA,IAACwV,GAAA,CACC,OAAQ6K,EACR,QAAS,IAAMC,EAAmB,EAAK,EACvC,YAAaG,CAAA,EACf,EACF,CAEJ,CCpCO,SAAS+B,IAAkB,CAChC,KAAM,CAACC,EAAUC,CAAW,EAAI7e,WAAwB,IAAI,EACtD,CAAC8e,EAASC,CAAU,EAAI/e,WAAS,EAAI,EAE3CW,mBAAU,IAAM,CACd,MAAMqe,EAAa,SAAY,CACzB,IAuBI,MAAAC,GADO,MArBI,MAAM,MACrB,iIACA,CACE,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,SAAU,CACR,CACE,MAAO,CACL,CACE,KAAM,iGACR,CACF,CACF,CAEH,GAEL,GAE4B,KAAK,GACV,WAAW,CAAC,EAAE,QAAQ,MAAM,CAAC,EAAE,KAChDxP,EAAQ,WAAWwP,EAAU,QAAQ,WAAY,EAAE,CAAC,EAErD,MAAMxP,CAAK,IACdoP,EAAYpP,CAAK,EACjBsP,EAAW,EAAK,SAEXpf,EAAO,CACN,cAAM,gCAAiCA,CAAK,EAExD,EAEWqf,EAAA,EACL,MAAAE,EAAW,YAAYF,EAAY,GAAK,EAEvC,UAAM,cAAcE,CAAQ,CACrC,EAAG,EAAE,EAOE,CAAE,SAAAN,EAAU,QAAAE,EAAS,gBALHK,GAClBP,EACEO,EAAYP,EADG,IAIoB,CAC9C,CC/CgB,SAAAQ,GAAa,CAAE,OAAA7jB,GAA6B,CAC1D,KAAM,CAAY,QAAAujB,EAAS,gBAAAO,GAAoBV,GAAgB,EACzDW,EAAYD,EAAgB9jB,CAAM,EAExC,OAAIujB,EAAgB3iB,MAAC,OAAK,WAAU,wBAAwB,SAAU,eACjEmjB,EAGHrgB,EAAA,KAAC,OAAK,WAAU,iCACd,UAAC9C,MAAAojB,GAAA,CAAQ,UAAU,wBAAyB,GAC3CD,EAAU,QAAQ,CAAC,GACtB,EANqB,IAQzB,CCnBsB,eAAAE,GACpB/f,EACAggB,EAKA,OACI,IACM,YAAI,oCAAqChgB,CAAM,EAC/C,YAAI,oBAAqBggB,CAAO,EAGlC,MAAE,KAAMC,EAAe,MAAOC,GAAoB,MAAMvgB,EAC3D,KAAK,UAAU,EACf,OAAO,MAAM,EACb,GAAG,MAAOoB,GAAA,MAAMpB,EAAS,KAAK,WAAW,KAAK,OAApC,YAAAoB,EAA0C,EAAE,EAEzD,GAAImf,EACM,oBAAM,qBAAsBA,CAAe,EAC7CA,EAGR,GAAI,EAACD,GAAA,MAAAA,EAAe,SAAUA,EAAc,CAAC,EAAE,OAAS,QAChD,UAAI,MAAM,oDAAoD,EAItE,KAAM,CAAE,KAAME,EAAe,MAAOC,CAAA,EAAkB,MAAMzgB,EACzD,KAAK,UAAU,EACf,OAAO,GAAG,EACV,GAAG,KAAMK,CAAM,EAElB,GAAIogB,EACM,oBAAM,2BAA4BA,CAAa,EACjDA,EAGJ,KAACD,GAAA,MAAAA,EAAe,QACZ,UAAI,MAAM,gBAAgB,EAGlC,QAAQ,IAAI,iBAAkBA,EAAc,CAAC,CAAC,EAG9C,MAAME,EAAa,CACjB,GAAGL,EACH,WAAY,IAAI,KAAK,EAAE,YAAY,CACrC,EAEQ,YAAI,oBAAqBK,CAAU,EAG3C,KAAM,CAAE,KAAApgB,EAAM,MAAOgV,CAAY,EAAI,MAAMtV,EACxC,KAAK,UAAU,EACf,OAAO0gB,CAAU,EACjB,GAAG,KAAMrgB,CAAM,EACf,OAAO,EAEV,GAAIiV,EACM,oBAAM,wBAAyBA,CAAW,EAC5CA,EAGJ,KAAChV,GAAA,MAAAA,EAAM,QACT,cAAQ,MAAM,8BAA8B,EACtC,IAAI,MAAM,kCAAkC,EAMpD,GAHA,QAAQ,IAAI,gCAAiCA,EAAK,CAAC,CAAC,EAGhD+f,EAAQ,KACN,IACF,MAAMrgB,EAAS,KAAK,MAAM,eAAeK,EAAQ,CAC/C,cAAe,CACb,KAAMggB,EAAQ,KAChB,CACD,EACD,QAAQ,IAAI,uCAAuC,QAC5C9f,EAAO,CACN,aAAK,iDAAkDA,CAAK,EAIxE,OAAOD,EAAK,CAAC,QACNC,EAAO,CACN,oBAAM,8BAA+BA,CAAK,EAC5CA,CAAA,CAEV,CAEA,eAAsBogB,IAAc,CAC9B,IAEI,MAAE,KAAMC,EAAU,MAAOC,CAAA,EAAkB,MAAM7gB,EACpD,KAAK,UAAU,EACf,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA,OAKP,EACA,MAAM,aAAc,CAAE,UAAW,GAAO,EAE3C,GAAI6gB,EACM,oBAAM,wBAAyBA,CAAa,EAC9CA,EAGJ,OAACD,EAEEA,EAAS,IAAgB7f,IAAA,CAC9B,GAAGA,EACH,KAAMA,EAAQ,MAAQ,OACtB,kBAAmBA,EAAQ,mBAAqB,OAChD,oBAAqBA,EAAQ,qBAAuB,UACpD,EAPoB,CAAC,QAQhBR,EAAO,CACN,oBAAM,wBAAyBA,CAAK,EACtCA,CAAA,CAEV,CCnEsB,eAAAugB,GAAiBjJ,EAA+BxX,EAAgB,CAChF,IACF,QAAQ,IAAI,wBAAyB,CAAE,MAAOwX,EAAW,OAAQ,OAAAxX,EAAQ,EACnE,MAAE,KAAAC,EAAM,MAAAC,CAAM,EAAI,MAAMP,EAC3B,KAAK,YAAY,EACjB,OACC6X,EAAW,IAAiBsC,IAAA,CAC1B,GAAGA,EACH,iBAAkB9Z,EAClB,WAAY,IAAI,KAAK,EAAE,YAAY,EACnC,WAAY,IAAI,KAAK,EAAE,YAAY,GACnC,CACJ,EAEF,GAAIE,EACM,oBAAM,kBAAmBA,CAAK,EAChCA,EAGA,mBAAI,qBAAsBD,CAAI,EAC/BA,QACAC,EAAO,CACN,oBAAM,8BAA+BA,CAAK,EAC5CA,CAAA,CAEV,CC3EA,MAAMwgB,GAAWpkB,EAAM,WACrB,CAAC,CAAE,UAAAC,EAAW,GAAGC,CAAA,EAASC,IAEtBC,EAAA,IAAC,YACC,UAAWjB,EACT,+PACAc,CACF,EACA,IAAAE,EACC,GAAGD,CAAA,CACN,CAGN,EACAkkB,GAAS,YAAc,WCXP,SAAAC,GAAmB,CAAE,SAAAvgB,GAAqC,CACxE,KAAM,CAACwgB,EAAgBC,CAAiB,EAAItgB,WAAkB,EAAK,EAC7D,CAACugB,EAAYC,CAAa,EAAIxgB,WAAkB,EAAI,EAE1DW,YAAU,IAAM,CACG8f,EAAA,CACnB,EAAG,EAAE,EAEL,MAAMA,EAAmB,IAAM,CAC7BD,EAAc,EAAI,EACd,IAEF,MAAMtX,EAAOjI,GAAQ,EACrBqf,EAAkB,EAAI,QACf3gB,EAAO,CACN,cAAM,8BAA+BA,CAAK,EAClD2gB,EAAkB,EAAK,SACvB,CACAE,EAAc,EAAK,EAEvB,EAEA,OAAID,QAEC,MAAI,WAAU,iDACb,SAACthB,EAAA,YAAI,UAAU,cACb,UAAC9C,MAAA,OAAI,UAAU,6FAA8F,GAC5GA,EAAA,SAAE,UAAU,wBAAwB,SAA0B,gCACjE,CACF,GAICkkB,oBAuBK,SAAAxgB,EAAS,QArBd,MAAI,WAAU,iDACb,SAACZ,EAAA,YAAI,UAAU,yDACb,UAAC9C,EAAA,UAAG,UAAU,2BAA2B,SAAoB,yBAC5DA,EAAA,SAAE,UAAU,6BAA6B,SAE1C,uGACA8C,EAAA,KAAC4C,EAAA,CACC,QAAQ,UACR,QAAS,IAAM,CACb,OAAO,SAAS,OAAO,CACzB,EACA,UAAU,iCAEV,UAAC1F,MAAAukB,GAAA,CAAU,UAAU,SAAU,GAAE,kBACnC,EACF,CACF,EAMN,CC3CA,SAASC,IAA0B,CACjC,KAAM,CAAChe,EAAQie,CAAS,EAAI5gB,WAAS,EAAK,EACpC,CAAC6gB,EAAUC,CAAW,EAAI9gB,WAAS,EAAE,EACrC,CAACsc,EAAaC,CAAc,EAAIvc,WAAS,EAAK,EAC9C,CAAC+gB,EAAaC,CAAc,EAAIhhB,WAAS,EAAK,EAC9C,CAACoc,EAAeC,CAAgB,EAAIrc,WAA4B,EAAE,EAClE,CAACihB,EAAoBC,CAAqB,EAAIlhB,WAAsB,IAAI,GAAK,EAC7E,CAACmhB,EAAaC,CAAc,EAAIphB,WAAS,CAAC,EAC1C,CAACqhB,EAAYC,CAAa,EAAIthB,WAAS,CAAC,EACxC,CAACuhB,EAAcC,CAAe,EAAIxhB,WAAS,CAAC,EAC5C,CAACyhB,EAAUC,CAAW,EAAI1hB,WAAsB,IAAI,EACpD,CAAC2hB,EAAUC,CAAW,EAAI5hB,WAAS,EAAE,EACrC,CAAC+R,EAAcC,CAAe,EAAIhS,WAAS,EAAK,EAChD,CAAC6hB,EAAcC,CAAe,EAAI9hB,WAAuC,MAAM,EAC/E,CAAC+hB,EAAeC,CAAgB,EAAIhiB,WAAS,EAAE,EAE/C,CAAE,KAAAF,CAAK,EAAImB,GAAQ,EACnB,CAAE,MAAAlD,CAAM,EAAIS,GAAS,EAG3BmC,YAAU,IAAM,CACTgC,IACH0Z,EAAiB,EAAE,EACG6E,EAAA,IAAI,GAAK,EAC/BE,EAAe,CAAC,EAChBE,EAAc,CAAC,EACfE,EAAgB,CAAC,EACjBV,EAAY,EAAE,EAChB,EACC,CAACne,CAAM,CAAC,EA0BX,MAAMsf,EAAe,SAAY,CAC/B,GAAI,IAACniB,GAAA,MAAAA,EAAM,KAAMmhB,EAAmB,OAAS,GAEzC,IACFD,EAAe,EAAI,EACb,MAAAkB,GAAqB9F,EAAc,OAAOlF,IAAK+J,EAAmB,IAAI/J,GAAE,EAAE,CAAC,EAC3E,MAAAgJ,GAAiBgC,GAAoBpiB,EAAK,EAAE,EAE5C/B,EAAA,CACJ,MAAO,UACP,YAAa,YAAYkjB,EAAmB,IAAI,2BACjD,EACDL,EAAU,EAAK,OACD,CACR7iB,EAAA,CACJ,QAAS,cACT,MAAO,QACP,YAAa,iDACd,SACD,CACAijB,EAAe,EAAK,EAExB,EAiBMmB,GAAoBnf,IAA2C,CAC/DA,GAAE,OAAO,OAASA,GAAE,OAAO,MAAM,OAAS,IAC5C0e,EAAY1e,GAAE,OAAO,MAAM,CAAC,CAAC,EAE7B4e,EAAY,EAAE,EAElB,EAEMQ,GAAoBpf,IAA8C,CAC1D4e,EAAA5e,GAAE,OAAO,KAAK,EAE1B0e,EAAY,IAAI,CAClB,EAGE,OAAAziB,EAAA,KAAC,MAAI,WAAU,wCACb,UAACA,OAAA,OAAI,UAAU,OACb,UAAC9C,EAAA,UAAG,UAAU,0BAA0B,SAAiB,sBACxDA,EAAA,SAAE,UAAU,wBAAwB,SAErC,4FACF,EAEA8C,OAAC,MAAI,WAAU,4BACb,UAAAA,OAAC8P,EACC,WAAA9P,OAAC+P,EACC,WAAA7S,MAAC8S,IAAU,SAAgB,qBAC3B9S,MAAC+S,IAAgB,SAEjB,wCACF,EACC/S,MAAAgT,EAAA,CACC,SAAClQ,OAAA,OAAI,UAAU,YACb,UAACA,OAAA,OAAI,UAAU,mHACb,UAAC9C,MAAAkmB,GAAA,CAAO,UAAU,8CAA+C,GAChElmB,EAAA,SAAE,UAAU,qCAAqC,SAElD,uDACAA,EAAA,IAACoL,EAAA,CACC,KAAK,OACL,OAAO,QACP,SAAU4a,GACV,UAAU,SACV,GAAG,cACL,EACChmB,EAAA,IAAAuL,EAAA,CAAM,QAAQ,cAAc,UAAU,iBACrC,SAACvL,MAAA0F,EAAA,CAAO,QAAQ,UAAU,KAAK,SAAS,wBAAY,CACtD,IACF,EAEC4f,GACCxiB,EAAA,KAAC,MAAI,WAAU,+BACb,UAAC9C,EAAA,SAAE,UAAU,mBAAmB,SAAc,mBAC9C8C,OAAC,IAAE,WAAU,wBAAyB,UAASwiB,EAAA,KAAK,KAAG,KAAK,MAAMA,EAAS,KAAO,IAAI,EAAE,OAAI,GAC9F,IAEJ,CACF,IACF,SAEC1S,EACC,WAAA9P,OAAC+P,EACC,WAAA7S,MAAC8S,IAAU,SAAe,oBAC1B9S,MAAC+S,IAAgB,SAEjB,mCACF,EACC/S,MAAAgT,EAAA,CACC,SAAClQ,OAAA,OAAI,UAAU,YACb,UAAA9C,EAAA,IAACgkB,GAAA,CACC,YAAY,qEACZ,KAAM,EACN,MAAOwB,EACP,SAAUS,GACV,UAAU,oBACZ,EACCjmB,EAAA,SAAE,UAAU,gCAAgC,SAE7C,gEACF,CACF,GACF,IACF,EAEAA,MAAC,MAAI,WAAU,wBACb,SAAAA,EAAA,IAAC0F,EAAA,CACC,QAASogB,EACT,SAAUlQ,GAAiB,CAAC0P,GAAY,CAACE,EACzC,UAAU,OAET,WAAe,eAAiB,sBAErC,EAECE,IAAiB,QAChB5iB,EAAA,KAACuX,GAAA,CACC,QAASqL,IAAiB,UAAY,UAAY,cAClD,UAAU,OAET,UAAiBA,IAAA,gBACfS,GAAa,WAAU,UAAU,EAElCnmB,EAAA,IAAComB,GAAY,WAAU,SAAU,GAElCpmB,EAAA,IAAAsa,GAAA,CACE,SAAiBoL,IAAA,UAAY,oBAAsB,gBACtD,EACA1lB,MAACua,IAAkB,SAAcqL,CAAA,IACnC,EAGF9iB,OAAC8P,EAAK,WAAU,OACd,UAAA5S,MAAC6S,EACC,UAAA/P,OAACgQ,GAAU,WAAU,0BACnB,UAAC9S,MAAAya,GAAA,CAAK,UAAU,SAAU,GAAE,4BAE9B,CACF,GACCza,MAAAgT,EAAA,CACC,SAAClQ,OAAA,OAAI,UAAU,YACb,UAAC9C,EAAA,SAAE,UAAU,gCAAgC,SAE7C,iDACAA,MAAC,MAAI,WAAU,gDAC1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAiBW,EACCA,EAAA,SAAE,UAAU,gCAAgC,SAE7C,6DACF,CACF,GACF,IACF,CAEJ,CAGO,SAASqmB,IAAmB,CACjC,OACGrmB,MAAAikB,GAAA,CACC,SAACjkB,MAAAwkB,GAAA,CAAwB,GAC3B,CAEJ,CChQA,SAAwB8B,IAAY,CAClC,KAAM,CAAE,KAAA3iB,EAAM,QAAAK,CAAQ,EAAIc,GAAQ,EAC5B+H,EAAWC,GAAY,EACvB,CAACyZ,EAAiBC,CAAkB,EAAI3hB,EAAM,SAAgB,EAAE,EAChE,CAAC4hB,EAAiBC,CAAkB,EAAI7hB,EAAM,SAAgB,EAAE,EAChE,CAAC8hB,EAAOC,CAAQ,EAAI/hB,EAAM,SAAgB,EAAE,EAC5C,CAACgiB,EAAgBC,CAAiB,EAAIjiB,EAAM,SAAS,CACzD,gBAAiB,EACjB,WAAY,EACZ,aAAc,EACd,YAAa,EACb,cAAe,EAChB,EACK,CAACX,EAAWC,CAAY,EAAIU,EAAM,SAAS,EAAI,EAC/C,CAACrB,EAAOujB,CAAQ,EAAIliB,EAAM,SAAwB,IAAI,EAEtDmiB,EAAYniB,EAAM,YAAY,SAAY,CAC9C,GAAI,GAAClB,IAAQK,GAAA,YAAAA,EAAS,QAAS,SAC3B,IACI,MAAAT,EAAO,MAAMqgB,GAAY,EAC/BgD,EAASrjB,CAAI,QACNC,EAAO,CACN,cAAM,uBAAwBA,CAAK,EAC3CujB,EAAS,sBAAsB,SAC/B,CACA5iB,EAAa,EAAK,EACpB,EACC,CAACR,EAAMK,CAAO,CAAC,EAEZijB,EAAmB,MAAO3jB,EAAgBggB,IAAiB,CAC3D,IACFnf,EAAa,EAAI,EACT,YAAI,6BAA8Bb,CAAM,EACxC,YAAI,WAAYggB,CAAO,EAE/B,MAAM4D,EAAiB,MAAM7D,GAAkB/f,EAAQggB,CAAO,EACtD,YAAI,qBAAsB4D,CAAc,EAG1C,MAAAC,EAAe,MAAMvD,GAAY,EACvCgD,EAASO,CAAY,EAErB,MAAM,2BAA2B,QAC1B3jB,EAAY,CACX,cAAM,uBAAwBA,CAAK,EACrCA,QAAM,SAAW,0DAA0D,SACjF,CACAW,EAAa,EAAK,EAEtB,EAEMijB,EAAiBviB,EAAM,YAAY,SAAY,CACnD,GAAKlB,EACD,IACI,MAAC0jB,EAAO,CAAE,KAAMC,EAAO,EAAI,MAAM,QAAQ,IAAI,CACjDrM,GAAmBtX,EAAK,EAAE,EAC1BV,EACG,KAAK,YAAY,EACjB,OACC;AAAA;AAAA,2EAID,GAAG,aAAcU,EAAK,EAAE,EAC5B,EAEkB+iB,EAAAY,GAAS,EAAE,EAC9Bd,EAAmBa,CAAK,EAGxB,MAAME,GAAmBD,GAAS,CAAC,GAAG,OAASD,EAAM,OAC/CG,EAAa,CAAC,GAAIF,GAAS,GAAK,GAAGD,CAAK,EAAE,OAC9C,CAACI,EAAKC,IAASD,GAAOC,EAAK,OAAS,GACpC,CACF,EACMC,EAAeH,GAAcD,GAAmB,GAChDK,EAAc,CAAC,GAAIN,GAAS,GAAK,GAAGD,CAAK,EAAE,OAC/C,CAACI,EAAKC,IAASD,GAAOC,EAAK,kBAAoB,GAC/C,CACF,EACMG,EAAgB,CAAC,GAAIP,GAAS,GAAK,GAAGD,CAAK,EAAE,OACjD,CAACI,EAAKC,IAASD,GAAOC,EAAK,gBAAkB,GAC7C,CACF,EAEkBZ,EAAA,CAChB,gBAAAS,EACA,WAAAC,EACA,aAAAG,EACA,YAAAC,EACA,cAAAC,CAAA,CACD,QACMrkB,EAAO,CACN,cAAM,4BAA6BA,CAAK,EAClD,EACC,CAACG,CAAI,CAAC,EAWT,OATAkB,EAAM,UAAU,IAAM,CACpB,GAAI,CAAClB,EAAM,CACTkJ,EAAS,GAAG,EACZ,OAEaua,EAAA,EACLJ,EAAA,GACT,CAACrjB,EAAMkJ,EAAUua,EAAgBJ,CAAS,CAAC,EAEzCrjB,EAMH3D,MAACuiB,IACC,SAACviB,EAAA,YAAK,UAAU,oCACd,SAAA8C,OAAC,MAAI,WAAU,8BACb,UAACA,OAAA,OAAI,UAAU,oCACb,UAAC9C,EAAA,UAAG,UAAU,qBAAqB,SAAS,oBAC3CqmB,GAAiB,KACpB,EAEAvjB,OAAC,MAAI,WAAU,uDACb,UAAA9C,MAAC4S,EACC,UAAA9P,OAACkQ,EAAY,WAAU,MACrB,UAAClQ,OAAA,OAAI,UAAU,yCACb,UAAC9C,EAAA,UAAG,UAAU,wBAAwB,SAAe,oBACrDA,MAAC4e,GAAc,WAAU,sBAAuB,IAClD,EACA9b,OAAC,IAAE,WAAU,qBAAqB,cAC9B+jB,EAAe,WAAW,eAAe,GAC7C,EACA/jB,OAAC,IAAE,WAAU,qCACV,UAAe+jB,EAAA,gBAAgB,cAClC,IACF,CACF,GAEC7mB,MAAA4S,EAAA,CACC,SAAC9P,OAAAkQ,EAAA,CAAY,UAAU,MACrB,UAAClQ,OAAA,OAAI,UAAU,yCACb,UAAC9C,EAAA,UAAG,UAAU,wBAAwB,SAAa,kBACnDA,MAAC8nB,GAAU,WAAU,sBAAuB,IAC9C,EACAhlB,OAAC,IAAE,WAAU,qBAAqB,cAC9B+jB,EAAe,aAAa,eAAe,GAC/C,EACC7mB,EAAA,SAAE,UAAU,qCAAqC,SAElD,kBACF,CACF,GAECA,MAAA4S,EAAA,CACC,SAAC9P,OAAAkQ,EAAA,CAAY,UAAU,MACrB,UAAClQ,OAAA,OAAI,UAAU,yCACb,UAAC9C,EAAA,UAAG,UAAU,wBAAwB,SAAY,iBAClDA,MAAC+nB,GAAW,WAAU,sBAAuB,IAC/C,EACAjlB,OAAC,IAAE,WAAU,qBAAqB,cAC9B+jB,EAAe,YAAY,eAAe,GAC9C,EACC7mB,EAAA,SAAE,UAAU,qCAAqC,SAElD,sBACF,CACF,GAECA,MAAA4S,EAAA,CACC,SAAC9P,OAAAkQ,EAAA,CAAY,UAAU,MACrB,UAAClQ,OAAA,OAAI,UAAU,yCACb,UAAC9C,EAAA,UAAG,UAAU,wBAAwB,SAAS,cAC/CA,MAACojB,GAAQ,WAAU,wBAAyB,IAC9C,EACCpjB,MAAAijB,GAAA,CAAa,OAAQ4D,EAAe,UAAY,GAChD7mB,EAAA,SAAE,UAAU,qCAAqC,SAElD,sBACF,CACF,IACF,GAECgE,GAAA,YAAAA,EAAS,QAAS,SAChBlB,EAAA,YAAI,UAAU,YACb,UAAA9C,MAAC,OAAI,UAAU,yCACb,SAAC8C,EAAA,WAAG,UAAU,iDACZ,UAAC9C,MAAAgoB,GAAA,CAAM,UAAU,SAAU,GAAE,oBAC/B,CACF,GACCxkB,GAASxD,EAAA,IAAC,MAAI,WAAU,oBAAqB,SAAMwD,EAAA,EACnDU,QACE,MAAI,sBAAU,GAEdlE,EAAA,WAAI,UAAU,aACZ,SAAA2mB,EAAM,IAAKhjB,SACT,MAAkB,WAAU,wBAC3B,SAACb,OAAA,OAAI,UAAU,oCACb,UAAAA,OAAC,MACC,WAAA9C,EAAA,IAAC,IAAE,WAAU,gBAAiB,SAAA2D,EAAK,UAAU,QAC5C,IAAE,WAAU,wBAAyB,SAAAA,EAAK,KAAM,IACnD,EACAb,OAAC,MAAI,WAAU,aACb,UAAAA,EAAA,KAAC,UACC,MAAOa,EAAK,KACZ,SAAWkD,GAAMogB,EAAiBtjB,EAAK,GAAI,CAAE,KAAMkD,EAAE,OAAO,MAAO,EACnE,UAAU,qBAEV,UAAC7G,EAAA,cAAO,MAAM,OAAO,SAAI,SACxBA,EAAA,cAAO,MAAM,YAAY,SAAS,cAClCA,EAAA,cAAO,MAAM,QAAQ,SAAK,WAC7B,EACA8C,EAAA,KAAC,UACC,MAAOa,EAAK,kBACZ,SAAWkD,GAAMogB,EAAiBtjB,EAAK,GAAI,CAAE,kBAAmBkD,EAAE,OAAO,MAAO,EAChF,UAAU,qBAEV,UAAC7G,EAAA,cAAO,MAAM,OAAO,SAAI,SACxBA,EAAA,cAAO,MAAM,QAAQ,SAAK,UAC1BA,EAAA,cAAO,MAAM,MAAM,SAAG,QACtBA,EAAA,cAAO,MAAM,UAAU,SAAO,cACjC,CACF,IACF,CA3BQ2D,IAAK,EA4Bf,CACD,CACH,IAEJ,EAGFb,OAAC,MAAI,WAAU,wCACb,UAACA,OAAA,OAAI,UAAU,YACb,UAACA,OAAA,MAAG,UAAU,iDACZ,UAAC9C,MAAAioB,GAAA,CAAK,UAAU,SAAU,GAAE,qBAC9B,QACC,MAAI,WAAU,YACZ,SAAgB1B,EAAA,IAAKc,GACpBrnB,EAAA,IAACoT,GAAA,CAEE,GAAGiU,EAAM,SACV,cAAcrjB,GAAA,YAAAA,EAAS,qBAAsB,QAFxCqjB,EAAM,SAAS,GAIvB,CACH,IACF,EAEAvkB,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,MAAG,UAAU,iDACZ,UAAC9C,MAAA8nB,GAAA,CAAU,UAAU,SAAU,GAAE,qBACnC,QACC,MAAI,WAAU,YACZ,SAAgBrB,EAAA,IAAKrJ,GACpBpd,EAAA,IAACoT,GAAA,CAEE,GAAGgK,EACJ,cAAcpZ,GAAA,YAAAA,EAAS,qBAAsB,QAFxCoZ,EAAS,GAIjB,CACH,GACF,GACF,GACF,EACF,GACF,GA1JAvQ,EAAS,GAAG,EACL,KA2JX,CCjRgB,SAAAqb,GAAkB,CAAE,YAAAC,GAAuC,CACnE,MAAE,QAAAnkB,CAAQ,EAAIc,GAAQ,EACtBsjB,GAAcpkB,GAAA,YAAAA,EAAS,oBAAqB,OAElD,aACG,MAAI,WAAU,sBACb,SAAClB,EAAA,YAAI,UAAU,yBACb,UAACA,OAAA,OAAI,UAAU,oBACb,UAAC9C,EAAA,UAAG,UAAU,0BAA0B,SAAgB,qBACvDA,EAAA,SAAE,UAAU,kCAAkC,SAE/C,kEACF,EAECA,MAAA,OAAI,UAAU,0DACZ,SAAO,eAAQiV,EAAkB,EAAE,IAAI,CAAC,CAACoT,EAAKpR,CAAI,IACjDnU,EAAA,KAAC8P,EAAA,CAEC,UAAW,YAAYyV,IAAQ,MAAQ,yFAA2F,EAAE,GAEnI,UAAAA,IAAQ,OACProB,MAAC,MAAI,WAAU,uLAAuL,SAEtM,wBAGD6S,EACC,WAAC/P,OAAA,OAAI,UAAU,oCACb,UAAA9C,EAAA,IAAC,KAAG,WAAU,qBAAsB,SAAAiX,EAAK,KAAK,EAC7CoR,IAAQ,WACNroB,EAAA,IAAA0N,GAAA,CAAM,UAAU,yBAA0B,IAE/C,EACA5K,OAAC,MAAI,WAAU,OACb,UAAA9C,EAAA,IAAC,OAAK,WAAU,qBAAsB,SAAAiX,EAAK,MAAM,EAChDjX,EAAA,YAAK,UAAU,qBAAqB,SAAM,WAC7C,IACF,EAECA,MAAAgT,EAAA,CACC,SAAChT,MAAA,MAAG,UAAU,YACX,SAAAiX,EAAK,SAAS,IAAI,CAACqR,EAAS7lB,IAC1BK,OAAA,MAAe,UAAU,yBACxB,UAAC9C,MAAAuoB,GAAA,CAAM,UAAU,+BAAgC,GACjDvoB,MAAC,QAAM,SAAQsoB,CAAA,EAFR,GAAA7lB,CAGT,CACD,CACH,GACF,QAECwQ,GACC,UAAAjT,EAAA,IAAC0F,EAAA,CACC,UAAU,SACV,QAAS2iB,IAAQ,MAAQ,UAAY,UACrC,QAAS,IAAMF,EAAYlR,EAAK,OAAO,EACvC,SAAUmR,IAAgBC,EAAI,YAAY,EAEzC,SAAgBD,IAAAC,EAAI,YAAY,EAC7B,eACA,aAER,KA5CKA,CAAA,CA8CR,CACH,IACF,CACF,EAEJ,CCpEA,SAAwBG,IAAc,CACpC,KAAM,CAAE,KAAA7kB,EAAM,QAAAK,EAAS,QAAAO,CAAA,EAAYO,GAAQ,EACrC,CAAE,MAAAlD,CAAM,EAAIS,GAAS,EACrB,CAACge,EAAiBC,CAAkB,EAAIzb,EAAM,SAAS,EAAK,EAC5D,CAAC4b,EAAUC,CAAW,EAAI7b,EAAM,SAA8B,QAAQ,EAEtEmS,EAAkB,MAAO7B,GAAoB,CACjD,GAAI,CAACxR,EAAM,CAEI,qBAAQ,gCAAiCwR,CAAO,EAG7DuL,EAAY,QAAQ,EACpBJ,EAAmB,EAAI,EACvB,OAGE,IACI,MAAApL,GAAsBC,EAASxR,EAAK,EAAE,OAC9B,CACR/B,EAAA,CACJ,MAAO,QACP,YAAa,0DACb,QAAS,cACV,EAEL,EAGE,OAAAkB,EAAA,KAAC,MAAI,WAAU,6BACb,UAAA9C,EAAA,IAACiM,GAAA,CACC,gBAAiB,CAAC,CAACtI,EACnB,YAAaK,GAAW,OACxB,SAAU,IAAM,CACd0c,EAAY,QAAQ,EACpBJ,EAAmB,EAAI,CACzB,EACA,SAAU,IAAM,CACdI,EAAY,QAAQ,EACpBJ,EAAmB,EAAI,CACzB,EACA,UAAW,SAAY,CACjB,IACF,MAAM/b,EAAQ,EACd,OAAO,SAAS,KAAO,UAChBf,EAAO,CACN,cAAM,qBAAsBA,CAAK,EAC3C,CACF,CACF,EACAxD,EAAA,IAACiS,GAAA,CACC,MAAM,2BACN,SAAS,iGACT,gBAAgB,8EAChB,WAAY,GACZ,UAAW,GACX,OAAO,YACT,SACC,OACC,WAACjS,MAAAkoB,GAAA,CAAkB,YAAalR,CAAiB,GACjDlU,OAAC,MAAI,WAAU,+BACb,UAACA,OAAA,OAAI,UAAU,kDACb,UAAC9C,EAAA,UAAG,UAAU,0BAA0B,SAExC,iDACAA,MAAC,KAAE,SAKH,iPAECA,EAAA,UAAG,UAAU,mCAAmC,SAAa,yBAC7D,KACC,WAAAA,MAAC,MAAG,SAEJ,+DACAA,MAAC,MAAG,SAA4C,iDAChDA,MAAC,MAAG,SAAmD,wDACvDA,MAAC,MAAG,SAA0C,+CAC9CA,MAAC,MAAG,SAAuC,6CAC7C,EAECA,EAAA,UAAG,UAAU,mCAAmC,SAAc,mBAC/DA,MAAC,KAAE,SAMH,mQAECA,EAAA,UAAG,UAAU,mCAAmC,SAEjD,yBACAA,MAAC,KAAE,SAIH,mLACF,QACCwa,GAAgB,IACnB,IACF,QACCL,GAAO,IAERna,EAAA,IAACwV,GAAA,CACC,OAAQ6K,EACR,QAAS,IAAMC,EAAmB,EAAK,EACvC,YAAaG,CAAA,EACf,EACF,CAEJ,CC7GO,SAASgI,GAAgB3oB,EAAO,CACrC,KAAM,CAAC4oB,EAAMC,CAAO,EAAI9jB,EAAM,SAAS,CAAC,EAClC,CAAC8d,EAASC,CAAU,EAAI/d,EAAM,SAAS,EAAK,EAC5C,CAAE,KAAAlB,CAAK,EAAImB,GAAQ,EACnB,CAAE,MAAAlD,CAAM,EAAIS,GAAS,EACrB,CAAC8T,EAAUC,CAAW,EAAIvR,EAAM,SAAS,CAC7C,aAAc,GACd,YAAa,GACb,gBAAiB,EAAC,CACnB,EAEK+jB,EAAiB,SAAY,CACjC,GAAKjlB,EACL,CAAAif,EAAW,EAAI,EAEX,IACI,MAAE,MAAApf,GAAU,MAAMP,EACrB,KAAK,UAAU,EACf,OAAO,CACN,WACEkT,EAAS,cACT,mDAAmDxS,EAAK,KAAK,GAC/D,WACEwS,EAAS,aACT,+DACF,kBAAmBA,EAAS,gBAC5B,qBAAsB,EACvB,GACA,GAAG,KAAMxS,EAAK,EAAE,EAEnB,GAAIH,EAAa,MAAAA,EAEX5B,EAAA,CACJ,MAAO,kBACP,YAAa,8CACd,EACD9B,EAAM,QAAQ,OACA,CACR8B,EAAA,CACJ,MAAO,QACP,YAAa,8CACb,QAAS,cACV,SACD,CACAghB,EAAW,EAAK,GAEpB,EAEMiG,EAAQ,CACZ,CACE,MAAO,gBACP,YAAa,kDACb,UACE/lB,EAAA,KAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,YACb,UAAA9C,MAACuL,GAAM,SAAiB,sBACxBvL,EAAA,IAACoL,EAAA,CACC,YAAY,oDACZ,MAAO+K,EAAS,aAChB,SAAWtP,GACTuP,EAAaE,IAAU,CACrB,GAAGA,EACH,aAAczP,EAAE,OAAO,OACvB,GAEN,EACF,EACCsP,EAAS,cACRnW,EAAA,IAAC,OACC,IAAKmW,EAAS,aACd,IAAI,kBACJ,UAAU,+CACZ,CAEJ,EAEJ,EACA,CACE,MAAO,mBACP,YAAa,2CACb,UACErT,EAAA,KAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,YACb,UAAA9C,MAACuL,GAAM,SAAgB,qBACvBvL,EAAA,IAACoL,EAAA,CACC,YAAY,oDACZ,MAAO+K,EAAS,YAChB,SAAWtP,GACTuP,EAAaE,IAAU,CACrB,GAAGA,EACH,YAAazP,EAAE,OAAO,OACtB,GAEN,EACF,EACCsP,EAAS,aACRnW,EAAA,IAAC,OACC,IAAKmW,EAAS,YACd,IAAI,iBACJ,UAAU,uCACZ,CAEJ,EAEJ,EACA,CACE,MAAO,oBACP,YAAa,uDACb,gBACG,MAAI,WAAU,YACb,SAACnW,MAAA,OAAI,UAAU,yBACZ,UACC,gBACA,gBACA,mBACA,eACA,kBACA,yBACA,IAAK8oB,GACL9oB,EAAA,IAAC0F,EAAA,CAEC,QACEyQ,EAAS,gBAAgB,SAAS2S,CAAM,EACpC,UACA,UAEN,QAAS,IACP1S,EAAaE,IAAU,CACrB,GAAGA,EACH,gBAAiBA,EAAK,gBAAgB,SAASwS,CAAM,EACjDxS,EAAK,gBAAgB,OAAQpG,GAAMA,IAAM4Y,CAAM,EAC/C,CAAC,GAAGxS,EAAK,gBAAiBwS,CAAM,GACpC,EAEJ,UAAU,iEAEV,SAAA9oB,EAAA,IAAC,QAAK,UAAU,yBACb,WAAO,QAAQ,IAAK,GAAG,CAC1B,IAlBK8oB,CAoBR,EACH,EACF,GAGN,EAGE,OAAA9oB,MAACmK,GAAO,MAAMrK,EAAM,OAAQ,aAAcA,EAAM,QAC9C,SAAAgD,OAAC6H,GAAc,WAAU,mBACvB,UAAA7H,OAACgI,GACC,WAAA9K,EAAA,IAACgL,GAAa,UAAA6d,EAAMH,CAAI,EAAE,MAAM,EAC/B1oB,EAAA,IAAAkL,GAAA,CAAmB,SAAM2d,EAAAH,CAAI,EAAE,WAAY,IAC9C,QAEC,MAAI,WAAU,OAAQ,SAAMG,EAAAH,CAAI,EAAE,UAAU,EAE7C5lB,OAAC,MAAI,WAAU,uBACb,UAAA9C,EAAA,IAAC0F,EAAA,CACC,QAAQ,UACR,QAAS,IAAMijB,EAASzJ,GAAM,KAAK,IAAI,EAAGA,EAAI,CAAC,CAAC,EAChD,SAAUwJ,IAAS,EACpB,oBAED,EACA1oB,EAAA,IAAC0F,EAAA,CACC,QAAS,IAAM,CACTgjB,IAASG,EAAM,OAAS,EACXD,EAAA,EAEPD,EAACzJ,GAAM,KAAK,IAAI2J,EAAM,OAAS,EAAG3J,EAAI,CAAC,CAAC,CAEpD,EACA,SAAUyD,EAET,SAAS+F,IAAAG,EAAM,OAAS,EAAI,iBAAmB,QAClD,CACF,IACF,CACF,EAEJ,CC9LA,SAAwBE,IAAsB,CAC5C,MAAMlc,EAAWC,GAAY,EACvB,CAACkc,CAAY,EAAIC,GAAgB,EACjC,CAAE,MAAArnB,CAAM,EAAIS,GAAS,EACrB,CAAE,KAAAsB,CAAK,EAAImB,GAAQ,EACnB,CAACokB,EAAgBC,CAAiB,EAAItlB,WAAS,EAAI,EAEzDW,mBAAU,IAAM,CACIwkB,EAAa,IAAI,YAAY,GAEvCpnB,EAAA,CACJ,MAAO,2BACP,YACE,sEACH,EAIEsnB,GACHrc,EAAS,YAAY,GAEtB,CAACqc,EAAgBrc,EAAUmc,EAAcpnB,CAAK,CAAC,EAI9CkB,EAAA,KAAA6D,WAAA,WAAC3G,EAAA,WAAI,UAAU,2DACb,SAACA,EAAA,WAAI,UAAU,8BACb,SAAA8C,OAAC,MAAI,WAAU,gDACb,UAAC9C,MAAA,OAAI,UAAU,oFACb,SAAAA,EAAA,IAAC,OACC,UAAU,yBACV,KAAK,OACL,OAAO,eACP,QAAQ,YAER,SAAAA,EAAA,IAAC,QACC,cAAc,QACd,eAAe,QACf,YAAa,EACb,EAAE,kBACJ,GAEJ,EACCA,EAAA,UAAG,UAAU,wCAAwC,SAEtD,6BACCA,EAAA,SAAE,UAAU,qBAAqB,SAGlC,wEACCA,EAAA,SAAE,UAAU,wBAAwB,SAErC,mCACF,EACF,GACF,EAEAA,EAAA,IAACyoB,GAAA,CACC,OAAQS,EACR,QAAS,IAAM,CACbC,EAAkB,EAAK,EACvBtc,EAAS,YAAY,EACvB,EACF,EACF,CAEJ,CCpEA,SAAwBuc,IAAqB,CAC3C,MAAMvc,EAAWC,GAAY,EACvB,CAAE,MAAAlL,CAAM,EAAIS,GAAS,EAE3BmC,mBAAU,IAAM,CACR5C,EAAA,CACJ,MAAO,yBACP,YACE,mFACF,QAAS,cACV,EAGK,MAAAynB,EAAQ,WAAW,IAAM,CAC7Bxc,EAAS,GAAG,GACX,GAAI,EAEA,UAAM,aAAawc,CAAK,CACjC,EAAG,EAAE,EAGHrpB,MAAC,MAAI,WAAU,2DACb,SAAAA,MAAC,MAAI,WAAU,8BACb,SAAA8C,EAAA,KAAC,MAAI,WAAU,gDACb,UAAC9C,MAAA,OAAI,UAAU,kFACb,SAAAA,EAAA,IAAC,OACC,UAAU,uBACV,KAAK,OACL,OAAO,eACP,QAAQ,YAER,SAAAA,EAAA,IAAC,QACC,cAAc,QACd,eAAe,QACf,YAAa,EACb,EAAE,wBACJ,GAEJ,EACCA,EAAA,UAAG,UAAU,wCAAwC,SAEtD,2BACCA,EAAA,SAAE,UAAU,qBAAqB,SAGlC,qFACCA,EAAA,SAAE,UAAU,wBAAwB,SAErC,uCACF,EACF,GACF,CAEJ,CC9CA,MAAMspB,GAAgB,EAAI,KAAO,KAC3BC,GAAqB,CAAC,aAAc,YAAa,YAAY,EAE5D,SAASC,GAAa,CAAE,iBAAAC,EAAkB,SAAAC,EAAU,aAAAC,GAAmC,CAC5F,KAAM,CAACC,EAAaC,CAAc,EAAIhmB,WAAS,EAAK,EAC9C,CAAE,MAAAjC,CAAM,EAAIS,GAAS,EACrBynB,EAAejlB,EAAM,OAAyB,IAAI,EAElDklB,EAAmB,MAAOrlB,GAA+C,OAC7E,MAAMslB,GAAO3lB,EAAAK,EAAM,OAAO,QAAb,YAAAL,EAAqB,GAClC,GAAK2lB,EAGD,IAAAA,EAAK,KAAOV,GAAe,CACvB1nB,EAAA,CACJ,MAAO,iBACP,YAAa,mCACb,QAAS,cACV,EACD,OAIF,GAAI,CAAC2nB,GAAmB,SAASS,EAAK,IAAI,EAAG,CACrCpoB,EAAA,CACJ,MAAO,oBACP,YAAa,0CACb,QAAS,cACV,EACD,OAGE,IACFioB,EAAe,EAAI,EACnB,MAAMH,EAASM,CAAI,EACbpoB,EAAA,CACJ,MAAO,UACP,YAAa,uCACd,QACM4B,EAAO,CACN,cAAM,0BAA2BA,CAAK,EACxC5B,EAAA,CACJ,MAAO,gBACP,YAAa,sDACb,QAAS,cACV,SACD,CACAioB,EAAe,EAAK,GAExB,EAGE,OAAA/mB,EAAA,KAAC,MAAI,WAAU,mCACb,UAACA,OAAAmF,GAAA,CAAO,UAAU,YAChB,UAACjI,MAAAmI,GAAA,CAAY,IAAKshB,CAAkB,GACpCzpB,MAACqI,IAAgB,SAAashB,CAAA,IAChC,EACA3pB,EAAA,IAAC,SACC,KAAK,OACL,IAAK8pB,EACL,UAAU,SACV,OAAQP,GAAmB,KAAK,GAAG,EACnC,SAAUQ,CAAA,CACZ,EACA/pB,EAAA,IAAC0F,EAAA,CACC,QAAQ,UACR,QAAS,IAAM,cAAArB,EAAAylB,EAAa,UAAb,YAAAzlB,EAAsB,SACrC,SAAUulB,EAET,WAAc,eAAiB,yBAClC,EACC5pB,EAAA,SAAE,UAAU,gCAAgC,SAE7C,gEACF,CAEJ,CC5EA,SAAwBiqB,IAAkB,OACxC,KAAM,CAAE,KAAAtmB,EAAM,QAAAK,CAAQ,EAAIc,GAAQ,EAC5B,CAAE,MAAAlD,CAAM,EAAIS,GAAS,EACrB,CAAC6B,EAAWC,CAAY,EAAIN,WAAS,EAAK,EAC1C,CAACsS,EAAUC,CAAW,EAAIvS,WAAS,CACvC,UAAUG,GAAA,YAAAA,EAAS,YAAa,GAChC,gBAAiB,GACjB,YAAa,GACb,gBAAiB,GAClB,EAEKkmB,EAAqB,MAAOF,GAAe,CAC/C,GAAKrmB,EAED,IAEF,MAAMwmB,EAAUH,EAAK,KAAK,MAAM,GAAG,EAAE,IAAI,EACnCI,EAAW,GAAGzmB,EAAK,EAAE,IAAI,KAAK,IAAK,KAAIwmB,CAAO,GAC9CE,EAAW,GAAG1mB,EAAK,EAAE,IAAIymB,CAAQ,GAGjC,CAAE,MAAOE,EAAa,KAAA/mB,CAAA,EAAS,MAAMN,EAAS,QACjD,KAAK,SAAS,EACd,OAAOonB,EAAUL,EAAM,CACtB,aAAc,OACd,OAAQ,GACT,EAEH,GAAIM,EACM,oBAAM,gBAAiBA,CAAW,EACpCA,EAIF,MACJ,KAAM,CAAE,UAAAC,CAAU,GAChBtnB,EAAS,QACV,KAAK,SAAS,EACd,aAAaonB,CAAQ,EAEhB,YAAI,6BAA8BE,CAAS,EAG7C,MAAE,MAAOhS,GAAgB,MAAMtV,EAClC,KAAK,UAAU,EACf,OAAO,CACN,WAAYsnB,EACZ,WAAY,IAAI,KAAK,EAAE,YAAY,CACpC,GACA,GAAG,KAAM5mB,EAAK,EAAE,EAEnB,GAAI4U,EACM,oBAAM,wBAAyBA,CAAW,EAC5CA,EAIR,KAAM,CAAE,KAAM2O,EAAgB,MAAOsD,GAAgB,MAAMvnB,EACxD,KAAK,UAAU,EACf,OAAO,YAAY,EACnB,GAAG,KAAMU,EAAK,EAAE,EAChB,OAAO,EAEV,GAAI6mB,EACM,oBAAM,sBAAuBA,CAAW,EAC1CA,EAGA,YAAI,mCAAoCtD,CAAc,EAG9D,OAAO,SAAS,OAAO,QAEhB1jB,EAAO,CACN,oBAAM,+BAAgCA,CAAK,EAC7CA,CAAA,CAEV,EAEMinB,EAAsB,MAAO5jB,GAAuB,CAExD,GADAA,EAAE,eAAe,EACb,EAAClD,EAED,IAIE,GAHJQ,EAAa,EAAI,EAGbgS,EAAS,YAAanS,GAAA,YAAAA,EAAS,WAAW,CAC5C,KAAM,CAAE,MAAOuU,GAAgB,MAAMtV,EAClC,KAAK,UAAU,EACf,OAAO,CAAE,UAAWkT,EAAS,QAAU,GACvC,GAAG,KAAMxS,EAAK,EAAE,EAEnB,GAAI4U,EAAmB,MAAAA,CAAA,CAIzB,GAAIpC,EAAS,YAAa,CACpB,GAAAA,EAAS,cAAgBA,EAAS,gBAC9B,UAAI,MAAM,4BAA4B,EAG9C,KAAM,CAAE,MAAOuU,CAAA,EAAkB,MAAMznB,EAAS,KAAK,WAAW,CAC9D,SAAUkT,EAAS,YACpB,EAED,GAAIuU,EAAqB,MAAAA,CAAA,CAGrB9oB,EAAA,CACJ,MAAO,UACP,YAAa,+BACd,EAGDwU,EAAqBE,IAAA,CACnB,GAAGA,EACH,gBAAiB,GACjB,YAAa,GACb,gBAAiB,IACjB,QACK9S,EAAY,CACX,cAAM,0BAA2BA,CAAK,EACxC5B,EAAA,CACJ,MAAO,gBACP,YAAa4B,EAAM,SAAW,2BAC9B,QAAS,cACV,SACD,CACAW,EAAa,EAAK,EAEtB,EAEMwlB,IAAetlB,EAAAL,GAAA,YAAAA,EAAS,YAAT,YAAAK,EACjB,MAAM,KACP,IAAIsJ,GAAKA,EAAE,CAAC,GACZ,KAAK,IACL,gBAAiB,KAGlB,OAAA3N,MAACuiB,IACC,SAACviB,EAAA,WAAI,UAAU,oCACb,SAAA8C,OAAC,MAAI,WAAU,8BACb,UAAC9C,EAAA,UAAG,UAAU,qBAAqB,SAAgB,4BAElD4S,EACC,WAAA5S,MAAC6S,EACC,UAAA7S,EAAA,IAAC8S,GAAU,2BAAe,GAC5B,QACCE,EACC,UAAAhT,EAAA,IAACwpB,GAAA,CACC,iBAAkBxlB,GAAA,YAAAA,EAAS,WAC3B,SAAUkmB,EACV,aAAAP,CAAA,EAEJ,IACF,SAEC/W,EACC,WAAA5S,MAAC6S,EACC,UAAA7S,EAAA,IAAC8S,GAAU,+BAAmB,GAChC,QACCE,EACC,UAAAlQ,OAAC,QAAK,SAAU2nB,EAAqB,UAAU,YAC7C,UAAA3nB,OAAC,MACC,WAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,WAAW,SAAS,cACnCvL,EAAA,IAACoL,EAAA,CACC,GAAG,WACH,MAAO+K,EAAS,SAChB,SAAetP,GAAAuP,EAAqBE,IAAA,CAAE,GAAGA,EAAM,SAAUzP,EAAE,OAAO,OAAQ,GAC5E,EACF,SAEC,MACC,WAAC7G,EAAA,IAAAuL,EAAA,CAAM,QAAQ,QAAQ,SAAK,UAC5BvL,EAAA,IAACoL,EAAA,CACC,GAAG,QACH,OAAOzH,GAAA,YAAAA,EAAM,QAAS,GACtB,SAAQ,IACV,EACF,EAEAb,OAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,UAAG,UAAU,6BAA6B,SAAe,oBAC1D8C,OAAC,MAAI,WAAU,YACb,UAAAA,OAAC,MACC,WAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,kBAAkB,SAAgB,qBACjDvL,EAAA,IAACoL,EAAA,CACC,GAAG,kBACH,KAAK,WACL,MAAO+K,EAAS,gBAChB,SAAetP,GAAAuP,EAAqBE,IAAA,CAAE,GAAGA,EAAM,gBAAiBzP,EAAE,OAAO,OAAQ,GACnF,EACF,SACC,MACC,WAAC7G,EAAA,IAAAuL,EAAA,CAAM,QAAQ,cAAc,SAAY,iBACzCvL,EAAA,IAACoL,EAAA,CACC,GAAG,cACH,KAAK,WACL,MAAO+K,EAAS,YAChB,SAAetP,GAAAuP,EAAqBE,IAAA,CAAE,GAAGA,EAAM,YAAazP,EAAE,OAAO,OAAQ,GAC/E,EACF,SACC,MACC,WAAC7G,EAAA,IAAAuL,EAAA,CAAM,QAAQ,kBAAkB,SAAoB,yBACrDvL,EAAA,IAACoL,EAAA,CACC,GAAG,kBACH,KAAK,WACL,MAAO+K,EAAS,gBAChB,SAAetP,GAAAuP,EAAqBE,IAAA,CAAE,GAAGA,EAAM,gBAAiBzP,EAAE,OAAO,OAAQ,GACnF,CACF,GACF,IACF,EAEA7G,MAAC0F,GAAO,KAAK,SAAS,SAAUxB,EAC7B,SAAAA,EAAY,YAAc,cAC7B,IACF,CACF,GACF,GACF,EACF,GACF,CAEJ,CCvOA,MAAMymB,GAAW,UAEZ,MAAI,WAAU,8DACb,SAAC7nB,EAAA,YAAI,UAAU,kCACb,UAAC9C,EAAA,UAAG,UAAU,6DAA6D,SAE3E,QACCA,EAAA,UAAG,UAAU,oDAAoD,SAElE,mBACCA,EAAA,SAAE,UAAU,gCAAgC,SAE7C,sHAECA,MAAA,OAAI,UAAU,iCACb,SAACA,EAAA,IAAA0F,EAAA,CAAO,QAAO,GACb,SAAC5C,OAAA8nB,GAAA,CAAK,GAAG,IAAI,UAAU,0BACrB,UAAC5qB,MAAA8f,GAAA,CAAK,UAAU,SAAU,GAAE,eAE9B,EACF,EACF,IACF,CACF,GC+BE+K,GAAY,CAChB,CACE,MAAO,6DACP,OAAQ,mBACR,aAAc,IAAI,KAAK,EAAE,YAAY,EACrC,IAAK,IACL,QAAS,uGACX,EACA,CACE,MAAO,oEACP,OAAQ,oBACR,aAAc,IAAI,KAAK,KAAK,MAAQ,KAAQ,EAAE,YAAY,EAC1D,IAAK,IACL,QAAS,yHACX,EACA,CACE,MAAO,+DACP,OAAQ,uBACR,aAAc,IAAI,KAAK,KAAK,MAAQ,MAAS,EAAE,YAAY,EAC3D,IAAK,IACL,QAAS,+GACX,EACA,CACE,MAAO,uDACP,OAAQ,4BACR,aAAc,IAAI,KAAK,KAAK,MAAQ,MAAS,EAAE,YAAY,EAC3D,IAAK,IACL,QAAS,6GACX,EACA,CACE,MAAO,uDACP,OAAQ,sBACR,aAAc,IAAI,KAAK,KAAK,MAAQ,MAAS,EAAE,YAAY,EAC3D,IAAK,IACL,QAAS,6GAEb,EAEMC,GAAuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA4BvBC,GAAuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBvBC,GAAkC,CACtC,CACE,KAAM,6BACN,aAAc,uBACd,aAAc,KACd,cAAe,IACf,gBAAiB,OACjB,WAAY,CACV,0BACA,yBACA,wBAEJ,EACA,CACE,KAAM,iCACN,aAAc,mCACd,aAAc,MACd,cAAe,IACf,gBAAiB,cACjB,WAAY,CACV,yBACA,wCACA,4BAEJ,EACA,CACE,KAAM,qBACN,aAAc,4BACd,aAAc,MACd,cAAe,IACf,gBAAiB,OACjB,WAAY,CACV,0BACA,0BACA,uBACF,CAEJ,EAGA,eAAeC,IAA4B,CACrC,IAEF,KAAM,CAAE,MAAOC,CAAW,EAAI,MAAMjoB,GACjC,KAAK,iBAAiB,EACtB,OAAO,IAAI,EACX,MAAM,CAAC,EAGN,GAAAioB,GAAcA,EAAW,OAAS,QAAS,CAC7C,QAAQ,IAAI,kEAAkE,EAI9E,KAAM,CAAE,MAAOC,CAAA,EAAgB,MAAMloB,GAAS,IAAI,8BAA8B,EAEhF,OAAIkoB,GACM,cAAM,0CAA2CA,CAAW,EAC7D,KAGT,QAAQ,IAAI,4CAA4C,EACjD,IAIF,eACA3nB,EAAO,CACN,qBAAM,iDAAkDA,CAAK,EAC9D,GAEX,CAGA,eAAsB4nB,IAAoB,CACpC,IAEF,MAAMhW,EAAW,MAAM,MACrB,2GACF,EAEI,IAACA,EAAS,GACZ,MAAM,IAAI,MAAM,uBAAuBA,EAAS,MAAM,EAAE,EAGpD,MAAA7R,EAAO,MAAM6R,EAAS,KAAK,EACjC,OAAI7R,EAAK,UAAYA,EAAK,SAAS,OAAS,EACnCA,EAAK,SAAS,IAAK8nB,IAAkB,CAC1C,MAAOA,EAAQ,MACf,OAAQA,EAAQ,OAAO,KACvB,aAAcA,EAAQ,YACtB,IAAKA,EAAQ,IACb,QAASA,EAAQ,aACjB,GAIJ,QAAQ,IAAI,oDAAoD,EACzDR,UACArnB,EAAO,CACN,qBAAM,gCAAiCA,CAAK,EAE7CqnB,EAAA,CAEX,CAGA,eAAsBS,GAAuBC,EAAgB,CACvD,IAEF,MAAMC,EAAS,0CACf,GAAI,CAACA,GAAUA,EAAO,SAAS,cAAc,EAC3C,eAAQ,KAAK,uDAAuD,EAC7DV,GAIH,MAAAW,EAAM,0FAA0FD,CAAM,GAEtGpW,EAAW,MAAM,MAAMqW,EAAK,CAChC,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,SAAU,CACR,CACE,MAAO,CACL,CACE,KAAMF,CAAA,CACR,CACF,CAEJ,EACA,iBAAkB,CAChB,YAAa,GACb,gBAAiB,KAEpB,GACF,EAEG,IAACnW,EAAS,GACZ,MAAM,IAAI,MAAM,uBAAuBA,EAAS,MAAM,EAAE,EAGpD,MAAA7R,EAAO,MAAM6R,EAAS,KAAK,EAGjC,IAAIsW,EAAgB,GAUpB,OATInoB,EAAK,YAAcA,EAAK,WAAW,CAAC,GAAKA,EAAK,WAAW,CAAC,EAAE,QAI9CmoB,EAHEnoB,EAAK,WAAW,CAAC,EAAE,QAAQ,MAAM,OAChDooB,GAAcA,EAAK,IACtB,EAC0B,IAAKA,GAAcA,EAAK,IAAI,EAAE,KAAK;AAAA,CAAI,EACxDpoB,EAAK,OACdmoB,EAAgBnoB,EAAK,MAGlBmoB,IACH,QAAQ,KAAK,iDAAiD,EACvDZ,UAIFtnB,EAAO,CACN,qBAAM,6BAA8BA,CAAK,EAE1CsnB,EAAA,CAEX,CAwBA,eAAsBc,IAA0B,CAC1C,IACF,MAAMX,GAA0B,EAE1B,MAAE,KAAA1nB,EAAM,MAAAC,CAAM,EAAI,MAAMP,GAC3B,KAAK,iBAAiB,EACtB,OAAO,GAAG,EACV,MAAM,eAAgB,CAAE,UAAW,GAAO,EAC1C,MAAM,CAAC,EAEV,OAAIO,GACM,cAAM,kCAAmCA,CAAK,EAE/C,CACL,GAAI,UACJ,QAASsnB,GACT,aAAc,IAAI,KAAK,EAAE,YAAY,CACvC,GAGKvnB,GAAQA,EAAK,OAAS,EAAIA,EAAK,CAAC,EAAI,WACpCC,EAAO,CACN,qBAAM,oCAAqCA,CAAK,EAEjD,CACL,GAAI,UACJ,QAASsnB,GACT,aAAc,IAAI,KAAK,EAAE,YAAY,CACvC,EAEJ,CA4BA,eAAsBe,IAAoB,CACpC,IAEK,OAAAd,SACAvnB,EAAO,CACN,qBAAM,kCAAmCA,CAAK,EAC/CunB,EAAA,CAEX,CAEA,eAAsBe,IAA+B,CAC/C,IAEK,OAAAd,SACAxnB,EAAO,CACN,qBAAM,6CAA8CA,CAAK,EAC1DwnB,EAAA,CAEX,CAEsB,eAAAe,GAAuBC,EAAS,KAAM,CACtD,IAEK,OACL,OAAAA,EACA,oBAAqB,KACrB,oBAAqB,IACrB,gBAAiB,GACjB,UAAW,YACX,QAAS,CACP,8BACA,6BACA,gCAEJ,QACOxoB,EAAO,CACN,qBAAM,uCAAwCA,CAAK,EACpD,CACL,OAAAwoB,EACA,oBAAqB,KACrB,oBAAqB,IACrB,gBAAiB,GACjB,UAAW,YACX,QAAS,CACP,8BACA,+CAEJ,EAEJ,CCraO,SAASC,GAAe,CAAE,KAAAtoB,EAAM,QAAAK,EAAS,UAAAnE,EAAW,SAAAqsB,EAAW,IAA6B,CACjG,KAAM,CAACC,EAAMC,CAAO,EAAIvnB,EAAM,SAAgB,EAAE,EAC1C,CAACwnB,EAAUC,CAAW,EAAIznB,EAAM,SAAiB,EAAE,EACnD,CAAC0nB,EAAgBC,CAAiB,EAAI3nB,EAAM,SAAiB,oCAAoC,EACjG,CAAC4nB,EAA2BC,CAA4B,EAAI7nB,EAAM,SAAgB,EAAE,EACpF,CAAC8d,EAASC,CAAU,EAAI/d,EAAM,SAAS,EAAI,EAC3C,CAACrB,EAAOujB,CAAQ,EAAIliB,EAAM,SAAwB,IAAI,EAE5DA,EAAM,UAAU,IAAM,EACH,SAAY,CACvB,IAEI,MAAA8nB,EAAW,MAAMvB,GAAkB,EACzCgB,EAAQO,EAAS,MAAM,EAAG,CAAC,CAAC,EAGtB,MAAAC,EAAiB,MAAMhB,GAAwB,EACrD,GAAIgB,EACFN,EAAYM,EAAe,OAAO,MAC7B,CAEL,MAAMC,EAAc,MAAMvB,GACxB,mMACF,EACAgB,EAAYO,CAAW,EAInB,MAAAC,EAAW,MAAMjB,GAAkB,EACzCW,EAAkBM,CAAQ,EAGpB,MAAAC,EAAoB,MAAMjB,GAA6B,EAC7DY,EAA6BK,CAAiB,EAGxC,MAAAC,EAAiB,MAAMjB,GAAuB,QAE7CvoB,EAAO,CACN,cAAM,6BAA8BA,CAAK,EACjDujB,EAAS,6BAA6B,SACtC,CACAnE,EAAW,EAAK,EAEpB,GAES,CACX,EAAG,EAAE,EAGL,MAAMqK,EAAY,CAChB,CAAE,MAAO,MAAO,MAAO,IAAO,EAC9B,CAAE,MAAO,MAAO,MAAO,KAAO,EAC9B,CAAE,MAAO,MAAO,MAAO,KAAO,EAC9B,CAAE,MAAO,MAAO,MAAO,KAAO,EAC9B,CAAE,MAAO,MAAO,MAAO,IAAO,EAC9B,CAAE,MAAO,MAAO,MAAO,KAAO,CAChC,EAEMC,EAAe,CACnB,CAAE,OAAQ,SAAU,MAAO,GAAO,EAClC,CAAE,OAAQ,aAAc,MAAO,IAAO,EACtC,CAAE,OAAQ,aAAc,MAAO,IAAO,EACtC,CAAE,OAAQ,QAAS,MAAO,GAAO,EACjC,CAAE,OAAQ,YAAa,MAAO,IAAO,CACvC,EAEA,OAGKpqB,EAAA,KAAA6D,WAAA,WACCulB,GAAAlsB,EAAA,IAAC,MAAI,WAAU,SACb,SAAAA,EAAA,IAACiS,GAAA,CACC,MAAM,sCACN,SAAS,yGACT,WAAY,GACZ,UAAW,GACX,OAAO,cAEX,EAIFjS,MAAC,MAAI,WAAWjB,EAAG,SAAUc,CAAS,EACpC,SAAAiD,EAAA,KAAC,MAAI,WAAU,+BACb,UAACA,OAAA,OAAI,UAAU,8CACb,UAAAA,OAAC8P,EACC,WAAA5S,MAAC6S,GACC,SAAC7S,EAAA,UAAG,UAAU,wBAAwB,wBAAY,CACpD,GACCA,MAAAgT,EAAA,CAAY,UAAU,OACrB,SAAChT,EAAA,IAAAmtB,GAAA,CAAoB,MAAM,OAAO,OAAO,OACvC,SAACrqB,EAAA,KAAAsqB,GAAA,CAAU,KAAMH,EACf,UAACjtB,MAAAqtB,GAAA,CAAc,gBAAgB,KAAM,GACrCrtB,MAACstB,GAAM,SAAQ,OAAQ,SACtBC,GAAM,IACPvtB,EAAA,IAACwtB,GAAA,CACC,UAAYC,GAAU,CAAC,IAAIA,EAAM,gBAAgB,GAAI,eAAe,EACtE,EACAztB,EAAA,IAAC0tB,GAAA,CACC,KAAK,WACL,QAAQ,QACR,OAAO,sBACP,UAAW,CAAE,EAAG,CAAE,GACpB,CACF,EACF,EACF,IACF,SAEC9a,EACC,WAAA5S,MAAC6S,GACC,SAAC7S,EAAA,UAAG,UAAU,wBAAwB,+BAAmB,CAC3D,GACCA,MAAAgT,EAAA,CAAY,UAAU,OACrB,SAAChT,EAAA,IAAAmtB,GAAA,CAAoB,MAAM,OAAO,OAAO,OACvC,SAACrqB,EAAA,KAAAsqB,GAAA,CAAU,KAAMF,EACf,UAACltB,MAAAqtB,GAAA,CAAc,gBAAgB,KAAM,GACrCrtB,MAACstB,GAAM,SAAQ,QAAS,SACvBC,GAAM,IACPvtB,EAAA,IAACwtB,GAAA,CACC,UAAYC,GAAU,CAAC,IAAIA,EAAM,gBAAgB,GAAI,eAAe,EACtE,EACAztB,EAAA,IAAC0tB,GAAA,CACC,KAAK,WACL,QAAQ,QACR,OAAO,sBACP,UAAW,CAAE,EAAG,CAAE,GACpB,CACF,EACF,EACF,GACF,IACF,EAEA5qB,OAAC8P,EAAK,WAAU,QACd,UAAA5S,MAAC6S,GACC,SAAC7S,EAAA,UAAG,UAAU,wBAAwB,2BAAe,CACvD,UACCgT,EACC,WAAChT,EAAA,SAAE,UAAU,6BAA6B,SAI1C,4MACCA,EAAA,SAAE,UAAU,6BAA6B,SAE1C,wDACA8C,OAAC,KAAG,WAAU,4CACZ,UAAA9C,MAAC,MAAG,SAAsD,2DAC1DA,MAAC,MAAG,SAAuC,4CAC3CA,MAAC,MAAG,SAAuD,4DAC3DA,MAAC,MAAG,SAA0C,gDAChD,EACAA,MAAC0F,GAAO,SAAoB,yBAC9B,IACF,GAGC1B,GAAA,YAAAA,EAAS,qBAAsB,QAC7BlB,EAAA,KAAA8P,EAAA,CAAK,UAAU,wEACd,UAAA5S,MAAC6S,EACC,UAAA/P,OAAC,KAAG,WAAU,0CAA0C,oCAErD9C,EAAA,YAAK,UAAU,iEAAiE,SAEjF,aACF,CACF,UACCgT,EACC,WAAChT,EAAA,SAAE,UAAU,6BAA6B,SAE1C,+EACA8C,OAAC,KAAG,WAAU,4CACZ,UAAA9C,MAAC,MAAG,SAA2D,gEAC/DA,MAAC,MAAG,SAAoE,yEACxEA,MAAC,MAAG,SAAqE,2EAC3E,EACAA,MAAC0F,GAAO,SAAsB,2BAChC,GACF,IAEJ,CACF,IACF,CAEJ,CChLO,SAASioB,GAAkB,CAAE,KAAAhqB,EAAM,QAAAK,EAAS,UAAAnE,GAAqC,CACtF,KAAM,CAAC+tB,EAAaC,CAAc,EAAIhpB,EAAM,SAAS,OAAO,EAGtDooB,EAAY,CAChB,CAAE,KAAM,OAAQ,MAAO,IAAO,EAC9B,CAAE,KAAM,OAAQ,MAAO,KAAO,EAC9B,CAAE,KAAM,OAAQ,MAAO,KAAO,EAC9B,CAAE,KAAM,OAAQ,MAAO,IAAO,EAC9B,CAAE,KAAM,OAAQ,MAAO,KAAO,EAC9B,CAAE,KAAM,OAAQ,MAAO,KAAO,EAC9B,CAAE,KAAM,OAAQ,MAAO,KAAO,CAChC,EAGMC,EAAe,CACnB,CAAE,KAAM,SAAU,MAAO,EAAG,EAC5B,CAAE,KAAM,aAAc,MAAO,EAAG,EAChC,CAAE,KAAM,aAAc,MAAO,EAAG,EAChC,CAAE,KAAM,WAAY,MAAO,EAAG,EAC9B,CAAE,KAAM,WAAY,MAAO,EAAG,CAChC,EAGMY,EAAmB,CACvB,CAAE,KAAM,WAAY,MAAO,GAAI,EAC/B,CAAE,KAAM,gBAAiB,MAAO,GAAI,EACpC,CAAE,KAAM,WAAY,MAAO,GAAI,EAC/B,CAAE,KAAM,OAAQ,MAAO,GAAI,EAC3B,CAAE,KAAM,WAAY,MAAO,GAAI,CACjC,EAGMC,EAAmB,CACvB,CAAE,OAAQ,SAAU,OAAQ,GAAI,EAChC,CAAE,OAAQ,aAAc,OAAQ,GAAI,EACpC,CAAE,OAAQ,OAAQ,OAAQ,GAAI,EAC9B,CAAE,OAAQ,aAAc,OAAQ,GAAI,EACpC,CAAE,OAAQ,gBAAiB,OAAQ,GAAI,EACvC,CAAE,OAAQ,gBAAiB,OAAQ,GAAI,EACvC,CAAE,OAAQ,YAAa,OAAQ,GAAI,EACnC,CAAE,OAAQ,aAAc,OAAQ,GAAI,EACpC,CAAE,OAAQ,aAAc,OAAQ,GAAI,EACpC,CAAE,OAAQ,QAAS,OAAQ,GAAI,EAC/B,CAAE,OAAQ,WAAY,OAAQ,GAAI,CACpC,EAGMC,EAAS,CAAC,UAAW,UAAW,UAAW,UAAW,SAAS,EAGnE,OAAAlrB,EAAA,KAAC,MAAI,WAAU,8BACb,UAACA,OAAA8P,EAAA,CAAK,UAAU,OACd,UAAA9P,OAAC+P,EACC,WAAC7S,EAAA,UAAG,UAAU,wBAAwB,SAA4B,iCACjEA,EAAA,SAAE,UAAU,wBAAwB,SAErC,iFACF,SACCgT,EACC,WAAAlQ,OAACyT,IAAK,aAAa,QAAQ,MAAOqX,EAAa,cAAeC,EAC5D,UAAC/qB,OAAA2T,GAAA,CAAS,UAAU,OAClB,UAAA3T,EAAA,KAAC6T,GAAY,OAAM,QAAQ,UAAU,oBACnC,UAAC3W,MAAAiuB,GAAA,CAAc,UAAU,cAAe,GAAE,gBAE5C,EACCnrB,EAAA,KAAA6T,GAAA,CAAY,MAAM,WAAW,UAAU,oBACtC,UAAC3W,MAAAkuB,GAAA,CAAa,UAAU,cAAe,GAAE,yBAE3C,EACCprB,EAAA,KAAA6T,GAAA,CAAY,MAAM,gBAAgB,UAAU,oBAC3C,UAAC3W,MAAAmuB,GAAA,CAAU,UAAU,cAAe,GAAE,kBAExC,EACCrrB,EAAA,KAAA6T,GAAA,CAAY,MAAM,iBAAiB,UAAU,oBAC5C,UAAC3W,MAAA0e,GAAA,CAAO,UAAU,cAAe,GAAE,kBAErC,IACF,EAEA1e,EAAA,IAAC6W,GAAY,OAAM,QAAQ,UAAU,YACnC,SAAA7W,EAAA,IAACmtB,GAAoB,OAAM,OAAO,OAAO,OACvC,SAAArqB,EAAA,KAACsqB,GAAA,CACC,KAAMH,EACN,OAAQ,CAAE,IAAK,GAAI,MAAO,GAAI,KAAM,GAAI,OAAQ,EAAG,EAEnD,UAACjtB,MAAAqtB,GAAA,CAAc,gBAAgB,KAAM,GACrCrtB,MAACstB,GAAM,SAAQ,MAAO,GACtBttB,EAAA,IAACutB,GAAA,CACC,cAAgBE,GAAU,KAAKA,EAAM,KAAM,QAAQ,CAAC,CAAC,IACrD,OAAQ,CAAC,kBAAmB,iBAAiB,EAC/C,EACAztB,EAAA,IAACwtB,GAAA,CACC,UAAYC,GAAU,CAAC,IAAIA,EAAM,gBAAgB,GAAI,eAAe,EACtE,QACCW,GAAO,IACRpuB,EAAA,IAAC0tB,GAAA,CACC,KAAK,WACL,QAAQ,QACR,KAAK,4BACL,OAAO,sBACP,UAAW,CAAE,EAAG,CAAE,EAClB,YAAa,GACf,IAEJ,CACF,GAEC1tB,MAAA6W,GAAA,CAAY,MAAM,WAAW,UAAU,YACtC,SAAC7W,MAAAmtB,GAAA,CAAoB,MAAM,OAAO,OAAO,OACvC,gBAACkB,GACC,WAAAruB,EAAA,IAACsuB,GAAA,CACC,KAAMpB,EACN,GAAG,MACH,GAAG,MACH,UAAW,GACX,YAAa,IACb,KAAK,UACL,QAAQ,QACR,MAAO,CAAC,CAAE,KAAAvN,EAAM,QAAA4O,CAAQ,IAAM,GAAG5O,CAAI,MAAM4O,EAAU,KAAK,QAAQ,CAAC,CAAC,IAEnE,WAAa,IAAI,CAAC/e,EAAO/M,UACvB+rB,GAA2B,MAAMR,EAAOvrB,EAAQurB,EAAO,MAAM,GAAnD,QAAQvrB,CAAK,EAAyC,CAClE,EACH,EACAzC,MAACwtB,GAAQ,WAAYC,GAAU,CAAC,GAAGA,CAAK,IAAK,cAAc,CAAG,SAC7DW,GAAO,IACV,EACF,GACF,EAEApuB,EAAA,IAAC6W,GAAY,OAAM,gBAAgB,UAAU,YAC3C,SAAA7W,EAAA,IAACmtB,GAAoB,OAAM,OAAO,OAAO,OACvC,SAAArqB,EAAA,KAAC2rB,GAAA,CACC,KAAMX,EACN,OAAQ,CAAE,IAAK,GAAI,MAAO,GAAI,KAAM,GAAI,OAAQ,EAAG,EAEnD,UAAC9tB,MAAAqtB,GAAA,CAAc,gBAAgB,KAAM,GACrCrtB,MAACstB,GAAM,SAAQ,MAAO,SACrBC,GAAM,IACNvtB,MAAAwtB,GAAA,CAAQ,UAAYC,GAAU,CAAC,GAAGA,EAAM,eAAe,CAAC,cAAe,OAAO,CAAG,SACjFW,GAAO,IACRpuB,EAAA,IAAC0uB,GAAA,CACC,QAAQ,QACR,KAAK,uBACL,KAAK,sBACL,QAAS,IACX,IAEJ,CACF,GAEA1uB,EAAA,IAAC6W,GAAY,OAAM,iBAAiB,UAAU,YAC5C,SAAA7W,EAAA,IAACmtB,GAAoB,OAAM,OAAO,OAAO,OACvC,SAAArqB,EAAA,KAAC2rB,GAAA,CACC,KAAMV,EACN,OAAQ,CAAE,IAAK,GAAI,MAAO,GAAI,KAAM,GAAI,OAAQ,EAAG,EACnD,OAAO,WAEP,UAAC/tB,MAAAqtB,GAAA,CAAc,gBAAgB,KAAM,GACrCrtB,MAACstB,GAAM,MAAK,QAAS,SACpBC,GAAM,MAAK,WAAW,QAAQ,SAAS,MAAO,IAAK,EACpDvtB,MAACwtB,GAAQ,WAAYC,GAAU,CAAC,IAAIA,CAAK,SAAU,OAAO,CAAG,GAC7DztB,EAAA,IAAC0uB,GAAA,CACC,QAAQ,SACR,KAAK,wBACL,KAAK,sBACL,QAAS,IACX,IAEJ,CACF,IACF,EAEA1uB,MAAC,OAAI,UAAU,qCACZ,2BAAS,qBAAsB,OAC7BA,EAAA,IAAA0F,EAAA,CAAO,SAER,+BAECA,EAAO,SAAQ,UAAU,QAAS,IAAM,OAAO,SAAS,KAAO,WAAY,kCAE5E,EAEJ,GACF,IACF,EAEA5C,OAAC,MAAI,WAAU,wCACb,UAAAA,OAAC8P,EACC,WAAA5S,MAAC6S,GACC,SAAC7S,EAAA,UAAG,UAAU,wBAAwB,0BAAc,CACtD,UACCgT,EACC,WAAChT,EAAA,SAAE,UAAU,6BAA6B,SAI1C,qNACCA,EAAA,SAAE,UAAU,wBAAwB,SAGrC,qIACF,IACF,SAEC4S,EACC,WAAA5S,MAAC6S,GACC,SAAC7S,EAAA,UAAG,UAAU,wBAAwB,qCAAyB,CACjE,UACCgT,EACC,WAAChT,EAAA,SAAE,UAAU,6BAA6B,SAG1C,6HACA8C,OAAC,KAAG,WAAU,4CACZ,UAAA9C,MAAC,MAAG,SAAoD,yDACxDA,MAAC,MAAG,SAAwD,6DAC5DA,MAAC,MAAG,SAAwD,6DAC5DA,MAAC,MAAG,SAA0C,+CAChD,GACF,GACF,GACF,IACF,CAEJ,CCtOA,MAAMikB,GAAqB,CAAC,CAAE,SAAAvgB,KAA8C,CACtE,IAEM,OAAAoB,GAAA,oBAEE,SAAApB,EAAS,OACL,CAGZ,OAAA1D,MAACuiB,IACC,SAACviB,EAAA,WAAI,UAAU,6DACb,SAAA8C,OAAC8P,EAAK,WAAU,sBACd,UAAC5S,EAAA,UAAG,UAAU,qCAAqC,SAAoB,yBACtEA,EAAA,SAAE,UAAU,yCAAyC,SAEtD,+EACAA,EAAA,IAAC0F,EAAA,CACC,UAAU,SACV,QAAS,IAAM,OAAO,SAAS,OAAO,EACvC,yBAED,CACF,EACF,GACF,EAGN,EAEA,SAAwBipB,IAAqB,CAC3C,KAAM,CAACC,EAAWC,CAAY,EAAIhrB,WAAS,UAAU,EAC/C,CAAE,KAAAF,EAAM,QAAAK,CAAQ,EAAIc,GAAQ,EAElC,OACG9E,EAAA,IAAAikB,GAAA,CACC,SAACnhB,OAAA,OAAI,UAAU,uBAEb,UAAA9C,EAAA,IAACiS,GAAA,CACC,MAAM,sCACN,SAAS,yGACT,WAAY,GACZ,UAAW,GACX,OAAO,YACT,EAGAjS,MAAC,MAAI,WAAU,8BACb,SAAA8C,EAAA,KAACyT,GAAA,CACC,aAAa,WACb,MAAOqY,EACP,cAAeC,EACf,UAAU,SAEV,UAAC/rB,OAAA2T,GAAA,CAAS,UAAU,OAClB,UAACzW,EAAA,IAAA2W,GAAA,CAAY,MAAM,WAAW,SAAe,oBAC5C3W,EAAA,IAAA2W,GAAA,CAAY,MAAM,gBAAgB,SAAkB,wBACvD,EAEC3W,EAAA,IAAA6W,GAAA,CAAY,MAAM,WAAW,UAAU,OAEtC,SAAA7W,EAAA,IAACisB,GAAA,CACC,KAAAtoB,EACA,QAAAK,EACA,UAAU,OACV,SAAU,KAEd,EAEAhE,MAAC6W,GAAY,OAAM,gBAAgB,UAAU,OAC3C,SAAC7W,EAAA,IAAA2tB,GAAA,CAAkB,KAAAhqB,EAAY,QAAAK,CAAkB,EACnD,KAEJ,IACF,CACF,EAEJ,CC/FA,eAAsB8qB,GAAgBvD,EAAiC,eACjE,IAEM,YAAI,gCAAiCA,CAAM,EAWnD,MAAMnW,EAAW,MAAM,MAAM,qIAA2B,CACtD,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,SAAU,CACR,CACE,MAAO,CACL,CACE,KAAMmW,CAAA,CACR,CACF,CAEJ,EACA,iBAAkB,CAChB,YAAa,GACb,gBAAiB,KAEpB,GACF,EAEG,IAACnW,EAAS,GACZ,cAAQ,MAAM,aAAcA,EAAS,OAAQ,MAAMA,EAAS,MAAM,EAC5D,IAAI,MAAM,cAAcA,EAAS,MAAM,MAAM,MAAMA,EAAS,KAAM,GAAE,EAOrE,QAHS2Z,GAAAC,GAAAC,GAAA3qB,GAAAD,GADH,MAAM+Q,EAAS,KAAK,GACZ,aAAL,YAAA/Q,EAAkB,KAAlB,YAAAC,EAAsB,UAAtB,YAAA2qB,EAA+B,QAA/B,YAAAD,EAAuC,KAAvC,YAAAD,EAA2C,OAC5C,4DAGRvrB,EAAO,CACN,qBAAM,+BAAgCA,CAAK,EAG5C0rB,GAAoB3D,CAAM,EAErC,CAGA,eAAsBQ,GAAuBrH,EAAgC,eACvE,IACM,YAAI,6CAA8CA,CAAQ,EAQ5D,MAAA8G,EAAS,0CACT2D,EAAS,yFAET5D,EAAS,4DAA4D7G,CAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,OAO7EtP,EAAW,MAAM,MAAM,GAAG+Z,CAAM,QAAQ3D,CAAM,GAAI,CACtD,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,SAAU,CACR,CACE,MAAO,CACL,CACE,KAAMD,CAAA,CACR,CACF,CAEJ,EACA,iBAAkB,CAChB,YAAa,GACb,gBAAiB,KAEpB,GACF,EAEG,IAACnW,EAAS,GACN,UAAI,MAAM,yBAAyB,EAIrC,MAAAoC,IAAUuX,GAAAC,GAAAC,GAAA3qB,GAAAD,GADH,MAAM+Q,EAAS,KAAK,GACZ,aAAL,YAAA/Q,EAAkB,KAAlB,YAAAC,EAAsB,UAAtB,YAAA2qB,EAA+B,QAA/B,YAAAD,EAAuC,KAAvC,YAAAD,EAA2C,OAAQ,KAEnE,GAAI,CAACvX,EAAe,UAAI,MAAM,8BAA8B,EAGxD,IAAA4X,EAAY5X,EAAQ,MAAM,0BAA0B,GACxCA,EAAQ,MAAM,kBAAkB,GAChCA,EAAQ,MAAM,eAAe,EAEzC,GAAA4X,GAAaA,EAAU,CAAC,EAC1B,OAAO,KAAK,MAAMA,EAAU,CAAC,EAAE,MAAM,EAGjC,IACK,YAAK,MAAM5X,CAAO,QAClB3Q,EAAG,CACF,qBAAM,sCAAuCA,CAAC,EAC/CwoB,GAA2B3K,CAAQ,SAGvClhB,EAAO,CACN,qBAAM,uCAAwCA,CAAK,EACpD6rB,GAA2B3K,CAAQ,EAE9C,CAGA,eAAsB4K,GAAsBtD,EAA8B,eACpE,IACM,YAAI,0CAA2CA,CAAM,EAQvD,MAAAR,EAAS,0CACT2D,EAAS,yFAET5D,EAAS,+DAA+DS,CAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCAc9E5W,EAAW,MAAM,MAAM,GAAG+Z,CAAM,QAAQ3D,CAAM,GAAI,CACtD,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,SAAU,CACR,CACE,MAAO,CACL,CACE,KAAMD,CAAA,CACR,CACF,CAEJ,EACA,iBAAkB,CAChB,YAAa,GACb,gBAAiB,KAEpB,GACF,EAEG,IAACnW,EAAS,GACN,UAAI,MAAM,yBAAyB,EAIrC,MAAAoC,IAAUuX,GAAAC,GAAAC,GAAA3qB,GAAAD,GADH,MAAM+Q,EAAS,KAAK,GACZ,aAAL,YAAA/Q,EAAkB,KAAlB,YAAAC,EAAsB,UAAtB,YAAA2qB,EAA+B,QAA/B,YAAAD,EAAuC,KAAvC,YAAAD,EAA2C,OAAQ,KAEnE,GAAI,CAACvX,EAAe,UAAI,MAAM,8BAA8B,EAGxD,IAAA4X,EAAY5X,EAAQ,MAAM,0BAA0B,GACxCA,EAAQ,MAAM,kBAAkB,GAChCA,EAAQ,MAAM,eAAe,EAEzC,GAAA4X,GAAaA,EAAU,CAAC,EAC1B,OAAO,KAAK,MAAMA,EAAU,CAAC,EAAE,MAAM,EAGjC,IACK,YAAK,MAAM5X,CAAO,QAClB3Q,EAAG,CACF,qBAAM,4BAA6BA,CAAC,EACrC0oB,GAAgBvD,CAAM,SAG1BxoB,EAAO,CACN,qBAAM,4BAA6BA,CAAK,EACzC+rB,GAAgBvD,CAAM,EAEjC,CAGA,SAASkD,GAAoB3D,EAAwB,CAC/C,OAAAA,EAAO,SAAS,iBAAiB,EAC5B,8kBACEA,EAAO,SAAS,mBAAmB,EACrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8HAEA,8ZAEX,CAEA,SAAS8D,GAA2B3K,EAAuB,CAClD,OACL,sBAAuB,CACrB,MAAO,IACP,MAAO,IACP,MAAO,IACP,MAAO,IACP,MAAO,GACT,EACA,iBAAkB,CAChB,MAAO,IACP,MAAO,IACP,MAAO,IACP,MAAO,IACP,MAAO,GACT,EACA,cAAe,0BAA0BA,CAAQ,mNACjD,WAAY,CACV,kDACA,qEACA,qDACA,gDACA,4CAEJ,CACF,CAEA,SAAS6K,GAAgBvD,EAAqB,CACrC,OACL,SAAU,CACR,CACE,KAAM,GAAGA,CAAM,oBACf,gBAAiB,IACjB,QAAS,CACP,+CACA,kDACA,2DACF,EACA,aAAc,IACd,eAAgB,uBAClB,EACA,CACE,KAAM,GAAGA,CAAM,eACf,gBAAiB,IACjB,QAAS,CACP,oDACA,uCACA,yCACF,EACA,aAAc,IACd,eAAgB,mBAClB,EACA,CACE,KAAM,GAAGA,CAAM,qBACf,gBAAiB,IACjB,QAAS,CACP,oCACA,uCACA,yCACF,EACA,aAAc,IACd,eAAgB,kBAClB,EACA,CACE,KAAM,GAAGA,CAAM,qBACf,gBAAiB,IACjB,QAAS,CACP,iDACA,gDACA,0CACF,EACA,aAAc,IACd,eAAgB,qBAClB,CAEJ,CACF,CAiCO,MAAMwD,GAAmB,CAC9B,+CACA,qDACA,kDACA,qDACA,iDACA,kDACF,EAEaC,GAAiBra,GAAkB,CAE1C,GAACA,EAAS,QACL,0CAAoCA,EAAS,OAAO,UAM7D,IAAIsa,GAHS,OAAOta,GAAa,SAAWA,EAAWA,EAAS,SAGvC,QACvB,iBACA,mCACF,EAGA,OAAAsa,EAAgBA,EAAc,QAC5B,aACA,gCACF,EAGAA,EAAgBA,EAAc,QAC5B,aACA,sCACF,EAGAA,EAAgBA,EAAc,QAC5B,iBACA,oCACF,EAGOA,EAAc,MAAM;AAAA,CAAI,EAAE,IAAI,CAACC,EAAM,IAC1CA,EAAO,uBAAuBA,CAAI,UAAY,iCAC/C,EAAE,KAAK,EAAE,CACZ,EClUMC,GAAe,CAAC,CACpB,OAAAC,EAAS,CACP,CACE,MAAO,qBACP,MAAO,WACP,OAAQ,QACR,WAAY,EACd,EACA,CACE,MAAO,iBACP,MAAO,KACP,OAAQ,OACR,WAAY,EACd,EACA,CACE,MAAO,qBACP,MAAO,QACP,OAAQ,QACR,WAAY,GAEhB,EACA,SAAAC,EAAW,CACT,CACE,MAAO,+CACP,QACE,iFACF,KAAM,YACR,EACA,CACE,MAAO,gDACP,QACE,mFACF,KAAM,YACR,EACA,CACE,MAAO,mCACP,QACE,wEACF,KAAM,aAEV,EACA,KAAAnsB,EACA,QAAAK,CACF,IAAyB,CAEvB,MAAMipB,EAAY,CAChB,CAAE,MAAO,MAAO,MAAO,IAAO,EAC9B,CAAE,MAAO,MAAO,MAAO,KAAO,EAC9B,CAAE,MAAO,MAAO,MAAO,KAAO,EAC9B,CAAE,MAAO,MAAO,MAAO,KAAO,EAC9B,CAAE,MAAO,MAAO,MAAO,IAAO,EAC9B,CAAE,MAAO,MAAO,MAAO,KAAO,CAChC,EAEMC,EAAe,CACnB,CAAE,OAAQ,SAAU,MAAO,IAAQ,OAAQ,GAAI,EAC/C,CAAE,OAAQ,aAAc,MAAO,KAAQ,OAAQ,GAAI,EACnD,CAAE,OAAQ,aAAc,MAAO,KAAQ,OAAQ,GAAI,EACnD,CAAE,OAAQ,QAAS,MAAO,IAAQ,OAAQ,GAAI,EAC9C,CAAE,OAAQ,YAAa,MAAO,KAAQ,OAAQ,GAAI,CACpD,EAGM6C,EAA4B,CAChC,CAAE,KAAM,SAAU,YAAa,IAAK,aAAc,IAAQ,aAAc,IAAK,EAC7E,CAAE,KAAM,aAAc,YAAa,IAAK,aAAc,MAAQ,aAAc,GAAI,EAChF,CAAE,KAAM,aAAc,YAAa,IAAK,aAAc,KAAQ,aAAc,GAAI,EAChF,CAAE,KAAM,kBAAmB,YAAa,IAAK,aAAc,MAAQ,aAAc,GAAI,EACrF,CAAE,KAAM,gBAAiB,YAAa,IAAK,aAAc,KAAQ,aAAc,GAAI,EACnF,CAAE,KAAM,gBAAiB,YAAa,IAAK,aAAc,MAAQ,aAAc,GAAI,EACnF,CAAE,KAAM,YAAa,YAAa,IAAK,aAAc,MAAQ,aAAc,GAAI,EAC/E,CAAE,KAAM,aAAc,YAAa,IAAK,aAAc,MAAQ,aAAc,GAAI,EAChF,CAAE,KAAM,aAAc,YAAa,IAAK,aAAc,MAAQ,aAAc,GAAI,EAChF,CAAE,KAAM,QAAS,YAAa,IAAK,aAAc,MAAQ,aAAc,GAAI,EAC3E,CAAE,KAAM,WAAY,YAAa,IAAK,aAAc,MAAQ,aAAc,GAAI,CAChF,EAGMC,EAAQ,CAAC,CAAE,KAAAzsB,KAEbvD,MAAC,MAAI,WAAU,0DACb,SAAAA,EAAA,IAAC,OACC,QAAQ,cACR,UAAU,8BACV,MAAO,CAAE,SAAU,OAAQ,EAG1B,UACC,CAAE,KAAM,wCAAyC,KAAM,QAAS,EAChE,CAAE,KAAM,wCAAyC,KAAM,YAAa,EACpE,CAAE,KAAM,wCAAyC,KAAM,YAAa,EACpE,CAAE,KAAM,wCAAyC,KAAM,iBAAkB,EACzE,CAAE,KAAM,wCAAyC,KAAM,eAAgB,EACvE,CAAE,KAAM,wCAAyC,KAAM,eAAgB,EACvE,CAAE,KAAM,wCAAyC,KAAM,WAAY,EACnE,CAAE,KAAM,wCAAyC,KAAM,YAAa,EACpE,CAAE,KAAM,wCAAyC,KAAM,YAAa,EACpE,CAAE,KAAM,wCAAyC,KAAM,OAAQ,EAC/D,CAAE,KAAM,uCAAwC,KAAM,UAAW,GACjE,IAAKgsB,GAAW,CAChB,MAAMiE,EAAa1sB,EAAK,SAAU6X,GAAE,OAAS4Q,EAAO,IAAI,EAClDkE,GAASD,GAAA,YAAAA,EAAY,cAAe,EAC1C,cACG,IACC,WAAAjwB,EAAA,IAAC,QACC,EAAGgsB,EAAO,KACV,KAAM,OAAO,KAAOkE,EAAS,GAAG,cAChC,OAAO,QACP,YAAY,IACZ,UAAU,qEACZ,QACC,QAAO,aAAGlE,EAAO,IAAI,MAAMkE,CAAM,GAAI,KARhClE,EAAO,IASf,CAEH,KAEL,EAIE,CAACmE,EAAgBC,CAAiB,EAAIvsB,WAAiB,EAAE,EACzD,CAACwsB,EAAmBC,CAAoB,EAAIzsB,WAAS,EAAK,EAC1D,CAAC0sB,EAAoBC,CAAqB,EAAI3sB,WAAS,EAAK,EAE5D4sB,EAAsB,MAAO/L,GAAqB,CACtD4L,EAAqB,EAAI,EACrB,IACF,MAAMlb,EAAW,MAAM0Z,GACrB,+DAA+DpK,CAAQ,wFACzE,EACA0L,EAAkBhb,CAAQ,QACnB5R,EAAO,CACN,cAAM,kCAAmCA,CAAK,EACtD4sB,EACE,yIACF,SACA,CACAE,EAAqB,EAAK,EAE9B,EAEM,CAACtD,EAAgB0D,CAAiB,EAAI7sB,WAA2B,EAAE,EACnE,CAAC8sB,EAAUC,CAAW,EAAI/sB,WAAwB,EAAE,EACpD,CAACgtB,EAAoBC,CAAqB,EAAIjtB,WAAS,EAAK,EAC5D,CAACktB,EAAuBC,CAAwB,EAAIntB,WAAS,EAAK,EAClE,CAACotB,EAAoBC,CAAqB,EAAIrtB,WAAS,EAAK,EAC5D,CAACstB,EAAmBC,CAAoB,EAAIvtB,WAAS,EAAK,EAE1DwtB,EAA2B,MAAO3M,GAAqB,OAC3DoM,EAAsB,EAAI,EACtB,IACI,MAAAvtB,EAAO,MAAMwoB,GAAuBrH,CAAQ,EAG9C,SAAM,QAAQnhB,CAAI,EACpBmtB,EAAkBntB,CAAI,UACbA,EAAK,SAAW,MAAM,QAAQA,EAAK,OAAO,EAEnDmtB,EAAkBntB,EAAK,OAAO,MACzB,CAEL,MAAM+tB,EAAkB,CACtB,CACE,OAAQ5M,GAAY,iBACpB,aAAc,KACd,eAAgB,MAAU,KAAKrgB,EAAAd,EAAK,wBAAL,YAAAc,EAA4B,QAAS,KAAO,KAC3E,WAAY,GACZ,cAAed,EAAK,YAAc,CAAC,8BAA8B,EAErE,EACAmtB,EAAkBY,CAAe,SAE5B9tB,EAAO,CACN,cAAM,uCAAwCA,CAAK,EAEzCktB,EAAA,CAChB,CACE,OAAQhM,EACR,aAAc,KACd,eAAgB,OAChB,WAAY,GACZ,cAAe,CACb,+BACA,yBACF,CACF,CACD,SACD,CACAoM,EAAsB,EAAK,EAE/B,EAEMS,EAAgB,MAAOvF,GAAmB,CAC9CoF,EAAqB,EAAI,EACrB,IACI,MAAA7tB,EAAO,MAAM+rB,GAAsBtD,CAAM,EAG3C,SAAM,QAAQzoB,CAAI,EAAG,CAEjB,MAAAiuB,EAAejuB,EAAK,IAAgBkuB,IAAA,CACxC,GAAGA,EACH,QAASA,EAAQ,SAAW,EAAC,EAC7B,EACFb,EAAYY,CAAY,UACfjuB,EAAK,UAAY,MAAM,QAAQA,EAAK,QAAQ,EAAG,CAExD,MAAMiuB,EAAejuB,EAAK,SAAS,IAAgBkuB,IAAA,CACjD,GAAGA,EACH,QAASA,EAAQ,SAAW,EAAC,EAC7B,EACFb,EAAYY,CAAY,OAGhB,aAAK,2CAA4CjuB,CAAI,EAC7DqtB,EAAY,EAAE,QAETptB,EAAO,CACN,cAAM,2BAA4BA,CAAK,EAEnCotB,EAAA,CACV,CACE,KAAM,GAAG5E,CAAM,oBACf,MAAO,GACP,gBAAiB,IACjB,QAAS,CACP,6BACA,iBACF,EACA,eAAgB,aAClB,EACA,CACE,KAAM,GAAGA,CAAM,kBACf,MAAO,GACP,gBAAiB,IACjB,QAAS,CACP,6BACA,iBACF,EACA,eAAgB,aAClB,CACD,SACD,CACAoF,EAAqB,EAAK,EAE9B,EAEMM,EAAwB,SAAY,CACxClB,EAAsB,EAAI,EAC1B,MAAMC,EAAoB,gBAAgB,EAC1CD,EAAsB,EAAK,CAC7B,EAEMmB,EAA2B,SAAY,CAC3CX,EAAyB,EAAI,EAC7B,MAAMK,EAAyB,gBAAgB,EAC/CL,EAAyB,EAAK,CAChC,EAEMY,GAAwB,SAAY,CACxCV,EAAsB,EAAI,EAC1B,MAAMK,EAAc,gBAAgB,EACpCL,EAAsB,EAAK,CAC7B,EAEM,CAACW,GAAcC,EAAe,EAAIjuB,WAAwB,IAAI,EAC9D,CAACL,GAAOujB,EAAQ,EAAIljB,WAAwB,IAAI,EAChD,CAACkuB,GAAgBC,EAAiB,EAAInuB,WAAS,EAAI,EAEnDouB,GAAoB,SAAY,CAChC,IACFD,GAAkB,EAAI,EACtB,MAAM5c,EAAW,MAAM,MACrB,6EACF,EAEI,IAACA,EAAS,GACN,UAAI,MAAM,+BAA+B,EAG3C,MAAA7R,EAAO,MAAM6R,EAAS,KAAK,EACjB0c,GAAAvuB,EAAK,QAAQ,GAAG,EAChCwjB,GAAS,IAAI,QACNmL,EAAK,CACJ,cAAM,gCAAiCA,CAAG,EAClDnL,GAAS,8BAA8B,EACvC+K,GAAgB,IAAI,SACpB,CACAE,GAAkB,EAAK,EAE3B,EAEAxtB,mBAAU,IAAM,CAEdisB,EAAoB,gBAAgB,EACpCY,EAAyB,gBAAgB,EACzCE,EAAc,gBAAgB,EACZU,GAAA,EAGZ,MAAAE,EAAkB,YAAY,IAAM,CACtBF,GAAA,GACjB,GAAK,EAED,UAAM,cAAcE,CAAe,CAC5C,EAAG,EAAE,EAKDrvB,EAAA,KAAA6D,WAAA,WAAA3G,EAAA,IAACiS,GAAA,CACC,MAAM,oCACN,SAAS,gHACT,WAAY,GACZ,UAAW,GACX,OAAO,YACT,EAEAnP,OAAC,UAAQ,WAAU,8DACjB,UAAA9C,MAAC,OAAI,UAAU,+BACb,SAAC8C,EAAA,KAAA8P,EAAA,CAAK,UAAU,wBACd,UAAA5S,MAAC6S,GACC,SAAC7S,EAAA,UAAG,UAAU,yBAAyB,4CAEvC,CACF,SACCgT,EACC,UAAAlQ,OAACyT,IAAK,aAAa,WAAW,UAAU,SACtC,UAAAvW,MAACyW,IAAS,UAAU,cAClB,SAAC3T,EAAA,YAAI,UAAU,+CACb,UAAA9C,MAAC2W,GAAY,OAAM,WAAW,UAAU,SAAS,SAEjD,0BACCA,GAAY,OAAM,WAAW,UAAU,SAAS,SAEjD,8BACCA,GAAY,OAAM,UAAU,UAAU,SAAS,SAEhD,oBACF,CACF,GAEC3W,MAAA6W,GAAA,CAAY,MAAM,WAAW,UAAU,YACtC,SAAA7W,EAAA,IAACmtB,GAAoB,OAAM,OAAO,OAAO,OACvC,SAACrqB,OAAAsvB,GAAA,CAAU,KAAMnF,EACf,UAAAjtB,MAAC,OACC,UAAA8C,EAAA,KAAC,kBACC,GAAG,aACH,GAAG,IACH,GAAG,IACH,GAAG,IACH,GAAG,IAEH,UAAA9C,EAAA,IAAC,QACC,OAAO,KACP,UAAU,sBACV,YAAa,GACf,EACAA,EAAA,IAAC,QACC,OAAO,MACP,UAAU,sBACV,YAAa,GACf,IAEJ,EACAA,MAACqtB,GAAc,iBAAgB,KAAM,GACrCrtB,MAACstB,GAAM,SAAQ,OAAQ,SACtBC,GAAM,UACNC,GAAQ,IACTxtB,EAAA,IAACqyB,GAAA,CACC,KAAK,WACL,QAAQ,QACR,OAAO,sBACP,YAAa,EACb,KAAK,oBACP,CACF,EACF,GACF,EAECryB,MAAA6W,GAAA,CAAY,MAAM,WAAW,UAAU,YACtC,SAAA7W,EAAA,IAACmtB,GAAoB,OAAM,OAAO,OAAO,OACvC,SAACrqB,OAAAsqB,GAAA,CAAU,KAAMF,EACf,UAACltB,MAAAqtB,GAAA,CAAc,gBAAgB,KAAM,GACrCrtB,MAACstB,GAAM,SAAQ,QAAS,SACvBC,GAAM,UACNC,GAAQ,IACTxtB,EAAA,IAAC0tB,GAAA,CACC,KAAK,WACL,QAAQ,QACR,OAAO,sBACT,EACA1tB,EAAA,IAAC0tB,GAAA,CACC,KAAK,WACL,QAAQ,SACR,OAAO,uBACT,CACF,EACF,GACF,EAEA1tB,EAAA,IAAC6W,GAAA,CACC,MAAM,UACN,UAAU,4BAEV,SAAA/T,EAAA,KAAC,MAAI,WAAU,+CACb,UAACA,OAAA,OAAI,UAAU,0BACb,UAAC9C,EAAA,UAAG,UAAU,mFAAmF,SAEjG,gCACC,MAAI,WAAU,iCACZ,SAAA+vB,EACE,KAAK,CAACtS,EAAGC,IAAMA,EAAE,YAAcD,EAAE,WAAW,EAC5C,IAAKuO,GACJlpB,EAAA,KAAC,OAEC,UAAU,uFAEV,UAACA,OAAA,OAAI,UAAU,0BACb,UAAA9C,EAAA,IAAC,OACC,UAAU,uBACV,MAAO,CACL,gBAAiB,OACf,KAAOgsB,EAAO,YAAc,GAC9B,cACF,CACF,SACC,MACC,WAAAhsB,EAAA,IAAC,IAAE,WAAU,cAAe,SAAAgsB,EAAO,KAAK,EACxClpB,OAAC,IAAE,WAAU,gCAAgC,cACzCkpB,EAAO,aAAa,eAAe,EACvC,GACF,IACF,EACAlpB,OAAC,MAAI,WAAU,aACb,UAACA,OAAA,KAAE,UAAU,6BAA6B,cACtCkpB,EAAO,YAAY,KACvB,EACAlpB,OAAC,IAAE,WAAU,gCACV,UAAOkpB,EAAA,aAAa,SACvB,GACF,KA1BKA,EAAO,KA4Bf,CACL,IACF,EACAhsB,MAAC,OAAI,UAAU,2FACb,eAACgwB,EAAM,MAAMD,CAAa,EAC5B,GACF,IACF,EACF,CACF,IACF,CACF,SAEC,MAAI,WAAU,+BACb,SAACjtB,EAAA,KAAA8P,EAAA,CAAK,UAAU,qDACd,UAAC9P,OAAA+P,EAAA,CAAW,UAAU,6CACpB,UAAC7S,EAAA,UAAG,UAAU,yBAAyB,SAAkB,uBACzDA,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,KAAK,OACL,QAASgsB,EACT,UAAW,WAAWnB,EAAqB,eAAiB,EAAE,GAC9D,SAAUA,GAAsBF,EAEhC,SAAArwB,MAACukB,GAAU,WAAU,SAAU,IACjC,EACF,EACCvkB,EAAA,IAAAgT,EAAA,CACE,SACCqd,EAAArwB,EAAA,IAAC,MAAI,WAAU,uCACb,SAAAA,EAAA,IAAC,MAAI,WAAU,6DAA8D,EAC/E,GAEAA,EAAA,IAAC,OACC,UAAU,4BACV,wBAAyB,CAAE,OAAQyvB,GAAcU,CAAc,CAAE,GAGvE,IACF,CACF,GAEArtB,OAAC,MAAI,WAAU,yDAEb,UAACA,OAAA8P,EAAA,CAAK,UAAU,qDACd,UAAC9P,OAAA+P,EAAA,CAAW,UAAU,6CACpB,UAAC7S,EAAA,UAAG,UAAU,yBAAyB,SAA2B,gCAClEA,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,KAAK,OACL,QAASisB,EACT,UAAW,WAAWZ,EAAwB,eAAiB,EAAE,GACjE,SAAUA,GAAyBF,EAEnC,SAAA7wB,MAACukB,GAAU,WAAU,SAAU,IACjC,EACF,EACAvkB,EAAA,IAACgT,EACE,UAAA6d,EACE7wB,MAAA,OAAI,UAAU,uCACb,SAAAA,EAAA,IAAC,MAAI,WAAU,8DAA8D,EAC/E,EAECA,EAAA,WAAI,UAAU,YACZ,SAAegtB,EAAA,IAAI,CAACsF,EAAY7vB,IAC/BK,OAAC,MAAgB,WAAU,6BACzB,UAACA,OAAA,OAAI,UAAU,yCACb,UAAA9C,EAAA,IAAC,KAAG,WAAU,wBAAyB,SAAAsyB,EAAW,OAAO,EACzDxvB,OAAC,MAAI,WAAU,uCAAuC,gBAChDwvB,EAAW,eAAiBA,EAAW,cAAgBA,EAAW,aAAe,KAAK,QAAQ,CAAC,EAAE,IACvG,IACF,QACC,MAAI,WAAU,+BACb,SAACxvB,EAAA,YAAI,UAAU,SACb,UAAC9C,MAAA,OAAI,UAAU,wCACb,SAAAA,EAAA,IAAC,OACC,UAAU,kCACV,MAAO,CAAE,MAAO,GAAGsyB,EAAW,UAAU,GAAI,IAEhD,EACAxvB,OAAC,IAAE,WAAU,qCAAqC,yBAAawvB,EAAW,WAAW,IAAC,IACxF,CACF,SACC,MAAI,WAAU,gCACZ,SAAWA,EAAA,eAAiB,MAAM,QAAQA,EAAW,aAAa,GAAKA,EAAW,cAAc,OAAS,EACtGA,EAAW,cAAc,CAAC,EAC1B,6BACN,KAtBQ7vB,CAuBV,CACD,EACH,CAEJ,IACF,EAGAK,OAAC8P,EAAK,WAAU,qDACd,UAAC9P,OAAA+P,EAAA,CAAW,UAAU,6CACpB,UAAC7S,EAAA,UAAG,UAAU,yBAAyB,SAA4B,iCACnEA,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,KAAK,OACL,QAASksB,GACT,UAAW,WAAWX,EAAqB,eAAiB,EAAE,GAC9D,SAAUA,GAAsBE,EAEhC,SAAAnxB,MAACukB,GAAU,WAAU,SAAU,IACjC,EACF,EACAvkB,MAACgT,EACE,UAAAme,EACEnxB,EAAA,WAAI,UAAU,wCACb,SAAAA,MAAC,MAAI,WAAU,wEAAyE,GAC1F,EACE2wB,EAAS,OAAS,EACpB3wB,EAAA,IAAC,MAAI,WAAU,YACZ,SAAS2wB,EAAA,IAAI,CAACc,EAAShvB,IACtBK,EAAA,KAAC,OAEC,UAAU,kEAEV,UAACA,OAAA,OAAI,UAAU,mCACb,UAAAA,OAAC,MACC,WAAA9C,EAAA,IAAC,KAAG,WAAU,6BACX,SAAAyxB,EAAQ,KACX,EACA3uB,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,YAAK,UAAU,2BAA2B,SAE3C,sBACAA,MAAC,MAAI,WAAU,oDACb,SAAAA,EAAA,IAAC,OACC,UAAU,oBACV,MAAO,CAAE,MAAO,GAAGyxB,EAAQ,KAAK,GAAI,IAExC,EACA3uB,OAAC,OAAK,WAAU,2BACb,UAAQ2uB,EAAA,MAAM,OACjB,GACF,IACF,EACA3uB,OAAC,MAAI,WAAU,8BACb,UAACA,OAAAqQ,GAAA,CAAM,UAAU,gBAAgB,cAC7Bse,EAAQ,gBAAgB,YAC5B,EACCzxB,EAAA,IAAAmT,GAAA,CAAM,QAAQ,UACZ,WAAQ,cACX,GACF,IACF,EACArQ,OAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,sBAAsB,SAAW,gBACjDA,MAAC,MAAG,UAAU,iBACX,WAAQ,SAAW,MAAM,QAAQyxB,EAAQ,OAAO,EAC/CA,EAAQ,QAAQ,IAAI,CAACc,EAAQC,IAC1B1vB,EAAA,WAAa,UAAU,2BACtB,UAAC9C,MAAAyyB,GAAA,CAAW,UAAU,gCAAiC,GACtDF,CAAA,GAFMC,CAGT,CACD,EAEA1vB,EAAA,WAAG,UAAU,2BACZ,UAAC9C,MAAAyyB,GAAA,CAAW,UAAU,gCAAiC,GAAE,oBAE3D,CAEJ,GACF,KAjDKhwB,CAAA,CAmDR,CACH,GAEAzC,EAAA,IAAC,OAAI,UAAU,yCAAyC,iDAExD,CAEJ,GACF,IACF,EAEA8C,OAAC,MAAI,WAAU,mCACb,UAACA,OAAA,OAAI,UAAU,oBACb,UAAC9C,EAAA,UAAG,UAAU,0BAA0B,SAAwB,6BAC/DA,EAAA,SAAE,UAAU,0CAA0C,SAGvD,oHACF,EAEAA,MAAC,OAAI,UAAU,8CACZ,WAAO,IAAI,CAAC0yB,EAAOjwB,IAClBzC,EAAA,IAAC4S,EAAA,CAEC,UAAW,wEAAwEnQ,IAAU,EAAI,sDAAwD,EAAE,GAE3J,SAAAK,EAAA,KAACkQ,EAAY,WAAU,MACrB,UAAClQ,OAAA,OAAI,UAAU,yCACb,UAAA9C,EAAA,IAAC,KAAG,WAAU,yCACX,SAAA0yB,EAAM,MACT,EACCjwB,IAAU,EACTzC,MAAC4e,GAAc,WAAU,2BAA2B,EAClDnc,IAAU,EACZzC,EAAA,IAAC8f,IAAK,UAAU,0BAA2B,GAE1C9f,MAAA+nB,GAAA,CAAW,UAAU,0BAA2B,IAErD,EACAjlB,OAAC,MAAI,WAAU,sCACb,UAAA9C,EAAA,IAAC,OAAK,WAAU,qCACb,SAAA0yB,EAAM,MACT,EACA1yB,EAAA,IAAC,QACC,UAAW,qBAAqB0yB,EAAM,WAAa,mBAAqB,cAAc,GAErF,SAAMA,EAAA,QACT,CACF,GACF,IA1BKjwB,CA4BR,GACH,EAEAzC,MAAC,OAAI,UAAU,yDACZ,WAAS,IAAI,CAACqrB,EAAS5oB,IACtBK,EAAA,KAAC8P,EAAA,CAEC,UAAU,uEAEV,UAAA5S,MAAC6S,EACC,UAAA/P,OAAC,MAAI,WAAU,oCACb,UAAA9C,EAAA,IAAC,KAAG,WAAU,wBAAyB,SAAAqrB,EAAQ,MAAM,EACrDrrB,MAAC,OAAK,WAAU,gCACb,aAAI,KAAKqrB,EAAQ,IAAI,EAAE,mBAAmB,QAAS,CAClD,MAAO,OACP,IAAK,UACL,KAAM,UACP,CACH,IACF,CACF,UACCrY,EACC,WAAAhT,EAAA,IAAC,IAAE,WAAU,6BAA8B,SAAAqrB,EAAQ,QAAQ,EAC3DvoB,EAAA,KAAC4C,EAAA,CACC,QAAQ,QACR,UAAU,+BACV,QAAS,IAAM,CACb,OAAO,SAAS,KAAO,YAAY,mBAAmB2lB,EAAQ,KAAK,CAAC,EACtE,EACD,sBAECrrB,MAACyyB,GAAW,WAAU,6DAA8D,KACtF,CACF,KA3BKhwB,CA6BR,GACH,QAEC,MAAI,WAAU,2BACb,SAACK,EAAA,YAAI,UAAU,sCACb,UAAC9C,EAAA,UAAG,UAAU,0BAA0B,SAAa,wBACpD,MAAI,WAAU,wCACb,SAAC8C,EAAA,KAAA8P,EAAA,CAAK,UAAU,MACd,UAAC5S,EAAA,UAAG,UAAU,6BAA6B,SAAmB,wBAC7D+xB,GACE/xB,EAAA,WAAI,UAAU,oCAAqC,GAClDwD,GACDxD,MAAA,KAAE,UAAU,eAAgB,SAAMwD,EAAA,GACjCquB,GACD7xB,MAAA,KAAE,UAAU,qBAAsB,SAAeb,EAAA0yB,EAAY,CAAE,GAE/D7xB,MAAA,KAAE,UAAU,wBAAwB,SAAiB,uBAE1D,CAEF,IACF,CACF,GACF,GACF,IACF,CAEJ,EC3wBgB,SAAA2yB,GAAe,CAAE,SAAAjvB,GAAiC,CAE9D,OAAA1D,EAAA,IAAC4G,GAAO,IAAP,CACC,QAAS,CAAE,QAAS,EAAG,EAAG,EAAG,EAC7B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAE,EAC5B,KAAM,CAAE,QAAS,EAAG,EAAG,EAAG,EAC1B,WAAY,CAAE,SAAU,EAAI,EAE3B,SAAAlD,CAAA,CACH,CAEJ,CCRA,MAAMugB,GAAqB,CAAC,CAAE,SAAAvgB,KAA8C,CACtE,IAEM,OAAAoB,GAAA,oBAEE,SAAApB,EAAS,OACL,CAGZ,OAAA1D,MAACuiB,IACC,SAACviB,EAAA,WAAI,UAAU,6DACb,SAAA8C,OAAC8P,EAAK,WAAU,sBACd,UAAC5S,EAAA,UAAG,UAAU,qCAAqC,SAAoB,yBACtEA,EAAA,SAAE,UAAU,yCAAyC,SAEtD,+EACAA,EAAA,IAAC0F,EAAA,CACC,UAAU,SACV,QAAS,IAAM,OAAO,SAAS,OAAO,EACvC,yBAED,CACF,EACF,GACF,EAGN,EAEMktB,GAAmB,IAEpB5yB,MAAAikB,GAAA,CACC,SAACjkB,MAAA6yB,GAAA,CAAoB,GACvB,EAKEA,GAAsB,IAAM,CAChC,KAAM,CAAE,KAAAlvB,EAAM,QAAAK,CAAQ,EAAIc,GAAQ,EAElC,OACG9E,EAAA,IAAAuiB,GAAA,CACC,SAACviB,MAAA2yB,GAAA,CACC,eAAC,MAAI,WAAU,6BACb,SAAA3yB,EAAA,IAAC4vB,GAAa,MAAAjsB,EAAY,QAAAK,EAAkB,EAC9C,CACF,GACF,CAEJ,EC/CO,SAAS8uB,GAAY,CAC1B,MAAAlwB,EAAQ,+CACR,QAAA4U,EAAU,kBACV,KAAAlY,EAAO,IAAI,KAAK,EAAE,YAAY,EAC9B,SAAAyzB,EAAW,YACb,EAAqB,CACnB,KAAM,CAAE,KAAApvB,EAAM,QAAAK,CAAQ,EAAIc,GAAQ,EAGhC,OAAAhC,EAAA,KAAC,MAAI,WAAU,6BACb,UAAA9C,MAACiM,IAAO,gBAAiB,CAAC,CAACtI,EAAM,YAAaK,GAAW,OAAW,EACnEhE,MAAA,QAAK,UAAU,oCACd,SAACA,EAAA,WAAI,UAAU,oBACb,SAACA,EAAA,IAAA4S,EAAA,CACC,SAAC9P,OAAAkQ,EAAA,CAAY,UAAU,MACrB,UAAChT,EAAA,UAAG,UAAU,0BAA2B,SAAM4C,EAAA,EAE/CE,OAAC,MAAI,WAAU,qDACb,UAACA,OAAA,OAAI,UAAU,0BACb,UAAC9C,MAAAgf,GAAA,CAAS,UAAU,SAAU,SAC7B,OAAM,cAAI,KAAK1f,CAAI,EAAE,oBAAqB,IAC7C,EACAwD,OAAC,MAAI,WAAU,0BACb,UAAC9C,MAAAgzB,GAAA,CAAM,UAAU,SAAU,GAC3BhzB,MAAC,QAAM,SAAS+yB,CAAA,GAClB,IACF,QAEC,MAAI,WAAU,qCACZ,SAAQvb,EAAA,MAAM;AAAA;AAAA,CAAM,EAAE,IAAI,CAACyb,EAAWxwB,UACpC,IAAc,WAAU,OACtB,SADKwwB,CAAA,EAAAxwB,CAER,CACD,CACH,IACF,EACF,EACF,CACF,IACF,CAEJ,CC1CA,MAAMywB,GAAkD,CAAC,CAAE,KAAAvvB,EAAM,QAAAK,KAAc,CAC7E,KAAM,CAACmvB,EAASC,CAAU,EAAIvvB,WAAgB,EAAE,EAC1C,CAAC8e,EAASC,CAAU,EAAI/e,WAAS,EAAI,EAE3CW,YAAU,IAAM,EAEO,SAAY,CAC3B,IACFoe,EAAW,EAAI,EAEf,WAAW,IAAM,CACJwQ,EAAA,CACT,CACE,GAAI,EACJ,MAAO,kCACP,QAAS,6GACT,KAAM,aACN,OAAQ,yBACR,SAAU,kBACV,UAAW,GACX,YAAa,GACf,EACA,CACE,GAAI,EACJ,MAAO,+BACP,QAAS,0HACT,KAAM,aACN,OAAQ,+BACR,SAAU,aACV,UAAW,GACX,YAAa,GACf,EACA,CACE,GAAI,EACJ,MAAO,8BACP,QAAS,iGACT,KAAM,aACN,OAAQ,0BACR,SAAU,SACV,UAAW,GACX,YAAa,IACf,CACD,EACDxQ,EAAW,EAAK,GACf,GAAI,QACApf,EAAO,CACN,cAAM,mCAAoCA,CAAK,EACvDof,EAAW,EAAK,EAEpB,GAEa,CACf,EAAG,EAAE,EAEC,MAAA1O,GAAelQ,GAAA,YAAAA,EAAS,qBAAsB,OAGlD,OAAAhE,MAAC,MAAI,WAAU,YACb,SAAAA,EAAA,IAAC,MAAI,WAAU,uDACZ,SAAA2iB,EACC,MAAM,CAAC,EACJ,KAAK,CAAC,EACN,IAAI,CAAChT,EAAGlN,IACPzC,MAAC4S,EAAiB,WAAU,kBAC1B,SAAA9P,OAAC,MAAI,WAAU,gBACb,UAAC9C,MAAA,OAAI,UAAU,0CAA2C,GAC1DA,MAAC,MAAI,WAAU,qCAAsC,GACrDA,MAAC,MAAI,WAAU,0CAA2C,GAC5D,EALS,EAAAyC,CAMX,CACD,EACD0wB,EAAQ,OAAS,EACnBA,EAAQ,IAAKE,GACVvwB,OAAA8P,EAAA,CAAqB,UAAU,gCAC9B,UAAC9P,OAAA+P,EAAA,CAAW,UAAU,4CACpB,UAAC/P,OAAA,OAAI,UAAU,YACb,UAAA9C,EAAA,IAAC,KAAG,WAAU,wBAAyB,SAAAqzB,EAAO,MAAM,EACpDvwB,OAAC,MAAI,WAAU,wDACb,UAAC9C,MAAAgf,GAAA,CAAS,UAAU,SAAU,GAC9Bhf,MAAC,OACE,UAAAszB,GAAe,IAAI,KAAKD,EAAO,IAAI,EAAO,SAAQ,CACjD,UAAW,GACZ,CACH,GACF,IACF,EACCA,EAAO,WACNrzB,EAAA,IAACmT,GAAA,CACC,QAAQ,UACR,UAAU,+CACX,oBAED,EAEJ,EACArQ,OAACkQ,EAAY,WAAU,YACrB,UAAAhT,EAAA,IAAC,IAAE,WAAU,6CACV,SAAAqzB,EAAO,QACV,EACAvwB,OAAC,MAAI,WAAU,+BACb,UAAC9C,MAAAuzB,GAAA,CAAI,UAAU,+BAAgC,GAC9CvzB,EAAA,YAAK,UAAU,4CACb,WAAO,QACV,GACF,IACF,QACCiT,GAAW,WAAU,gBACnB,SAAOogB,EAAA,WAAa,CAACnf,EACpBpR,EAAA,KAAC4C,EAAA,CACC,QAAQ,UACR,UAAU,SACV,QAAS,IAAM,OAAO,SAAS,KAAO,WAEtC,UAAC1F,MAAA2e,GAAA,CAAS,UAAU,cAAe,GAAE,uBAIvC3e,MAAC0F,EAAO,WAAU,SAAS,QAAO,GAChC,SAAA5C,EAAA,KAAC,IAAE,MAAMuwB,EAAO,YAAa,SAAQ,GACnC,UAACrzB,MAAAwzB,GAAA,CAAS,UAAU,cAAe,GAAE,kBAEvC,EACF,EAEJ,KAnDSH,EAAO,EAoDlB,CACD,EAEAvwB,OAAA,OAAI,UAAU,kCACb,UAAC9C,MAAA2e,GAAA,CAAS,UAAU,8CAA+C,GAClE3e,EAAA,UAAG,UAAU,2BAA2B,SAAoB,yBAC5DA,EAAA,SAAE,UAAU,wBAAwB,SAErC,uDACF,EAEJ,GACF,CAEJ,ECtIakb,GAAW,MAAOP,EAAO,EAAGW,EAAQ,IAAM,CACjD,IACI,MAAAT,GAASF,EAAO,GAAKW,EAE3B,QAAQ,IAAI,8BAA+B,CAAE,KAAAX,EAAM,MAAAW,EAAO,MAAAT,EAAO,EAE3D,MAAE,KAAAtX,EAAM,MAAAC,GAAU,MAAMP,GAC3B,KAAK,OAAO,EACZ,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAaP,EACA,MAAM4X,EAAOA,EAAQS,EAAQ,CAAC,EAC9B,MAAM,aAAc,CAAE,UAAW,GAAO,EAI3C,GAFA,QAAQ,IAAI,yBAA0B,CAAE,KAAA/X,EAAM,MAAAC,EAAO,EAEjDA,EACF,cAAQ,MAAM,wBAAyBA,EAAM,QAASA,CAAK,EACrD,IAAI,MAAM,0BAA0BA,EAAM,OAAO,EAAE,EAG3D,GAAI,CAACD,GAAQA,EAAK,SAAW,EAC3B,eAAQ,IAAI,4BAA4B,EACjC,CAAC,EAIJ,MAAA+tB,EAAkB/tB,EAAK,IAAa8e,IAAA,CACxC,GAAIA,EAAK,GACT,MAAOA,EAAK,MACZ,YAAaA,EAAK,YAClB,SAAUA,EAAK,SACf,MAAO,OAAOA,EAAK,KAAK,EACxB,eAAgB,OAAOA,EAAK,cAAc,EAC1C,gBAAiBA,EAAK,gBACtB,cAAeA,EAAK,cACpB,UAAWA,EAAK,UAChB,UAAWA,EAAK,UAChB,WAAYA,EAAK,WACjB,WAAYA,EAAK,YACjB,EAEM,mBAAI,qBAAsBiP,CAAe,EAC1CA,QACA9tB,EAAO,CACd,cAAQ,MAAM,qBAAsBA,aAAiB,MAAQA,EAAM,QAAUA,CAAK,EAC5EA,CAAA,CAEV,EC1EA,SAASiwB,GAAS,CAChB,UAAA5zB,EACA,GAAGC,CACL,EAAyC,CAErC,OAAAE,EAAA,IAAC,OACC,UAAWjB,EAAG,oCAAqCc,CAAS,EAC3D,GAAGC,CAAA,CACN,CAEJ,CAEO,SAAS4zB,IAAuB,CAEnC,OAAA5wB,EAAA,KAAC,MAAI,WAAU,4CACb,UAAC9C,MAAAyzB,GAAA,CAAS,UAAU,qBAAsB,GAC1C3wB,OAAC,MAAI,WAAU,gBACb,UAAC9C,MAAAyzB,GAAA,CAAS,UAAU,WAAY,GAChCzzB,MAACyzB,GAAS,WAAU,WAAY,GAChC3wB,OAAC,MAAI,WAAU,YACb,UAAC9C,MAAAyzB,GAAA,CAAS,UAAU,YAAa,GACjCzzB,MAACyzB,GAAS,WAAU,WAAY,IAClC,EACA3wB,OAAC,MAAI,WAAU,yBACb,UAAAA,OAAC,MACC,WAAC9C,MAAAyzB,GAAA,CAAS,UAAU,eAAgB,GACpCzzB,MAACyzB,GAAS,WAAU,UAAW,IACjC,SACC,MACC,WAACzzB,MAAAyzB,GAAA,CAAS,UAAU,eAAgB,GACpCzzB,MAACyzB,GAAS,WAAU,UAAW,GACjC,GACF,GACF,IACF,CAEJ,CClBO,SAASE,GAAS,CACvB,KAAAtR,EACA,aAAAnO,EACA,QAAAG,EACA,UAAAnQ,EACA,KAAAP,EACA,kBAAAiwB,EAAoB,EACtB,EAAkB,CAChB,MAAM/mB,EAAWC,GAAY,EACvB,CAAC+mB,EAAoBC,CAAqB,EAAIjwB,WAAS,EAAK,EAElE,GAAIK,EACF,aAAQwvB,GAAqB,IAGzB,MAAAK,EAAsBltB,GAAwB,CAElD,GADAA,EAAE,gBAAgB,EACd,CAAClD,EAAM,CACTkJ,EAAS,QAAQ,EACjB,OAEFinB,EAAsB,EAAI,CAC5B,EAEA,OAEIhxB,EAAA,KAAA6D,WAAA,WAAA7D,EAAA,KAAC8P,EAAA,CACC,UAAU,mEACV,QAASjP,EAAO0Q,EAAU,IAAMxH,EAAS,QAAQ,EAEjD,UAAC/J,OAAA,OAAI,UAAU,iDACb,UAAA9C,EAAA,IAAC,OACC,IAAKqiB,EAAK,UACV,IAAKA,EAAK,MACV,UAAU,6BACV,QAAQ,OACV,EACC,CAAC1e,GACA3D,MAAC,MAAI,WAAU,gEACb,SAAAA,EAAA,IAACmT,GAAM,SAAQ,YAAY,0BAAe,GAC5C,EAEFrQ,OAAC,MAAI,WAAU,oCACb,UAAA9C,MAACmT,IAAM,QAAQ,YAAY,UAAU,2CAClC,WAAK,cACR,QACCA,GAAM,SAAQ,YAAY,UAAU,+CAClC,WAAK,SACR,GACF,IACF,EAEAnT,EAAA,IAAC6S,EACC,UAAA/P,OAAC,MACC,WAAA9C,EAAA,IAAC,KAAG,WAAU,0CAA2C,SAAAqiB,EAAK,MAAM,EACpEvf,OAAC,MAAI,WAAU,wDACb,UAAC9C,MAAA0e,GAAA,CAAO,UAAU,SAAU,GAC3B1e,EAAA,YAAK,UAAU,eAAgB,WAAK,QAAS,GAChD,IACF,CACF,GAECA,MAAAgT,EAAA,CACC,SAAClQ,OAAA,OAAI,UAAU,YACb,UAAA9C,EAAA,IAAC,IAAE,WAAU,6CACV,SAAAqiB,EAAK,YACR,EAEAvf,OAAC,MAAI,WAAU,yBACb,UAACA,OAAA,OAAI,UAAU,YACb,UAAC9C,EAAA,SAAE,UAAU,gCAAgC,SAAK,gBACjD,IAAE,WAAU,wBAAyB,SAAeb,EAAAkjB,EAAK,KAAK,CAAE,IACnE,EACAvf,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,SAAE,UAAU,gCAAgC,SAAG,QAChD8C,OAAC,IAAE,WAAU,yCACV,UAAKuf,EAAA,eAAe,IACvB,GACF,IACF,QAEC,MAAI,WAAU,gBACb,SAACvf,EAAA,YAAI,UAAU,yBACb,UAACA,OAAA,OAAI,UAAU,YACb,UAAC9C,EAAA,SAAE,UAAU,gCAAgC,SAAe,oBAC3DA,EAAA,SAAE,UAAU,cAAe,WAAK,eAAgB,IACnD,EACA8C,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,SAAE,UAAU,gCAAgC,SAAgB,qBAC5DA,EAAA,SAAE,UAAU,+BAA+B,SAAU,eACxD,IACF,CACF,GAEC2D,GAAQiwB,GACP9wB,EAAA,KAAC4C,EAAA,CACC,QAAQ,UACR,UAAU,SACV,QAASquB,EAET,UAAC/zB,MAAA8N,GAAA,CAAc,UAAU,cAAe,GAAE,4BAE5C,EAEJ,CACF,IACF,EAECnK,GACC3D,EAAA,IAACiZ,GAAA,CACC,OAAQ4a,EACR,QAAS,IAAMC,EAAsB,EAAK,EAC1C,WAAW,QACX,OAAQzR,EAAK,GACb,KAAAA,CAAA,EACF,EAEJ,CAEJ,CCnIA,MAAM2R,GAASC,GAITC,GAAcC,GAEdC,GAAgBx0B,aAGpB,CAAC,CAAE,UAAAC,EAAW,SAAA6D,EAAU,GAAG5D,CAAM,EAAGC,IACpC+C,EAAA,KAACuxB,GAAA,CACC,IAAAt0B,EACA,UAAWhB,EACT,kTACAc,CACF,EACC,GAAGC,EAEH,UAAA4D,EACD1D,MAACs0B,GAAA,CAAqB,QAAO,GAC3B,SAACt0B,EAAA,IAAAyH,GAAA,CAAY,UAAU,oBAAqB,EAC9C,IACF,CACD,EACD2sB,GAAc,YAAcC,GAAwB,YAEpD,MAAME,GAAuB30B,EAG3B,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACw0B,GAAA,CACC,IAAAz0B,EACA,UAAWhB,EACT,uDACAc,CACF,EACC,GAAGC,EAEJ,SAAAE,MAACy0B,GAAU,WAAU,SAAU,GACjC,CACD,EACDF,GAAqB,YAAcC,GAA+B,YAElE,MAAME,GAAyB90B,EAG7B,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAAC20B,GAAA,CACC,IAAA50B,EACA,UAAWhB,EACT,uDACAc,CACF,EACC,GAAGC,EAEJ,SAAAE,MAACyH,GAAY,WAAU,SAAU,GACnC,CACD,EACDitB,GAAuB,YACrBC,GAAiC,YAEnC,MAAMC,GAAgBh1B,aAGpB,CAAC,CAAE,UAAAC,EAAW,SAAA6D,EAAU,SAAAyb,EAAW,SAAU,GAAGrf,GAASC,IACxDC,MAAA60B,GAAA,CACC,SAAA/xB,EAAA,KAACgyB,GAAA,CACC,IAAA/0B,EACA,UAAWhB,EACT,scACAogB,IAAa,UACX,kIACFtf,CACF,EACA,SAAAsf,EACC,GAAGrf,EAEJ,UAAAE,EAAA,IAACu0B,GAAqB,IACtBv0B,EAAA,IAAC+0B,GAAA,CACC,UAAWh2B,EACT,MACAogB,IAAa,UACX,yFACJ,EAEC,SAAAzb,CAAA,CACH,QACCgxB,GAAuB,KAC1B,EACF,CACD,EACDE,GAAc,YAAcE,GAAwB,YAEpD,MAAME,GAAcp1B,EAGlB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACi1B,GAAA,CACC,IAAAl1B,EACA,UAAWhB,EAAG,yCAA0Cc,CAAS,EAChE,GAAGC,CAAA,CACN,CACD,EACDk1B,GAAY,YAAcC,GAAsB,YAEhD,MAAMC,EAAat1B,aAGjB,CAAC,CAAE,UAAAC,EAAW,SAAA6D,EAAU,GAAG5D,CAAM,EAAGC,IACpC+C,EAAA,KAACqyB,GAAA,CACC,IAAAp1B,EACA,UAAWhB,EACT,4NACAc,CACF,EACC,GAAGC,EAEJ,UAAAE,EAAA,IAAC,OAAK,WAAU,+DACd,SAAAA,MAACo1B,GAAA,CACC,SAAAp1B,MAACuoB,GAAM,WAAU,SAAU,EAC7B,GACF,EAECvoB,MAAAq1B,GAAA,CAA0B,SAAA3xB,CAAS,IACtC,CACD,EACDwxB,EAAW,YAAcC,GAAqB,YAE9C,MAAMG,GAAkB11B,EAGtB,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACu1B,GAAA,CACC,IAAAx1B,EACA,UAAWhB,EAAG,2BAA4Bc,CAAS,EAClD,GAAGC,CAAA,CACN,CACD,EACDw1B,GAAgB,YAAcC,GAA0B,YCnIxD,MAAMC,GAAoD,CAAC,CAAE,KAAA7xB,EAAM,QAAAK,KAAc,CAC/E,KAAM,CAACyxB,EAAaC,CAAc,EAAI7xB,WAAiB,UAAU,EAC3D,CAAC8xB,EAAgBC,CAAiB,EAAI/xB,WAAiB,EAAE,EACzD,CAACgyB,EAAiBC,CAAkB,EAAIjyB,WAAiB,UAAU,EACnE,CAAC+R,EAAcC,CAAe,EAAIhS,WAAkB,EAAK,EACzD,CAACkyB,EAAmBC,CAAoB,EAAInyB,WAAgB,CAChE,CACE,GAAI,EACJ,KAAM,kBACN,QAAS,qIACT,SAAU,OACV,OAAQ,cACR,YAAa,uBACb,oBAAqB,sBACvB,EACA,CACE,GAAI,EACJ,KAAM,WACN,QAAS,4GACT,SAAU,WACV,OAAQ,YACR,YAAa,uBACb,YAAa,uBACf,CACD,EAEK4O,EAAgB5L,GAAuB,CAC3CA,EAAE,eAAe,EACjBgP,EAAgB,EAAI,EAGpB,WAAW,IAAM,CACf,MAAMogB,EAAa,CACjB,GAAIF,EAAkB,OAAS,EAC/B,KAAMN,IAAgB,WAAa,WAAa,kBAChD,QAASE,EACT,SAAUE,EACV,OAAQ,UACR,YAAa,IAAI,KAAK,EAAE,YAAY,EACpC,oBAAqB,IAAI,KAAK,KAAK,IAAI,EAAI,MAAuB,EAAE,YAAY,CAClF,EAEAG,EAAqB,CAACC,EAAY,GAAGF,CAAiB,CAAC,EACvDH,EAAkB,EAAE,EACpB/f,EAAgB,EAAK,GACpB,IAAI,CACT,EAEM3B,GAAelQ,GAAA,YAAAA,EAAS,qBAAsB,OAC9CkyB,EAAwBhiB,EACxBiiB,EAAoBjiB,EAAe,YAAc,QAEjDkiB,EAAiBC,GAAmB,CACxC,OAAQA,EAAQ,CACd,IAAK,YACI,OAAAr2B,EAAA,IAACuoB,GAAM,WAAU,wBAAyB,GACnD,IAAK,cACI,OAAAvoB,EAAA,IAACgzB,GAAM,WAAU,uBAAwB,GAClD,IAAK,UACI,OAAAhzB,EAAA,IAACgzB,GAAM,WAAU,wBAAyB,GACnD,QACS,OAAAhzB,EAAA,IAACs2B,GAAc,WAAU,sBAAuB,GAE7D,EAEMj3B,EAAck3B,GACL,IAAI,KAAKA,CAAU,EACpB,mBAAmB,QAAS,CACtC,IAAK,UACL,MAAO,QACP,KAAM,UACP,EAGH,cACG,MACC,WAACzzB,OAAA8P,EAAA,CAAK,UAAU,OACd,UAAA5S,MAAC6S,GACC,SAAC7S,EAAA,UAAG,UAAU,wBAAwB,mCAAuB,CAC/D,GACAA,EAAA,IAACgT,GACC,SAAChT,MAAA,QAAK,SAAUyS,EACd,SAAA3P,EAAA,KAAC,MAAI,WAAU,YACb,UAAAA,OAAC,MACC,WAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,eAAe,SAAY,iBAC1CzI,EAAA,KAACkxB,GAAA,CACC,MAAOyB,EACP,cAAeC,EAEf,UAAA11B,MAACo0B,IAAc,GAAG,eAChB,eAACF,GAAY,aAAY,sBAAsB,CACjD,UACCU,GACC,WAAC50B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,WAAW,SAAiB,sBAC7Cl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,SAAS,SAAe,oBAC5C,KACF,EACF,SAEC,MACC,WAACl1B,EAAA,IAAAuL,EAAA,CAAM,QAAQ,kBAAkB,SAAO,YACxCvL,EAAA,IAACgkB,GAAA,CACC,GAAG,kBACH,YAAY,0EACZ,KAAM,EACN,MAAO2R,EACP,SAAW9uB,GAAM+uB,EAAkB/uB,EAAE,OAAO,KAAK,GACnD,EACF,SAEC,MACC,WAAC7G,EAAA,IAAAuL,EAAA,CAAM,QAAQ,mBAAmB,SAAQ,aAC1CzI,EAAA,KAACkxB,GAAA,CACC,MAAO6B,EACP,cAAeC,EACf,SAAU,CAACI,GAAyBL,IAAoB,OAExD,UAAA71B,MAACo0B,IAAc,GAAG,mBAChB,eAACF,GAAY,aAAY,kBAAkB,CAC7C,UACCU,GACC,WAAC50B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,WAAW,SAAiB,6BAC7CA,EAAW,OAAM,OAAO,SAAU,CAACgB,EAAuB,mCAExD,CAACA,GAAyB,qBAC7B,GACF,KACF,CACF,GACF,EACF,GACF,EACApzB,OAACmQ,GAAW,WAAU,sFACpB,UAACnQ,OAAA,OAAI,UAAU,6CAA6C,4CAC1B9C,EAAA,YAAK,UAAU,cAAe,SAAkBm2B,CAAA,IAClF,EACAn2B,EAAA,IAAC0F,EAAA,CACC,KAAK,SACL,QAAS+M,EACT,SAAU,CAACkjB,EAAe,QAAU/f,EAEnC,WAAe,gBAAkB,kBACpC,CACF,IACF,SAEChD,EACC,WAAA5S,MAAC6S,GACC,SAAC7S,EAAA,UAAG,UAAU,wBAAwB,kCAAsB,CAC9D,SACCgT,EACE,UAAA+iB,EAAkB,OAAS,QACzB,MAAI,WAAU,YACZ,SAAAA,EAAkB,IAAKS,GACrB1zB,OAAA,OAAqB,UAAU,wBAC9B,UAACA,OAAA,OAAI,UAAU,mCACb,UAAAA,OAAC,MACC,WAACA,OAAA,OAAI,UAAU,+BACb,UAAC9C,MAAAy2B,GAAA,CAAa,UAAU,SAAU,GAClC3zB,OAAC,KAAG,WAAU,cAAe,UAAQ0zB,EAAA,KAAK,WAAQ,IACpD,EACCx2B,EAAA,SAAE,UAAU,qCAAsC,WAAQ,QAAQ,EACnE8C,OAAC,MAAI,WAAU,gCAAgC,wBACjCzD,EAAWm3B,EAAQ,WAAW,EAC5C,IACF,EACA1zB,OAAC,MAAI,WAAU,0BACZ,UAAAszB,EAAcI,EAAQ,MAAM,EAC7Bx2B,MAAC,QAAK,UAAU,iCACb,WAAQ,OAAO,QAAQ,IAAK,GAAG,CAClC,GACF,IACF,EAECw2B,EAAQ,SAAW,eACjB1zB,EAAA,YAAI,UAAU,mDAAmD,mCACzCzD,EAAWm3B,EAAQ,mBAAmB,GAC/D,EAGDA,EAAQ,SAAW,aAClBx2B,MAAC,OAAI,UAAU,qBACb,SAAC8C,EAAA,KAAA4C,EAAA,CAAO,QAAQ,UAAU,KAAK,KAAK,UAAU,mBAC5C,UAAC1F,MAAA,UAAS,UAAU,cAAe,GAAE,mBAEvC,CACF,EAhCM,GAAAw2B,EAAQ,EAkClB,CACD,EACH,EAEC1zB,OAAA,OAAI,UAAU,mBACb,UAAC9C,MAAAy2B,GAAA,CAAa,UAAU,8CAA+C,GACtEz2B,EAAA,UAAG,UAAU,2BAA2B,SAAe,oBACvDA,EAAA,SAAE,UAAU,wBAAwB,SAErC,sDACF,CAEJ,GACF,IACF,CAEJ,EC1MMikB,GAAqB,CAAC,CAAE,SAAAvgB,KAA8C,CACtE,IAEM,OAAAoB,GAAA,oBAEE,SAAApB,EAAS,OACL,CAGZ,OAAA1D,MAACuiB,IACC,SAACviB,EAAA,WAAI,UAAU,6DACb,SAAA8C,OAAC8P,EAAK,WAAU,sBACd,UAAC5S,EAAA,UAAG,UAAU,qCAAqC,SAAoB,yBACtEA,EAAA,SAAE,UAAU,yCAAyC,SAEtD,+EACAA,EAAA,IAAC0F,EAAA,CACC,UAAU,SACV,QAAS,IAAM,OAAO,SAAS,OAAO,EACvC,yBAED,CACF,EACF,GACF,EAGN,EAEMgxB,GAAyB,IAE1B12B,MAAAikB,GAAA,CACC,SAACjkB,MAAA22B,GAAA,CAAoB,GACvB,EAKEA,GAAgC,IAAM,CAC1C,KAAM,CAAE,KAAAhzB,EAAM,QAAAK,EAAS,UAAAE,CAAA,EAAcY,GAAQ,EACvC+H,EAAWC,GAAY,EACvB,CAACqO,EAAOyb,CAAQ,EAAI/yB,WAAiB,EAAE,EACvC,CAAC8e,EAASC,CAAU,EAAI/e,WAAS,EAAI,EACrC,CAAC0c,EAAyBC,CAA0B,EACxD3b,EAAM,SAAS,EAAK,EAChB,CAAC+pB,EAAWC,CAAY,EAAIhqB,EAAM,SAAS,SAAS,EAoC1D,OA/BAL,YAAU,IAAM,CACd,IAAIqyB,EAAU,GAEd,eAAeC,GAAY,CACrB,IACI,MAAApV,EAAY,MAAMxG,GAAS,EAC7B2b,IACFD,EAASlV,CAAS,EAClBkB,EAAW,EAAK,SAEXpf,EAAO,CACN,cAAM,uBAAwBA,CAAK,EACvCqzB,GACFjU,EAAW,EAAK,CAClB,CACF,CAIE,OAAAjf,GAAQ,CAACO,EACD4yB,EAAA,EACD,CAAC5yB,GAAa,CAACP,GACxBkJ,EAAS,QAAQ,EAGZ,IAAM,CACDgqB,EAAA,EACZ,CACC,GAAClzB,EAAMO,EAAW2I,CAAQ,CAAC,EAG1B3I,QAEC,MAAI,WAAU,gDACb,SAAClE,EAAA,WAAI,sBAAU,CACjB,GAKC2D,QAKF4e,GACC,UAAAviB,EAAA,IAAC2yB,IACC,SAAC7vB,EAAA,YAAI,UAAU,0BACb,UAAA9C,EAAA,IAACiS,GAAA,CACC,MAAM,sBACN,SAAS,0DACT,WAAY,GACZ,UAAW,GACX,OAAO,YACP,MAAM,qBACR,EACAnP,OAAC,OAAK,WAAU,8BACd,UAACA,OAAA,OAAI,UAAU,8BACb,UAACA,OAAA,OAAI,UAAU,oBACb,UAAC9C,EAAA,UAAG,UAAU,uCAAuC,SAAe,oBACnEA,EAAA,SAAE,UAAU,0CAA0C,SAGvD,+EACF,EAEE8C,EAAA,KAACyT,GAAA,CACC,aAAa,UACb,MAAOqY,EACP,cAAeC,EACf,UAAU,OAEV,UAAC/rB,OAAA2T,GAAA,CAAS,UAAU,OAClB,UAACzW,EAAA,IAAA2W,GAAA,CAAY,MAAM,UAAU,SAAgB,qBAC5C3W,EAAA,IAAA2W,GAAA,CAAY,MAAM,WAAW,SAAiB,uBACjD,EAEA3W,MAAC6W,IAAY,MAAM,UACjB,eAACqc,GAAgB,MAAAvvB,EAAY,QAAAK,EAAkB,CACjD,GAEAhE,MAAC6W,IAAY,MAAM,WACjB,eAAC2e,GAAiB,MAAA7xB,EAAY,QAAAK,CAAkB,EAClD,IAGF,CAWA,EAEJ,EAEC2e,EACE3iB,MAAA,OAAI,UAAU,mBAAmB,4BAAgB,EAElD8C,EAAA,KAAC,MAAI,WAAU,QACb,UAAC9C,EAAA,UAAG,UAAU,0BAA0B,SAAY,uBACnD,MAAI,WAAU,2CACZ,SAAMmb,EAAA,IAAKkH,GACVriB,EAAA,IAAC2zB,GAAA,CAEC,KAAAtR,EACA,cAAcre,GAAA,YAAAA,EAAS,qBAAsB,QAFxCqe,EAAK,GAIb,CACH,GACF,IAEJ,EAEAriB,EAAA,IAAC+W,GAAA,CACC,OAAQwJ,EACR,QAAS,IAAMC,EAA2B,EAAK,GACjD,CACF,EACF,GACF,EApFO,IAsFX,ECzLA,SAAwBuW,IAAW,CACjC,KAAM,CAAE,KAAMpnB,EAAG,QAASqnB,CAAA,EAAOlyB,GAAQ,EAEnCmyB,EAAY,CAChB,CACE,MAAO,uCACP,QACE,mHACF,SAAU,kBACV,KAAM,aACN,SAAU,aACV,MACE,6EACJ,EACA,CACE,MAAO,uCACP,QACE,0GACF,SAAU,aACV,KAAM,aACN,SAAU,cACV,MACE,0EACJ,EACA,CACE,MAAO,+BACP,QACE,+GACF,SAAU,QACV,KAAM,aACN,SAAU,aACV,MACE,2EAEN,EAGE,OAAAj3B,MAAC2yB,GACC,UAAA7vB,OAACyf,GACC,WAAAviB,EAAA,IAACiS,GAAA,CACC,MAAM,2BACN,SAAS,yDACT,gBAAgB,2EAChB,WAAY,GACZ,UAAW,GACX,OAAO,YACT,QACC,OAAK,WAAU,4CACd,SAAAjS,MAAC,OAAI,UAAU,8BACb,SAACA,MAAA,OAAI,UAAU,uDACZ,SAAAi3B,EAAU,IAAI,CAACC,EAAMz0B,IACpBK,EAAA,KAAC8P,EAAA,CAEC,UAAU,yDAEV,UAAC5S,MAAA,OAAI,UAAU,oDACb,SAAAA,EAAA,IAAC,OACC,IAAKk3B,EAAK,MACV,IAAKA,EAAK,MACV,UAAU,+BAEd,EACAp0B,OAAC+P,EAAW,WAAU,mCACpB,UAAC7S,MAAAuzB,GAAA,CAAI,UAAU,SAAU,GACxBvzB,EAAA,YAAK,UAAU,gCACb,WAAK,QACR,IACF,EACA8C,OAACkQ,EAAY,WAAU,uBACrB,UAAAhT,EAAA,IAAC,KAAG,WAAU,6BAA8B,SAAAk3B,EAAK,MAAM,EACtDl3B,EAAA,SAAE,UAAU,oCACV,WAAK,QACR,EACA8C,OAAC,MAAI,WAAU,yCACb,UAACA,OAAA,OAAI,UAAU,wDACb,UAACA,OAAA,OAAI,UAAU,0BACb,UAAC9C,MAAAgf,GAAA,CAAS,UAAU,SAAU,GAC9Bhf,MAAC,QACE,SAAI,SAAKk3B,EAAK,IAAI,EAAE,oBACvB,IACF,EACAp0B,OAAC,MAAI,WAAU,0BACb,UAAC9C,MAAAgzB,GAAA,CAAM,UAAU,SAAU,GAC3BhzB,MAAC,OAAM,UAAAk3B,EAAK,QAAS,GACvB,IACF,EACAp0B,EAAA,KAAC4C,EAAA,CACC,QAAQ,QACR,UAAU,2BACV,QAAS,IAAM,CACN,gBAAS,KAAO,SAASwxB,EAAK,MAAM,YAAc,UAAQ,KAAM,GAAG,CAAC,EAC7E,EACD,sBAECl3B,MAACyyB,GAAW,WAAU,6DAA8D,KACtF,CACF,GACF,KA7CKhwB,CAAA,CA+CR,CACH,GACF,CACF,IACF,CACF,EAEJ,CCjGA,SAAwB00B,IAAkB,CACxC,MAAMC,EAAoB,CACxB,CACE,MAAO,kBACP,KAAMp3B,MAACq3B,GAAK,WAAU,SAAU,GAChC,YAAa,yCACb,QAAS,CACP,+BACA,gCACA,0BACA,8BAEJ,EACA,CACE,MAAO,oBACP,KAAMr3B,MAAC2e,GAAS,WAAU,SAAU,GACpC,YAAa,uCACb,QAAS,CACP,2BACA,0BACA,kBACA,kBAEJ,EACA,CACE,MAAO,oBACP,KAAM3e,MAACs3B,GAAW,WAAU,SAAU,GACtC,YAAa,iCACb,QAAS,CACP,wBACA,sBACA,eACA,wBACF,CAEJ,EAEMC,EAAiB,CACrB,CACE,KAAMv3B,MAACw3B,GAAK,WAAU,SAAU,GAChC,MAAO,gBACP,YAAa,qBACb,OAAQ,sBACR,WAAY,aACZ,QAAS,IAAO,OAAO,SAAS,KAAO,4BACzC,EACA,CACE,KAAMx3B,MAACy3B,GAAM,WAAU,SAAU,GACjC,MAAO,gBACP,YAAa,oBACb,OAAQ,gBACR,WAAY,WACZ,QAAS,IAAO,OAAO,SAAS,KAAO,iBACzC,EACA,CACE,KAAMz3B,MAAC8N,GAAc,WAAU,SAAU,GACzC,MAAO,YACP,YAAa,6BACb,OAAQ,iBACR,WAAY,aACZ,QAAS,IAAM,CACP,MAAApJ,EAAQ,IAAI,YAAY,gBAAiB,CAC7C,OAAQ,CAAE,WAAY,SAAU,EACjC,EACD,OAAO,cAAcA,CAAK,EAC5B,CAEJ,EAGE,OAAA1E,MAAC2yB,GACC,UAAA7vB,OAACyf,GACC,WAAAviB,EAAA,IAACiS,GAAA,CACC,MAAM,wBACN,SAAS,uEACT,gBAAgB,8EAChB,WAAY,GACZ,UAAW,GACX,OAAO,YACT,QACC,OAAK,WAAU,8BACd,SAACnP,EAAA,YAAI,UAAU,+BACb,UAAC9C,EAAA,WAAI,UAAU,wCACZ,SAAkBo3B,EAAA,IAAI,CAACM,EAAUj1B,IAChCK,OAAC8P,EAAiB,WAAU,oCAC1B,UAAC9P,OAAA+P,EAAA,CAAW,UAAU,mCACnB,UAAS6kB,EAAA,YACT,MACC,WAAA13B,EAAA,IAAC,KAAG,WAAU,gBAAiB,SAAA03B,EAAS,MAAM,EAC7C13B,EAAA,SAAE,UAAU,gCACV,WAAS,WACZ,GACF,IACF,EACCA,MAAAgT,EAAA,CACC,SAAChT,MAAA,MAAG,UAAU,YACX,SAAA03B,EAAS,QAAQ,IAAI,CAACvpB,EAAMyB,IAC1B9M,OAAA,MAAW,UAAU,UAAU,eAC3BqL,CAAA,GADIyB,CAET,CACD,EACH,CACF,KAlBSnN,CAmBX,CACD,EACH,EAEAK,OAAC,MAAI,WAAU,gCACb,UAACA,OAAA,OAAI,UAAU,mBACb,UAAC9C,EAAA,UAAG,UAAU,0BAA0B,SAAe,oBACtDA,EAAA,SAAE,UAAU,wBAAwB,SAErC,6CACF,EAEAA,MAAC,OAAI,UAAU,wCACZ,WAAe,IAAI,CAAC23B,EAAQl1B,IAC3BzC,EAAA,IAAC4S,EAAA,CAEC,UAAU,oCAEV,SAAA9P,EAAA,KAACkQ,EAAY,WAAU,kBACrB,UAAAhT,EAAA,IAAC,MAAI,WAAU,2BACZ,SAAA23B,EAAO,KACV,EACC33B,EAAA,UAAG,UAAU,qBAAsB,WAAO,MAAM,EAChDA,EAAA,SAAE,UAAU,qCACV,WAAO,YACV,EACCA,EAAA,SAAE,UAAU,2BACV,WAAO,OACV,EACAA,MAAC0F,GAAO,QAASiyB,EAAO,QAAS,UAAU,SACxC,WAAO,UACV,GACF,IAjBKl1B,CAAA,CAmBR,CACH,GACF,IACF,CACF,IACF,CACF,EAEJ,CCjIA,MAAMgtB,GAAiBlhB,GAAiB,CAEtC,IAAImhB,EAAgBnhB,EAAK,QACvB,iBACA,mCACF,EAGA,OAAAmhB,EAAgBA,EAAc,QAC5B,aACA,gCACF,EAGAA,EAAgBA,EAAc,QAC5B,aACA,sCACF,EAGAA,EAAgBA,EAAc,QAC5B,iBACA,oCACF,EAGOA,EAAc,MAAM;AAAA,CAAI,EAAE,IAAKC,GACpCA,EAAO,uBAAuBA,CAAI,UAAY,iCAC/C,EAAE,KAAK,EAAE,CACZ,EAEMiI,GAAiB,0CACjBC,GAAiB,qFAEhB,SAASC,IAAU,CACxB,KAAM,CAAE,KAAAn0B,EAAM,QAAAK,CAAQ,EAAIc,GAAQ,EAC5B,CAAC0B,EAAQie,CAAS,EAAI5f,EAAM,SAAS,EAAK,EAC1C,CAAC+pB,EAAWC,CAAY,EAAIhqB,EAAM,SAAS,IAAI,EAC/C,CAACkzB,EAAYC,CAAa,EAAInzB,EAAM,SAAoB,EAAE,EAC1D,CAACozB,EAAiBC,CAAkB,EAAIrzB,EAAM,SAAoB,EAAE,EACpE,CAACszB,EAAgBC,CAAiB,EAAIvzB,EAAM,SAAoB,EAAE,EAClE,CAACwzB,EAAOC,CAAQ,EAAIzzB,EAAM,SAAS,EAAE,EACrC,CAACX,EAAWC,CAAY,EAAIU,EAAM,SAAS,EAAK,EAChD,CAAC0zB,EAAUC,CAAW,EAAI3zB,EAAM,SAAoB,EAAE,EACtD,CAAC4zB,EAAiBC,CAAkB,EAAI7zB,EAAM,SAClD,IACF,EACM8zB,EAAY9zB,EAAM,OAAuB,IAAI,EAC7CgI,EAAWC,GAAY,EAG7BjI,EAAM,UAAU,IAAM,CACpB,GAAIlB,EAAM,CACKi1B,EAAA,EAGP,MAAAC,EAAsBhyB,GAAmB,CAC7C4d,EAAU,EAAI,EACdoK,EAAa,UAAU,EACjB,MAAAtX,EAAa1Q,EAAE,OAAO,WACtBiyB,EAAUP,EAAS,KAAM/mB,GAAMA,EAAE,KAAO+F,CAAU,EACpDuhB,GACFJ,EAAmBI,CAAO,CAE9B,EAEO,+BACL,gBACAD,CACF,EACO,IACL,OAAO,oBACL,gBACAA,CACF,EACJ,EACC,CAACl1B,EAAM40B,CAAQ,CAAC,EAEnB,MAAMK,EAAe,SAAY,CAC3B,IACI,MAAE,KAAM1f,CAAS,EAAI,MAAMjW,EAC9B,KAAK,UAAU,EACf,OACC;AAAA;AAAA;AAAA;AAAA,WAMD,GAAG,gBAAgBU,GAAA,YAAAA,EAAM,EAAE,mBAAmBA,GAAA,YAAAA,EAAM,EAAE,EAAE,EACxD,MAAM,aAAc,CAAE,UAAW,GAAO,EAE3C,GAAI,CAACuV,EAAU,OAGT,MAAA6f,MAAqB,IAClB7f,EAAA,QAASS,GAAQ,CAClB,MAAAmf,EAAUnf,EAAI,OAAO,MAAOhW,GAAA,YAAAA,EAAM,IAAKgW,EAAI,SAAWA,EAAI,OAC3Dof,EAAe,IAAID,EAAQ,EAAE,GACjBC,EAAA,IAAID,EAAQ,GAAI,CAC7B,GAAIA,EAAQ,GACZ,UAAWA,EAAQ,UACnB,MAAOA,EAAQ,MACf,aAAcnf,EAAI,QAClB,aAAcA,EAAI,eAAgBhW,GAAA,YAAAA,EAAM,KAAM,CAACgW,EAAI,QAAU,EAAI,EAClE,CACH,CACD,EAED6e,EAAY,MAAM,KAAKO,EAAe,OAAQ,EAAC,QACxCv1B,EAAO,CACN,cAAM,0BAA2BA,CAAK,EAElD,EAEMw1B,EAAa,MAAOzqB,GAAiB,CACrC,GAACA,EAAK,OAEV,GAAIqgB,IAAc,KAAM,CAERoJ,EAAC1hB,GAAS,CAAC,GAAGA,EAAM,CAAE,KAAA/H,EAAM,OAAQ,EAAK,CAAC,CAAC,EACzD+pB,EAAS,EAAE,EACXn0B,EAAa,EAAI,EAEb,IAEF,MAAM80B,EAAa,MAAM,MACvB,GAAGpB,EAAc,QAAQD,EAAc,GACvC,CACE,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,UAAU,CACnB,SAAU,CAAC,CACT,MAAO,CAAC,CACN,KAAArpB,CACD,EACF,EACF,GAEL,EAEI,IAAC0qB,EAAW,GACd,MAAM,IAAI,MAAM,iBAAiBA,EAAW,MAAM,EAAE,EAIhD,MAAA7jB,GADS,MAAM6jB,EAAW,KAAK,GACb,WAAW,CAAC,EAAE,QAAQ,MAAM,CAAC,EAAE,KAGvD,GAAIt1B,EAAM,CACR,MAAMuU,EAAiB,MAAMvU,EAAK,EAAE,IAAI,KAAK,KAAK,GAElD,MAAMV,EAAS,KAAK,UAAU,EAAE,OAAO,CACrC,CACE,UAAWU,EAAK,GAChB,YAAaA,EAAK,GAClB,QAAS4K,EACT,WAAY,GACZ,gBAAiB2J,CACnB,EACA,CACE,UAAW,KACX,YAAavU,EAAK,GAClB,QAASyR,EACT,WAAY,GACZ,gBAAiB8C,CAAA,CACnB,CACD,EAGW8f,EAAC1hB,GAAS,CAAC,GAAGA,EAAM,CAAE,KAAMlB,EAAU,OAAQ,EAAM,CAAC,CAAC,QAC7D5R,EAAO,CACN,cAAM,oBAAqBA,CAAK,EACxCw0B,EAAe1hB,GAAS,CACtB,GAAGA,EACH,CAAE,KAAM,mDAAoD,OAAQ,EAAM,EAC3E,SACD,CACAnS,EAAa,EAAK,EACpB,SACUR,EAOZ,GAAWirB,IAAc,UAAW,CAEfsJ,EAAC5hB,GAAS,CAAC,GAAGA,EAAM,CAAE,KAAA/H,EAAM,OAAQ,EAAK,CAAC,CAAC,EAC9D+pB,EAAS,EAAE,EAEP,IACF,MAAMY,EAAwB,WAAWv1B,EAAK,EAAE,IAAI,KAAK,KAAK,GAGxD,CAAE,MAAOw1B,GAAiB,MAAMl2B,EAAS,KAAK,UAAU,EAAE,OAAO,CACrE,UAAWU,EAAK,GAChB,YAAa,UACb,QAAS4K,EACT,WAAY,GACZ,gBAAiB2qB,CAAA,CAClB,EAED,GAAIC,EAAoB,MAAAA,EAGxB,MAAMC,EAAe,0EACf,CAAE,MAAOC,GAAiB,MAAMp2B,EAAS,KAAK,UAAU,EAAE,OAAO,CACrE,UAAW,KACX,YAAaU,EAAK,GAClB,QAASy1B,EACT,WAAY,GACZ,gBAAiBF,CAAA,CAClB,EAED,GAAIG,EAAoB,MAAAA,EAExBnB,EAAoB5hB,GAAS,CAC3B,GAAGA,EACH,CAAE,KAAM8iB,EAAc,OAAQ,EAAM,EACrC,QACM51B,EAAO,CACN,cAAM,kCAAmCA,CAAK,EACtD00B,EAAoB5hB,GAAS,CAC3B,GAAGA,EACH,CAAE,KAAM,oEAAqE,OAAQ,EAAM,EAC5F,EACH,KACK,CAED,IAAC3S,GAAQ,CAAC80B,EAAiB,OAE3B,IACF,QAAQ,IAAI,+BAAgC,CAC1C,UAAW90B,EAAK,GAChB,YAAa80B,EAAgB,GAC7B,QAASlqB,EACT,WAAYqgB,IAAc,UAC3B,EACK,MAAE,KAAArrB,EAAM,MAAAC,GAAU,MAAMP,EAAS,KAAK,UAAU,EAAE,OAAO,CAC7D,CACE,UAAWU,EAAK,GAChB,YAAa80B,EAAgB,GAC7B,QAASlqB,EACT,WAAYqgB,IAAc,UAC5B,CACD,EAED,GAAIprB,EACM,oBAAM,yBAA0BA,CAAK,EACvCA,EAGA,YAAI,2BAA4BD,CAAI,EAE5C60B,EAAmB9hB,GAAS,CAC1B,GAAGA,EACH,CACE,KAAA/H,EACA,OAAQ,GACR,OAAQ,CACN,WAAWvK,GAAA,YAAAA,EAAS,YAAa,GACjC,OAAOA,GAAA,YAAAA,EAAS,QAAS,EAC3B,EACA,UAAW,IAAI,KAAK,EAAE,YAAY,EACpC,CACD,EACDs0B,EAAS,EAAE,QACJ90B,EAAO,CACN,cAAM,yBAA0BA,CAAK,EAC/C,KA3FgB,CAEhBw0B,EAAe1hB,GAAS,CACtB,GAAGA,EACH,CAAE,KAAM,+DAAgE,OAAQ,EAAM,EACvF,EACD,OAuFJ,EAEMoD,EAAiB,IAAM,CACvBif,EAAU,UACFA,EAAA,QAAQ,UAAYA,EAAU,QAAQ,aAEpD,EAEA,OAAA9zB,EAAM,UAAU,IAAM,CACL6U,EAAA,CACd,GAACqe,EAAYE,EAAiBE,CAAc,CAAC,EAEhDtzB,EAAM,UAAU,IAAM,CACL6U,EAAA,GACd,CAACxV,CAAS,CAAC,EAGdW,EAAM,UAAU,IAAM,CAChB,IAAClB,GAAQ,CAAC80B,EAAiB,OAEzB,MAAAa,EAAer2B,EAClB,QAAQ,YAAYU,EAAK,EAAE,IAAI80B,EAAgB,EAAE,EAAE,EACnD,GACC,mBACA,CACE,MAAO,SACP,OAAQ,SACR,MAAO,WACP,OAAQ,uBAAuB90B,EAAK,EAAE,mBAAmB80B,EAAgB,EAAE,sBAAsBA,EAAgB,EAAE,mBAAmB90B,EAAK,EAAE,IAC/I,EACCgV,GAAY,CACH,YAAI,6BAA8BA,CAAO,EACjD,MAAMS,EAAaT,EAAQ,IACvBS,EAAW,YAAczV,EAAK,IAChCy0B,EAAmB9hB,GAAS,CAC1B,GAAGA,EACH,CACE,KAAM8C,EAAW,QACjB,OAAQ,GACR,OAAQqf,EACR,UAAWrf,EAAW,WACxB,CACD,CACH,GAGH,UAAU,EAEb,MAAO,IAAM,CACXkgB,EAAa,YAAY,CAC3B,GACC,CAAC31B,EAAM80B,CAAe,CAAC,EAItBz4B,EAAA,IAAA2G,WAAA,gBAAC,MAAI,WAAW,+BAA+BH,EAAS,OAAS,QAAQ,GACtE,SAAAA,EACE1D,OAAA,OAAI,UAAU,4CACb,UAACA,OAAA,OAAI,UAAU,iDACb,gBAAC,MAAG,UAAU,gBAAgB,SAAY,iBACzCA,OAAA,MAAI,WAAU,aACb,UAAA9C,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,KAAK,OACL,QAAS,IAAMmH,EAAS,WAAW,EACnC,MAAM,kBAEN,SAAC7M,MAAAgoB,GAAM,WAAU,SAAU,GAC7B,EACAhoB,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,KAAK,OACL,QAAS,IAAM+e,EAAU,EAAK,EAE9B,SAACzkB,MAAA8G,GAAE,WAAU,SAAU,IACzB,CACF,IACF,SAECyP,GAAA,CAAK,aAAcqY,EAAW,cAAeC,EAC5C,iBAAChY,GAAY,OAAM,KAAK,UAAU,eAChC,UAAA/T,EAAA,KAAC,OACC,IAAK61B,EACL,UAAU,qCAET,UAAAZ,EAAW,SAAW,EACpBj1B,EAAA,YAAI,UAAU,YACb,gBAAC,KAAE,UAAU,gCAAgC,SAI7C,0HACA9C,MAAC,OAAI,UAAU,uBACZ,YAAiB,IAAI,CAACu5B,EAAU92B,IAC/BzC,EAAA,IAAC0F,EAAA,CAEC,QAAQ,UACR,KAAK,KACL,UAAU,UACV,QAAS,IAAMszB,EAAWO,CAAQ,EAEjC,SAAAA,CAAA,EANI92B,CAAA,CAQR,CACH,GACF,GAEAs1B,EAAW,IAAI,CAAC/f,EAASvV,IACvBzC,EAAA,IAAC,OAEC,UAAW,QAAQgY,EAAQ,OAAS,cAAgB,eAAe,GAEnE,SAAAhY,EAAA,IAAC,OACC,UAAW,8BACTgY,EAAQ,OACJ,qCACA,UACN,GAEA,SAAAhY,EAAA,IAAC,KACC,UAAU,8BACV,wBAAyB,CACvB,OAAQgY,EAAQ,OAASA,EAAQ,KAAOyX,GAAczX,EAAQ,IAAI,EACpE,EACF,EACF,EAhBKvV,CAAA,CAkBR,EAEFyB,GACElE,MAAA,MAAI,WAAU,qBACb,SAACA,MAAA,OAAI,UAAU,sCACb,SAACA,MAAA,IAAE,WAAU,UAAU,qBAAS,EAClC,CACF,IAEJ,QACC,MAAI,WAAU,eACb,SAAC8C,EAAA,YAAI,UAAU,aACb,UAAA9C,EAAA,IAACoL,EAAA,CACC,MAAOitB,EACP,SAAWxxB,GAAMyxB,EAASzxB,EAAE,OAAO,KAAK,EACxC,YAAY,oCACZ,WAAaA,GAAM,CACbA,EAAE,MAAQ,SACZmyB,EAAWX,CAAK,CAClB,CACF,CACF,EACAr4B,EAAA,IAAC0F,EAAA,CACC,QAAS,IAAMszB,EAAWX,CAAK,EAC/B,SAAU,CAACA,EAAM,KAAK,EAEtB,SAACr4B,MAAA8Z,GAAK,WAAU,SAAU,IAC5B,EACF,CACF,IACF,SAECjD,GAAA,CAAY,MAAM,WAAW,UAAU,eACtC,UAAA7W,EAAA,IAAC,OACC,IAAK24B,EACL,UAAU,qCAET,SAACh1B,EAMG80B,QAuCF,OAAI,UAAU,YACZ,SAAeN,EAAA,IAAI,CAACngB,EAASvV,IAC5BzC,EAAA,IAAC,OAEC,UAAW,QAAQgY,EAAQ,OAAS,cAAgB,eAAe,GAEnE,SAAAhY,EAAA,IAAC,OACC,UAAW,8BAA8BgY,EAAQ,OAAS,qCAAuC,UAAU,GAE3G,eAAC,KAAE,UAAU,UAAW,WAAQ,IAAK,IACvC,EAPKvV,CAAA,CASR,CACH,GAnDCzC,MAAA,OAAI,UAAU,YACZ,SAAAu4B,EAAS,IAAKO,GACb,OAAAh2B,SAAA,KAAC,OAEC,UAAU,iFACV,QAAS,IAAM41B,EAAmBI,CAAO,EAEzC,UAACh2B,OAAA,OAAI,UAAU,0BACb,UAACA,OAAAmF,GAAA,CAAO,UAAU,UAChB,UAAAjI,EAAA,IAACmI,GAAA,CACC,IAAK,oCAAoC,mBAAmB2wB,EAAQ,SAAS,CAAC,qBAC9E,IAAKA,EAAQ,UACf,QACCzwB,GACE,WAAAhE,EAAAy0B,EAAQ,YAAR,YAAAz0B,EACG,MAAM,KACP,IAAKsJ,GAAMA,EAAE,CAAC,GACd,KAAK,GACV,IACF,SACC,MACC,WAAA3N,EAAA,IAAC,IAAE,WAAU,cACV,SAAA84B,EAAQ,UACX,EACC94B,EAAA,SAAE,UAAU,gCACV,WAAQ,YACX,GACF,IACF,EACC84B,EAAQ,cAAgBA,EAAQ,aAAe,SAC7C,OAAK,WAAU,oEACb,SAAAA,EAAQ,YACX,KA7BGA,EAAQ,EAgChB,GACH,GA1CC94B,MAAA,OAAI,UAAU,kBACb,SAAAA,MAAC,IAAE,WAAU,qCAAqC,0CAElD,EACF,EAqDA,CAEJ,EAECy4B,SACE,MAAI,WAAU,eACb,SAAC31B,OAAA,OAAI,UAAU,aACb,UAAA9C,EAAA,IAACoL,EAAA,CACC,MAAOitB,EACP,SAAWxxB,GAAMyxB,EAASzxB,EAAE,OAAO,KAAK,EACxC,YAAY,oBACZ,WAAaA,GAAM,CACbA,EAAE,MAAQ,SACZmyB,EAAWX,CAAK,CAClB,CACF,CACF,EACAr4B,EAAA,IAAC0F,EAAA,CACC,QAAS,IAAMszB,EAAWX,CAAK,EAC/B,SAAU,CAACA,EAAM,KAAK,EAEtB,SAACr4B,MAAA8Z,GAAK,WAAU,SAAU,IAC5B,EACF,CACF,IAEJ,SAECjD,GAAA,CAAY,MAAM,UAAU,UAAU,eACrC,UAAA7W,EAAA,IAAC,OACC,IAAK24B,EACL,UAAU,qCAET,WAAgB,SAAW,QACzB,MAAI,WAAU,YACb,SAAC34B,MAAA,KAAE,UAAU,gCAAgC,0DAE7C,EACF,EAEAi4B,EAAgB,IAAI,CAACjgB,EAASvV,IAC5BzC,EAAA,IAAC,OAEC,UAAW,QAAQgY,EAAQ,OAAS,cAAgB,eAAe,GAEnE,SAAAhY,EAAA,IAAC,OACC,UAAW,8BAA8BgY,EAAQ,OAAS,qCAAuC,UAAU,GAE3G,eAAC,KAAE,UAAU,UAAW,WAAQ,IAAK,IACvC,EAPKvV,CASR,GAEL,QAEC,MAAI,WAAU,eACb,SAACK,EAAA,YAAI,UAAU,aACb,UAAA9C,EAAA,IAACoL,EAAA,CACC,MAAOitB,EACP,SAAWxxB,GAAMyxB,EAASzxB,EAAE,OAAO,KAAK,EACxC,YAAY,gCACZ,WAAaA,GAAM,CACbA,EAAE,MAAQ,SACZmyB,EAAWX,CAAK,CAClB,CACF,CACF,EACAr4B,EAAA,IAAC0F,EAAA,CACC,QAAS,IAAMszB,EAAWX,CAAK,EAC/B,SAAU,CAACA,EAAM,KAAK,EAEtB,SAACr4B,MAAA8Z,GAAK,WAAU,SAAU,IAC5B,EACF,CACF,GACF,GACF,IACF,EAEA9Z,EAAA,IAAC0F,EAAA,CACC,QAAS,IAAM+e,EAAU,EAAI,EAC7B,UAAU,0DAEV,SAACzkB,MAAA8N,GAAc,WAAU,SAAU,GACrC,EAEJ,EACF,CAEJ,CCxmBA,SAAwB0rB,IAAe,CACrC,MAAM3sB,EAAWC,GAAY,EAE7BtI,mBAAU,IAAM,CACdvB,EAAS,KAAK,kBAAkB,CAACyB,EAAOZ,IAAY,CAC1C,YAAI,qBAAsBY,EAAOZ,CAAO,EAC5CY,IAAU,aACZmI,EAAS,YAAY,CACvB,CACD,GAG4B,SAAY,CACjC,MACJ,KAAM,CAAE,QAAA/I,CAAQ,GACd,MAAMb,EAAS,KAAK,WAAW,EAC3B,YAAI,mBAAoBa,CAAO,EAErC+I,EADE/I,EACO,aAEA,GAFY,CAIzB,GAEqB,GACpB,CAAC+I,CAAQ,CAAC,QAGV,MAAI,WAAU,gDACb,SAAC/J,EAAA,YAAI,UAAU,cACb,UAAC9C,EAAA,UAAG,UAAU,8BAA8B,SAAiB,sBAC5DA,EAAA,SAAE,UAAU,wBAAwB,SAErC,mDACF,CACF,EAEJ,CCjCA,MAAMy5B,GAAa,CACjB,CACE,MAAO,uBACP,YAAa,2HACb,KAAMC,GACN,MAAO,YACT,EACA,CACE,MAAO,wBACP,YAAa,kGACb,KAAM5Z,GACN,MAAO,aACT,EACA,CACE,MAAO,yBACP,YAAa,sFACb,KAAMgI,GACN,MAAO,YACT,EACA,CACE,MAAO,sBACP,YAAa,yGACb,KAAMqG,GACN,MAAO,WACT,EACA,CACE,MAAO,kBACP,YAAa,gEACb,KAAMwL,GACN,MAAO,cACT,EACA,CACE,MAAO,iBACP,YAAa,8DACb,KAAMC,GACN,MAAO,WAEX,EAEMC,GAAqB,CACzB,CACE,MAAO,mBACP,YAAa,uFACf,EACA,CACE,MAAO,kBACP,YAAa,iFACf,EACA,CACE,MAAO,uBACP,YAAa,yDACf,EACA,CACE,MAAO,sBACP,YAAa,gFAEjB,EAEA,SAAwBC,IAAyB,CAE7C,OAAA95B,MAAC2yB,GACC,UAAA7vB,OAACyf,GACC,WAAAviB,EAAA,IAACiS,GAAA,CACC,MAAM,iCACN,SAAS,+EACT,gBAAgB,8EAChB,WAAY,GACZ,UAAW,GACX,OAAO,YACT,QACC,OAAK,WAAU,oCACd,SAACnP,EAAA,YAAI,UAAU,+BACb,UAACA,OAAA,OAAI,UAAU,cACb,UAAC9C,EAAA,UAAG,UAAU,0BAA0B,SAExC,wCACCA,EAAA,SAAE,UAAU,0CAA0C,SAEvD,mHACF,EAGA8C,OAAC,UAAQ,WAAU,YACjB,UAAC9C,EAAA,UAAG,UAAU,qCAAqC,SAAmB,wBACrEA,EAAA,WAAI,UAAU,uDACZ,SAAWy5B,GAAA,IAAI,CAACnR,EAAS7lB,IACxBK,OAAC8P,EAAiB,WAAU,oCAC1B,UAAA9P,OAAC+P,EACC,WAAC/P,OAAA,OAAI,UAAU,yCACb,UAAA9C,MAACsoB,EAAQ,KAAR,CAAa,UAAU,sBAAuB,GAC9CtoB,EAAA,IAAAmT,GAAA,CAAM,QAAQ,YAAa,WAAQ,KAAM,IAC5C,EACCnT,EAAA,IAAA8S,GAAA,CAAU,UAAU,UAAW,WAAQ,KAAM,IAChD,EACA9S,MAACgT,GACC,SAAChT,EAAA,SAAE,UAAU,wBAAyB,SAAAsoB,EAAQ,WAAY,EAC5D,GAVS,EAAA7lB,CAWX,CACD,CACH,IACF,EAGAK,OAAC,UAAQ,WAAU,YACjB,UAAC9C,EAAA,UAAG,UAAU,qCAAqC,SAA4B,iCAC9EA,EAAA,WAAI,UAAU,wCACZ,SAAmB65B,GAAA,IAAI,CAACE,EAASt3B,IAChCK,OAAC8P,EAAiB,WAAU,oCAC1B,UAAA5S,MAAC6S,EACC,UAAA7S,MAAC8S,GAAW,UAAAinB,EAAQ,KAAM,GAC5B,EACA/5B,MAACgT,GACC,SAAChT,EAAA,SAAE,UAAU,wBAAyB,SAAA+5B,EAAQ,WAAY,EAC5D,GANS,EAAAt3B,CAOX,CACD,CACH,IACF,EAEAK,OAAC,UAAQ,WAAU,oCACjB,UAAC9C,EAAA,UAAG,UAAU,qCAAqC,SAAqC,gDACvF,MAAI,WAAU,4BACb,SAAC8C,EAAA,WAAG,UAAU,2BACZ,UAAA9C,MAAC,MAAG,SAAwD,6DAC5DA,MAAC,MAAG,SAAiD,sDACrDA,MAAC,MAAG,SAA4C,iDAChDA,MAAC,MAAG,SAA+C,oDACnDA,MAAC,MAAG,SAAkC,uCACtCA,MAAC,MAAG,SAAqC,2CAC3C,CACF,IACF,EAEA8C,OAAC,UAAQ,WAAU,wBACjB,UAAC9C,EAAA,UAAG,UAAU,yBAAyB,SAA4C,iDAClFA,EAAA,SAAE,UAAU,0CAA0C,SAEvD,uIACC0F,EAAO,MAAK,KAAK,UAAU,OAAO,SAEnC,oBACF,IACF,CACF,IACF,CACF,EAEJ,CCtJA,MAAMs0B,GAASp6B,EAGb,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1B+C,EAAA,KAACm3B,GAAA,CACC,IAAAl6B,EACA,UAAWhB,EACT,2DACAc,CACF,EACC,GAAGC,EAEJ,UAACE,MAAAk6B,GAAA,CAAsB,UAAU,wEAC/B,SAACl6B,MAAAm6B,GAAA,CAAsB,UAAU,6BAA6B,CAChE,GACCn6B,MAAAo6B,GAAA,CAAsB,UAAU,qNAAsN,IACzP,CACD,EACDJ,GAAO,YAAcC,GAAqB,YCpB1C,IAAII,GAEJ,eAAeC,IAAe,CAC5B,GAAI,CAACD,GAAO,CACV,KAAM,CAAE,mBAAAE,CAAA,EAAuB,MAAMC,GAAA,mCAAAD,CAAA,eAAO,sBAAuB,OAAA5sB,KAAA,8BAAA4sB,CAAA,OAC3DF,GAAA,IAAIE,EAAmB,yCAAmC,EAE7D,OAAAF,EACT,CAEA,SAASI,GAAmBC,EAAqB,CAEzC,MAAA7f,EAAQ6f,EAAI,QAAQ,GAAG,EACvBC,EAAMD,EAAI,YAAY,GAAG,EAAI,EACnC,GAAI7f,IAAU,IAAM8f,IAAQ,EAAS,UAAI,MAAM,uBAAuB,EAC/D,OAAAD,EAAI,MAAM7f,EAAO8f,CAAG,CAC7B,CAEsB,eAAAC,GAAsBjnB,EAAsBknB,EAAgB,CAEhF,MAAMC,GADK,MAAMR,GAAa,GACb,mBAAmB,CAAE,MAAO,aAAc,EAErD/O,EAAS;AAAA,oFACmE5X,CAAY,iCAAiCknB,CAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAYjI,IAEI,MAAAzlB,EAAW,MADF,MAAM0lB,EAAM,gBAAgBvP,CAAM,GACnB,SACxBhd,EAAOksB,GAAmBrlB,EAAS,KAAK,EAAE,MAAM,EAC9C,YAAI,yBAA0B7G,CAAI,EAEpC,MAAAwsB,EAAa,KAAK,MAAMxsB,CAAI,EAG9B,IAACwsB,EAAW,UAAY,CAACA,EAAW,WACpC,CAAC,MAAM,QAAQA,EAAW,KAAK,GAAK,CAAC,MAAM,QAAQA,EAAW,aAAa,GAC3E,CAAC,MAAM,QAAQA,EAAW,aAAa,EACnC,UAAI,MAAM,yBAAyB,EAGpC,OACL,SAAUA,EAAW,SACrB,UAAWA,EAAW,UACtB,MAAOA,EAAW,MAAM,MAAM,EAAG,CAAC,EAClC,cAAeA,EAAW,cAAc,MAAM,EAAG,CAAC,EAClD,cAAeA,EAAW,cAAc,MAAM,EAAG,CAAC,CACpD,QACOv3B,EAAO,CACN,qBAAM,kCAAmCA,CAAK,EAC/C,CACL,SAAU,gBAAgBmQ,CAAY,qBAAqBknB,CAAM,mCACjE,UAAW,QACX,MAAO,CACL,oBACA,uBACA,0BACF,EACA,cAAe,CACb,+BACA,8BACA,2BACF,EACA,cAAe,CACb,6BACA,sBACA,6BAEJ,EAEJ,CAEA,eAAsBG,GAAqBtW,EAAkB,CAE3D,MAAMoW,GADK,MAAMR,GAAa,GACb,mBAAmB,CAAE,MAAO,aAAc,EAErD/O,EAAS;AAAA,8EAC6D7G,CAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAShF,IAEI,MAAAtP,EAAW,MADF,MAAM0lB,EAAM,gBAAgBvP,CAAM,GACnB,SACxBhd,EAAOksB,GAAmBrlB,EAAS,KAAK,EAAE,MAAM,EAC9C,mBAAI,4BAA6B7G,CAAI,EACtC,KAAK,MAAMA,CAAI,QACf/K,EAAO,CACN,qBAAM,iCAAkCA,CAAK,EAC9C,CACL,iBAAkB,0CAClB,eAAgB,CAAC,oBAAqB,uBAAwB,6BAA6B,EAC3F,gBAAiB,CAAC,sBAAuB,+BAAgC,0BAA0B,CACrG,EAEJ,CAEA,eAAsBy3B,GAAsBC,EAAsB,CAEhE,MAAMJ,GADK,MAAMR,GAAa,GACb,mBAAmB,CAAE,MAAO,aAAc,EAErD/O,EAAS;AAAA,wEACuD2P,EAAgB,UAAU,mBAAmBA,EAAgB,MAAM,eAAeA,EAAgB,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAUjL,IAEI,MAAA9lB,EAAW,MADF,MAAM0lB,EAAM,gBAAgBvP,CAAM,GACnB,SACxBhd,EAAOksB,GAAmBrlB,EAAS,KAAK,EAAE,MAAM,EAC9C,mBAAI,yBAA0B7G,CAAI,EACnC,KAAK,MAAMA,CAAI,QACf/K,EAAO,CACN,qBAAM,kCAAmCA,CAAK,EAC/C,CACL,SAAU,4CACV,qBAAsB,+CACtB,SAAU,wCACV,iBAAkB,+BACpB,EAEJ,CCxHA,SAAwB23B,IAA8B,CACpD,KAAM,CAACxY,EAASC,CAAU,EAAI/d,EAAM,SAAS,EAAK,EAC5C,CAACrB,EAAOujB,CAAQ,EAAIliB,EAAM,SAAwB,IAAI,EACtD,CAAC8O,EAAcynB,CAAe,EAAIv2B,EAAM,SAAuB,aAAa,EAC5E,CAACg2B,EAAQQ,CAAS,EAAIx2B,EAAM,SAAS,IAAM,EAC3C,CAAC6f,EAAUC,CAAW,EAAI9f,EAAM,SAAS,QAAQ,EACjD,CAACy2B,EAAUC,CAAW,EAAI12B,EAAM,SAAc,IAAI,EAClD,CAAC22B,EAAaC,CAAc,EAAI52B,EAAM,SAAc,IAAI,EACxD,CAAC62B,EAAUC,CAAW,EAAI92B,EAAM,SAAc,IAAI,EAElDq2B,EAAkB,CACtB,WAAY,eACZ,OAAAL,EACA,cAAe,UACjB,EAEMe,EAAgB,SAAY,CAChChZ,EAAW,EAAI,EACfmE,EAAS,IAAI,EAET,IAEF,MAAM8U,EAAe,MAAMjB,GAAsBjnB,EAAcknB,CAAM,EACrE,GAAI,CAACgB,GAAgB,OAAOA,GAAiB,SACrC,UAAI,MAAM,gCAAgC,EAElDN,EAAYM,CAAY,EAElB,MAAAC,EAAkB,MAAMd,GAAqBtW,CAAQ,EAC3D,GAAI,CAACoX,GAAmB,OAAOA,GAAoB,SAC3C,UAAI,MAAM,mCAAmC,EAErDL,EAAeK,CAAe,EAExB,MAAAC,EAAe,MAAMd,GAAsBC,CAAe,EAChE,GAAI,CAACa,GAAgB,OAAOA,GAAiB,SACrC,UAAI,MAAM,gCAAgC,EAElDJ,EAAYI,CAAY,QAEjBv4B,EAAO,CACN,cAAM,qBAAsBA,CAAK,EACzCujB,EAASvjB,aAAiB,MAAQA,EAAM,QAAU,gDAAgD,EAElG+3B,EAAY,IAAI,EAChBE,EAAe,IAAI,EACnBE,EAAY,IAAI,SAChB,CACA/Y,EAAW,EAAK,EAEpB,EAGE,OAAA5iB,MAAC2yB,GACC,UAAA7vB,OAACyf,GACC,WAAAviB,EAAA,IAACiS,GAAA,CACC,MAAM,iCACN,SAAS,uEACT,WAAY,GACZ,OAAO,YACP,SAAU,IAAM,EAAC,CACnB,QAEC,OAAK,WAAU,oCACd,SAACnP,EAAA,YAAI,UAAU,+BAEb,UAACA,OAAA,WAAQ,UAAU,mCACjB,UAAC9C,EAAA,UAAG,UAAU,0BAA0B,SAAmB,wBAC3D8C,OAAC,MAAI,WAAU,wCACb,UAACA,OAAA,OAAI,UAAU,YACb,UAAC9C,EAAA,aAAM,UAAU,sBAAsB,SAAa,kBACpD8C,EAAA,KAACkxB,GAAA,CACC,aAAcrgB,EACd,cAAgB8Z,GAAwB2N,EAAgB3N,CAAK,EAE7D,UAAAztB,MAACo0B,IAAc,UAAU,SACvB,eAACF,GAAY,aAAY,uBAAuB,CAClD,UACCU,GACC,WAAC50B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,cAAc,SAAW,gBAC1Cl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,aAAa,SAAU,eACxCl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,aAAa,SAAU,eAC3C,KACF,EACF,EAEApyB,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,aAAM,UAAU,sBAAsB,SAAQ,aAC/CA,EAAA,IAACoL,EAAA,CACC,KAAK,OACL,MAAOsZ,EACP,SAAW7d,GAAM8d,EAAY9d,EAAE,OAAO,KAAK,EAC3C,YAAY,kBACd,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,SAAM,UAAU,sBAAsB,sBAAU+3B,EAAO,eAAe,GAAE,EACzE76B,EAAA,IAACg6B,GAAA,CACC,MAAO,CAACa,CAAM,EACd,cAAgBpN,GAAU4N,EAAU5N,EAAM,CAAC,CAAC,EAC5C,IAAK,IACL,IAAK,IACL,KAAM,KACR,CACF,IACF,EAEAztB,EAAA,IAAC0F,EAAA,CACC,QAASk2B,EACT,SAAUjZ,EACV,UAAU,OACV,KAAK,KAEJ,WAEG7f,OAAA6D,EAAA,oBAAC3G,MAAAg8B,GAAA,CAAQ,UAAU,2BAA4B,GAAE,gBAEnD,EAEA,kCAEJ,EACF,EAGCx4B,GACCxD,EAAA,IAAC,MAAI,WAAU,oDACZ,SACHwD,EAAA,EAGD83B,GAAYE,GAAeE,GAAY,CAACl4B,GACtCV,OAAA,OAAI,UAAU,wCAEb,UAAAA,OAAC8P,EACC,WAAA9P,OAAC+P,EACC,WAAC7S,MAAA+nB,GAAA,CAAW,UAAU,2BAA4B,GAClD/nB,MAAC8S,IAAU,SAAe,qBAC5B,EACAhQ,OAACkQ,EAAY,WAAU,YACrB,UAAAlQ,OAAC,MACC,WAAC9C,EAAA,UAAG,UAAU,gBAAgB,SAAQ,mBACrC,IAAE,WAAU,gCACV,SAAAs7B,EAAS,UAAY,wBACxB,IACF,SACC,MACC,WAACt7B,EAAA,UAAG,UAAU,gBAAgB,SAAS,oBACtC,IAAE,WAAU,gCACV,SAAAs7B,EAAS,WAAa,yBACzB,IACF,SACC,MACC,WAACt7B,EAAA,UAAG,UAAU,gBAAgB,SAAK,UACnCA,MAAC,KAAG,WAAU,+CACX,eAAM,QAAQs7B,EAAS,KAAK,EAC3BA,EAAS,MAAM,IAAI,CAACW,EAAcrsB,IAC/B5P,MAAA,MAAY,SAAJi8B,CAAA,EAAArsB,CAAS,CACnB,EAED5P,EAAA,IAAC,KAAG,oCAAwB,EAEhC,IACF,SACC,MACC,WAACA,EAAA,UAAG,UAAU,gBAAgB,SAAa,kBAC3CA,MAAC,KAAG,WAAU,+CACX,eAAM,QAAQs7B,EAAS,aAAa,EACnCA,EAAS,cAAc,IAAI,CAAC5I,EAAe9iB,IACxC5P,MAAA,MAAY,SAAJ0yB,CAAA,EAAA9iB,CAAU,CACpB,EAED5P,EAAA,IAAC,KAAG,uCAA2B,EAEnC,GACF,GACF,IACF,SAGC4S,EACC,WAAA9P,OAAC+P,EACC,WAAC7S,MAAA05B,GAAA,CAAM,UAAU,2BAA4B,GAC7C15B,MAAC8S,IAAU,SAAc,oBAC3B,EACAhQ,OAACkQ,EAAY,WAAU,YACrB,UAAAlQ,OAAC,MACC,WAAC9C,EAAA,UAAG,UAAU,gBAAgB,SAAW,sBACxC,IAAE,WAAU,gCACV,SAAAw7B,EAAY,kBAAoB,gCACnC,IACF,SACC,MACC,WAACx7B,EAAA,UAAG,UAAU,gBAAgB,SAAc,mBAC5CA,MAAC,KAAG,WAAU,+CACX,eAAM,QAAQw7B,EAAY,cAAc,EACvCA,EAAY,eAAe,IAAI,CAACjJ,EAAgB3iB,IAC7C5P,MAAA,MAAY,SAAJuyB,CAAA,EAAA3iB,CAAW,CACrB,EAED5P,EAAA,IAAC,KAAG,wCAA4B,EAEpC,GACF,GACF,IACF,SAGC4S,EACC,WAAA9P,OAAC+P,EACC,WAAC7S,MAAAmuB,GAAA,CAAU,UAAU,2BAA4B,GACjDnuB,MAAC8S,IAAU,SAAoB,0BACjC,EACAhQ,OAACkQ,EAAY,WAAU,YACrB,UAAAlQ,OAAC,MACC,WAAC9C,EAAA,UAAG,UAAU,gBAAgB,SAAoB,+BACjD,IAAE,WAAU,gCACV,SAAA07B,EAAS,sBAAwB,oCACpC,IACF,SACC,MACC,WAAC17B,EAAA,UAAG,UAAU,gBAAgB,SAAgB,2BAC7C,IAAE,WAAU,gCACV,SAAA07B,EAAS,kBAAoB,gCAChC,IACF,SACC,MACC,WAAC17B,EAAA,UAAG,UAAU,gBAAgB,SAAQ,mBACrC,IAAE,WAAU,gCACV,SAAA07B,EAAS,UAAY,wBACxB,GACF,GACF,GACF,GACF,IAEJ,CACF,IACF,CACF,EAEJ,CCnQA,SAAwBQ,IAAc,CAElC,OAAAl8B,MAAC2yB,GACC,UAAA7vB,OAACyf,GACC,WAAAviB,EAAA,IAACiS,GAAA,CACC,MAAM,cACN,SAAS,4CACT,gBAAgB,8EAChB,WAAY,GACZ,UAAW,GACX,OAAO,YACT,QACC,OAAK,WAAU,oCACd,SAACnP,EAAA,YAAI,UAAU,8BACb,UAACA,OAAA,OAAI,UAAU,cACb,UAAC9C,EAAA,UAAG,UAAU,0BAA0B,SAAS,cAChDA,EAAA,SAAE,UAAU,wBAAwB,SAGrC,0GACF,EAEA8C,OAAC,UAAQ,WAAU,YACjB,UAAC9C,EAAA,UAAG,UAAU,yBAAyB,SAAW,gBAClDA,MAAC,KAAE,SAKH,0PACF,EAEA8C,OAAC,UAAQ,WAAU,YACjB,UAAC9C,EAAA,UAAG,UAAU,yBAAyB,SAAU,eACjD8C,OAAC,KAAG,WAAU,wBACZ,UAAA9C,MAAC,MAAG,SAIJ,4HACAA,MAAC,MAAG,SAGJ,kGACAA,MAAC,MAAG,SAIJ,gIACF,IACF,EAEA8C,OAAC,UAAQ,WAAU,YACjB,UAAC9C,EAAA,UAAG,UAAU,yBAAyB,SAAQ,aAC/CA,MAAC,KAAE,SAMH,oRACF,EAEA8C,OAAC,UAAQ,WAAU,YACjB,UAAC9C,EAAA,UAAG,UAAU,yBAAyB,SAAU,eACjDA,MAAC,KAAE,SAGH,iHACAA,MAAC0F,GAAO,SAAU,eACpB,IACF,CACF,IACF,CACF,EAEJ,CChEO,MAAMy2B,GAAsC,CAAC,CAAE,OAAA31B,EAAQ,QAAAC,EAAS,KAAA4b,EAAM,aAAAnO,KACtEmO,EAGHriB,EAAA,IAACmK,IAAO,KAAM3D,EAAQ,aAAcC,EAClC,SAAA3D,EAAA,KAAC6H,GAAc,WAAU,6DACvB,UAAA3K,MAAC8K,GACC,UAAAhI,OAACkI,GAAY,WAAU,6EACrB,UAAAhL,EAAA,IAAC,OAAK,WAAU,gDAAiD,SAAAqiB,EAAK,MAAM,EAC5Evf,OAAC,MAAI,WAAU,uBACb,UAAA9C,EAAA,IAACmT,GAAM,WAAU,UAAW,SAAAkP,EAAK,cAAc,QAC9ClP,GAAM,SAAQ,YAAY,UAAU,UAAW,WAAK,SAAU,GACjE,IACF,CACF,GAGAnT,MAAC,MAAI,WAAU,gEACb,SAAAA,EAAA,IAAC,OACC,IAAKqiB,EAAK,UACV,IAAKA,EAAK,MACV,UAAU,+BAEd,EAGAvf,OAAC,MAAI,WAAU,kFACb,UAAC9C,MAAA0e,GAAA,CAAO,UAAU,uBAAwB,GACzC1e,EAAA,YAAK,UAAU,cAAe,WAAK,QAAS,IAC/C,EAGA8C,OAAC,MAAI,WAAU,eACb,UAAC9C,EAAA,UAAG,UAAU,0CAA0C,SAAW,gBAClEA,EAAA,SAAE,UAAU,2CAA4C,WAAK,WAAY,IAC5E,EAGA8C,OAAC,MAAI,WAAU,8DACb,UAAAA,OAAC,MACC,WAAC9C,EAAA,UAAG,UAAU,kDAAkD,SAAK,gBACpE,IAAE,WAAU,uBAAwB,SAAeb,EAAAkjB,EAAK,KAAK,CAAE,IAClE,SACC,MACC,WAACriB,EAAA,UAAG,UAAU,kDAAkD,SAAG,QACnE8C,OAAC,IAAE,WAAU,wCAAyC,UAAKuf,EAAA,eAAe,IAAC,IAC7E,SACC,MACC,WAACriB,EAAA,UAAG,UAAU,kDAAkD,SAAe,oBAC9EA,EAAA,SAAE,UAAU,uBAAwB,WAAK,eAAgB,IAC5D,SACC,MACC,WAACA,EAAA,UAAG,UAAU,kDAAkD,SAAa,kBAC5EA,EAAA,SAAE,UAAU,uBAAwB,WAAK,aAAc,GAC1D,IACF,EAGA8C,OAAC,MAAI,WAAU,yBACb,UAAAA,OAAC,MACC,WAAC9C,EAAA,UAAG,UAAU,kDAAkD,SAAS,oBACxEmT,GAAM,SAAQ,UAAU,UAAU,qBAAsB,WAAK,SAAU,IAC1E,SACC,MACC,WAACnT,EAAA,UAAG,UAAU,kDAAkD,SAAQ,aACvEA,EAAA,SAAE,UAAU,uDAAwD,WAAK,QAAS,GACrF,GACF,IACF,CACF,GApEgB,KCDdikB,GAAqB,CAAC,CAAE,SAAAvgB,KAA8C,CACtE,IAEM,OAAAoB,GAAA,oBAEE,SAAApB,EAAS,OACL,CAGZ,OAAA1D,MAACuiB,IACC,SAACviB,EAAA,WAAI,UAAU,6DACb,SAAA8C,OAAC8P,EAAK,WAAU,sBACd,UAAC5S,EAAA,UAAG,UAAU,qCAAqC,SAAoB,yBACtEA,EAAA,SAAE,UAAU,yCAAyC,SAEtD,+EACAA,EAAA,IAAC0F,EAAA,CACC,UAAU,SACV,QAAS,IAAM,OAAO,SAAS,OAAO,EACvC,yBAED,CACF,EACF,GACF,EAGN,EAEA,SAAwB02B,GAAU,CAAE,SAAAjwB,EAAU,SAAAC,GAA4B,CAExE,aACG6X,GACC,UAAAjkB,MAACq8B,GAAiB,UAAAlwB,EAAoB,SAAAC,CAAoB,GAC5D,CAEJ,CAGA,SAASiwB,GAAiB,CAAE,SAAAlwB,EAAU,SAAAC,GAA4B,CAChE,KAAM,CAAE,KAAAzI,EAAM,QAAAK,EAAS,UAAAE,CAAA,EAAcY,GAAQ,EACvC,CAACqW,EAAOyb,CAAQ,EAAI/yB,WAAiB,EAAE,EACvC,CAAC8e,EAASC,CAAU,EAAI/e,WAAS,EAAI,EACrC,CAACy4B,EAAcC,CAAe,EAAI14B,WAAsB,IAAI,EA4BlE,OA1BAW,YAAU,IAAM,CACd,IAAIqyB,EAAU,GAEd,eAAeC,GAAY,CACrB,IACI,MAAApV,EAAY,MAAMxG,GAAS,EAC7B2b,IACFD,EAASlV,CAAS,EAClBkB,EAAW,EAAK,SAEXpf,EAAO,CACN,cAAM,uBAAwBA,CAAK,EACvCqzB,GACFjU,EAAW,EAAK,CAClB,CACF,CAGQ,OAAAkU,EAAA,EAEH,IAAM,CACDD,EAAA,EACZ,CACF,EAAG,EAAE,EAGD3yB,EAEAlE,MAACuiB,GACC,UAAAviB,MAAC,MAAI,WAAU,gDACb,SAACA,MAAA,OAAI,SAAU,cACjB,GACF,QAKDuiB,GACC,UAAAviB,EAAA,IAAC2yB,IACC,SAAC7vB,EAAA,YAAI,UAAU,0BACb,UAAA9C,EAAA,IAACiS,GAAA,CACC,MAAM,iBACN,SAAS,uDACT,WAAY,GACZ,UAAW,GACX,OAAO,YACP,MAAM,kBACR,EAEAjS,EAAA,IAAC,OAAK,WAAU,8BACb,SAAA2iB,EACE3iB,MAAA,OAAI,UAAU,mBAAmB,SAAgB,qBAC/C2D,QA2CF,MAAI,WAAU,2CACZ,SAAMwX,EAAA,IAAKkH,GACVriB,EAAA,IAAC2zB,GAAA,CAEC,KAAAtR,EACA,cAAcre,GAAA,YAAAA,EAAS,qBAAsB,OAC7C,QAAS,IAAMu4B,EAAgBla,CAAI,EACnC,KAAA1e,CAAA,EAJK0e,EAAK,GAMb,CACH,GAnDAvf,OAAC,MAAI,WAAU,oBACb,UAACA,OAAA8P,EAAA,CAAK,UAAU,uBACd,UAAC5S,EAAA,UAAG,UAAU,0BAA0B,SAAiC,sCACxEA,EAAA,SAAE,UAAU,6BAA6B,SAG1C,mIACA8C,OAAC,MAAI,WAAU,4BACb,UAAAA,EAAA,KAAC4C,EAAA,CACC,QAASyG,EACT,UAAU,0BAEV,UAACnM,MAAAgO,GAAA,CAAM,UAAU,SAAU,GAAE,WAE/B,EACAlL,EAAA,KAAC4C,EAAA,CACC,QAAQ,UACR,QAAS0G,EACT,UAAU,0BAEV,UAACpM,MAAAiO,GAAA,CAAS,UAAU,SAAU,GAAE,mBAElC,CACF,IACF,QAGC,MAAI,WAAU,2CACZ,SAAMkN,EAAA,IAAKkH,GACVriB,EAAA,IAAC2zB,GAAA,CAEC,KAAAtR,EACA,aAAc,GACd,QAASlW,EACT,KAAM,MAJDkW,EAAK,GAMb,CACH,GACF,GAeJ,EAEAriB,EAAA,IAACm8B,GAAA,CACC,OAAQ,CAAC,CAACG,EACV,QAAS,IAAMC,EAAgB,IAAI,EACnC,KAAMD,EACN,cAAct4B,GAAA,YAAAA,EAAS,qBAAsB,QAC/C,CACF,EACF,GACF,CAEJ,CCpJA,SAAwBw4B,IAAW,gBACjC,KAAM,CAAE,KAAMC,CAAS,EAAI33B,GAAQ,EAC7B,CAAC43B,EAAeC,CAAgB,EAAI94B,WAAyB,EAAE,EAC/D,CAAC+4B,EAAsBC,CAAuB,EAAIh5B,WAAwB,IAAI,EAC9E,CAACqV,EAAUC,CAAW,EAAItV,WAAgC,EAAE,EAC5D,CAACuV,EAAYC,CAAa,EAAIxV,WAAS,EAAE,EACzC,CAACK,EAAWC,CAAY,EAAIN,WAAS,EAAI,EACzC,CAACi5B,EAAmBC,CAAoB,EAAIl5B,WAAS,EAAK,EAC1D,CAACL,EAAOujB,CAAQ,EAAIljB,WAAwB,IAAI,EAChD,CAAC0O,EAAYC,CAAa,EAAI3O,WAAS,EAAE,EACzC,CAACoc,EAAeC,CAAgB,EAAIrc,WAAgB,EAAE,EACtD,CAACsc,EAAaC,CAAc,EAAIvc,WAAS,EAAK,EAC9C,CAACm5B,EAAeC,CAAgB,EAAIp5B,WAAS,EAAK,EAClD,CAACq5B,EAAcC,CAAe,EAAIt5B,WAAS,EAAK,EAChD,CAACu5B,EAAoBC,CAAqB,EAAIx5B,WAAS,EAAK,EAC5D2V,EAAiBnK,SAAuB,IAAI,EAC5C,CAAE,KAAMvL,CAAY,EAAAw5B,GAAO,UAAW,SAAY,SACtD,KAAM,CAAE,KAAA/5B,CAAK,EAAI,MAAMN,EAAS,KAAK,WAAW,EAChD,eAAQ,IAAI,qBAAsB,CAAE,WAAY,CAAC,CAACM,EAAK,QAAS,aAAae,GAAAD,EAAAd,EAAK,UAAL,YAAAc,EAAc,OAAd,YAAAC,EAAoB,GAAI,EAC9Ff,EAAK,QACb,EAGK2I,EAAkB,CAAC,CAACuwB,GAAY,CAAC,CAAC34B,EAExCU,YAAU,IAAM,OACd,QAAQ,IAAI,wBAAyB,CACnC,SAAU,CAAC,CAACi4B,EACZ,WAAYA,GAAA,YAAAA,EAAU,GACtB,QAAS,CAAC,CAAC34B,EACX,eAAeO,EAAAP,GAAA,YAAAA,EAAS,OAAT,YAAAO,EAAe,GAC9B,gBAAA6H,CAAA,CACD,CACA,GAACuwB,EAAU34B,EAASoI,CAAe,CAAC,EAGvC1H,YAAU,IAAM,CACd,MAAM+4B,EAAe,IAAM,CACTJ,EAAA,OAAO,WAAa,GAAG,CACzC,EAEa,OAAAI,EAAA,EACN,wBAAiB,SAAUA,CAAY,EACvC,IAAM,OAAO,oBAAoB,SAAUA,CAAY,CAChE,EAAG,EAAE,EAGL/4B,YAAU,IAAM,CACV04B,GAAgBN,GAClBS,EAAsB,EAAI,CAC5B,EACC,CAACT,EAAsBM,CAAY,CAAC,EAGvC14B,YAAU,IAAM,CACd,GAAI0H,EAAiB,CACnB,QAAQ,IAAI,8CAA8C,EACxCsxB,EAAA,EACZ,MAAAlE,EAAe7gB,GAAqBT,GAAY,EAEhDA,EAAQ,YAAc4kB,GACtB5kB,EAAQ,cAAgB4kB,IAE1BzjB,EAAoB7C,GAAA,CAAC,GAAGA,EAAM0B,CAAO,CAAC,EAGtBwlB,EAAA,EACnB,EAED,MAAO,IAAM,CACXlE,GAAA,MAAAA,EAAc,aAChB,OAEA,QAAQ,IAAI,2BAA2B,EACvCvS,EAAS,sCAAsC,EAC/C5iB,EAAa,EAAK,CACpB,EACC,CAAC+H,EAAiB0wB,CAAoB,CAAC,EAG1Cp4B,YAAU,IAAM,CACR,MAAE,KAAMi5B,GAAiBx6B,EAAS,KAAK,kBAAkB,CAACyB,EAAOZ,IAAY,CACjF,QAAQ,IAAI,8BAA+BY,EAAO,CAAC,CAACZ,CAAO,EACvDA,IAAYY,IAAU,aAAeA,IAAU,qBACjD,QAAQ,IAAI,2CAA2C,EACvDqiB,EAAS,IAAI,EACKyW,EAAA,EACpB,CACD,EAED,MAAO,IAAM,CACXC,EAAa,aAAa,YAAY,CACxC,CACF,EAAG,EAAE,EAGLj5B,YAAU,IAAM,CACVo4B,GACFnjB,GAAamjB,CAAoB,CACnC,EACC,CAACA,CAAoB,CAAC,EAGzBp4B,YAAU,IAAM,CACCkV,GAAA,GACd,CAACR,CAAQ,CAAC,EAGb1U,YAAU,IAAM,CACVw4B,GACFpkB,GAAY,EAAE,CAChB,EACC,CAACokB,CAAa,CAAC,EAElB,MAAMQ,EAAoB,SAAY,CAChC,IACFr5B,EAAa,EAAI,EACX,MAAAu5B,GAAa55B,GAAA,YAAAA,EAAS,OAAQ24B,EAEhC,KAACiB,GAAA,MAAAA,EAAY,IAAI,CACnB,QAAQ,IAAI,gDAAgD,EAC5Df,EAAiB,EAAE,EACnB,OAGF,QAAQ,IAAI,mCAAmCe,EAAW,EAAE,EAAE,EACxD,MAAAn6B,EAAO,MAAMoU,GAAiB,EAC5B,YAAI,wBAAyBpU,CAAI,EACzCo5B,EAAiBp5B,CAAI,EACrBwjB,EAAS,IAAI,QACNvjB,EAAO,CACN,cAAM,+BAAgCA,CAAK,EACnDujB,EAAS,iDAAiD,SAC1D,CACA5iB,EAAa,EAAK,EAEtB,EAEMsV,GAAe,MAAOnW,GAAmB,CACzC,IACFy5B,EAAqB,EAAI,EACnB,MAAAY,EAAO,MAAMvlB,GAAY9U,CAAM,EACrC6V,EAAYwkB,CAAI,QACTzL,EAAK,CACJ,cAAM,0BAA2BA,CAAG,SAC5C,CACA6K,EAAqB,EAAK,EAE9B,EAEMljB,GAAoB,MAAOhT,GAAuB,CAEtD,GADAA,EAAE,eAAe,EACb,GAAC+1B,GAAwB,CAACxjB,EAAW,QAErC,IACc,MAAM9B,GAAYslB,EAAsBxjB,EAAW,MAAM,GAGvEC,EAAc,EAAE,QAEX7V,EAAO,CACN,cAAM,yBAA0BA,CAAK,EAEjD,EAEMkW,GAAiB,IAAM,QAC3BrV,EAAAmV,EAAe,UAAf,MAAAnV,EAAwB,eAAe,CAAE,SAAU,UACrD,EAEMuU,GAAc,MAAOqJ,GAAiB,CAC1C7B,EAAe,EAAI,EACf,IAEF,QAAQ,IAAI,oCAAoC6B,GAAQ,WAAW,GAAG,EAGhE,MAAA2b,EAAU,MAAMC,GAAe5b,CAAI,EAGzC,QAAQ,IAAI,oBAAmB2b,GAAA,YAAAA,EAAS,SAAU,CAAC,UAAWA,CAAO,EAEpD1d,EAAA0d,GAAW,EAAE,QACvBp6B,EAAO,CACN,cAAM,yBAA0BA,CAAK,EAC7C0c,EAAiB,EAAE,SACnB,CACAE,EAAe,EAAK,EAExB,EAEM0d,GAA4B,IAAM,CACtCT,EAAsB,EAAK,CAC7B,EAsBI,OAACnxB,GAAmB,CAAChI,QAEpBqe,GACC,UAAAviB,MAAC2yB,GACC,UAAA3yB,MAAC,OAAI,UAAU,oCACb,SAACA,EAAA,WAAI,UAAU,mBACb,SAAA8C,EAAA,KAACuX,IAAM,QAAQ,cAAc,UAAU,YACrC,UAACra,EAAA,IAAAsa,GAAA,CAAW,UAAU,gBAAgB,SAAuB,4BAC7Dta,MAACua,IAAiB,SAElB,4CACF,GACF,GACF,EACF,CACF,GAKFva,EAAA,IAACuiB,GACC,UAAAviB,EAAA,IAAC2yB,GACC,UAAA3yB,MAAC,MAAI,WAAU,sDACb,SAAA8C,EAAA,KAAC,MAAI,WAAU,6CACb,UAAC9C,EAAA,UAAG,UAAU,sCAAsC,SAAa,wBAChE,MAAI,WAAU,2CACb,SAAC8C,EAAA,YAAI,UAAU,oFAEb,UAAA9C,MAAC,OAAI,UAAWjB,EACd,kCACCm+B,GAAgBE,EAAsB,SAAW,iBAElD,SAAAt6B,OAAC8P,EAAK,WAAU,qFACd,UAAC9P,OAAA+P,EAAA,CAAW,UAAU,gFACpB,UAAC/P,OAAA,OAAI,UAAU,0BACb,UAAC9C,MAAA25B,GAAA,CAAc,UAAU,uBAAwB,GACjD35B,MAAC8S,IAAU,SAAQ,cACrB,EACChQ,EAAA,KAAAqH,GAAA,CAAO,KAAM6yB,EAAe,aAAcC,EACzC,UAAAj9B,MAACqK,IAAc,QAAO,GACpB,SAACrK,MAAA0F,EAAA,CAAO,KAAK,OAAO,QAAQ,UAAU,UAAU,gDAC9C,SAAC1F,MAAA+9B,GAAA,CAAK,UAAU,wBAAwB,CAC1C,GACF,SACCpzB,GACC,WAAA3K,MAAC8K,GACC,UAAAhI,OAACkI,GAAY,WAAU,0BACrB,UAAChL,MAAAiO,GAAA,CAAS,UAAU,uBAAwB,GAAE,oBAEhD,CACF,GACAnL,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,aACb,UAAA9C,EAAA,IAACoL,EAAA,CACC,YAAY,kBACZ,MAAOmH,EACP,SAAW1L,GAAM,CACD2L,EAAA3L,EAAE,OAAO,KAAK,CAC9B,EACA,UAAYA,GAAM,CACZA,EAAE,MAAQ,SACZ+R,GAAYrG,CAAU,CAE1B,EACA,UAAU,SACZ,EACAvS,EAAA,IAAC0F,EAAA,CACC,KAAK,OACL,QAAQ,QACR,SAAUya,EACV,UAAU,WACV,QAAS,IAAMvH,GAAYrG,CAAU,EAEpC,SAAA4N,QAAe6b,GAAQ,WAAU,sBAAuB,GAAKh8B,MAAC2S,GAAO,WAAU,SAAU,IAC5F,EACF,EACA7P,OAACiD,GAAW,WAAU,YACnB,UAAAoa,SACE,MAAI,WAAU,6CACb,SAAAngB,MAAC+Y,IAAe,GAClB,EAED,CAACoH,GAAeF,EAAc,SAAW,GACvCnd,OAAA,OAAI,UAAU,+DACb,UAAC9C,MAAAgoB,GAAA,CAAM,UAAU,iDAAkD,GACnEhoB,MAAC,KAAE,SAAc,mBACjBA,MAAC,KAAE,UAAU,eACV,WAAa,mBAAmBuS,CAAU,IAAM,wCACnD,GACAzP,OAAC,MAAI,WAAU,eACb,UAAA9C,MAAC,KAAE,SAAkB,uBACrB8C,OAAC,KAAG,WAAU,0CACZ,UAAA9C,MAAC,MAAG,SAAoC,yCACxCA,MAAC,MAAG,SAA6C,kDACjDA,MAAC,MAAG,SAAuB,4BAC3BA,MAAC,MAAG,SAAgC,qCACtC,GACF,IACF,EAED,CAACmgB,GAAeF,EAAc,IAC7Btc,GAAA,SAAAb,SAAA,KAAC,OAEC,UAAU,2FACV,QAAS,IAAM,CACb+5B,EAAwBl5B,EAAK,EAAE,EAC/Bs5B,EAAiB,EAAK,CACxB,EAEA,UAACn6B,OAAAmF,GAAA,CAAO,UAAU,qCAChB,UAAAjI,EAAA,IAACmI,GAAY,KAAKxE,EAAK,YAAc,OAAW,EAC/C3D,EAAA,IAAAqI,GAAA,CAAe,UAAU,4BACvB,eAAK,0BAAW,OAAO,OAAM/D,EAAAX,EAAK,QAAL,YAAAW,EAAY,OAAO,KAAM,GACzD,IACF,SACC,MACC,WAAAtE,MAAC,KAAE,UAAU,cAAe,SAAK2D,EAAA,WAAaA,EAAK,MAAM,EACxDA,EAAK,WAAaA,EAAK,aACrB,IAAE,WAAU,gCAAiC,SAAAA,EAAK,KAAM,GAE7D,KAlBKA,EAAK,EAoBb,IACH,GACF,GACF,GACF,IACF,EACAb,OAACkQ,EAAY,WAAU,6BACpB,UACCxP,GAAAxD,EAAA,IAACqa,IAAM,QAAQ,cAAc,UAAU,gBACrC,SAAAra,MAACua,GAAkB,UAAA/W,CAAA,CAAM,CAC3B,GAGDU,EACElE,MAAA,OAAI,UAAU,0CACb,eAAC+Y,GAAe,MAAK,IAAK,GAC5B,EACE2jB,EAAc,SAAW,EAC1B55B,OAAA,OAAI,UAAU,wFACb,UAAC9C,MAAA25B,GAAA,CAAc,UAAU,8BAA+B,GACvD35B,EAAA,UAAG,UAAU,2BAA2B,SAAoB,yBAC5DA,EAAA,SAAE,UAAU,sCAAsC,SAEnD,6DACA8C,EAAA,KAAC4C,EAAA,CACC,QAAS,IAAMu3B,EAAiB,EAAI,EACpC,UAAU,sCACV,KAAK,KAEL,UAACj9B,MAAAiO,GAAA,CAAS,UAAU,SAAU,GAAE,qBAElC,CACF,GAEAjO,MAAC+F,GAAW,WAAU,SACpB,SAAA/F,EAAA,IAAC,MAAI,WAAU,2BACZ,SAAA08B,EAAc,IAAKvkB,GAClBnY,EAAA,IAAC,OAEC,UAAWjB,EACT,wDACA69B,IAAyBzkB,EAAa,KAAK,GAAK,cAAgB,EAClE,EACA,QAAS,IAAM0kB,EAAwB1kB,EAAa,KAAK,EAAE,EAE3D,SAAArV,EAAA,KAAC,MAAI,WAAU,0BACb,UAACA,OAAAmF,GAAA,CAAO,UAAU,qCAChB,UAAAjI,EAAA,IAACmI,GAAY,KAAKgQ,EAAa,KAAK,YAAc,OAAW,EAC7DnY,MAACqI,IAAe,UAAU,4BACvB,WAAa,KAAK,UAAU,OAAO,CAAC,CACvC,IACF,EACAvF,OAAC,MAAI,WAAU,iBACb,UAACA,OAAA,OAAI,UAAU,oCACb,UAAA9C,MAAC,IAAE,WAAU,uBAAwB,SAAAmY,EAAa,KAAK,UAAU,EACjEnY,MAAC,IAAE,WAAU,uDACV,SAAAg+B,GAAoB,IAAI,KAAK7lB,EAAa,YAAY,UAAU,EAAG,CAClE,UAAW,GACZ,CACH,IACF,EACArV,OAAC,MAAI,WAAU,yCACb,UAACA,OAAA,KAAE,UAAU,yCACV,UAAaqV,EAAA,YAAY,YAAcskB,EAAS,IAAM,QACtDtkB,EAAa,YAAY,SAC5B,EACCA,EAAa,YAAc,GAC1BnY,MAAC,OAAI,UAAU,uGACZ,WAAa,WAChB,GAEJ,GACF,GACF,IAnCKmY,EAAa,KAAK,EAqC1B,EACH,EACF,GAEJ,IACF,CACF,GAGAnY,MAAC,OAAI,UAAWjB,EACd,0CACCm+B,GAAgB,CAACE,EAAsB,SAAW,iBAEnD,SAAAt6B,OAAC8P,EAAK,WAAU,qFACd,UAAA5S,MAAC6S,EAAW,WAAU,qFACnB,SAAA+pB,EAEI95B,EAAA,KAAA6D,WAAA,WACCu2B,GAAAl9B,EAAA,IAAC0F,EAAA,CACC,QAAQ,QACR,KAAK,OACL,UAAU,yBACV,QAASo4B,GAET,SAAA99B,MAACi+B,GAAU,WAAU,uBAAwB,GAC/C,IAED55B,GAAAq4B,EAAc,KAAUlrB,KAAE,KAAK,KAAOorB,CAAoB,IAA1D,YAAAv4B,GAA6D,OAC5DvB,EAAA,KAAC,MAAI,WAAU,0CACb,UAACA,OAAAmF,GAAA,CAAO,UAAU,mCAChB,UAAAjI,EAAA,IAACmI,GAAA,CACC,MAAK7D,GAAAo4B,EAAc,KAAUlrB,KAAE,KAAK,KAAOorB,CAAoB,IAA1D,YAAAt4B,GAA6D,KAAK,aAAc,OACvF,QACC+D,GAAe,WAAU,4BACvB,WAAA4mB,GAAAyN,EAAc,KAAUlrB,KAAE,KAAK,KAAOorB,CAAoB,IAA1D,YAAA3N,GAA6D,KAAK,UAAU,OAAO,KAAM,GAC5F,IACF,QACC,MAAI,WAAU,kBACb,SAACjvB,MAAA,KAAE,UAAU,+BACV,UAAAgvB,EAAA0N,EAAc,KAAKlrB,GAAKA,EAAE,KAAK,KAAOorB,CAAoB,IAA1D,YAAA5N,EAA6D,KAAK,UACrE,CACF,GACF,IAEJ,EAEChvB,MAAA,OAAI,UAAU,cAAc,mBAAQ,GAEzC,EACAA,MAACgT,GAAY,UAAU,6BACpB,WACElQ,OAAA,OAAI,UAAU,uBACZ,UACCg6B,EAAA98B,MAAC,OAAI,UAAU,0CACb,eAAC+Y,GAAe,MAAK,KAAK,CAC5B,SAEChT,GAAW,WAAU,aACnB,SAASmT,EAAA,SAAW,EAClBpW,EAAA,YAAI,UAAU,kFACb,UAAC9C,MAAA25B,GAAA,CAAc,UAAU,8BAA+B,GACvD35B,EAAA,UAAG,UAAU,2BAA2B,SAAe,oBACvDA,EAAA,SAAE,UAAU,sCAAsC,SAEnD,6CACF,GAEA8C,OAAC,MAAI,WAAU,YACZ,UAASoW,EAAA,IAAI,CAAClB,EAASvV,IAAU,CAC1B,MAAAy7B,EAASlmB,EAAQ,YAAcykB,EAAS,GACxC0B,GAAa,CAACD,IAAWz7B,IAAU,GAAKyW,EAASzW,EAAQ,CAAC,EAAE,YAAcuV,EAAQ,WAGtF,OAAAlV,EAAA,KAAC,OAEC,UAAW/D,EACT,OACAm/B,EAAS,cAAgB,eAC3B,EAEC,UACCC,GAAAr7B,EAAA,KAACmF,GAAO,WAAU,6CAChB,UAAAjI,EAAA,IAACmI,GAAY,KAAK6P,EAAQ,OAAO,WAAY,EAC7ChY,MAACqI,IAAe,UAAU,4BACvB,WAAQ,OAAO,UAAU,OAAO,CAAC,CACpC,GACF,GACE,CAAC61B,GACFl+B,MAAA,OAAI,UAAU,OAAO,EAExB8C,EAAA,KAAC,OACC,UAAW/D,EACT,4DACAm/B,EACI,yCACA,6BACN,EAEA,UAAAl+B,EAAA,IAAC,IAAE,WAAU,UAAW,SAAAgY,EAAQ,QAAQ,EACxChY,MAAC,KAAE,UAAWjB,EACZ,eACAm/B,EAAS,gBAAkB,iBAE1B,SAAoBF,GAAA,IAAI,KAAKhmB,EAAQ,UAAU,EAAG,CAAE,UAAW,EAAK,CAAC,CACxE,KACF,GA/BKA,EAAQ,EAgCf,EAEH,EACDhY,MAAC,MAAI,KAAKwZ,CAAgB,IAC5B,CAEJ,GAGFxZ,MAAC,QAAK,SAAU6Z,GAAmB,UAAU,0BAC3C,SAAA/W,EAAA,KAAC,MAAI,WAAU,aACb,UAAA9C,EAAA,IAACoL,EAAA,CACC,MAAOgO,EACP,SAAUvS,GAAKwS,EAAcxS,EAAE,OAAO,KAAK,EAC3C,YAAY,oBACZ,UAAU,kCACZ,EACA/D,EAAA,KAAC4C,EAAA,CACC,KAAK,SACL,UAAU,yCACV,SAAU,CAAC0T,EAAW,KAAK,EAE3B,UAACpZ,MAAA8Z,GAAA,CAAK,UAAU,cAAe,GAAE,SAEnC,EACF,CACF,GACF,GAEAhX,OAAC,MAAI,WAAU,kFACb,UAAC9C,MAAA25B,GAAA,CAAc,UAAU,8BAA+B,GACvD35B,EAAA,UAAG,UAAU,2BAA2B,SAAqB,0BAC7DA,EAAA,SAAE,UAAU,sCAAsC,SAEnD,4DACF,CAEJ,IACF,CACF,IACF,CACF,IACF,EACF,CACF,GACF,CAEJ,CCtlBa,MAAAo+B,GAAgB,2CCCvBC,GAAe,0BACfC,GAAW,qBA2TjB,eAAsBC,GAAgBC,EAAyD,CACzF,IACI,MAAAC,EAAc,IAAI,gBAGZA,EAAA,OAAO,WAAYD,EAAO,QAAQ,EAC1CA,EAAO,KAAiBC,EAAA,OAAO,MAAOD,EAAO,IAAI,UAAU,EAC3DA,EAAO,MAAkBC,EAAA,OAAO,OAAQD,EAAO,KAAK,UAAU,EAC9DA,EAAO,UAAsBC,EAAA,OAAO,WAAYD,EAAO,SAAS,UAAU,EAC1EA,EAAO,eAAeC,EAAY,OAAO,gBAAiBD,EAAO,aAAa,EAC9EA,EAAO,iBAA6BC,EAAA,OAAO,kBAAmBD,EAAO,gBAAgB,UAAU,EAE7F,MAAA/S,EAAM,GAAG4S,EAAY,GAAGC,EAAQ,mBAAmBG,EAAY,UAAU,GACvE,YAAI,+BAAgChT,CAAG,EAEzC,MAAArW,EAAW,MAAM,MAAMqW,EAAK,CAChC,OAAQ,MACR,QAAS,CACP,cAAiB,SAAS2S,EAAa,GACvC,eAAgB,mBAChB,OAAU,mBACZ,CACD,EAEG,IAAChpB,EAAS,GAAI,CACV,MAAA5R,EAAQ,MAAM4R,EAAS,KAAK,EAClC,MAAM,IAAI,MAAM5R,EAAM,SAAW,+BAA+B,EAG3D,aAAM4R,EAAS,KAAK,QACpB5R,EAAO,CACN,oBAAM,gCAAiCA,CAAK,EAC9CA,CAAA,CAEV,CAGA,eAAsBk7B,GAAkBF,EAA0B,OAC5D,IACI,MAAAC,EAAc,IAAI,gBAGZA,EAAA,OAAO,WAAYD,EAAO,QAAQ,EAC1CA,EAAO,UAAUC,EAAY,OAAO,WAAYD,EAAO,QAAQ,EAC/DA,EAAO,KAAiBC,EAAA,OAAO,MAAOD,EAAO,IAAI,UAAU,EAC3DA,EAAO,MAAkBC,EAAA,OAAO,OAAQD,EAAO,KAAK,UAAU,EACtDC,EAAA,OAAO,gBAAiBD,EAAO,aAAa,EACpDA,EAAO,QAAQC,EAAY,OAAO,SAAUD,EAAO,MAAM,EACzDA,EAAO,WAAWC,EAAY,OAAO,YAAaD,EAAO,SAAS,EAClEA,EAAO,gBAA4BC,EAAA,OAAO,iBAAkBD,EAAO,eAAe,UAAU,EAC5FA,EAAO,iBAA6BC,EAAA,OAAO,kBAAmBD,EAAO,gBAAgB,UAAU,EAC/FA,EAAO,mBAAqB,QAAWC,EAAY,OAAO,mBAAoBD,EAAO,iBAAiB,UAAU,EAE9G,MAAA/S,EAAM,GAAG4S,EAAY,GAAGC,EAAQ,iBAAiBG,EAAY,UAAU,GACrE,YAAI,iCAAkChT,CAAG,EAE3C,MAAArW,EAAW,MAAM,MAAMqW,EAAK,CAChC,OAAQ,MACR,QAAS,CACP,cAAiB,SAAS2S,EAAa,GACvC,eAAgB,mBAChB,OAAU,mBACZ,CACD,EAEG,IAAChpB,EAAS,GAAI,CAChB,MAAMupB,EAAY,MAAMvpB,EAAS,OAAO,MAAM,KAAO,CAAE,OAAQ,CAAC,wBAAwB,GAAI,EACtF,UAAI,QAAM/Q,EAAAs6B,EAAU,SAAV,YAAAt6B,EAAmB,KAAM,uBAAuB+Q,EAAS,MAAM,EAAE,EAG7E,MAAA7R,EAAO,MAAM6R,EAAS,KAAK,EAIjC,GAHQ,YAAI,4BAA6B7R,CAAI,EAGzCA,EAAK,SAAW,SAAWA,EAAK,OAAQ,CACpC,MAAAq7B,EAAe,MAAM,QAAQr7B,EAAK,MAAM,EAC1CA,EAAK,OAAO,CAAC,EACbA,EAAK,SAAW,kCACd,UAAI,MAAMq7B,CAAY,EAI1B,OAAAr7B,GAAQA,EAAK,MAAQ,MAAM,QAAQA,EAAK,KAAK,iBAAiB,EACzD,CACL,WAAYA,EAAK,KAAK,kBACtB,MAAOA,EAAK,KAAK,qBAAuBA,EAAK,KAAK,kBAAkB,OACpE,WAAYA,EAAK,KAAK,iBAAmB,KAAK,KAAKA,EAAK,KAAK,qBAAuBi7B,EAAO,WAAa,GAAG,CAC7G,EAIEj7B,GAAQA,EAAK,MAAQ,MAAM,QAAQA,EAAK,KAAK,UAAU,EAClD,CACL,WAAYA,EAAK,KAAK,WACtB,MAAOA,EAAK,KAAK,OAASA,EAAK,KAAK,WAAW,OAC/C,WAAYA,EAAK,KAAK,aAAe,KAAK,KAAKA,EAAK,KAAK,WAAW,QAAUi7B,EAAO,WAAa,GAAG,CACvG,GAIM,aAAK,yDAA0Dj7B,CAAI,EACpE,CAAE,WAAY,GAAI,MAAO,EAAG,WAAY,CAAE,SAC1CC,EAAO,CACN,oBAAM,kCAAmCA,CAAK,EAChDA,CAAA,CAEV,CAGA,eAAsBq7B,GAAoBL,EAA4B,SAChE,IACI,MAAAC,EAAc,IAAI,gBAGZA,EAAA,OAAO,WAAYD,EAAO,QAAQ,EAC1CA,EAAO,UAAUC,EAAY,OAAO,WAAYD,EAAO,QAAQ,EAC/DA,EAAO,KAAiBC,EAAA,OAAO,MAAOD,EAAO,IAAI,UAAU,EAC3DA,EAAO,MAAkBC,EAAA,OAAO,OAAQD,EAAO,KAAK,UAAU,EAC9DA,EAAO,QAAoBC,EAAA,OAAO,SAAUD,EAAO,OAAO,UAAU,EACpEA,EAAO,SAAqBC,EAAA,OAAO,UAAW,KAAK,UAAUD,EAAO,OAAO,CAAC,EAC5EA,EAAO,eAAeC,EAAY,OAAO,gBAAiBD,EAAO,aAAa,EAC9EA,EAAO,UAAsBC,EAAA,OAAO,WAAYD,EAAO,SAAS,UAAU,EAC1EA,EAAO,qBAAuB,QAAWC,EAAY,OAAO,qBAAsBD,EAAO,mBAAmB,UAAU,EACtHA,EAAO,eAAiB,QAAWC,EAAY,OAAO,eAAgBD,EAAO,aAAa,UAAU,EACpGA,EAAO,uBAAyB,QAAWC,EAAY,OAAO,uBAAwBD,EAAO,qBAAqB,UAAU,EAC5HA,EAAO,iCAAmC,QAAWC,EAAY,OAAO,iCAAkCD,EAAO,+BAA+B,UAAU,EAC1JA,EAAO,SAASC,EAAY,OAAO,UAAWD,EAAO,OAAO,EAC5DA,EAAO,MAAkBC,EAAA,OAAO,OAAQD,EAAO,KAAK,UAAU,EAC9DA,EAAO,WAAuBC,EAAA,OAAO,YAAaD,EAAO,UAAU,UAAU,EAC7EA,EAAO,eAAeC,EAAY,OAAO,gBAAiBD,EAAO,aAAa,EAE5E,MAAA/S,EAAM,GAAG4S,EAAY,GAAGC,EAAQ,mBAAmBG,EAAY,UAAU,GACvE,YAAI,mCAAoChT,CAAG,EAW7C,MAAAloB,EAAO,MATI,MAAM,MAAMkoB,EAAK,CAChC,OAAQ,MACR,QAAS,CACP,cAAiB,SAAS2S,EAAa,GACvC,eAAgB,mBAChB,OAAU,mBACZ,CACD,GAE2B,KAAK,EAIjC,GAHQ,YAAI,8BAA+B76B,CAAI,EAG3CA,EAAK,SAAW,SAAWA,EAAK,OAAQ,CACpC,MAAAq7B,EAAe,MAAM,QAAQr7B,EAAK,MAAM,EAC1CA,EAAK,OAAO,CAAC,EACbA,EAAK,SAAW,oCACd,UAAI,MAAMq7B,CAAY,EAI1B,OAAAr7B,GAAQA,EAAK,MAAQ,MAAM,QAAQA,EAAK,KAAK,iBAAiB,EACzD,CACL,WAAYA,EAAK,KAAK,kBACtB,MAAOA,EAAK,KAAK,qBAAuBA,EAAK,KAAK,kBAAkB,OACpE,WAAYA,EAAK,KAAK,iBAAmB,KAAK,KAAKA,EAAK,KAAK,qBAAuBi7B,EAAO,WAAa,GAAG,CAC7G,EAIEj7B,GAAQA,EAAK,WACR,CACL,WAAYA,EAAK,YAAc,CAAC,EAChC,MAAOA,EAAK,SAASc,EAAAd,EAAK,aAAL,YAAAc,EAAiB,SAAU,EAChD,WAAYd,EAAK,aAAe,KAAK,QAAMe,EAAAf,EAAK,aAAL,YAAAe,EAAiB,SAAU,IAAMk6B,EAAO,WAAa,GAAG,CACrG,EAIEj7B,GAAQA,EAAK,MAAQA,EAAK,KAAK,WAC1B,CACL,WAAYA,EAAK,KAAK,WACtB,MAAOA,EAAK,KAAK,OAASA,EAAK,KAAK,WAAW,OAC/C,WAAYA,EAAK,KAAK,aAAe,KAAK,KAAKA,EAAK,KAAK,WAAW,QAAUi7B,EAAO,WAAa,GAAG,CACvG,GAIM,aAAK,qCAAsCj7B,CAAI,EAChD,CAAE,WAAY,GAAI,MAAO,EAAG,WAAY,CAAE,SAC1CC,EAAO,CACN,oBAAM,oCAAqCA,CAAK,EAClDA,CAAA,CAEV,CAGA,eAAsBs7B,GAAgBN,EAA4B,CAC5D,IACI,MAAAC,EAAc,IAAI,gBACZA,EAAA,OAAO,WAAYD,EAAO,QAAQ,EAC1CA,EAAO,eAAeC,EAAY,OAAO,gBAAiBD,EAAO,aAAa,EAE5E,MAAA/S,EAAM,GAAG4S,EAAY,GAAGC,EAAQ,mBAAmBG,EAAY,UAAU,GACvE,YAAI,+BAAgChT,CAAG,EAEzC,MAAArW,EAAW,MAAM,MAAMqW,EAAK,CAChC,OAAQ,MACR,QAAS,CACP,cAAiB,SAAS2S,EAAa,GACvC,eAAgB,mBAChB,OAAU,mBACZ,CACD,EAEG,IAAChpB,EAAS,GAAI,CACV,MAAA5R,EAAQ,MAAM4R,EAAS,KAAK,EAClC,MAAM,IAAI,MAAM5R,EAAM,SAAW,+BAA+B,EAI3D,OADM,MAAM4R,EAAS,KAAK,QAE1B5R,EAAO,CACN,oBAAM,gCAAiCA,CAAK,EAC9CA,CAAA,CAEV,CC9dA,SAAwBu7B,IAAW,cACjC,KAAM,CAACxsB,EAAYC,CAAa,EAAI3N,EAAM,SAAS,EAAE,EAC/C,CAACX,EAAWC,CAAY,EAAIU,EAAM,SAAS,EAAK,EAChD,CAACm6B,EAAkBC,CAAmB,EAAIp6B,EAAM,SAA2B,EAAE,EAC7E,CAACq6B,EAAgBC,CAAiB,EAAIt6B,EAAM,SAAyB,EAAE,EACvE,CAACu6B,EAAcC,CAAe,EAAIx6B,EAAM,SAAuB,EAAE,EACjE,CAACy6B,EAAUC,CAAW,EAAI16B,EAAM,SAA4B,QAAQ,EACpE,CAACugB,EAAcC,CAAe,EAAIxgB,EAAM,SAAS,CAAC,EAClD,CAACqgB,EAAYC,CAAa,EAAItgB,EAAM,SAAS,CAAC,EAC9C,CAAE,MAAAjD,CAAM,EAAIS,GAAS,EAErB,CAACm9B,EAASC,CAAU,EAAI56B,EAAM,SAAkB,CACpD,aAAc,MACd,OAAQ,MACR,QAAS,IACT,OAAQ,EACR,KAAM,EACN,MAAO,GACP,SAAU,GACV,aAAc,GACd,OAAQ,wBACT,EAEK,CAAC66B,EAAkBC,CAAmB,EAAI96B,EAAM,SAAS,EAAI,EAC7D,CAAC+6B,EAAeC,CAAgB,EAAIh7B,EAAM,SAAS,EAAI,EACvD,CAACi7B,EAA0BC,CAA2B,EAAIl7B,EAAM,SAAS,EAAK,EAE9E,CAACuc,EAAkBC,CAAmB,EAAIxc,EAAM,SAA+C,IAAI,EACnG,CAACm7B,EAAaC,CAAc,EAAIp7B,EAAM,SAAS,EAAK,EAEpDq7B,EAAoBr7B,EAAM,QAAQ,IAC/By6B,IAAa,SAAWN,EAAmBE,EACjD,CAACI,EAAUN,EAAkBE,CAAc,CAAC,EAEzCiB,EAAoB,MAAO9iB,GAAqB,CAChD,IACF,KAAM,CAAC+iB,EAAcC,CAAY,EAAI,MAAM,QAAQ,IAAI,CACrD9B,GAAgB,CACd,SAAAlhB,EACA,cAAemiB,EAAQ,eAAiB,MAAQ,OAAYA,EAAQ,aACpE,SAAUA,EAAQ,UAAY,IAAM,OAAY,SAASA,EAAQ,OAAO,EACxE,OAAQA,EAAQ,OACjB,EACDV,GAAgB,CACd,SAAAzhB,EACA,cAAemiB,EAAQ,eAAiB,MAAQ,OAAYA,EAAQ,aACpE,eAAgBA,EAAQ,YACzB,GAKF,EAEeH,EAAA,CACd,aAAAe,EACA,aAAAC,CAAA,CAID,QACM78B,EAAO,CACN,cAAM,gCAAiCA,CAAK,EAExD,EAGM88B,GAAuBljB,GAAiC,CAExD,GAAAA,EAAS,WAAa,OAAOA,EAAS,WAAc,UAAYA,EAAS,UAAU,KAAK,IAAM,GAChG,eAAQ,IAAI,iCAAiC,EACtCA,EAAS,UAIlB,MAAMmjB,EAAsB,CAC1B,aACA,YACA,YACA,OACF,EAEA,UAAWC,KAASD,EAClB,GAAInjB,EAASojB,CAAK,GAAK,OAAOpjB,EAASojB,CAAK,GAAM,UAAYpjB,EAASojB,CAAK,EAAE,SAAW,GAC/E,mBAAI,2BAA2BA,CAAK,EAAE,EACvCpjB,EAASojB,CAAK,EAMzB,UAAWnY,KAAOjL,EAChB,GAAI,OAAOA,EAASiL,CAAG,GAAM,UACzBjL,EAASiL,CAAG,EAAE,SAAS,sBAAsB,IAC5CjL,EAASiL,CAAG,EAAE,SAAS,MAAM,GAAKjL,EAASiL,CAAG,EAAE,SAAS,OAAO,GAAKjL,EAASiL,CAAG,EAAE,SAAS,MAAM,GAC7F,mBAAI,qCAAqCA,CAAG,EAAE,EAC/CjL,EAASiL,CAAG,EAKnB,GAAAjL,EAAS,QAAU,MAAM,QAAQA,EAAS,MAAM,GAAKA,EAAS,OAAO,OAAS,EAAG,CAE7E,MAAAqjB,EAAarjB,EAAS,OAAO,KAAMsC,GACvC,OAAOA,GAAQ,UAAYA,EAAI,SAAS,sBAAsB,CAChE,EAEA,GAAI+gB,EACF,eAAQ,IAAI,uCAAuC,EAC5CA,EAIT,GAAI,OAAOrjB,EAAS,OAAO,CAAC,GAAM,SAChC,eAAQ,IAAI,qCAAqC,EAC1CA,EAAS,OAAO,CAAC,EAI1B,GAAIA,EAAS,OAAO,CAAC,GAAK,OAAOA,EAAS,OAAO,CAAC,GAAM,UAAYA,EAAS,OAAO,CAAC,EAAE,IACrF,eAAQ,IAAI,mDAAmD,EACxDA,EAAS,OAAO,CAAC,EAAE,GAC5B,CAIE,GAAAA,EAAS,QAAU,MAAM,QAAQA,EAAS,MAAM,GAAKA,EAAS,OAAO,OAAS,EAAG,CAC7E,MAAAsjB,EAAatjB,EAAS,OAAO,KAAMsC,GACvC,OAAOA,GAAQ,UAAYA,EAAI,SAAS,sBAAsB,CAChE,EAEA,GAAIghB,EACF,eAAQ,IAAI,uCAAuC,EAC5CA,EAGT,GAAI,OAAOtjB,EAAS,OAAO,CAAC,GAAM,SAChC,eAAQ,IAAI,qCAAqC,EAC1CA,EAAS,OAAO,CAAC,EAG1B,GAAIA,EAAS,OAAO,CAAC,GAAK,OAAOA,EAAS,OAAO,CAAC,GAAM,UAAYA,EAAS,OAAO,CAAC,EAAE,IACrF,eAAQ,IAAI,mDAAmD,EACxDA,EAAS,OAAO,CAAC,EAAE,GAC5B,CAIE,GAAAA,EAAS,cAAgB,MAAM,QAAQA,EAAS,YAAY,GAAKA,EAAS,aAAa,OAAS,GACvF,UAAAujB,KAAevjB,EAAS,aACjC,GAAKujB,EAGL,WAAWH,KAASD,EAClB,GAAII,EAAYH,CAAK,GAAK,OAAOG,EAAYH,CAAK,GAAM,UAAYG,EAAYH,CAAK,EAAE,SAAW,GACxF,mBAAI,oCAAoCA,CAAK,EAAE,EAChDG,EAAYH,CAAK,EAK5B,UAAWnY,KAAOsY,EAChB,GAAI,OAAOA,EAAYtY,CAAG,GAAM,UAC5BsY,EAAYtY,CAAG,EAAE,SAAS,sBAAsB,IAC/CsY,EAAYtY,CAAG,EAAE,SAAS,MAAM,GAAKsY,EAAYtY,CAAG,EAAE,SAAS,OAAO,GAAKsY,EAAYtY,CAAG,EAAE,SAAS,MAAM,GACtG,mBAAI,8CAA8CA,CAAG,EAAE,EACxDsY,EAAYtY,CAAG,EAKtB,GAAAsY,EAAY,QAAU,MAAM,QAAQA,EAAY,MAAM,GAAKA,EAAY,OAAO,OAAS,EAAG,CACtF,MAAAF,EAAaE,EAAY,OAAO,KAAMjhB,IAC1C,OAAOA,IAAQ,UAAYA,GAAI,SAAS,sBAAsB,CAChE,EAEA,GAAI+gB,EACF,eAAQ,IAAI,oDAAoD,EACzDA,EAGT,GAAI,OAAOE,EAAY,OAAO,CAAC,GAAM,SACnC,eAAQ,IAAI,kDAAkD,EACvDA,EAAY,OAAO,CAAC,CAC7B,GAMN,eAAQ,IAAI,6BAA6B,EAClC,IACT,EAEM3e,GAAe,SAAY,CAC/B,GAAI,CAACzP,EAAY,CACT3Q,EAAA,CACJ,QAAS,cACT,MAAO,QACP,YAAa,sCACd,EACD,OAGE,IACFuC,EAAa,EAAI,EAGjB,MAAMy8B,EAAa,6CAA6C,KAAKruB,EAAW,MAAM,EAatF,GATkB4tB,EAAA5tB,CAAU,EAAE,MAAe/O,GAAA,CACnC,cAAM,gCAAiCA,CAAK,EAC9C5B,EAAA,CACJ,QAAS,cACT,MAAO,UACP,YAAa,kEACd,EACF,EAEG09B,IAAa,SACX,IACI,MAAAuB,EAAgB,MAAMhC,GAAoB,CAC9C,SAAUtsB,EAAW,KAAK,EAE1B,SAAWquB,EAAiC,OAApBruB,EAAW,OACnC,OAAQitB,EAAQ,OAChB,cAAeA,EAAQ,eAAiB,MAAQ,OAAYA,EAAQ,aACpE,OAAQA,EAAQ,SAAW,MAAQ,OAAYA,EAAQ,OACvD,SAAUA,EAAQ,UAAY,IAAM,OAAY,SAASA,EAAQ,OAAO,EACxE,UAAWA,EAAQ,UAAY,OAC/B,KAAMA,EAAQ,KACd,UAAWA,EAAQ,MACnB,QAASA,EAAQ,OACjB,qBAAsB,GACtB,mBAAoB,GACpB,aAAc,GACf,EAGD,QAAQ,IAAI,mCAAoC,KAAK,UAAUqB,EAAe,KAAM,CAAC,CAAC,EAEhF,MAAAC,EAAiBD,EAAc,WAAW,CAAC,EAC7CC,IACF,QAAQ,IAAI,sCAAuC,KAAK,UAAUA,EAAgB,KAAM,CAAC,CAAC,EAG1F,QAAQ,IAAI,wCAAyC,CACnD,YAAaA,EAAe,YAC5B,aAAcA,EAAe,aAC7B,IAAKA,EAAe,IACpB,GAAIA,EAAe,GACnB,aAAcA,EAAe,aAC7B,UAAWA,EAAe,UAC1B,KAAMA,EAAe,KACrB,mBAAoBA,EAAe,mBACpC,GAgCH,MAAMC,GA5BsBF,EAAc,WAAW,IAAI,CAACzjB,EAAe3a,KAAkB,CAEzF,IAAIu+B,GAAqB,KAAK,MAAM,KAAK,UAAU5jB,CAAQ,CAAC,EAG5D,OAAIA,EAAS,OACQ4jB,GAAA,KAAO,OAAO5jB,EAAS,IAAI,GAI5CA,EAAS,kBACX4jB,GAAmB,MAAQ5jB,EAAS,iBAInB4jB,GAAA,UAAYV,GAAoBljB,CAAQ,EAGvD,CAAC4jB,GAAmB,eAAiB5jB,EAAS,WAChD4jB,GAAmB,cAAgB5jB,EAAS,WAClC4jB,GAAmB,gBAC7BA,GAAmB,cAAgB,SAG9BA,EAAA,CACR,EAGiD,IAAK5jB,GACrD6jB,GAAqB7jB,CAAQ,CAC/B,EAEA6hB,EAAoB8B,EAAqB,EACzC1b,EAAgBwb,EAAc,KAAK,EACnC1b,EAAc0b,EAAc,UAAU,EAElCA,EAAc,WAAW,SAAW,GAChCj/B,EAAA,CACJ,QAAS,UACT,MAAO,aACP,YAAa,mFACd,QAEI4B,EAAO,CACN,cAAM,oCAAqCA,CAAK,EAClD5B,EAAA,CACJ,QAAS,cACT,MAAO,QACP,YAAa4B,aAAiB,MAAQA,EAAM,QAAU,sFACvD,EACDy7B,EAAoB,EAAE,EACtB5Z,EAAgB,CAAC,EACjBF,EAAc,CAAC,MAGb,KACI,MAAA+b,EAAc,MAAMxC,GAAkB,CAC1C,SAAUnsB,EAAW,KAAK,EAE1B,SAAWquB,EAAiC,OAApBruB,EAAW,OACnC,OAAQitB,EAAQ,OAChB,cAAeA,EAAQ,eAAiB,MAAQ,OAASA,EAAQ,aACjE,OAAQA,EAAQ,SAAW,MAAQ,OAAYA,EAAQ,OACvD,eAAgBA,EAAQ,aACxB,gBAAiB,GACjB,iBAAkB,GAClB,KAAMA,EAAQ,KACd,UAAWA,EAAQ,MACpB,EAGD,QAAQ,IAAI,0CAA2C,KAAK,UAAU0B,EAAa,KAAM,CAAC,EAAE,UAAU,EAAG,GAAG,EAAI,KAAK,EACjHA,EAAY,YAAcA,EAAY,WAAW,OAAS,GAC5D,QAAQ,IAAI,mCAAoCA,EAAY,WAAW,CAAC,CAAC,EA2C3E,MAAMH,EAvCsBG,EAAY,WAAW,IAAK9jB,IAAkB,QAExE,IAAI4jB,EAAqB,KAAK,MAAM,KAAK,UAAU5jB,EAAQ,CAAC,EAI5D,GAAI,CAAC4jB,EAAmB,OAAS,CAACA,EAAmB,YAC/C,IAAA38B,GAAA+Y,GAAS,UAAT,MAAA/Y,GAAkB,MACD28B,EAAA,MAAQ5jB,GAAS,QAAQ,cACnCA,GAAS,WAClB4jB,EAAmB,WAAa5jB,GAAS,mBAChCA,GAAS,WAClB4jB,EAAmB,WAAa5jB,GAAS,mBAChCA,GAAS,kBAClB4jB,EAAmB,WAAa5jB,GAAS,0BAChC,OAAOA,GAAS,OAAU,SAAU,CAE7C,MAAM+jB,GAAa/jB,GAAS,MAAM,MAAM,QAAQ,EAC5C+jB,KACiBH,EAAA,MAAQ,SAASG,GAAW,CAAC,EAAE,QAAQ,KAAM,EAAE,CAAC,EACrE,EAKJ,GAAIH,EAAmB,YAAc,OAAOA,EAAmB,YAAe,SAAU,CACtF,MAAMG,GAAaH,EAAmB,WAAW,MAAM,QAAQ,EAC3DG,KACiBH,EAAA,WAAa,SAASG,GAAW,CAAC,EAAE,QAAQ,KAAM,EAAE,CAAC,EAC1E,CAIiB,OAAAH,EAAA,UAAYV,GAAoBljB,EAAQ,EAEpD4jB,CAAA,CACR,EAGiD,IAAK5jB,IACrD6jB,GAAqB7jB,EAAQ,CAC/B,EAEA+hB,EAAkB4B,CAAqB,EACvC1b,EAAgB6b,EAAY,KAAK,EACjC/b,EAAc+b,EAAY,UAAU,EAEhCA,EAAY,WAAW,SAAW,GAC9Bt/B,EAAA,CACJ,QAAS,UACT,MAAO,aACP,YAAa,iFACd,QAEI4B,EAAO,CACN,cAAM,kCAAmCA,CAAK,EAChD5B,EAAA,CACJ,QAAS,cACT,MAAO,QACP,YAAa4B,aAAiB,MAAQA,EAAM,QAAU,oFACvD,EACD27B,EAAkB,EAAE,EACpB9Z,EAAgB,CAAC,EACjBF,EAAc,CAAC,SAIZ3hB,EAAO,CACN,cAAM,gBAAiBA,CAAK,EAC9B5B,EAAA,CACJ,QAAS,cACT,MAAO,QACP,YAAa4B,aAAiB,MAAQA,EAAM,QAAU,kDACvD,SACD,CACAW,EAAa,EAAK,EAEtB,EAGM88B,GAAiE7jB,GAAmB,CAClF,MAAAgkB,EAAsB,CAAE,GAAGhkB,CAAS,EAGpC9J,EACJ8tB,EAAoB,OACpBA,EAAoB,cACpBA,EAAoB,YACnBA,EAA4B,YAC5BA,EAA4B,cAC7B,EAEF,GAAI9tB,EAAQ,IAEL8tB,EAAoB,aACHA,EAAA,WAAaC,GAAmB/tB,CAAK,GAIvD8tB,EAAoB,gBAAkB,CAACA,EAAoB,eAC7DA,EAAoB,eAAiBE,GAAsBhuB,EAAO8tB,EAAoB,eAAgB,EAAI,EACjGA,EAAoB,cAAgB,CAACA,EAAoB,iBAClEA,EAAoB,eAAiBE,GAAsBhuB,EAAO8tB,EAAoB,aAAc,EAAK,GAIvG,CAACA,EAAoB,gBAAgB,CAGvC,IAAIG,EAAsB,EAS1B,GAHAA,EADmBjuB,EADK,IAEW,GAG/B8tB,EAAoB,SAAU,CAEhC,MAAMI,GAAgB,GAAKJ,EAAoB,SAAW,GAAK,GAC/DG,GAAuB,KAAK,IAAI,GAAK,KAAK,IAAIC,GAAe,GAAG,CAAC,EAM/D,GAHgBJ,EAAA,eAAiB,KAAK,MAAMG,CAAmB,EAG/D,CAACH,EAAoB,aAAc,CAC/BK,SAAaL,EAAoB,eAAiB,GACpCA,EAAA,aAAgBK,GAAanuB,EAAS,IAIxD,IAAC8tB,EAAoB,IAAK,CAI5B,MAAMM,GAAcpuB,EAAQ,KAAK,IAAI,KAAwB,CAAY,EACnEquB,GAAYP,EAAoB,eAAiB,GAAK,EACtDQ,GAAeF,GAAcpuB,EAASquB,GACxBP,EAAA,IAAOQ,GAActuB,EAAS,IAI/C8tB,EAAoB,mBAEvBA,EAAoB,iBAAmB,IACzC,CAIG,OAAAA,CACT,EA0BMC,GAAqB,CAAC/tB,EAAeuuB,EAAsB,GAAOC,EAA4B,KAAU,CAExG,GAAAxuB,GAAS,EAAU,SAEvB,IAAIyuB,EAAY,EAEhB,OAAID,IAEExuB,GAAS,MACCyuB,EAAA,EACHzuB,GAAS,MAClByuB,GAAazuB,EAAQ,OAAU,IAGZwuB,EAAA,IAIlBA,IAECxuB,GAAS,KACCyuB,EAAA,EACHzuB,GAAS,MAClByuB,GAAazuB,EAAQ,MAAU,IACtBA,GAAS,KAClByuB,GAAazuB,EAAQ,OAAU,GAAO,MAAmB,IAEzDyuB,GAAazuB,EAAQ,MAAW,IAAQ,MAAoB,GAAO,MAAmB,KAKtFuuB,IACFE,GAAazuB,EAAQ,KAGhB,KAAK,MAAMyuB,CAAS,CAC7B,EAGMT,GAAwB,CAAChuB,EAAe3N,EAAcq8B,EAAoB,KAAU,CACxF,GAAI,CAAC1uB,GAAS,CAAC3N,GAAQA,GAAQ,EAAU,YAEzC,GAAIq8B,EAEK,YAAK,MAAM1uB,EAAQ3N,CAAI,EACzB,CAEC,MAAAs8B,EAAaD,EAAWr8B,EAAO,OAASA,EACvC,YAAK,MAAM2N,EAAQ2uB,CAAU,EAExC,EAEAp9B,EAAM,UAAU,IAAM,CAChB0N,GACWyP,GAAA,CAEd,GAACsd,EAAUE,EAAQ,IAAI,CAAC,EAG3B36B,EAAM,UAAU,IAAM,CAChBy6B,IAAa,QAAUE,EAAQ,eAAiB,OAClDC,MAAoB,CAAE,GAAGnpB,EAAM,aAAc,QAAS,CAEvD,GAACgpB,EAAUE,EAAQ,YAAY,CAAC,EAG7B,MAAA0C,GAA4BzU,GAAwB,CAC7CgS,EAAAnpB,IAAS,CAAE,GAAGA,EAAM,aAAcmX,EAAO,KAAM,GAAI,CAChE,EAEM0U,GAAsB1U,GAA0B,CACzCgS,EAAAnpB,IAAS,CAAE,GAAGA,EAAM,OAAQmX,EAAO,KAAM,GAAI,CAC1D,EAEM2U,GAAwB3U,GAAkB,CACnCgS,EAAAnpB,IAAS,CAAE,GAAGA,EAAM,QAASmX,EAAO,KAAM,GAAI,CAC3D,EAEM4U,EAAsB5U,GAAkB,CACjCgS,EAAAnpB,IAAS,CAAE,GAAGA,EAAM,OAAQ,WAAWmX,CAAK,EAAG,KAAM,CAAI,GACtE,EAEM6U,EAAoB7U,GAAiC,CAC9CgS,EAAAnpB,IAAS,CAAE,GAAGA,EAAM,OAAQmX,EAAO,KAAM,GAAI,CAC1D,EAGM8U,EAAqBnlB,GAA4C,CACrEiE,EAAoBjE,CAAQ,EAC5B6iB,EAAe,EAAI,CACrB,EAGMuC,EAAqB,IAAM,CAC/BvC,EAAe,EAAK,EAEpB,WAAW,IAAM5e,EAAoB,IAAI,EAAG,GAAG,CACjD,EAGMlE,GAAgB,IAAM,oBACtB,IAACiE,EAAyB,YAExB,MAAA9N,EACJ8N,EAAiB,OACjBA,EAAiB,cACjBA,EAAiB,YAChBA,EAAyB,YACzBA,EAAyB,cAC1B,EAEIqhB,EAAiB,qBAAsBrhB,EAIvCvM,EAAWuM,EAAiB,UAG5BshB,EAAkBthB,EAAiB,UAClBA,EAAiB,WAAW/c,GAAA+c,EAAiB,QAAQ,MAAM,2CAA2C,IAA1E,YAAA/c,GAA8E,KAC3G,gBAGhBs+B,GAAiBvhB,EAAiB,cAAgBA,EAAiB,aAAa,OAAS,EACzFwhB,EAAkBD,GACpBvhB,EAAiB,aACd,OAAQ5D,GAAcA,GAAQA,EAAK,MAAQ,CAAC,MAAM,IAAI,KAAKA,EAAK,IAAI,EAAE,SAAS,GAAKA,EAAK,OAAS,CAAC,MAAM,WAAW,OAAOA,EAAK,KAAK,CAAC,CAAC,CAAC,EACxI,KAAK,CAACC,EAAQC,KAAW,IAAI,KAAKD,EAAE,IAAI,EAAE,QAAY,MAAI,KAAKC,GAAE,IAAI,EAAE,QAAS,GACnF,CAAC,EAGCmlB,GAAcD,EAAgB,QAAU,GACxCA,EAAgBA,EAAgB,OAAS,CAAC,EAAE,MAAQA,EAAgB,CAAC,EAAE,OAASA,EAAgB,CAAC,EAAE,MAAS,IAC9G,KAGEE,GAAoB,CAACC,EAAuBhlB,GAA6B,GAAIC,GAAuB,IAAKC,GAAoB,KAAO,CAClI,MAAA+kB,GAAcD,GAAiBhlB,GAAqB,KACpDG,GAAa6kB,EAAgBC,GAC7BC,GAAkBjlB,GAAe,IAAM,GACvCklB,GAAgBjlB,GAAY,GAE5BI,GAAiBH,IACrB+kB,GAAkB,KAAK,IAAI,EAAIA,GAAiBC,EAAa,IAE7D,KAAK,IAAI,EAAID,GAAiBC,EAAa,EAAI,GAG1C,OACL,YAAAF,GACA,WAAA9kB,GACA,eAAAG,GACA,cAAA6kB,GACA,eAAgB7kB,GAAiB6kB,EACnC,CACF,EAGMC,GAAkB7vB,EAAQ,EAAIwvB,GAAkBxvB,CAAK,EAAI,KAE/D,cACG,MAAI,WAAW,2DAA2D0sB,EAAc,cAAgB,+BAA+B,mCAEtI,UAAAhgC,EAAA,IAAC,MAAI,WAAU,+BAA+B,QAASwiC,EAAoB,EAG3E1/B,OAAC,MAAI,WAAU,qGAEb,UAAA9C,EAAA,IAAC,UACC,QAASwiC,EACT,UAAU,4FAEV,SAAAxiC,MAAC8G,GAAE,WAAU,SAAU,GACzB,EAEAhE,OAAC,MAAI,WAAU,mDAEb,UAACA,OAAA,OAAI,UAAU,sDACZ,UACC+R,EAAA7U,EAAA,IAAC,OACC,IAAK6U,EACL,IAAKuM,EAAiB,SAAW,WACjC,UAAU,6BAGZ,EAAAte,EAAA,KAAC,MAAI,WAAU,iDACb,UAAC9C,MAAA8f,GAAA,CAAK,UAAU,yBAA0B,GACzC9f,EAAA,SAAE,UAAU,6BAA6B,SAAkB,wBAC9D,EAIFA,EAAA,IAAC,MAAI,WAAU,wBACb,SAAAA,MAAC,QAAK,UAAU,oEACb,SAAiBohB,EAAA,cACpB,CACF,GAGCA,EAAiB,aAChBte,EAAA,KAAC,KACC,KAAMse,EAAiB,YACvB,OAAO,SACP,IAAI,sBACJ,UAAU,sJAEV,UAACphB,MAAAojC,GAAA,CAAa,UAAU,SAAU,GAAE,iBAEtC,EAEJ,EAGAtgC,OAAC,MAAI,WAAU,sCACb,UAAA9C,EAAA,IAAC,KAAG,WAAU,yBAA0B,SAAAohB,EAAiB,QAAQ,QAChE,IAAE,WAAU,2CACV,SAAAjiB,EAAemU,CAAK,EACvB,EAGAxQ,OAAC,MAAI,WAAU,6CACb,UAACA,OAAA,OAAI,UAAU,gBACb,UAAC9C,EAAA,YAAK,UAAU,wBAAwB,SAAa,kBACrD8C,OAAC,MAAI,WAAU,+BACb,UAAC9C,MAAAye,GAAA,CAAS,UAAU,uBAAwB,SAC3C,OAAK,WAAU,cAAe,SAAA2C,EAAiB,eAAiB,KAAM,GACzE,IACF,EAECA,EAAiB,UACfte,OAAA,OAAI,UAAU,gBACb,UAAC9C,EAAA,YAAK,UAAU,wBAAwB,SAAQ,aAChD8C,OAAC,MAAI,WAAU,+BACb,UAAC9C,MAAAse,GAAA,CAAI,UAAU,uBAAwB,GACtCte,EAAA,YAAK,UAAU,cAAe,WAAiB,QAAS,GAC3D,IACF,EAGDohB,EAAiB,WACfte,OAAA,OAAI,UAAU,gBACb,UAAC9C,EAAA,YAAK,UAAU,wBAAwB,SAAS,cACjD8C,OAAC,MAAI,WAAU,+BACb,UAAC9C,EAAA,WAAI,UAAU,yDAAyD,SAAE,OACzEA,EAAA,YAAK,UAAU,cAAe,WAAiB,SAAU,GAC5D,IACF,EAGF8C,OAAC,MAAI,WAAU,gBACb,UAAC9C,EAAA,YAAK,UAAU,wBAAwB,SAAQ,aAChD8C,OAAC,MAAI,WAAU,+BACb,UAAC9C,MAAA0e,GAAA,CAAO,UAAU,uBAAwB,GACzC1e,EAAA,YAAK,UAAU,cAAe,SAAgB0iC,CAAA,GACjD,IACF,EAEA5/B,OAAC,MAAI,WAAU,gBACb,UAAC9C,EAAA,YAAK,UAAU,wBAAwB,SAAM,WAC9C8C,OAAC,MAAI,WAAU,+BACb,UAAC9C,MAAAqjC,GAAA,CAAI,UAAU,uBAAwB,SACtC,OAAK,WAAU,cAAe,SAAAjiB,EAAiB,QAAU,KAAM,GAClE,IACF,EAECqhB,GACC3/B,EAAA,KAAC,MAAI,WAAU,gBACb,UAAC9C,EAAA,YAAK,UAAU,wBAAwB,SAAS,cACjD8C,OAAC,MAAI,WAAU,+BACb,UAAC9C,MAAAgf,GAAA,CAAS,UAAU,uBAAwB,GAC5Chf,MAAC,OAAK,WAAU,cACb,aAAI,KAAMohB,EAAkC,gBAAgB,EAAE,oBACjE,GACF,IACF,GAGAA,EAAiB,cAAgBA,EAAiB,iBACjDte,OAAA,OAAI,UAAU,gBACb,UAAC9C,EAAA,YAAK,UAAU,wBAAwB,SAAI,SAC5C8C,OAAC,MAAI,WAAU,+BACb,UAAC9C,MAAAsjC,GAAA,CAAW,UAAU,uBAAwB,GAC9CxgC,OAAC,OAAK,WAAU,cACb,UAAAse,EAAiB,aAAe,GAAGA,EAAiB,YAAY,SAAW,GAC3EA,EAAiB,eAAiB,GAAGA,EAAiB,cAAc,MAAQ,GAC/E,GACF,IACF,EAGDA,EAAiB,gBACfte,OAAA,OAAI,UAAU,gBACb,UAAC9C,EAAA,YAAK,UAAU,wBAAwB,SAAe,oBACvD8C,OAAC,MAAI,WAAU,+BACb,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,uBAAwB,SAChD,OAAK,WAAU,cAAe,SAAezf,EAAAiiB,EAAiB,cAAc,CAAE,GACjF,GACF,IAEJ,EAGAte,OAAC,MAAI,WAAU,wDACb,UAACA,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAA+nB,GAAA,CAAW,UAAU,+BAAgC,GAAE,wBAE1D,EAEAjlB,OAAC,MAAI,WAAU,wCAEb,UAACA,OAAA,OAAI,UAAU,YACZ,UAAAse,EAAiB,gBAChBte,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,SAAE,UAAU,oCAAoC,SAAsB,2BACvE8C,OAAC,IAAE,WAAU,uCACV,UAAA3D,EAAeiiB,EAAiB,cAAc,EAAE,UACnD,EACCA,EAAiB,cACfte,OAAA,KAAE,UAAU,6BACV,UAAiBse,EAAA,aAAa,QAAQ,CAAC,EAAE,UAC5C,IAEJ,EAGDA,EAAiB,KACfte,OAAA,OAAI,UAAU,2BACb,UAAC9C,EAAA,SAAE,UAAU,sCAAsC,SAAmB,wBACtE8C,OAAC,IAAE,WAAU,yCACV,UAAiBse,EAAA,IAAI,QAAQ,CAAC,EAAE,KACnC,EACCA,EAAiB,kBACfte,OAAA,KAAE,UAAU,+BACV,UAAiBse,EAAA,iBAAiB,QAAQ,CAAC,EAAE,kBAChD,GAEJ,IAEJ,EAGC+hB,IACCrgC,EAAA,KAAC,MAAI,WAAU,4BACb,UAAC9C,EAAA,SAAE,UAAU,uCAAuC,SAA+B,oCACnF8C,OAAC,IAAE,WAAU,0CACV,UAAA3D,EAAegkC,GAAgB,cAAc,EAAE,UAClD,EACArgC,OAAC,MAAI,WAAU,0CACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAA9C,MAAC,QAAK,SAAc,mBACnBA,EAAA,YAAM,SAAeb,EAAAgkC,GAAgB,WAAW,CAAE,IACrD,EACArgC,OAAC,MAAI,WAAU,uBACb,UAAA9C,MAAC,QAAK,SAAY,iBACjBA,EAAA,YAAM,SAAeb,EAAAgkC,GAAgB,UAAU,CAAE,IACpD,EACArgC,OAAC,MAAI,WAAU,uBACb,UAAA9C,MAAC,QAAK,SAAK,UACXA,MAAC,QAAK,SAAgB,qBACxB,GACF,GACF,IAEJ,EAGCohB,EAAiB,gBAAkB+hB,IACjCrgC,EAAA,YAAI,UAAU,mDACb,UAAC9C,EAAA,SAAE,UAAU,oCAAoC,SAA0B,+BAC3E8C,OAAC,MAAI,WAAU,yBACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAA9C,MAAC,QAAK,SAAc,mBACpB8C,OAAC,OAAK,WAAU,mBAAmB,cAAE3D,EAAeiiB,EAAiB,cAAc,EAAE,IACvF,EACAte,OAAC,MAAI,WAAU,uBACb,UAAA9C,MAAC,QAAK,SAAiB,sBACvB8C,OAAC,OAAK,WAAU,eAAe,cAAE3D,EAAegkC,GAAgB,cAAc,EAAE,IAClF,EACArgC,OAAC,MAAI,WAAU,uBACb,UAAA9C,MAAC,QAAK,SAAiB,sBACvB8C,OAAC,OAAK,WAAU,eAAe,cAAE3D,EAAeiiB,EAAiB,eAAiB,EAAG,EAAE,IACzF,EACAte,OAAC,MAAI,WAAU,uBACb,UAAA9C,MAAC,QAAK,SAAiB,sBACvB8C,OAAC,OAAK,WAAU,eAAe,cAAE3D,EAAeiiB,EAAiB,eAAiB,GAAI,EAAE,IAC1F,EACAte,OAAC,MAAI,WAAU,oEACb,UAAA9C,MAAC,QAAK,SAAc,mBACpBA,MAAC,QAAK,UAAW,GAAGohB,EAAiB,eAAiB+hB,GAAgB,eAAiB/hB,EAAiB,eAAiB,IAAO,EAAI,mBAAqB,cAAc,GACpK,SAAAjiB,EAAeiiB,EAAiB,eAAiB+hB,GAAgB,eAAiB/hB,EAAiB,eAAiB,GAAI,CAC3H,GACF,GACF,GACF,IAEJ,EAGCA,EAAiB,aAAe,QAC9Bte,EAAA,YAAI,UAAU,OACb,UAAC9C,EAAA,UAAG,UAAU,6BAA6B,SAAc,mBACzD8C,OAAC,MAAI,WAAU,wCACb,UAACA,OAAA,OAAI,UAAU,0BACb,UAAC9C,EAAA,SAAE,UAAU,qCAAqC,SAAU,qBAC3D,IAAE,WAAU,wCACV,SAAeb,EAAAiiB,EAAiB,UAAU,EAC7C,EACCphB,EAAA,SAAE,UAAU,8BAA8B,SAE3C,wDACF,EAEA8C,OAAC,MAAI,WAAU,4BACb,UAAC9C,EAAA,SAAE,UAAU,uCAAuC,SAAmB,wBACvEA,MAAC,KAAE,UAAU,0CACV,WAAesT,GAAS8N,EAAiB,YAAc,EAAE,CAC5D,GACAte,OAAC,MAAI,WAAU,0CACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAA9C,MAAC,QAAK,SAAe,oBACpBA,MAAA,QAAM,SAAeb,EAAAmU,CAAK,CAAE,IAC/B,EACAxQ,OAAC,MAAI,WAAU,uBACb,UAAA9C,MAAC,QAAK,SAAW,sBAChB,OAAM,UAAAb,EAAeiiB,EAAiB,YAAc,CAAC,CAAE,IAC1D,EACAte,OAAC,MAAI,WAAU,uBACb,UAAA9C,MAAC,QAAK,SAAkB,uBACvBA,MAAA,QAAM,SAAeb,EAAA,IAAI,CAAE,GAC9B,GACF,GACF,GACF,IACF,IAID8vB,IAAA3qB,GAAA86B,EAAa,eAAb,YAAA96B,GAA2B,OAA3B,YAAA2qB,GAAiC,oBAAqB,QACpDnsB,OAAA,OAAI,UAAU,OACb,UAACA,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAAoyB,GAAA,CAAU,UAAU,4BAA6B,GAAE,iBAEtD,EACAtvB,OAAC,MAAI,WAAU,wCACb,UAACA,OAAA,OAAI,UAAU,yBACb,UAAC9C,EAAA,SAAE,UAAU,oCAAoC,SAAgB,qBACjE8C,OAAC,MAAI,WAAU,+BACZ,UAAAs8B,EAAa,aAAa,KAAK,iBAAmB,EAChDp/B,EAAA,IAAA+e,GAAA,CAAa,UAAU,2BAA2B,EAEnD/e,EAAA,IAAC8e,GAAe,WAAU,uBAAuB,EAEnDhc,OAAC,IAAE,WAAW,qBAAqBs8B,EAAa,aAAa,KAAK,iBAAmB,EAAI,mBAAqB,cAAc,GACzH,UAAAA,EAAa,aAAa,KAAK,iBAAiB,QAAQ,CAAC,EAAE,IAC9D,IACF,EACCp/B,EAAA,SAAE,UAAU,6BAA6B,SAAc,mBAGxDA,MAAC,MAAI,WAAU,6CACb,SAAAA,EAAA,IAAC,OACC,UAAW,UAAUo/B,EAAa,aAAa,KAAK,iBAAmB,EAAI,iBAAmB,YAAY,GAC1G,MAAO,CAAE,MAAO,GAAG,KAAK,IAAI,KAAK,IAAIA,EAAa,aAAa,KAAK,gBAAgB,EAAI,EAAG,GAAG,CAAC,GAAI,GAEvG,IACF,IAECrQ,IAAAC,GAAAoQ,EAAa,eAAb,YAAApQ,GAA2B,OAA3B,YAAAD,GAAiC,OAC/BjsB,OAAA,OAAI,UAAU,yBACb,UAAC9C,EAAA,SAAE,UAAU,oCAAoC,SAAkB,uBACnEA,MAAC,KAAE,UAAU,uCACV,WAAeo/B,EAAa,aAAa,KAAK,IAAI,CACrD,GACC9rB,EAAQ,GACPxQ,OAAC,MACC,WAACA,OAAA,KAAE,UAAU,6BAA6B,8BACvB9C,MAAC,UAAQ,SAAQsT,EAAA8rB,EAAa,aAAa,KAAK,KAAO,QAAU,OAAQ,GAAS,YACrG,EAGAt8B,OAAC,MAAI,WAAU,yDACb,UAACA,OAAA,OAAI,UAAU,wBACb,UAAA9C,MAAC,OAAI,UAAU,qBAAqB,MAAO,CAAE,MAAO,OAAS,EAC7DA,MAAC,OAAI,UAAU,qBAAqB,MAAO,CAAE,MAAO,MAAS,IAC/D,EACAA,EAAA,IAAC,OACC,UAAU,qCACV,MAAO,CACL,KAAM,MACN,UAAW,mBACb,CACD,EACDA,EAAA,IAAC,OACC,UAAU,mDACV,MAAO,CACL,KAAM,GAAG,KAAK,IAAI,KAAK,IAAKsT,EAAQ8rB,EAAa,aAAa,KAAK,KAAQ,GAAI,EAAE,EAAG,EAAE,CAAC,IACvF,UAAW,mBACb,EACD,EACH,EACAt8B,OAAC,MAAI,WAAU,kDACb,UAAA9C,MAAC,QAAK,SAAI,SACVA,MAAC,QAAK,SAAO,YACbA,MAAC,QAAK,SAAI,SACZ,GACF,GAEJ,GAEJ,IACF,EAIDohB,EAAiB,aACfte,OAAA,OAAI,UAAU,OACb,UAAC9C,EAAA,UAAG,UAAU,6BAA6B,SAAW,gBACrDA,EAAA,SAAE,UAAU,gBAAiB,WAAiB,WAAY,IAC7D,EAID2iC,IAAkBC,EAAgB,OAAS,GACzC9/B,OAAA,OAAI,UAAU,OACb,UAACA,OAAA,MAAG,UAAU,+CACZ,UAAC9C,MAAA+nB,GAAA,CAAW,UAAU,6BAA8B,GAAE,gBAExD,EAGC8a,KAAgB,MACd//B,OAAA,OAAI,UAAU,+BACb,UAACA,OAAA,OAAI,UAAU,oBACb,UAAC9C,EAAA,YAAK,UAAU,8BAA8B,SAAmB,wBACjE8C,OAAC,QAAK,UAAW,aAAa+/B,IAAe,EAAI,mBAAqB,cAAc,GACjF,UAAAA,IAAe,EAAI,IAAM,GAAIA,GAAY,QAAQ,CAAC,EAAE,IACvD,IACF,EAGCD,EAAgB,QAAU,GACxB9/B,EAAA,YAAI,UAAU,8BAA8B,kBACrC,KAAK,OAAO,IAAI,KAAK8/B,EAAgBA,EAAgB,OAAS,CAAC,EAAE,IAAI,EAAE,QAAQ,EACrE,IAAI,KAAKA,EAAgB,CAAC,EAAE,IAAI,EAAE,QAAQ,IACzC,IAAO,GAAK,GAAK,GAAK,IAAI,EAAE,WAC3C,IAAI,KAAKA,EAAgB,CAAC,EAAE,IAAI,EAAE,YAAY,EAAE,OAAK,IAAI,KAAKA,EAAgBA,EAAgB,OAAS,CAAC,EAAE,IAAI,EAAE,YAAY,EAAE,IAClI,IAEJ,EAIDA,EAAgB,QAAU,GACxB9/B,EAAA,YAAI,UAAU,mDACb,UAAC9C,EAAA,WAAI,UAAU,gBAEb,SAACA,MAAA,OAAI,UAAU,yDACZ,SAAgB4iC,EAAA,IAAI,CAACplB,EAAWgV,KAAgB,CACzC,MAAAvT,GAAW,KAAK,IAAI,GAAG2jB,EAAgB,IAAK1jB,IAAWA,GAAE,KAAK,CAAC,EAC/D/N,GAAUqM,EAAK,MAAQyB,GAAY,IACnC/N,GAAQ,GAAG,IAAM0xB,EAAgB,MAAM,IACvCW,GAAS/Q,GAAM,EAAI,YAAc,IAErC,OAAAxyB,EAAA,IAAC,OAEC,UAAU,uEACV,MAAO,CACL,OAAQ,GAAGmR,EAAM,IACjB,MAAAD,GACA,OAAAqyB,EACF,EAGA,SAAAzgC,EAAA,KAAC,MAAI,WAAU,yJACb,UAAA9C,EAAA,IAAC,MAAK,UAAAb,EAAeqe,EAAK,KAAK,EAAE,EACjCxd,MAAC,OAAK,SAAI,SAAKwd,EAAK,IAAI,EAAE,oBAAqB,GACjD,IAZKgV,EAaP,EAEH,EACH,CACF,GACAxyB,MAAC,OAAI,UAAU,kDACZ,WAAgB,IAAI,CAACwd,EAAWgV,KAC/BxyB,MAAC,OACE,SAAI,SAAKwd,EAAK,IAAI,EAAE,YADb,GAAAgV,EAEV,CACD,CACH,IACF,EAIDxyB,EAAA,WAAI,UAAU,YACZ,SAAgB4iC,EAAA,IAAI,CAACplB,EAAWgV,KAC/B1vB,OAAC,MAAc,WAAU,qDACvB,UAACA,OAAA,OAAI,UAAU,0BACb,UAAC9C,MAAAgf,GAAA,CAAS,UAAU,uBAAwB,GAC5Chf,MAAC,QAAM,SAAI,SAAKwd,EAAK,IAAI,EAAE,oBAAqB,IAClD,QACC,OAAK,WAAU,cACb,gBAAOA,EAAK,OAAU,UAAY,CAAC,MAAMA,EAAK,KAAK,EAChDre,EAAeqe,EAAK,KAAK,EACzB,qBACN,GATQ,EAAAgV,EAUV,CACD,CACH,IACF,EAIDpR,EAAiB,iBAAmBA,EAAiB,gBAAgB,OAAS,GAC7Ete,EAAA,KAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,UAAG,UAAU,6BAA6B,SAAgB,qBAC1DA,EAAA,WAAI,UAAU,YACZ,SAAiBohB,EAAA,gBAAgB,IAAI,CAACoiB,EAAchR,KAClD1vB,OAAA,OAAc,UAAU,qDACvB,UAAC9C,MAAA,QAAM,WAAQ,IAAK,GACpB8C,OAAC,OAAK,WAAU,gBAAiB,UAAQ0gC,EAAA,SAAS,SAAM,GAFhD,EAAAhR,EAGV,CACD,CACH,IACF,EAIDpR,EAAiB,gBAAkBA,EAAiB,eAAe,OAAS,GAC3Ete,EAAA,KAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,UAAG,UAAU,6BAA6B,SAAc,mBACxDA,EAAA,WAAI,UAAU,YACZ,SAAiBohB,EAAA,eAAe,IAAI,CAACqiB,EAAajR,KAChD1vB,OAAA,OAAc,UAAU,qDACvB,UAAC9C,MAAA,QAAM,WAAO,IAAK,GACnB8C,OAAC,OAAK,WAAU,gBAAiB,UAAO2gC,EAAA,SAAS,SAAM,GAF/C,EAAAjR,EAGV,CACD,CACH,GACF,GAEJ,GACF,GACF,IACF,CAEJ,EAEA,cACGjQ,GAEC,WAAAviB,MAAC,OAAI,UAAU,gBACb,SAAC8C,EAAA,YAAI,UAAU,WACb,UAAA9C,MAAC,OAAI,UAAU,mBACb,eAAC,MAAI,WAAU,oFAAoF,CACrG,GACA8C,OAAC,MAAI,WAAU,wDACb,UAAC9C,EAAA,UAAG,UAAU,wFAAwF,SAEtG,oBACCA,EAAA,SAAE,UAAU,oEAAoE,SAEjF,qIACF,IACF,CACF,GAEA8C,OAAC,OAAK,WAAU,+CAEd,UAACA,OAAA,OAAI,UAAU,8DACb,UAACA,OAAA,OAAI,UAAU,mFACb,UAAC9C,EAAA,UAAG,UAAU,qBAAqB,SAAe,oBAClD8C,OAAC,MAAI,WAAU,aACb,UAAA9C,EAAA,IAAC0F,EAAA,CACC,QAAS45B,IAAa,SAAW,UAAY,UAC7C,QAAS,IAAMC,EAAY,QAAQ,EACnC,UAAU,gBACX,6BAED,EACAv/B,EAAA,IAAC0F,EAAA,CACC,QAAS45B,IAAa,OAAS,UAAY,UAC3C,QAAS,IAAMC,EAAY,MAAM,EACjC,UAAU,gBACX,4BAED,CACF,IACF,EAEAz8B,OAAC,MAAI,WAAU,YAEb,UAACA,OAAA,OAAI,UAAU,uDACb,UAAAA,EAAA,KAACkxB,GAAA,CACC,MAAOwL,EAAQ,aACf,cAAe0C,GAEf,UAAAliC,MAACo0B,IAAc,UAAU,SACvB,eAACF,GAAY,aAAY,gBAAgB,CAC3C,UACCU,GAEE,WAAA0K,IAAa,UACZt/B,MAACk1B,EAAW,OAAM,MAAM,SAAQ,aAEjCl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,OAAO,SAAI,SAC5Bl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,WAAW,SAAQ,aACpCl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,gBAAgB,SAAa,kBAC9Cl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,WAAW,SAAQ,aACpCl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,WAAW,SAAQ,aACvC,IACF,EAEApyB,EAAA,KAACkxB,GAAA,CACC,MAAOwL,EAAQ,OACf,cAAe2C,GAEf,UAAAniC,MAACo0B,IAAc,UAAU,SACvB,eAACF,GAAY,aAAY,SAAS,CACpC,UACCU,GACC,WAAC50B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,MAAM,SAAU,eACjCl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,WAAW,SAAQ,aACpCl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,YAAY,SAAS,cACzC,IACF,EAEApyB,EAAA,KAACkxB,GAAA,CACC,MAAOwL,EAAQ,QACf,cAAe4C,GAEf,UAAApiC,MAACo0B,IAAc,UAAU,SACvB,eAACF,GAAY,aAAY,eAAe,CAC1C,UACCU,GACC,WAAC50B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,IAAI,SAAG,QACxB,CAAC,EAAG,EAAG,EAAG,EAAG,CAAC,EAAE,IAAKwO,GACnB5gC,EAAA,KAAAoyB,EAAA,CAAqB,MAAOwO,EAAI,SAAa,YAAAA,EAAI,WAAjCA,CAAuC,CACzD,EACH,IACF,EAEA5gC,EAAA,KAACkxB,GAAA,CACC,MAAOwL,EAAQ,OAAO,SAAS,EAC/B,cAAe6C,EAEf,UAAAriC,MAACo0B,IAAc,UAAU,SACvB,eAACF,GAAY,aAAY,gBAAgB,CAC3C,SACCU,GACE,WAAC,IAAM,GAAK,EAAG,EAAG,EAAG,EAAE,EAAE,IAAK8O,GAC7B5gC,OAACoyB,GAAqB,MAAOwO,EAAI,SAAa,YAAAA,EAAI,SAAjC,EAAAA,CAAuC,CACzD,CACH,IACF,EAECpE,IAAa,UACZx8B,EAAA,KAACkxB,GAAA,CACC,MAAOwL,EAAQ,OACf,cAAe8C,EAEf,UAAAtiC,MAACo0B,IAAc,UAAU,SACvB,eAACF,GAAY,aAAY,UAAU,CACrC,UACCU,GACC,WAAC50B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,wBAAwB,SAAgB,qBACzDl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,WAAW,SAAQ,aACvC,KACF,EAEJ,EAGApyB,OAAC,MAAI,WAAU,kBACb,UAAA9C,EAAA,IAACoL,EAAA,CACC,KAAK,OACL,YAAY,gDACZ,MAAOmH,EACP,SAAW1L,GAAM2L,EAAc3L,EAAE,OAAO,KAAK,EAC7C,UAAU,cACZ,EACA7G,EAAA,IAAC0F,EAAA,CACC,QAASsc,GACT,UAAU,8GACV,SAAU9d,EAET,SAAYA,EAAAlE,MAAC+Y,GAAe,MAAK,KAAK,EAAK,UAC9C,EACF,EAGAjW,OAAC,MAAI,WAAU,4BACb,UAACA,OAAA,SAAM,UAAU,kCACf,UAAA9C,EAAA,IAAC,SACC,KAAK,WACL,QAAS0/B,EACT,SAAW74B,GAAM84B,EAAoB94B,EAAE,OAAO,OAAO,EACrD,UAAU,kEACZ,EAAE,wBAEJ,EACA/D,OAAC,QAAM,WAAU,kCACf,UAAA9C,EAAA,IAAC,SACC,KAAK,WACL,QAAS4/B,EACT,SAAW/4B,GAAMg5B,EAAiBh5B,EAAE,OAAO,OAAO,EAClD,UAAU,kEACZ,EAAE,mBAEJ,EACA/D,OAAC,QAAM,WAAU,kCACf,UAAA9C,EAAA,IAAC,SACC,KAAK,WACL,QAAS8/B,EACT,SAAWj5B,GAAMk5B,EAA4Bl5B,EAAE,OAAO,OAAO,EAC7D,UAAU,kEACZ,EAAE,6BAEJ,GACF,GACF,IACF,EAGC3C,EACClE,MAAC,MAAI,WAAU,wCACb,SAACA,MAAA+Y,GAAA,CAAe,KAAK,KAAK,CAC5B,GACEmnB,EAAkB,OAAS,EAG1Bp9B,EAAA,KAAA6D,WAAA,aAAAtC,GAAA+6B,EAAa,eAAb,YAAA/6B,GAA2B,OACzBvB,EAAA,YAAI,UAAU,sCACb,UAACA,OAAA,MAAG,UAAU,6BAA6B,+BAAmByP,CAAA,EAAW,EACzEzP,OAAC,MAAI,WAAU,wCACb,UAACA,OAAA,OAAI,UAAU,+BACb,UAAC9C,EAAA,UAAG,UAAU,4CAA4C,SAAoB,yBAC9EA,MAAC,IAAE,WAAU,sCACV,SAAAb,EAAeigC,EAAa,aAAa,KAAK,MAAQ,CAAC,CAC1D,IACF,EAEAt8B,OAAC,MAAI,WAAU,4BACb,UAAC9C,EAAA,UAAG,UAAU,yCAAyC,SAAmB,wBAC1EA,MAAC,IAAE,WAAU,mCACV,SAAAb,EAAeigC,EAAa,aAAa,KAAK,QAAU,CAAC,CAC5D,IACF,IAECnQ,IAAA3qB,GAAA86B,EAAa,eAAb,YAAA96B,GAA2B,OAA3B,YAAA2qB,GAAiC,oBAAqB,QACpDnsB,OAAA,OAAI,UAAU,8BACb,UAAC9C,EAAA,UAAG,UAAU,2CAA2C,SAAuB,4BAChF8C,OAAC,IAAE,WAAU,qCACV,UAAAs8B,EAAa,aAAa,KAAK,iBAAiB,QAAQ,CAAC,EAAE,IAC9D,GACF,GAEJ,IACF,QAID,MAAI,WAAU,OACb,SAACt8B,EAAA,WAAG,UAAU,wBAAwB,mBAC7BsiB,EAAa,IAAEka,IAAa,SAAW,SAAW,OAAO,eAClE,CACF,GACAt/B,MAAC,OAAI,UAAU,uDACZ,WAAkB,IAAI,CAACod,EAAU3a,IAChCzC,EAAA,IAAC4S,EAAA,CAEC,UAAU,gFACV,QAAS,IAAM2vB,EAAkBnlB,CAAQ,EAExC,SAAAkiB,IAAa,SAEVx8B,EAAA,KAAA6D,EAAA,oBAAC7D,OAAA,OAAI,UAAU,oCACZ,UAAAsa,EAAS,UACRpd,EAAA,IAAC,OACC,IAAKod,EAAS,UACd,IAAKA,EAAS,SAAW,WACzB,UAAU,6BACV,QAAQ,OAGV,EAAAta,EAAA,KAAC,MAAI,WAAU,0DACb,UAAC9C,MAAA8f,GAAA,CAAK,UAAU,yBAA0B,GACzC9f,EAAA,SAAE,UAAU,6BAA6B,SAAkB,wBAC9D,EAEF8C,OAAC,MAAI,WAAU,oCACb,UAAA9C,EAAA,IAAC,OAAK,WAAU,oEACb,SAAAod,EAAS,cACZ,EACCA,EAAS,WACRpd,MAAC,OAAK,WAAU,0EAA0E,SAE1F,cAEJ,IACF,EACA8C,OAAC,MAAI,WAAU,MACb,UAAA9C,EAAA,IAAC,KAAG,WAAU,0CACX,SAAAod,EAAS,QACZ,EACApd,MAAC,IAAE,WAAU,2CACV,SAAAb,EACCie,EAAS,OACTA,EAAS,cACTA,EAAS,iBACRA,EAAiB,YACjBA,EAAiB,cAClB,GAEJ,EAGCsiB,GAAoBtiB,EAAS,gBAC3Bta,EAAA,UAAE,UAAU,6BACV,UAAA3D,EAAeie,EAAS,cAAc,EAAE,SACxCA,EAAS,cAAgB,MAAMA,EAAS,YAAY,SACpDA,EAAS,gBAAkB,MAAMA,EAAS,cAAc,OAC3D,EAGFta,OAAC,MAAI,WAAU,kDACb,UAACA,OAAA,OAAI,UAAU,0BACb,UAAC9C,MAAAse,GAAA,CAAI,UAAU,SAAU,GACxBte,EAAA,YAAM,SAASod,EAAA,UAAY,KAAM,IACpC,EACAta,OAAC,MAAI,WAAU,0BACb,UAAC9C,MAAA0e,GAAA,CAAO,UAAU,SAAU,GAC5B1e,MAAC,OAAM,UAAAod,EAAS,QAAS,IAC3B,EACAta,OAAC,MAAI,WAAU,0BACb,UAAC9C,MAAA8f,GAAA,CAAK,UAAU,SAAU,GACzB9f,EAAA,YAAM,SAASod,EAAA,QAAU,KAAM,GAClC,IACF,EAGCwiB,GAAiBxiB,EAAS,aAAe,QACxCpd,EAAA,IAAC,MAAI,WAAU,YACb,SAAA8C,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,wBAAwB,SAAW,sBAClD,OAAK,WAAU,cAAe,SAAeb,EAAAie,EAAS,UAAU,CAAE,IACrE,CACF,IAIAA,EAAS,gBAAkBA,EAAS,cAAgBA,EAAS,KAAOA,EAAS,mBAC7Eta,EAAA,KAAC,MAAI,WAAU,qCACb,UAAC9C,EAAA,UAAG,UAAU,2CAA2C,SAAoB,yBAC7E8C,OAAC,MAAI,WAAU,gDACZ,UAAAsa,EAAS,gBACRta,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,SAAE,UAAU,4BAA4B,SAAS,cAClD8C,OAAC,IAAE,WAAU,0BAA2B,UAAA3D,EAAeie,EAAS,cAAc,EAAE,MAAG,IACrF,EAEDA,EAAS,cACPta,OAAA,OAAI,UAAU,4BACb,UAAC9C,EAAA,SAAE,UAAU,+BAA+B,SAAK,UACjD8C,OAAC,IAAE,WAAU,6BAA8B,UAASsa,EAAA,aAAa,QAAQ,CAAC,EAAE,IAAC,IAC/E,EAEDA,EAAS,KACPta,OAAA,OAAI,UAAU,2BACb,UAAC9C,EAAA,SAAE,UAAU,8BAA8B,SAAO,YAClD8C,OAAC,IAAE,WAAU,4BAA6B,UAASsa,EAAA,IAAI,QAAQ,CAAC,EAAE,IAAC,IACrE,EAEDA,EAAS,kBACPta,OAAA,OAAI,UAAU,0BACb,UAAC9C,EAAA,SAAE,UAAU,6BAA6B,SAAM,WAChD8C,OAAC,IAAE,WAAU,2BAA4B,UAASsa,EAAA,iBAAiB,QAAQ,CAAC,EAAE,IAAC,GACjF,GAEJ,GACF,GAEJ,GACF,GAEAta,OAAC,MAAI,WAAU,MACb,UAAA9C,EAAA,IAAC,KAAG,WAAU,0CACX,SAAAod,EAAS,QACZ,EACApd,MAAC,IAAE,WAAU,2CACV,SAAAb,EACCie,EAAS,YACTA,EAAS,OACRA,EAAiB,YAClB,GAEJ,EACAta,OAAC,MAAI,WAAU,kDACb,UAACA,OAAA,OAAI,UAAU,0BACb,UAAC9C,MAAA0e,GAAA,CAAO,UAAU,SAAU,GAC5B1e,MAAC,OAAM,UAAAod,EAAS,QAAS,IAC3B,EACAta,OAAC,MAAI,WAAU,0BACb,UAAC9C,MAAA8f,GAAA,CAAK,UAAU,SAAU,GAC1B9f,MAAC,OAAM,UAAAod,EAAS,aAAc,IAChC,EACAta,OAAC,MAAI,WAAU,0BACb,UAAC9C,MAAAgf,GAAA,CAAS,UAAU,SAAU,UAC7B,OAAK,oBAAO,IAAI,KAAK5B,EAAS,gBAAgB,EAAE,mBAAmB,EAAE,IACxE,EACCA,EAAS,UACPta,OAAA,OAAI,UAAU,0BACb,UAAC9C,MAAAse,GAAA,CAAI,UAAU,SAAU,UACxB,OAAM,WAASlB,EAAA,SAAS,QAAK,GAChC,IAEJ,EAGCwiB,GAAiBxiB,EAAS,aAAe,QACxCpd,EAAA,IAAC,MAAI,WAAU,YACb,SAAA8C,OAAC,MAAI,WAAU,oCACb,UAAC9C,EAAA,YAAK,UAAU,wBAAwB,SAAW,sBAClD,OAAK,WAAU,cAAe,SAAeb,EAAAie,EAAS,UAAU,CAAE,IACrE,CACF,IAIAA,EAAS,gBAAkBA,EAAS,cAAgBA,EAAS,KAAOA,EAAS,mBAC7Eta,EAAA,KAAC,MAAI,WAAU,qCACb,UAAC9C,EAAA,UAAG,UAAU,2CAA2C,SAAoB,yBAC7E8C,OAAC,MAAI,WAAU,gDACZ,UAAAsa,EAAS,gBACRta,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,SAAE,UAAU,4BAA4B,SAAS,cAClD8C,OAAC,IAAE,WAAU,0BAA2B,UAAA3D,EAAeie,EAAS,cAAc,EAAE,MAAG,IACrF,EAEDA,EAAS,cACPta,OAAA,OAAI,UAAU,4BACb,UAAC9C,EAAA,SAAE,UAAU,+BAA+B,SAAK,UACjD8C,OAAC,IAAE,WAAU,6BAA8B,UAASsa,EAAA,aAAa,QAAQ,CAAC,EAAE,IAAC,IAC/E,EAEDA,EAAS,KACPta,OAAA,OAAI,UAAU,2BACb,UAAC9C,EAAA,SAAE,UAAU,8BAA8B,SAAO,YAClD8C,OAAC,IAAE,WAAU,4BAA6B,UAASsa,EAAA,IAAI,QAAQ,CAAC,EAAE,IAAC,IACrE,EAEDA,EAAS,kBACPta,OAAA,OAAI,UAAU,0BACb,UAAC9C,EAAA,SAAE,UAAU,6BAA6B,SAAM,WAChD8C,OAAC,IAAE,WAAU,2BAA4B,UAASsa,EAAA,iBAAiB,QAAQ,CAAC,EAAE,IAAC,GACjF,GAEJ,GACF,GAEJ,IA9LG,GAAGA,EAAS,OAAO,IAAI3a,CAAK,EAiMpC,GACH,EAGCyiB,EAAa,GACXpiB,OAAA,OAAI,UAAU,iCACb,UAAA9C,EAAA,IAAC0F,EAAA,CACC,QAAQ,UACR,QAAS,IAAM+5B,EAAWkE,IAAM,CAAE,GAAGA,EAAG,KAAM,KAAK,IAAI,EAAGA,EAAE,KAAO,CAAC,CAAI,IACxE,SAAUnE,EAAQ,OAAS,EAC5B,oBAED,EACA18B,OAAC,OAAK,WAAU,yBAAyB,kBACjC08B,EAAQ,KAAK,OAAKta,CAAA,EAC1B,EACAllB,EAAA,IAAC0F,EAAA,CACC,QAAQ,UACR,QAAS,IAAM+5B,EAAWkE,IAAM,CAAE,GAAGA,EAAG,KAAM,KAAK,IAAIze,EAAYye,EAAE,KAAO,CAAC,CAAI,IACjF,SAAUnE,EAAQ,OAASta,EAC5B,iBAED,CACF,EAEJ,UAEC,MAAI,WAAU,oBACb,SAACpiB,OAAA,KAAE,UAAU,gBAAgB,gBACvBw8B,EAAS,0DACf,CACF,IAEJ,QAGCniB,GAAc,KACjB,CAEJ,CCjoDA,MAAMymB,GAAqB,IAAM,CAC/B,KAAM,CAACC,EAAeC,CAAgB,EAAIjgC,WAAS,IAAM,EACnD,CAACkgC,EAASC,CAAU,EAAIngC,WAAS,GAAK,EACtC,CAACma,EAAcimB,CAAe,EAAIpgC,WAAS,GAAG,EAC9C,CAACqgC,EAAcC,CAAe,EAAItgC,WAAS,EAAE,EAC7C,CAACwa,EAAgB+lB,CAAiB,EAAIvgC,WAAwB,IAAI,EAClE,CAACwgC,EAAgBC,CAAiB,EAAIzgC,WAAwB,IAAI,EAClE,CAAC0gC,EAAeC,CAAgB,EAAI3gC,WAAwB,IAAI,EAEhEi/B,EAAoB,IAAM,CAC9B,MAAM5kB,EAAa2lB,EAAgBE,EAC7BU,EAAsBzmB,EAAe,IAAM,GAC3C0mB,EAAmBR,EAAe,GAGlCrnB,EAAI,KAAK,IAAI,EAAI4nB,EAAqBC,CAAgB,EACtDC,EAAWzmB,EAAarB,EAAI4nB,GAAwB5nB,EAAI,GAExD+nB,EAAYD,EAAUD,EACtBG,EAAoBD,EAAY1mB,EAEtCkmB,EAAkBO,CAAO,EACzBL,EAAkBM,CAAS,EAC3BJ,EAAiBK,CAAiB,CACpC,EAGMC,GAAQjB,EAAgBE,GAAWF,EAAiB,IAGxD,OAAA/gC,EAAA,KAAC8P,EAAK,WAAU,SACd,UAAA5S,MAAC6S,EACC,UAAA/P,OAACgQ,GAAU,WAAU,0CACnB,UAAC9S,MAAA+kC,GAAA,CAAe,UAAU,cAAe,GAAE,+BAE7C,CACF,SACC/xB,EAAY,WAAU,aACrB,SAAClQ,EAAA,YAAI,UAAU,wCACb,UAACA,OAAA,OAAI,UAAU,YACb,UAACA,OAAA,OAAI,UAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,iBAAiB,SAAc,mBAC9CzI,OAAC,OAAK,WAAU,gCAAgC,cAAE+gC,EAAc,eAAe,EAAE,IACnF,EACA/gC,OAAC,MAAI,WAAU,aACb,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,+BAAgC,GACzD5e,EAAA,IAACg6B,GAAA,CACC,GAAG,iBACH,IAAK,IACL,IAAK,IACL,KAAM,IACN,aAAc,CAAC6J,CAAa,EAC5B,cAAgBpW,GAAUqW,EAAiBrW,EAAM,CAAC,CAAC,GACrD,EACF,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAOy4B,EACP,SAAWh9B,GAAMi9B,EAAiB,OAAOj9B,EAAE,OAAO,KAAK,CAAC,EACxD,UAAU,QACZ,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,UAAU,SAAO,YAChCzI,OAAC,OAAK,WAAU,gCAAgC,cAAEihC,EAAQ,eAAe,EAAE,KAAGe,EAAI,QAAQ,CAAC,EAAE,SAAM,IACrG,EACAhiC,OAAC,MAAI,WAAU,aACb,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,+BAAgC,GACzD5e,EAAA,IAACg6B,GAAA,CACC,GAAG,UACH,IAAK,EACL,IAAK6J,EACL,KAAM,IACN,aAAc,CAACE,CAAO,EACtB,cAAgBtW,GAAUuW,EAAWvW,EAAM,CAAC,CAAC,GAC/C,EACF,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAO24B,EACP,SAAWl9B,GAAMm9B,EAAW,OAAOn9B,EAAE,OAAO,KAAK,CAAC,EAClD,UAAU,QACZ,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,gBAAgB,SAAa,kBAC5CzI,OAAC,OAAK,WAAU,gCAAiC,UAAAkb,EAAa,IAAC,IACjE,EACAlb,OAAC,MAAI,WAAU,aACb,UAAC9C,MAAAglC,GAAA,CAAQ,UAAU,+BAAgC,GACnDhlC,EAAA,IAACg6B,GAAA,CACC,GAAG,gBACH,IAAK,GACL,IAAK,GACL,KAAM,GACN,aAAc,CAAChc,CAAY,EAC3B,cAAgByP,GAAUwW,EAAgBxW,EAAM,CAAC,CAAC,GACpD,EACF,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAO4S,EACP,SAAWnX,GAAMo9B,EAAgB,OAAOp9B,EAAE,OAAO,KAAK,CAAC,EACvD,UAAU,OACV,KAAM,IACR,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,gBAAgB,SAAa,kBAC5CzI,OAAC,OAAK,WAAU,gCAAiC,UAAAohC,EAAa,SAAM,IACtE,EACAphC,OAAC,MAAI,WAAU,aACb,UAAC9C,MAAAgf,GAAA,CAAS,UAAU,+BAAgC,GACpDhf,EAAA,IAACg6B,GAAA,CACC,GAAG,gBACH,IAAK,EACL,IAAK,GACL,KAAM,EACN,aAAc,CAACkK,CAAY,EAC3B,cAAgBzW,GAAU0W,EAAgB1W,EAAM,CAAC,CAAC,GACpD,EACF,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAO84B,EACP,SAAWr9B,GAAMs9B,EAAgB,OAAOt9B,EAAE,OAAO,KAAK,CAAC,EACvD,UAAU,QACZ,EACF,EAEA7G,EAAA,IAAC0F,EAAA,CACC,QAASo9B,EACT,UAAU,cACX,sBAED,EACF,EAEAhgC,OAAC,MAAI,WAAU,YACZ,UAAAub,IAAmB,MAClBvb,OAAC,MAAI,WAAU,kCACb,UAAC9C,EAAA,UAAG,UAAU,sBAAsB,SAAgB,qBAEpD8C,OAAC,MAAI,WAAU,iBACb,UAACA,OAAA,OAAI,UAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAY,iBACnD8C,OAAC,MAAI,WAAU,yBAAyB,eAAG+gC,EAAgBE,GAAS,eAAe,EAAE,IACvF,EAEAjhC,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAgB,qBACvD8C,OAAC,MAAI,WAAU,yBAAyB,cAAEub,EAAe,QAAQ,CAAC,EAAE,IACtE,EAEAvb,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAgB,qBACvD8C,OAAC,MAAI,WAAU,yBAAyB,cAAEuhC,GAAA,YAAAA,EAAgB,QAAQ,EAAC,CAAE,IACvE,EAEAvhC,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAe,oBACtD8C,OAAC,MAAI,WAAU,yBAAyB,cAAEyhC,GAAA,YAAAA,EAAe,QAAQ,EAAC,CAAE,IACtE,EAEAzhC,OAAC,MAAI,WAAU,uCACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAoB,yBAC3D8C,OAAC,MAAI,WAAU,yBAA0B,UAAAgiC,EAAI,QAAQ,CAAC,EAAE,IAAC,GAC3D,GACF,IACF,EAGD9kC,MAAA4S,EAAA,CACC,SAAC9P,OAAAkQ,EAAA,CAAY,UAAU,OACrB,UAAChT,EAAA,UAAG,UAAU,2BAA2B,SAAI,SAC7C8C,OAAC,KAAG,WAAU,yDACZ,UAAA9C,MAAC,MAAG,SAAiE,sEACrEA,MAAC,MAAG,SAA4E,iFAChFA,MAAC,MAAG,SAAkD,uDACtDA,MAAC,MAAG,SAAmE,wEACzE,IACF,CACF,GACF,IACF,CACF,IACF,CAEJ,EC1MMilC,GAAWrlC,EAGf,YAAC,CAAE,UAAAC,EAAW,GAAGC,CAAM,EAAGC,IAC1BC,EAAA,IAACklC,GAAA,CACC,IAAAnlC,EACA,UAAWhB,EACT,qQACAc,CACF,EACC,GAAGC,EAEJ,SAAAE,EAAA,IAACmlC,GAAA,CACC,UAAWpmC,EAAG,+CAA+C,EAE7D,SAAAiB,MAAC2J,GAAU,WAAU,SAAU,IACjC,CACF,CACD,EACDs7B,GAAS,YAAcC,GAAuB,YChB9C,MAAME,GAAsB,IAAM,CAChC,KAAM,CAACvB,EAAeC,CAAgB,EAAIjgC,WAAS,GAAM,EACnD,CAACi+B,EAAkBuD,CAAmB,EAAIxhC,WAAS,EAAK,EACxD,CAACyhC,EAAsBC,CAAuB,EAAI1hC,WAAS,EAAK,EAChE,CAAC2hC,EAAiBC,CAAkB,EAAI5hC,WAAS,EAAK,EACtD,CAACk+B,EAAW2D,CAAY,EAAI7hC,WAAwB,IAAI,EACxD,CAAC8hC,EAAWC,CAAY,EAAI/hC,WAA6C,EAAE,EAG3Ew9B,EAAqB,IAAM,CAC/B,IAAIwE,EAA6D,CAAC,EAC9DC,EAAW,EACXC,EAAqD,CAAC,EAGtDjE,EAEM+D,EAAA,CACN,CAAE,MAAO,EAAG,IAAK,MAAQ,KAAM,CAAE,EACjC,CAAE,MAAO,MAAQ,IAAK,MAAQ,KAAM,GAAK,EACzC,CAAE,MAAO,MAAQ,IAAK,KAAM,KAAM,GAAK,CACzC,EAGQA,EAAA,CACN,CAAE,MAAO,EAAG,IAAK,KAAQ,KAAM,CAAE,EACjC,CAAE,MAAO,KAAQ,IAAK,MAAQ,KAAM,GAAK,EACzC,CAAE,MAAO,MAAQ,IAAK,KAAS,KAAM,EAAI,EACzC,CAAE,MAAO,KAAS,IAAK,KAAM,KAAM,GAAK,CAC1C,EAII,MAAAG,EAAiBV,EAAuB,IAAO,EAG/CW,EAAoBT,EAAkB,IAAO,EAGnD,IAAIU,EAAiBrC,EACrBgC,EAAM,QAAgBM,GAAA,CACpB,GAAID,EAAiB,EAAG,CACtB,MAAME,EAAYD,EAAK,IAAMA,EAAK,IAAMA,EAAK,MAAQD,EAC/CG,EAAe,KAAK,IAAIH,EAAgBE,CAAS,EAGjDE,EAAWH,EAAK,KAAOH,EAAiBC,EACxCM,EAAUF,EAAeC,EAE/B,GAAIC,EAAU,EAAG,CAEf,MAAMC,EAAYL,EAAK,IACnB,IAAIA,EAAK,MAAM,gBAAgB,OAAOA,EAAK,IAAI,eAAgB,IAC/D,SAASA,EAAK,MAAM,gBAAgB,GAExCJ,EAAe,KAAK,CAClB,KAAM,GAAGS,CAAS,OAAOF,EAAW,KAAK,QAAQ,CAAC,CAAC,IACnD,IAAKC,CAAA,CACN,EAGST,GAAAS,EACML,GAAAG,CAAA,CACpB,CACD,EAEDX,EAAaI,CAAQ,EACrBF,EAAaG,CAAc,CAC7B,EAGE,OAAAjjC,EAAA,KAAC8P,EAAK,WAAU,SACd,UAAA5S,MAAC6S,EACC,UAAA/P,OAACgQ,GAAU,WAAU,0CACnB,UAAC9S,MAAA+kC,GAAA,CAAe,UAAU,cAAe,GAAE,kCAE7C,CACF,SACC/xB,EAAY,WAAU,aACrB,SAAClQ,EAAA,YAAI,UAAU,wCACb,UAACA,OAAA,OAAI,UAAU,YACb,UAACA,OAAA,OAAI,UAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,iBAAiB,SAAc,mBAC9CzI,OAAC,OAAK,WAAU,gCAAgC,cAAE+gC,EAAc,eAAe,EAAE,IACnF,EACA/gC,OAAC,MAAI,WAAU,aACb,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,+BAAgC,GACzD5e,EAAA,IAACg6B,GAAA,CACC,GAAG,iBACH,IAAK,IACL,IAAK,IACL,KAAM,IACN,aAAc,CAAC6J,CAAa,EAC5B,cAAgBpW,GAAUqW,EAAiBrW,EAAM,CAAC,CAAC,GACrD,EACF,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAOy4B,EACP,SAAWh9B,GAAMi9B,EAAiB,OAAOj9B,EAAE,OAAO,KAAK,CAAC,EACxD,UAAU,QACZ,EACF,EAEA/D,OAAC,MAAI,WAAU,iBACb,UAACA,OAAA,OAAI,UAAU,8BACb,UAAA9C,EAAA,IAACilC,GAAA,CACC,GAAG,mBACH,QAASnD,EACT,gBAAkBt4B,GAAY,CAC5B67B,EAAoB77B,IAAY,EAAI,EAChCA,KAAiC,EAAK,EAC5C,CACF,EACAxJ,EAAA,IAACuL,EAAA,CACC,QAAQ,mBACR,UAAU,6FACX,6BAED,EACF,EAEAzI,OAAC,MAAI,WAAU,8BACb,UAAA9C,EAAA,IAACilC,GAAA,CACC,GAAG,sBACH,QAASK,EACT,gBAAkB97B,GAAY,CAC5B+7B,EAAwB/7B,IAAY,EAAI,EACpCA,KAA6B,EAAK,CACxC,EACA,SAAUs4B,CAAA,CACZ,EACA9hC,EAAA,IAACuL,EAAA,CACC,QAAQ,sBACR,UAAU,6FACX,+CAED,EACF,EAEAzI,OAAC,MAAI,WAAU,8BACb,UAAA9C,EAAA,IAACilC,GAAA,CACC,GAAG,kBACH,QAASO,EACT,gBAAkBh8B,GAAYi8B,EAAmBj8B,IAAY,EAAI,EACnE,EACAxJ,EAAA,IAACuL,EAAA,CACC,QAAQ,kBACR,UAAU,6FACX,2CAED,CACF,IACF,EAEAvL,EAAA,IAAC0F,EAAA,CACC,QAAS27B,EACT,UAAU,cACX,iCAED,EACF,EAEAv+B,OAAC,MAAI,WAAU,YACZ,UAAAi/B,IAAc,MACbj/B,OAAC,MAAI,WAAU,kCACb,UAAC9C,EAAA,UAAG,UAAU,sBAAsB,SAAkB,uBAEtD8C,OAAC,MAAI,WAAU,iBACb,UAAA9C,MAAC,OAAI,UAAU,yBACb,SAAC8C,EAAA,YAAI,UAAU,oCAAoC,gCAC7Bi/B,EAAU,QAAQ,CAAC,GACzC,CACF,GAEC4D,EAAU,OAAS,GACjB7iC,EAAA,YAAI,UAAU,gBACb,UAAC9C,EAAA,UAAG,UAAU,2BAA2B,SAAU,eAClD2lC,EAAU,IAAI,CAACx3B,EAAM1L,IACnBK,OAAA,OAAgB,UAAU,iCACzB,UAAA9C,EAAA,IAAC,MAAI,WAAU,wBAAyB,SAAAmO,EAAK,KAAK,EAClDrL,OAAC,MAAI,WAAU,aAAa,cAAEqL,EAAK,IAAI,QAAQ,CAAC,EAAE,KAF1C1L,CAGV,CACD,EACH,GAEJ,IACF,EAGDzC,MAAA4S,EAAA,CACC,SAAC9P,OAAAkQ,EAAA,CAAY,UAAU,OACrB,UAAChT,EAAA,UAAG,UAAU,2BAA2B,SAAK,UAC9C8C,OAAC,KAAG,WAAU,yDACZ,UAAA9C,MAAC,MAAG,SAA0D,+DAC9DA,MAAC,MAAG,SAAwD,6DAC5DA,MAAC,MAAG,SAAmD,wDACvDA,MAAC,MAAG,SAA0E,+EAC9EA,MAAC,MAAG,SAA4C,iDAClD,IACF,CACF,GACF,IACF,CACF,IACF,CAEJ,ECjNMymC,GAAkB,IAAM,CAC5B,KAAM,CAAC5C,EAAeC,CAAgB,EAAIjgC,WAAS,IAAM,EACnD,CAAC6iC,EAAaC,CAAc,EAAI9iC,WAAS,IAAI,EAC7C,CAAC+iC,EAAgBC,CAAiB,EAAIhjC,WAAS,GAAI,EACnD,CAACijC,EAAYC,CAAa,EAAIljC,WAAwB,IAAI,EAC1D,CAACmjC,EAAUC,CAAW,EAAIpjC,WAAwB,IAAI,EAEtDqjC,EAAiB,IAAM,CAC3B,MAAMzF,EAAaiF,EAAc,GAC3BS,EAAmB1F,EAAaoC,EAAiB,IACjDuD,GAAkB3F,EAAamF,GAAkB/C,EAAiB,IAExEkD,EAAcI,CAAe,EAC7BF,EAAYG,CAAa,CAC3B,EAGE,OAAAtkC,EAAA,KAAC8P,EAAK,WAAU,SACd,UAAA5S,MAAC6S,EACC,UAAA/P,OAACgQ,GAAU,WAAU,0CACnB,UAAC9S,MAAAqnC,GAAA,CAAa,UAAU,cAAe,GAAE,2BAE3C,CACF,SACCr0B,EAAY,WAAU,aACrB,SAAClQ,EAAA,YAAI,UAAU,wCACb,UAACA,OAAA,OAAI,UAAU,YACb,UAACA,OAAA,OAAI,UAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,iBAAiB,SAAc,mBAC9CzI,OAAC,OAAK,WAAU,gCAAgC,cAAE+gC,EAAc,eAAe,EAAE,IACnF,EACA/gC,OAAC,MAAI,WAAU,aACb,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,+BAAgC,GACzD5e,EAAA,IAACg6B,GAAA,CACC,GAAG,iBACH,IAAK,IACL,IAAK,IACL,KAAM,IACN,aAAc,CAAC6J,CAAa,EAC5B,cAAgBpW,GAAUqW,EAAiBrW,EAAM,CAAC,CAAC,GACrD,EACF,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAOy4B,EACP,SAAWh9B,GAAMi9B,EAAiB,OAAOj9B,EAAE,OAAO,KAAK,CAAC,EACxD,UAAU,QACZ,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,eAAe,SAAY,iBAC1CzI,OAAC,OAAK,WAAU,gCAAgC,cAAE4jC,CAAA,CAAY,IAChE,EACA5jC,OAAC,MAAI,WAAU,aACb,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,+BAAgC,GACzD5e,EAAA,IAACg6B,GAAA,CACC,GAAG,eACH,IAAK,IACL,IAAK,IACL,KAAM,GACN,aAAc,CAAC0M,CAAW,EAC1B,cAAgBjZ,GAAUkZ,EAAelZ,EAAM,CAAC,CAAC,GACnD,EACF,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAOs7B,EACP,SAAW7/B,GAAM8/B,EAAe,OAAO9/B,EAAE,OAAO,KAAK,CAAC,EACtD,UAAU,QACZ,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,kBAAkB,SAAe,oBAChDzI,OAAC,OAAK,WAAU,gCAAgC,cAAE8jC,CAAA,CAAe,IACnE,EACA9jC,OAAC,MAAI,WAAU,aACb,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,+BAAgC,GACzD5e,EAAA,IAACg6B,GAAA,CACC,GAAG,kBACH,IAAK,EACL,IAAK,IACL,KAAM,IACN,aAAc,CAAC4M,CAAc,EAC7B,cAAgBnZ,GAAUoZ,EAAkBpZ,EAAM,CAAC,CAAC,GACtD,EACF,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAOw7B,EACP,SAAW//B,GAAMggC,EAAkB,OAAOhgC,EAAE,OAAO,KAAK,CAAC,EACzD,UAAU,QACZ,EACF,EAEA7G,EAAA,IAAC0F,EAAA,CACC,QAASwhC,EACT,UAAU,cACX,4BAED,EACF,EAEApkC,OAAC,MAAI,WAAU,YACZ,UAAAgkC,IAAe,MACdhkC,OAAC,MAAI,WAAU,kCACb,UAAC9C,EAAA,UAAG,UAAU,sBAAsB,SAAa,kBAEjD8C,OAAC,MAAI,WAAU,iBACb,UAACA,OAAA,OAAI,UAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAqB,0BAC5D8C,OAAC,MAAI,WAAU,yBAAyB,eAAG4jC,EAAc,IAAI,eAAe,EAAE,IAChF,EAEA5jC,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAgB,qBACvD8C,OAAC,MAAI,WAAU,yBAAyB,cAAE8jC,EAAe,eAAe,EAAE,IAC5E,EAEA9jC,OAAC,MAAI,WAAU,uCACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAY,iBACnD8C,OAAC,MAAI,WAAU,yBAA0B,UAAAgkC,EAAW,QAAQ,CAAC,EAAE,IAAC,IAClE,EAEAhkC,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAU,eACjD8C,OAAC,MAAI,WAAU,yBAA0B,UAAAkkC,EAAS,QAAQ,CAAC,EAAE,IAAC,GAChE,GACF,IACF,EAGDhnC,MAAA4S,EAAA,CACC,SAAC9P,OAAAkQ,EAAA,CAAY,UAAU,OACrB,UAAChT,EAAA,UAAG,UAAU,2BAA2B,SAAwB,6BACjE8C,OAAC,KAAG,WAAU,yDACZ,UAAAA,OAAC,KAAG,WAAA9C,MAAC,UAAO,SAAS,cAAS,mCAA+B,SAC5D,KAAG,WAAAA,MAAC,UAAO,SAAK,UAAS,iDAA6C,SACtE,KAAG,WAAAA,MAAC,UAAO,SAAK,UAAS,qCAAiC,SAC1D,KAAG,WAAAA,MAAC,UAAO,SAAS,cAAS,+CAA4C,IAC5E,EAEA8C,OAAC,MAAI,WAAU,qCACb,UAAA9C,MAAC,KAAE,SAA4D,iEAC/D8C,OAAC,KAAG,WAAU,sBACZ,UAAA9C,MAAC,MAAG,SAAe,oBACnBA,MAAC,MAAG,SAAiB,sBACrBA,MAAC,MAAG,SAAS,cACbA,MAAC,MAAG,SAAe,oBACnBA,MAAC,MAAG,SAAY,iBAClB,GACF,IACF,CACF,GACF,IACF,CACF,IACF,CAEJ,EClKMsnC,GAAgB,IAAM,CAC1B,KAAM,CAACC,EAAeC,CAAgB,EAAI3jC,WAAS,IAAM,EACnD,CAAC4jC,EAAgBC,CAAiB,EAAI7jC,WAAS,IAAK,EACpD,CAACk+B,EAAW2D,CAAY,EAAI7hC,WAAS,IAAI,EACzC,CAAC8jC,EAAYC,CAAa,EAAI/jC,WAAS,GAAI,EAC3C,CAAC6iC,EAAaC,CAAc,EAAI9iC,WAAS,IAAI,EAC7C,CAAC+iC,EAAgBC,CAAiB,EAAIhjC,WAAS,IAAI,EACnD,CAACgkC,EAAeC,CAAgB,EAAIjkC,WAAS,CAAC,EAC9C,CAACkkC,EAAoBC,CAAqB,EAAInkC,WAAS,CAAC,EACxD,CAACokC,EAAiBC,CAAkB,EAAIrkC,WAAS,MAAM,EACvD,CAACskC,EAAiBC,CAAkB,EAAIvkC,WAAS,KAAK,EACtD,CAACma,EAAcimB,CAAe,EAAIpgC,WAAS,GAAG,EAC9C,CAACqgC,EAAcC,CAAe,EAAItgC,WAAS,EAAE,EAE7C,CAAC+5B,EAASyK,CAAU,EAAIxkC,WAQpB,IAAI,EAERykC,EAAe,IAAM,CAEnB,MAAAC,EAAkBN,IAAoB,OACxCV,EAAgBE,EAAiB1F,EAAY4F,EAC7CQ,EAAkBV,EAAiB1F,EAAY4F,EAG7ClG,EAAaiF,EAAc,GACjC,IAAI8B,EAAyB,EAE7B,GAAIP,IAAoB,WAAY,CAClC,MAAM/pB,EAAaqpB,EAAgBY,EAC7B1D,EAAsBzmB,EAAe,IAAM,GAC3C0mB,EAAmBR,EAAe,GAGlCrnB,EAAI,KAAK,IAAI,EAAI4nB,EAAqBC,CAAgB,EAG5D8D,EAFwBtqB,EAAarB,EAAI4nB,GAAwB5nB,EAAI,GAE3B,GAGtC,MAAA4rB,EAAiBhH,EAAamF,EAAiB4B,EAG/CE,GAAoBD,EAAiBF,EAAmB,IAGxDI,GAAqBpB,EAAgB,KAAK,IAAI,EAAKQ,EAAqB,IAAMF,CAAa,EAGjG,IAAIe,GAAsB,EAC1B,GAAIX,IAAoB,WAAY,CAClC,MAAM/pB,EAAaqpB,EAAgBY,EAC7B1D,EAAsBzmB,EAAe,IAAM,GAC3C0mB,EAAmBR,EAAe,GAClC7lB,EAAkBH,EAAa,KAAK,IAAI,EAAIumB,EAAqBC,CAAgB,EAAID,GAAwB,KAAK,IAAI,EAAIA,EAAqBC,CAAgB,EAAI,GAGzK,IAAImE,GAAU3qB,EACd,QAAStO,GAAI,EAAGA,GAAIi4B,EAAgB,GAAIj4B,KAAK,CAC3C,MAAMk5B,GAAkBD,GAAUpE,EAC5BsE,GAAmB1qB,EAAiByqB,GAC/BD,IAAAE,EAAA,CAGSH,GAAA,KAAK,IAAI,EAAGC,EAAO,EAI3C,MAAMG,GAAgBP,EAAiBZ,EACjCoB,GAAaN,GAAqBpB,EAAgBqB,GAClDhhB,GAAcohB,GAAgBC,GAG9BC,GAAYthB,GAAc2gB,EAAmB,IAG7CY,GAAgB,KAAK,IAAI,EAAKD,GAAW,IAAM,EAAIrB,CAAa,EAAI,EAE/DQ,EAAA,CACT,gBAAAE,EACA,SAAUE,EACV,iBAAAC,GACA,mBAAAC,GACA,YAAA/gB,GACA,SAAAshB,GACA,cAAeC,GAAgB,IAChC,CACH,EAGE,OAAArmC,EAAA,KAAC8P,EAAK,WAAU,SACd,UAAA5S,MAAC6S,EACC,UAAA/P,OAACgQ,GAAU,WAAU,0CACnB,UAAC9S,MAAA+nB,GAAA,CAAW,UAAU,cAAe,GAAE,yCAEzC,CACF,GACC/nB,MAAAgT,EAAA,CACC,SAAClQ,OAAA,OAAI,UAAU,wCACb,UAACA,OAAA,OAAI,UAAU,YACb,UAAC9C,EAAA,UAAG,UAAU,sBAAsB,SAAgB,qBAEpD8C,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,iBAAiB,SAAc,mBAC9CzI,OAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,+CAA+C,SAAC,MAChEA,EAAA,IAACoL,EAAA,CACC,GAAG,iBACH,KAAK,SACL,MAAOm8B,EACP,SAAW1gC,GAAM2gC,EAAiB,OAAO3gC,EAAE,OAAO,KAAK,CAAC,EACxD,UAAU,kBACZ,CACF,IACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,kBAAkB,SAAe,oBAChDzI,OAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,+CAA+C,SAAC,MAChEA,EAAA,IAACoL,EAAA,CACC,GAAG,kBACH,KAAK,SACL,MAAOq8B,EACP,SAAW5gC,GAAM6gC,EAAkB,OAAO7gC,EAAE,OAAO,KAAK,CAAC,EACzD,UAAU,kBACZ,CACF,IACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,aAAa,SAAU,eACtCzI,OAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,+CAA+C,SAAC,MAChEA,EAAA,IAACoL,EAAA,CACC,GAAG,aACH,KAAK,SACL,MAAO22B,EACP,SAAWl7B,GAAM6+B,EAAa,OAAO7+B,EAAE,OAAO,KAAK,CAAC,EACpD,UAAU,kBACZ,CACF,IACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,cAAc,SAAiC,sCAC9DzI,OAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,+CAA+C,SAAC,MAChEA,EAAA,IAACoL,EAAA,CACC,GAAG,cACH,KAAK,SACL,MAAOu8B,EACP,SAAW9gC,GAAM+gC,EAAc,OAAO/gC,EAAE,OAAO,KAAK,CAAC,EACrD,UAAU,kBACZ,CACF,IACF,EAEC7G,EAAA,UAAG,UAAU,2BAA2B,SAAwB,6BAEjE8C,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,eAAe,SAAY,iBAC1CzI,OAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,+CAA+C,SAAC,MAChEA,EAAA,IAACoL,EAAA,CACC,GAAG,eACH,KAAK,SACL,MAAOs7B,EACP,SAAW7/B,GAAM8/B,EAAe,OAAO9/B,EAAE,OAAO,KAAK,CAAC,EACtD,UAAU,kBACZ,CACF,IACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,kBAAkB,SAAe,oBAChDzI,OAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,+CAA+C,SAAC,MAChEA,EAAA,IAACoL,EAAA,CACC,GAAG,kBACH,KAAK,SACL,MAAOw7B,EACP,SAAW//B,GAAMggC,EAAkB,OAAOhgC,EAAE,OAAO,KAAK,CAAC,EACzD,UAAU,kBACZ,CACF,IACF,EAEC7G,EAAA,UAAG,UAAU,2BAA2B,SAAkB,uBAE3D8C,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,mBAAmB,SAAgB,qBAClDzI,EAAA,KAACkxB,GAAA,CACC,aAAciU,EACd,cAAgBxa,GAAUya,EAAmBza,CAAK,EAElD,UAAAztB,MAACo0B,IAAc,GAAG,mBAChB,eAACF,GAAY,aAAY,0BAA0B,CACrD,UACCU,GACC,WAAC50B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,OAAO,SAAa,kBACrCl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,WAAW,SAAQ,aACvC,KACF,EACF,EAEC+S,IAAoB,YAEjBnlC,OAAA6D,EAAA,oBAAC7D,OAAA,OAAI,UAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,mBAAmB,SAAgB,qBAClDzI,OAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,+CAA+C,SAAC,MAChEA,EAAA,IAACoL,EAAA,CACC,GAAG,mBACH,KAAK,SACL,MAAO+8B,EACP,SAAWthC,GAAMuhC,EAAmB,OAAOvhC,EAAE,OAAO,KAAK,CAAC,EAC1D,UAAU,kBACZ,EACF,EACA/D,OAAC,MAAI,WAAU,qCACV,WAAkBqlC,EAAAZ,EAAiB,KAAK,QAAQ,CAAC,EAAE,sBACxD,IACF,EAEAzkC,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,gBAAgB,SAAiB,sBAChDvL,EAAA,IAACoL,EAAA,CACC,GAAG,gBACH,KAAK,SACL,MAAO4S,EACP,SAAWnX,GAAMo9B,EAAgB,OAAOp9B,EAAE,OAAO,KAAK,CAAC,EACvD,KAAM,IACR,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,gBAAgB,SAAqB,0BACpDvL,EAAA,IAACoL,EAAA,CACC,GAAG,gBACH,KAAK,SACL,MAAO84B,EACP,SAAWr9B,GAAMs9B,EAAgB,OAAOt9B,EAAE,OAAO,KAAK,CAAC,GACzD,CACF,IACF,EAGF/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,iBAAiB,SAAiC,sCACjEvL,EAAA,IAACoL,EAAA,CACC,GAAG,iBACH,KAAK,SACL,MAAOy8B,EACP,SAAWhhC,GAAMihC,EAAiB,OAAOjhC,EAAE,OAAO,KAAK,CAAC,GAC1D,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,sBAAsB,SAAgC,qCACrEvL,EAAA,IAACoL,EAAA,CACC,GAAG,sBACH,KAAK,SACL,MAAO28B,EACP,SAAWlhC,GAAMmhC,EAAsB,OAAOnhC,EAAE,OAAO,KAAK,CAAC,EAC7D,KAAM,IACR,EACF,EAEA7G,EAAA,IAAC0F,EAAA,CACC,QAAS4iC,EACT,UAAU,cACX,0BAED,EACF,EAEAxlC,OAAC,MAAI,WAAU,YACZ,UACC86B,GAAA96B,EAAA,KAAC,MAAI,WAAU,kCACb,UAAC9C,EAAA,UAAG,UAAU,sBAAsB,SAAW,gBAE/C8C,OAAC,MAAI,WAAU,iBACb,UAACA,OAAA,OAAI,UAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAiB,sBACxD8C,OAAC,MAAI,WAAU,yBAAyB,cAAE86B,EAAQ,gBAAgB,eAAe,EAAE,IACrF,EAEA96B,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAiB,sBACxD8C,OAAC,MAAI,WAAU,yBAAyB,cAAE86B,EAAQ,SAAS,eAAe,EAAE,IAC9E,EAEA96B,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAoB,yBAC3D8C,OAAC,MAAI,WAAU,yBAA0B,UAAQ86B,EAAA,iBAAiB,QAAQ,CAAC,EAAE,IAAC,IAChF,EAEA96B,OAAC,MAAI,WAAU,uCACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAqB,0BAC5D8C,OAAC,MAAI,WAAU,yBAAyB,cAAE86B,EAAQ,mBAAmB,eAAe,EAAE,IACxF,EAEA96B,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAa,kBACpD8C,OAAC,MAAI,WAAU,yBAAyB,cAAE86B,EAAQ,YAAY,eAAe,EAAE,IACjF,EAEA96B,OAAC,MAAI,WAAU,iDACb,UAAA9C,MAAC,OAAI,SAAU,eACf8C,OAAC,MAAI,WAAU,aAAc,UAAQ86B,EAAA,SAAS,QAAQ,CAAC,EAAE,IAAC,IAC5D,EAEA96B,OAAC,MAAI,WAAU,mCACb,UAAA9C,MAAC,OAAI,SAAe,oBACpB8C,OAAC,MAAI,WAAU,aAAc,UAAQ86B,EAAA,cAAc,QAAQ,CAAC,EAAE,IAAC,GACjE,GACF,IACF,EAGD59B,MAAA4S,EAAA,CACC,SAAC9P,OAAAkQ,EAAA,CAAY,UAAU,OACrB,UAAChT,EAAA,UAAG,UAAU,2BAA2B,SAAa,kBACtD8C,OAAC,KAAG,WAAU,yDACZ,UAAAA,OAAC,KAAG,WAAA9C,MAAC,UAAO,SAAoB,yBAAS,yDAAqD,SAC7F,KAAG,WAAAA,MAAC,UAAO,SAAU,eAAS,+EAA2E,SACzG,KAAG,WAAAA,MAAC,UAAO,SAAe,oBAAS,wFAAqF,IAC3H,EAEA8C,OAAC,MAAI,WAAU,qCACb,UAAA9C,MAAC,KAAE,SAAoC,yCACvC8C,OAAC,KAAG,WAAU,sBACZ,UAAA9C,MAAC,MAAG,SAAyB,8BAC7BA,MAAC,MAAG,SAA4B,iCAChCA,MAAC,MAAG,SAAmB,wBACzB,GACF,IACF,CACF,GACF,IACF,CACF,IACF,CAEJ,EC/VMopC,GAA0B,IAAM,CACpC,KAAM,CAACC,EAAcC,CAAe,EAAIzlC,WAAS,GAAK,EAChD,CAAC0lC,EAAkBC,CAAmB,EAAI3lC,WAAS,CAAC,EACpD,CAACkgC,EAASC,CAAU,EAAIngC,WAAS,GAAK,EACtC,CAAC4lC,EAAcC,CAAe,EAAI7lC,WAAS,GAAG,EAC9C,CAACma,EAAcimB,CAAe,EAAIpgC,WAAS,GAAG,EAC9C,CAACqgC,EAAcC,CAAe,EAAItgC,WAAS,EAAE,EAC7C,CAAC8lC,EAAwBC,CAAyB,EAAI/lC,WAAS,GAAG,EAElE,CAAC+5B,EAASyK,CAAU,EAAIxkC,WAMpB,IAAI,EAERgmC,EAAyB,IAAM,CAEnC,MAAMC,EAAcT,EAAeE,EAC7BQ,EAAcD,EAAcH,EAG5BK,EAAmBD,EAAchG,EAGjCU,EAAsBzmB,EAAe,IAAM,GAC3C0mB,EAAmBR,EAAe,GAGlCrnB,EAAI,KAAK,IAAI,EAAI4nB,EAAqBC,CAAgB,EACtDrmB,EAAkB0rB,EAAcltB,EAAI4nB,GAAwB5nB,EAAI,GAGhEgL,EAAgBiiB,EAAc,GAC9BG,EAAsB5rB,EAAiBwJ,EAAiB,IAGxDqiB,GAAkBlsB,EAAe,GAAK,IAAM,GAC5CmsB,EAAU,KAAK,IAAI,EAAID,EAAgBxF,CAAgB,EACvD0F,EAAuBL,EAAcI,EAAUD,GAAmBC,EAAU,GAEvE9B,EAAA,CACT,YAAA0B,EACA,iBAAAC,EACA,eAAA3rB,EACA,mBAAA4rB,EACA,oBAAAG,CAAA,CACD,CACH,EAGE,OAAAtnC,EAAA,KAAC8P,EAAK,WAAU,SACd,UAAA5S,MAAC6S,EACC,UAAA/P,OAACgQ,GAAU,WAAU,0CACnB,UAAC9S,MAAAqqC,GAAA,CAAY,UAAU,cAAe,GAAE,qCAE1C,CACF,GACCrqC,MAAAgT,EAAA,CACC,SAAClQ,OAAA,OAAI,UAAU,wCACb,UAACA,OAAA,OAAI,UAAU,YACb,UAAC9C,EAAA,UAAG,UAAU,sBAAsB,SAAc,mBAElD8C,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,gBAAgB,SAAkB,uBACjDzI,OAAC,OAAK,WAAU,gCAAgC,cAAEumC,EAAa,eAAe,EAAE,IAClF,EACAvmC,OAAC,MAAI,WAAU,aACb,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,+BAAgC,GACzD5e,EAAA,IAACg6B,GAAA,CACC,GAAG,gBACH,IAAK,IACL,IAAK,IACL,KAAM,IACN,aAAc,CAACqP,CAAY,EAC3B,cAAgB5b,GAAU6b,EAAgB7b,EAAM,CAAC,CAAC,GACpD,EACF,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAOi+B,EACP,SAAWxiC,GAAMyiC,EAAgB,OAAOziC,EAAE,OAAO,KAAK,CAAC,EACvD,UAAU,QACZ,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,oBAAoB,SAAwC,6CAC3EzI,OAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,+CAA+C,SAAC,MAChEA,EAAA,IAACoL,EAAA,CACC,GAAG,oBACH,KAAK,SACL,MAAOm+B,EACP,SAAW1iC,GAAM2iC,EAAoB,OAAO3iC,EAAE,OAAO,KAAK,CAAC,EAC3D,UAAU,kBACZ,CACF,IACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,UAAU,SAAiB,sBAC1CzI,OAAC,OAAK,WAAU,gCAAgC,cAAEihC,EAAQ,eAAe,EAAE,IAC7E,EACAjhC,OAAC,MAAI,WAAU,aACb,UAAC9C,MAAA4e,GAAA,CAAc,UAAU,+BAAgC,GACzD5e,EAAA,IAACg6B,GAAA,CACC,GAAG,UACH,IAAK,EACL,IAAK,IACL,KAAM,IACN,aAAc,CAAC+J,CAAO,EACtB,cAAgBtW,GAAUuW,EAAWvW,EAAM,CAAC,CAAC,GAC/C,EACF,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAO24B,EACP,SAAWl9B,GAAMm9B,EAAW,OAAOn9B,EAAE,OAAO,KAAK,CAAC,EAClD,UAAU,QACZ,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,gBAAgB,SAAqB,0BACpDzI,OAAC,MAAI,WAAU,OACb,UAAC9C,EAAA,YAAK,UAAU,+CAA+C,SAAC,MAChEA,EAAA,IAACoL,EAAA,CACC,GAAG,gBACH,KAAK,SACL,MAAOq+B,EACP,SAAW5iC,GAAM6iC,EAAgB,OAAO7iC,EAAE,OAAO,KAAK,CAAC,EACvD,UAAU,kBACZ,EACF,EACC7G,EAAA,WAAI,UAAU,qCAAqC,SAEpD,oDACF,EAECA,EAAA,UAAG,UAAU,2BAA2B,SAAgB,qBAEzD8C,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,gBAAgB,SAAiB,sBAChDzI,OAAC,OAAK,WAAU,gCAAiC,UAAAkb,EAAa,IAAC,IACjE,EACAhe,MAAC,MAAI,WAAU,aACb,SAAAA,EAAA,IAACg6B,GAAA,CACC,GAAG,gBACH,IAAK,EACL,IAAK,GACL,KAAM,GACN,aAAc,CAAChc,CAAY,EAC3B,cAAgByP,GAAUwW,EAAgBxW,EAAM,CAAC,CAAC,IAEtD,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAO4S,EACP,SAAWnX,GAAMo9B,EAAgB,OAAOp9B,EAAE,OAAO,KAAK,CAAC,EACvD,UAAU,OACV,KAAM,IACR,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAACA,OAAA,OAAI,UAAU,uBACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,gBAAgB,SAAqB,0BACpDzI,OAAC,OAAK,WAAU,gCAAiC,UAAAohC,EAAa,SAAM,IACtE,EACAlkC,MAAC,MAAI,WAAU,aACb,SAAAA,EAAA,IAACg6B,GAAA,CACC,GAAG,gBACH,IAAK,EACL,IAAK,GACL,KAAM,EACN,aAAc,CAACkK,CAAY,EAC3B,cAAgBzW,GAAU0W,EAAgB1W,EAAM,CAAC,CAAC,IAEtD,EACAztB,EAAA,IAACoL,EAAA,CACC,KAAK,SACL,MAAO84B,EACP,SAAWr9B,GAAMs9B,EAAgB,OAAOt9B,EAAE,OAAO,KAAK,CAAC,EACvD,UAAU,QACZ,EACF,EAEA/D,OAAC,MAAI,WAAU,YACb,UAAC9C,EAAA,IAAAuL,EAAA,CAAM,QAAQ,iBAAiB,SAAuB,4BACvDzI,EAAA,KAACkxB,GAAA,CACC,aAAc2V,EAAuB,SAAS,EAC9C,cAAgBlc,GAAUmc,EAA0B,OAAOnc,CAAK,CAAC,EAEjE,UAAAztB,MAACo0B,IAAc,GAAG,iBAChB,eAACF,GAAY,aAAY,iCAAiC,CAC5D,UACCU,GACC,WAAC50B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,IAAI,SAAW,gBAChCl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,MAAM,SAAW,gBAClCl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,IAAI,SAAW,gBAChCl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,MAAM,SAAW,gBAClCl1B,EAAA,IAAAk1B,EAAA,CAAW,MAAM,IAAI,SAAW,gBACnC,IACF,EACCl1B,EAAA,WAAI,UAAU,qCAAqC,SAEpD,6DACF,EAEAA,EAAA,IAAC0F,EAAA,CACC,QAASmkC,EACT,UAAU,cACX,oCAED,EACF,EAEA/mC,OAAC,MAAI,WAAU,YACZ,UACC86B,GAAA96B,EAAA,KAAC,MAAI,WAAU,kCACb,UAAC9C,EAAA,UAAG,UAAU,sBAAsB,SAAqB,0BAEzD8C,OAAC,MAAI,WAAU,iBACb,UAACA,OAAA,OAAI,UAAU,2CACb,UAAC9C,EAAA,WAAI,UAAU,gCAAgC,SAAsB,2BACrE8C,OAAC,MAAI,WAAU,0BAA0B,cAAE86B,EAAQ,iBAAiB,eAAe,EAAE,IACvF,EAEA96B,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAiB,sBACxD8C,OAAC,MAAI,WAAU,yBAAyB,cAAE86B,EAAQ,YAAY,eAAe,EAAE,IACjF,EAEA96B,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAgB,qBACvD8C,OAAC,MAAI,WAAU,yBAAyB,cAAE86B,EAAQ,eAAe,QAAQ,CAAC,EAAE,IAC9E,EAEA96B,OAAC,MAAI,WAAU,yBACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAoB,yBAC3D8C,OAAC,MAAI,WAAU,yBACZ,UAAQ86B,EAAA,mBAAmB,QAAQ,CAAC,EAAE,IACvC59B,MAAC,QAAK,UAAW,yCAAyC49B,EAAQ,oBAAsB,GAAK,8BAAgCA,EAAQ,oBAAsB,GAAK,gCAAkC,yBAAyB,GACxN,WAAQ,oBAAsB,GAAK,OAASA,EAAQ,oBAAsB,GAAK,WAAa,MAC/F,GACF,IACF,EAEA96B,OAAC,MAAI,WAAU,uCACb,UAAC9C,EAAA,WAAI,UAAU,wBAAwB,SAAsB,2BAC7D8C,OAAC,MAAI,WAAU,yBAAyB,cAAE86B,EAAQ,oBAAoB,QAAQ,CAAC,GAAE,EAChF59B,EAAA,WAAI,UAAU,2CAA2C,SAE1D,8CACF,GACF,IACF,EAGDA,MAAA4S,EAAA,CACC,SAAC9P,OAAAkQ,EAAA,CAAY,UAAU,OACrB,UAAChT,EAAA,UAAG,UAAU,2BAA2B,SAAmB,wBAC5D8C,OAAC,KAAG,WAAU,yDACZ,UAAAA,OAAC,KAAG,WAAA9C,MAAC,UAAO,SAAoB,yBAAS,2EAAuE,SAC/G,KAAG,WAAAA,MAAC,UAAO,SAAqB,0BAAS,yFAAqF,SAC9H,KAAG,WAAAA,MAAC,UAAO,SAAe,oBAAS,gFAA4E,SAC/G,KAAG,WAAAA,MAAC,UAAO,SAAQ,aAAS,kEAA+D,IAC9F,EAEA8C,OAAC,MAAI,WAAU,qCACb,UAAC9C,EAAA,SAAE,UAAU,cAAc,SAA6B,kCACxD8C,OAAC,KAAG,WAAU,sBACZ,UAAA9C,MAAC,MAAG,SAAmB,wBACvBA,MAAC,MAAG,SAAoC,yCACxCA,MAAC,MAAG,SAA2B,gCAC/BA,MAAC,MAAG,SAAqC,0CACzCA,MAAC,MAAG,SAAY,iBAClB,GACF,IACF,CACF,GACF,IACF,CACF,IACF,CAEJ,ECjSMsqC,GAAc,KAElB9lC,YAAU,IAAM,CACd,QAAQ,IAAI,sDAAsD,CACpE,EAAG,EAAE,EAGH1B,EAAA,KAAC,MAAI,WAAU,6BAEb,UAAC9C,MAAA,OAAI,UAAU,SACb,SAAAA,EAAA,IAACiS,GAAA,CACC,MAAM,kCACN,SAAS,qGACT,WAAY,GACZ,UAAW,GACX,OAAO,cAEX,EAGAjS,MAAC,OAAI,UAAU,oCACb,gBAACuW,GAAK,cAAa,WAAW,UAAU,SACtC,UAAAvW,MAACyW,IAAS,UAAU,cAClB,SAAC3T,EAAA,YAAI,UAAU,8DACb,UAAA9C,MAAC2W,GAAY,OAAM,WAAW,UAAU,SAAS,SAAQ,mBACxDA,GAAY,OAAM,YAAY,UAAU,SAAS,SAAU,qBAC3DA,GAAY,OAAM,QAAQ,UAAU,SAAS,SAAY,uBACzDA,GAAY,OAAM,MAAM,UAAU,SAAS,SAAG,cAC9CA,GAAY,OAAM,gBAAgB,UAAU,SAAS,SAAa,mBACrE,CACF,GAEA3W,MAAC6W,IAAY,MAAM,WAAW,UAAU,OACtC,SAAA7W,EAAA,IAAC4jC,KAAmB,CACtB,GAEA5jC,MAAC6W,IAAY,MAAM,YAAY,UAAU,OACvC,SAAA7W,EAAA,IAAColC,KAAoB,CACvB,GAEAplC,MAAC6W,IAAY,MAAM,QAAQ,UAAU,OACnC,SAAA7W,EAAA,IAACymC,KAAgB,CACnB,GAEAzmC,MAAC6W,IAAY,MAAM,MAAM,UAAU,OACjC,SAAA7W,EAAA,IAACsnC,KAAc,CACjB,GAEAtnC,MAAC6W,IAAY,MAAM,gBAAgB,UAAU,OAC3C,SAAA7W,MAACopC,IAAwB,EAC3B,IACF,CACF,IACF,GCjCJ,SAASmB,IAAqB,CACtB,MAAE,MAAA3nC,CAAM,EAAI4nC,GAAU,EAI1B,OAAAxqC,EAAA,IAAC8yB,GAAA,CACC,MAAOlwB,GAAS,aAChB,QAAQ,wBACR,SAAU,KAAK,EAAE,cAAc,MAAM,GAAG,EAAE,CAAC,EAC7C,CAEJ,CAGA,SAAS6nC,IAAa,CACpB,KAAM,CAACvmC,EAAWC,CAAY,EAAIN,WAAS,EAAI,EACzC6gB,EAAWgmB,GAAY,EACvB,CAAE,KAAA/mC,EAAM,QAAAK,EAAS,QAAAO,EAAS,eAAAH,CAAA,EAAmBU,GAAQ,EAG3DN,mBAAU,IAAM,CACd,QAAQ,IAAI,qBAAsB,CAAE,KAAAb,EAAM,QAAAK,EAAS,EAGpCI,EAAA,CACjB,EAAG,EAAE,EAELI,YAAU,IAAM,CACR,MAAAmmC,EAAc,IAAMxmC,EAAa,EAAI,EACrCymC,EAAa,IAAMzmC,EAAa,EAAK,EAE/BwmC,EAAA,EACN,MAAAthB,EAAQ,WAAWuhB,EAAY,GAAG,EAEjC,UAAM,aAAavhB,CAAK,GAC9B,CAAC3E,EAAS,QAAQ,CAAC,EAEtBlgB,YAAU,IAAM,CACL,yBAAgB,UAAU,OAAO,MAAM,CAClD,EAAG,EAAE,EAGF1B,EAAA,WAAI,WAAU,6BACb,UAAA9C,EAAA,IAACiM,GAAA,CACC,gBAAiB,CAAC,CAACtI,EACnB,YAAaK,GAAW,OACxB,SAAU,IAAM,CAEhB,EACA,SAAU,IAAM,CAEhB,EACA,UAAWO,CAAA,CACb,QACC,OACC,UAACzB,OAAA+nC,GACC,WAAA7qC,MAAC8qC,IAAM,KAAK,IAAI,QAAS9qC,MAAC8f,IAAK,GAAI,QAClCgrB,GAAM,MAAK,YAAY,QAAS9qC,MAAC++B,IAAS,GAAI,QAC9C+L,GAAM,MAAK,SAAS,QAAS9qC,MAACo8B,IAAU,GAAI,QAC5C0O,GAAM,MAAK,UAAU,QAAS9qC,MAAC4yB,IAAiB,GAAI,QACpDkY,GAAM,MAAK,YAAY,QAAS9qC,MAAC2uB,IAAmB,GAAI,QACxDmc,GAAM,MAAK,eAAe,QAAS9qC,MAACsqC,IAAY,GAAI,QACpDQ,GAAM,MAAK,WAAW,QAAS9qC,MAACiqB,IAAgB,GAAI,EACpDjqB,MAAA8qC,GAAM,MAAK,SAAS,QAAU9qC,EAAA,IAAA+qC,GAAA,CAAS,GAAG,IAAI,QAAO,GAAC,EAAI,QAC1DD,GAAM,MAAK,aAAa,QAAS9qC,MAACsmB,IAAU,GAAI,QAChDwkB,GAAM,MAAK,WAAW,QAAS9qC,MAACwoB,IAAY,GAAI,QAChDsiB,GAAM,MAAK,wBAAwB,QAAS9qC,MAAC+oB,IAAoB,GAAI,QACrE+hB,GAAM,MAAK,uBAAuB,QAAS9qC,MAACopB,IAAmB,GAAI,QACnE0hB,GAAM,MAAK,WAAW,QAAS9qC,MAACiqB,IAAgB,GAAI,QACpD6gB,GAAM,MAAK,YAAY,QAAS9qC,MAAC02B,IAAa,GAAI,QAClDoU,GAAM,MAAK,QAAQ,QAAS9qC,MAAC+2B,IAAS,GAAI,QAC1C+T,GAAM,MAAK,kBAAkB,QAAS9qC,MAACuqC,IAAmB,GAAI,QAC9DO,GAAM,MAAK,cAAc,QAAS9qC,MAACuqC,IAAmB,GAAI,QAC1DO,GAAM,MAAK,QAAQ,QAAS9qC,MAACm3B,IAAgB,GAAI,QACjD2T,GAAM,MAAK,iBAAiB,QAAS9qC,MAACw5B,IAAa,GAAI,QACvDsR,GAAM,MAAK,uBAAuB,QAAS9qC,MAAC85B,IAAuB,GAAI,QACvEgR,GAAM,MAAK,4BAA4B,QAAS9qC,MAACm7B,IAA4B,GAAI,QACjF2P,GAAM,MAAK,YAAY,QAAS9qC,MAACk8B,IAAY,GAAI,QACjD4O,GAAM,MAAK,YAAY,QAAS9qC,MAACw8B,IAAS,GAAI,EAC9C,SAGAsO,GAAM,MAAK,IAAI,QAAS9qC,EAAA,IAAC2qB,KAAS,CAAI,IACzC,EACF,QACCmN,GAAQ,UACRp1B,GAAQ,IACR1C,MAAAiF,GAAY,aAAaf,CAAW,IACvC,CAEJ,CAGA,SAAS8mC,IAAM,CAEX,OAAAhrC,MAACyD,GACC,gBAACwnC,WAAS,UAAWjrC,MAAAgF,GAAA,EAAQ,EAC3B,SAAChF,MAAAyqC,GAAW,GACd,GACF,CAEJ,CCzHAS,GAAA,cAAc,KAAK,EAEnBC,GAAQ,KAAK,kDACT,CACI,SAAU,2BACV,gBAAiB,kBAEzB,EAEA,MAAMC,GAAc,IAAIC,GAExBC,GAAS,WAAW,SAAS,eAAe,MAAM,CAAE,EAAE,aACnDzmC,EAAM,WAAN,CACC,SAAA7E,MAACurC,IAAoB,OAAQH,GAC3B,SAACprC,MAAAwrC,GAAA,CACC,eAAC/nC,GACC,UAAAzD,MAACgrC,KAAI,CACP,EACF,EACF,EACF,EACF","names":["cn","inputs","twMerge","clsx","formatCurrency","amount","formatDate","date","formatNumber","number","ToastProvider","ToastPrimitives.Provider","ToastViewport","React.forwardRef","className","props","ref","jsx","ToastPrimitives.Viewport","toastVariants","cva","Toast","variant","ToastPrimitives.Root","ToastAction","ToastPrimitives.Action","ToastClose","ToastPrimitives.Close","Cross2Icon","ToastTitle","ToastPrimitives.Title","ToastDescription","ToastPrimitives.Description","TOAST_LIMIT","TOAST_REMOVE_DELAY","count","genId","toastTimeouts","addToRemoveQueue","toastId","timeout","dispatch","reducer","state","action","toast","t","listeners","memoryState","listener","id","update","dismiss","open","useToast","setState","React.useState","React.useEffect","index","Toaster","toasts","title","description","jsxs","supabaseUrl","supabaseKey","supabase","createClient","AuthContext","createContext","fetchProfile","userId","data","error","AuthProvider","children","user","setUser","useState","session","setSession","profile","setProfile","isLoading","setIsLoading","refreshSession","_a","_b","signOut","useEffect","unsubscribe","event","fn","contextValue","React","useAuth","useContext","Loading","ProgressBar","isAnimating","progress","setProgress","timer1","timer2","timer3","timer4","buttonVariants","Button","size","asChild","Comp","Slot","ScrollArea","ScrollAreaPrimitive.Root","ScrollAreaPrimitive.Viewport","ScrollBar","ScrollAreaPrimitive.Corner","orientation","ScrollAreaPrimitive.ScrollAreaScrollbar","ScrollAreaPrimitive.ScrollAreaThumb","MobileNav","isOpen","onClose","AnimatePresence","Fragment","motion","e","X","NavigationMenu","NavigationMenuPrimitive.Root","NavigationMenuViewport","NavigationMenuList","NavigationMenuPrimitive.List","NavigationMenuItem","NavigationMenuPrimitive.Item","navigationMenuTriggerStyle","NavigationMenuTrigger","NavigationMenuPrimitive.Trigger","ChevronDown","NavigationMenuContent","NavigationMenuPrimitive.Content","NavigationMenuLink","NavigationMenuPrimitive.Link","NavigationMenuPrimitive.Viewport","NavigationMenuIndicator","NavigationMenuPrimitive.Indicator","Avatar","AvatarPrimitive.Root","AvatarImage","AvatarPrimitive.Image","AvatarFallback","AvatarPrimitive.Fallback","DropdownMenu","DropdownMenuPrimitive.Root","DropdownMenuTrigger","DropdownMenuPrimitive.Trigger","DropdownMenuSubTrigger","inset","DropdownMenuPrimitive.SubTrigger","ChevronRightIcon","DropdownMenuSubContent","DropdownMenuPrimitive.SubContent","DropdownMenuContent","sideOffset","DropdownMenuPrimitive.Portal","DropdownMenuPrimitive.Content","DropdownMenuItem","DropdownMenuPrimitive.Item","DropdownMenuCheckboxItem","checked","DropdownMenuPrimitive.CheckboxItem","DropdownMenuPrimitive.ItemIndicator","CheckIcon","DropdownMenuRadioItem","DropdownMenuPrimitive.RadioItem","DotFilledIcon","DropdownMenuLabel","DropdownMenuPrimitive.Label","DropdownMenuSeparator","DropdownMenuPrimitive.Separator","Dialog","DialogPrimitive.Root","DialogTrigger","DialogPrimitive.Trigger","DialogPortal","DialogPrimitive.Portal","DialogOverlay","DialogPrimitive.Overlay","DialogContent","DialogPrimitive.Content","DialogPrimitive.Close","DialogHeader","DialogFooter","DialogTitle","DialogPrimitive.Title","DialogDescription","DialogPrimitive.Description","Input","type","labelVariants","Label","LabelPrimitive.Root","LoginModal","onSuccess","email","setEmail","password","setPassword","handleLogin","MobileNavLinks","Header","isAuthenticated","onSignIn","onSignUp","userProfile","onSignOut","showMobileMenu","setShowMobileMenu","isScrolled","setIsScrolled","loginModalOpen","setLoginModalOpen","navigate","useNavigate","auth","actualIsAuthenticated","actualUserProfile","actualSignOut","handleScroll","handleLoginClick","handleSignOut","handleMobileNavLinkClick","requiresAuth","href","ListItem","Crown","n","LayoutDashboard","Settings","MessageCircle","LogOut","LogIn","UserPlus","Menu","item","subItem","subIndex","SplitText","text","delay","animationFrom","animationTo","easing","threshold","rootMargin","textAlign","onLetterAnimationComplete","words","word","letters","inView","setInView","useRef","animatedCount","observer","entry","springs","useSprings","_","i","next","wordIndex","letter","letterIndex","acc","w","animated","VERT","FRAG","Aurora","colorStops","amplitude","blend","propsRef","ctnDom","ctn","renderer","Renderer","gl","program","resize","width","height","geometry","Triangle","colorStopsArray","hex","c","Color","Program","mesh","Mesh","animateId","time","speed","stops","HeroSection","onSearch","subtitle","showSearch","showStats","image","searchTerm","setSearchTerm","handleSubmit","handleAnimationComplete","Search","Card","CardHeader","CardTitle","CardDescription","CardContent","CardFooter","badgeVariants","Badge","PropertyCard","address","price","squareFootage","bedrooms","bathrooms","isPremium","propertyType","createdAt","author","original_price","roi_percentage","investment_term","deal_type","isSubscriber","isDeal","images","onClick","onMessageAuthor","currentUser","isSaved","setIsSaved","handleSaveToggle","handleShare","handleMessageAuthor","imageUrl","Heart","Share","supabaseAnonKey","SUBSCRIPTION_TIERS","createCheckoutSession","priceId","response","sessionId","stripe","loadStripe","AuthModal","defaultMode","mode","setMode","isSubmitting","setIsSubmitting","showConfirmation","setShowConfirmation","signIn","signUp","signInWithGoogle","formData","setFormData","pendingPriceId","prev","Tabs","TabsPrimitive.Root","TabsList","TabsPrimitive.List","TabsTrigger","TabsPrimitive.Trigger","TabsContent","TabsPrimitive.Content","SubscriptionModal","handleSubscribe","tier","profanityList","filterProfanity","filteredText","regex","sendMessage","receiverId","content","dealId","userError","getConversations","sessionError","userData","fetchConversationsForUser","conversationsMap","message","otherUser","conversationId","conversation","getMessages","otherUserId","unreadMessages","updateError","m","subscribeToMessages","callback","payload","searchUsers","query","formattedTerm","LoadingSpinner","sizeClasses","MessagesModal","messages","setMessages","newMessage","setNewMessage","receiver","setReceiver","messagesEndRef","loadMessages","scrollToBottom","msg","receiverData","handleSendMessage","Send","RandomFact","fact","setFact","Lightbulb","Footer","alertVariants","Alert","AlertTitle","AlertDescription","LegalDisclaimer","Info","getFeaturedProperties","page","perPage","start","properties","p","searchProperties","getSavedProperties","getDeals","deals","d","useDeals","limit","useInfiniteQuery","pageParam","lastPage","allPages","Marquee","direction","pauseOnHover","reverse","fade","vertical","LiquidChrome","baseColor","frequencyX","frequencyY","interactive","containerRef","container","vertexShader","fragmentShader","resUniform","handleMouseMove","rect","x","y","mouseUniform","handleTouchMove","touch","animationId","PropertyModal","property","postcode","tenure","validSaleHistory","sale","a","b","priceGrowthPercentage","mostRecentPrice","oldestPrice","mortgage","downPaymentPercent","interestRate","termYears","loanAmount","monthlyRate","numPayments","monthlyPayment","Bed","Bath","Square","Building","MapPin","FileText","PoundSterling","Compass","ArrowDownRight","ArrowUpRight","Calendar","maxPrice","s","position","reviews","firstRow","secondRow","thirdRow","fourthRow","ReviewCard","img","name","username","body","Home","isInitialLoad","setIsInitialLoad","searchResults","setSearchResults","isSearching","setIsSearching","isAuthModalOpen","setIsAuthModalOpen","isSubscriptionModalOpen","setIsSubscriptionModalOpen","authMode","setAuthMode","isMessagesModalOpen","setIsMessagesModalOpen","selectedReceiverId","setPage","hasMore","setHasMore","PROPERTIES_PER_PAGE","isFetchingMore","setIsFetchingMore","selectedProperty","setSelectedProperty","isPropertyModalOpen","setIsPropertyModalOpen","observerTarget","loadingRef","dealsData","isLoadingDeals","loadFeaturedProperties","pageNum","isLoadingMore","entries","handleSearch","term","mappedResults","showLoading","showProperties","deal","review","Layout","useBitcoinPrice","btcPrice","setBtcPrice","loading","setLoading","fetchPrice","priceText","interval","gbpAmount","BitcoinPrice","convertGBPtoBTC","btcAmount","Bitcoin","updateUserProfile","updates","adminProfiles","adminCheckError","existingUsers","existingError","updateData","getAllUsers","profiles","profilesError","importProperties","Textarea","AuthContextChecker","hasAuthContext","setHasAuthContext","isChecking","setIsChecking","checkAuthContext","RefreshCw","PropertyImporterContent","setIsOpen","location","setLocation","isImporting","setIsImporting","selectedProperties","setSelectedProperties","currentPage","setCurrentPage","totalPages","setTotalPages","totalResults","setTotalResults","fileData","setFileData","jsonData","setJsonData","importStatus","setImportStatus","statusMessage","setStatusMessage","handleImport","propertiesToImport","handleFileChange","handleJsonChange","Upload","CheckCircle2","AlertCircle","PropertyImporter","Dashboard","savedProperties","setSavedProperties","addedProperties","setAddedProperties","users","setUsers","portfolioStats","setPortfolioStats","setError","loadUsers","handleUserUpdate","updatedProfile","updatedUsers","loadProperties","saved","added","totalProperties","totalValue","sum","prop","averagePrice","totalProfit","monthlyIncome","Building2","TrendingUp","Users","Star","SubscriptionPlans","onSubscribe","currentTier","key","feature","Check","PricingPage","OnboardingModal","step","setStep","handleComplete","steps","widget","SubscriptionSuccess","searchParams","useSearchParams","showOnboarding","setShowOnboarding","SubscriptionCancel","timer","MAX_FILE_SIZE","ALLOWED_FILE_TYPES","AvatarUpload","currentAvatarUrl","onUpload","userInitials","isUploading","setIsUploading","fileInputRef","handleFileSelect","file","AccountSettings","handleAvatarUpload","fileExt","fileName","filePath","uploadError","publicUrl","verifyError","handleUpdateProfile","passwordError","NotFound","Link","MOCK_NEWS","MOCK_MARKET_INSIGHTS","MOCK_RISK_ASSESSMENT","MOCK_PERSONALIZED_OPPORTUNITIES","ensureMarketInsightsTable","checkError","createError","fetchPropertyNews","article","generateMarketInsights","prompt","apiKey","url","generatedText","part","getLatestMarketInsights","getRiskAssessment","getPersonalizedOpportunities","getPredictiveAnalytics","region","MarketInsights","showHero","news","setNews","insights","setInsights","riskAssessment","setRiskAssessment","personalizedOpportunities","setPersonalizedOpportunities","newsData","latestInsights","newInsights","riskData","opportunitiesData","predictiveData","priceData","regionalData","ResponsiveContainer","LineChart","CartesianGrid","XAxis","YAxis","Tooltip","value","Line","DataVisualization","activeChart","setActiveChart","propertyTypeData","pricePerSqftData","COLORS","LineChartIcon","PieChartIcon","BarChart3","Legend","PieChart","Pie","percent","Cell","BarChart","Bar","MarketInsightsPage","activeTab","setActiveTab","getChatResponse","_e","_d","_c","getMockChatResponse","apiUrl","jsonMatch","getMockPredictiveAnalytics","getInvestmentHotspots","getMockHotspots","popularQuestions","formatMessage","formattedText","line","MarketTrends","trends","articles","heatmapData","UKMap","regionData","growth","marketInsights","setMarketInsights","isLoadingInsights","setIsLoadingInsights","refreshingInsights","setRefreshingInsights","fetchMarketInsights","setPredictiveData","hotspots","setHotspots","isLoadingAnalytics","setIsLoadingAnalytics","refreshingPredictions","setRefreshingPredictions","refreshingHotspots","setRefreshingHotspots","isLoadingHotspots","setIsLoadingHotspots","fetchPredictiveAnalytics","transformedData","fetchHotspots","safeHotspots","hotspot","handleRefreshInsights","handleRefreshPredictions","handleRefreshHotspots","bitcoinPrice","setBitcoinPrice","bitcoinLoading","setBitcoinLoading","fetchBitcoinPrice","err","refreshInterval","AreaChart","Area","prediction","factor","idx","ArrowRight","trend","PageTransition","MarketTrendsPage","MarketTrendsContent","ArticlePage","readTime","Clock","paragraph","ResearchReports","reports","setReports","report","formatDistance","Tag","Download","Skeleton","PropertyCardSkeleton","DealCard","showMessageButton","isMessageModalOpen","setIsMessageModalOpen","handleMessageClick","Select","SelectPrimitive.Root","SelectValue","SelectPrimitive.Value","SelectTrigger","SelectPrimitive.Trigger","SelectPrimitive.Icon","SelectScrollUpButton","SelectPrimitive.ScrollUpButton","ChevronUp","SelectScrollDownButton","SelectPrimitive.ScrollDownButton","SelectContent","SelectPrimitive.Portal","SelectPrimitive.Content","SelectPrimitive.Viewport","SelectLabel","SelectPrimitive.Label","SelectItem","SelectPrimitive.Item","SelectPrimitive.ItemIndicator","SelectPrimitive.ItemText","SelectSeparator","SelectPrimitive.Separator","ResearchRequests","requestType","setRequestType","requestDetails","setRequestDetails","requestPriority","setRequestPriority","submittedRequests","setSubmittedRequests","newRequest","canSubmitHighPriority","requestsRemaining","getStatusIcon","status","AlertTriangle","dateString","request","FileQuestion","ResearchPage","ResearchPageContent","setDeals","mounted","loadDeals","BlogPage","__","blogPosts","post","HelpSupportPage","supportCategories","Book","HelpCircle","contactMethods","Mail","Phone","category","method","GEMINI_API_KEY","GEMINI_API_URL","ChatBot","aiMessages","setAiMessages","supportMessages","setSupportMessages","directMessages","setDirectMessages","input","setInput","contacts","setContacts","selectedContact","setSelectedContact","scrollRef","loadContacts","handleOpenMessages","contact","uniqueContacts","handleSend","aiResponse","supportConversationId","userMsgError","autoResponse","supportError","subscription","question","AuthCallback","aiFeatures","Brain","MessageSquare","Shield","managementServices","PropertyManagementPage","service","Slider","SliderPrimitive.Root","SliderPrimitive.Track","SliderPrimitive.Range","SliderPrimitive.Thumb","genAI","initializeAI","GoogleGenerativeAI","__vitePreload","sanitizeJsonString","str","end","getInvestmentAnalysis","budget","model","parsedData","getMarketPredictions","getInvestmentStrategy","investorProfile","InvestmentOpportunitiesPage","setPropertyType","setBudget","analysis","setAnalysis","predictions","setPredictions","strategy","setStrategy","handleAnalyze","analysisData","predictionsData","strategyData","Loader2","risk","AboutUsPage","DealModal","DealsPage","DealsPageContent","selectedDeal","setSelectedDeal","Messages","authUser","conversations","setConversations","selectedConversation","setSelectedConversation","isMessagesLoading","setIsMessagesLoading","isNewChatOpen","setIsNewChatOpen","isMobileView","setIsMobileView","mobileShowMessages","setMobileShowMessages","useSWR","handleResize","loadConversations","authListener","activeUser","msgs","results","searchUsersApi","handleBackToConversations","Plus","formatDistanceToNow","ArrowLeft","isUser","showAvatar","PATMA_API_KEY","API_BASE_URL","API_PATH","getAskingPrices","params","queryParams","getSoldProperties","errorData","errorMessage","getListedProperties","getPriceHistory","Listings","listedProperties","setListedProperties","soldProperties","setSoldProperties","areaInsights","setAreaInsights","viewMode","setViewMode","filters","setFilters","showPricePerSqft","setShowPricePerSqft","showStampDuty","setShowStampDuty","showPlanningApplications","setShowPlanningApplications","isModalOpen","setIsModalOpen","displayProperties","fetchAreaInsights","askingPrices","priceHistory","getPropertyImageUrl","possibleImageFields","field","patmaImage","patmaPhoto","historyItem","isPostcode","listedResults","sampleProperty","propertiesWithMetrics","normalizedProperty","addInvestmentMetrics","soldResults","priceMatch","propertyWithMetrics","calculateStampDuty","calculatePricePerSqft","monthlyRentEstimate","bedroomFactor","annualRent","futureValue","totalRent","totalReturn","isBuyToLet","isFirstTimeBuyer","stampDuty","isMetric","sizeInSqft","handlePropertyTypeChange","handleTenureChange","handleBedroomsChange","handleRadiusChange","handleSortChange","openPropertyModal","closePropertyModal","isSoldProperty","displayPostcode","hasSaleHistory","saleHistoryData","priceGrowth","calculateMortgage","propertyPrice","downPayment","monthlyInterest","totalPayments","mortgageDetails","ExternalLink","Key","SquareIcon","margin","station","school","num","f","MortgageCalculator","propertyValue","setPropertyValue","deposit","setDeposit","setInterestRate","mortgageTerm","setMortgageTerm","setMonthlyPayment","totalRepayment","setTotalRepayment","totalInterest","setTotalInterest","monthlyInterestRate","numberOfPayments","monthly","totalPaid","totalInterestPaid","ltv","CalculatorIcon","Percent","Checkbox","CheckboxPrimitive.Root","CheckboxPrimitive.Indicator","StampDutyCalculator","setIsFirstTimeBuyer","isAdditionalProperty","setIsAdditionalProperty","isNonUKResident","setIsNonUKResident","setStampDuty","breakdown","setBreakdown","bands","totalTax","breakdownItems","additionalRate","nonUKResidentRate","remainingValue","band","bandWidth","amountInBand","bandRate","bandTax","bandLabel","YieldCalculator","monthlyRent","setMonthlyRent","annualExpenses","setAnnualExpenses","grossYield","setGrossYield","netYield","setNetYield","calculateYield","grossYieldValue","netYieldValue","BadgePercent","ROICalculator","purchasePrice","setPurchasePrice","renovationCost","setRenovationCost","otherCosts","setOtherCosts","holdingPeriod","setHoldingPeriod","annualAppreciation","setAnnualAppreciation","financingMethod","setFinancingMethod","mortgageDeposit","setMortgageDeposit","setResults","calculateROI","totalInvestment","annualMortgagePayments","annualCashFlow","cashOnCashReturn","estimatedSalePrice","outstandingMortgage","balance","interestPayment","principalPayment","totalCashFlow","equityGain","totalROI","annualizedROI","AffordabilityCalculator","annualIncome","setAnnualIncome","additionalIncome","setAdditionalIncome","monthlyDebts","setMonthlyDebts","loanToIncomeMultiplier","setLoanToIncomeMultiplier","calculateAffordability","totalIncome","maxMortgage","maxPropertyPrice","affordabilityRatio","stressTestRate","stressX","stressTestedPayment","ShieldCheck","Calculators","ArticlePageWrapper","useParams","AppContent","useLocation","handleStart","handleStop","Routes","Route","Navigate","App","Suspense","TempoDevtools","posthog","queryClient","QueryClient","ReactDOM","QueryClientProvider","BrowserRouter"],"ignoreList":[],"sources":["../../src/lib/utils.ts","../../src/components/ui/toast.tsx","../../src/components/ui/use-toast.ts","../../src/components/ui/toaster.tsx","../../src/lib/supabaseClient.ts","../../src/lib/auth.ts","../../src/components/ui/loading.tsx","../../src/components/ui/progress-bar.tsx","../../src/components/ui/button.tsx","../../src/components/ui/scroll-area.tsx","../../src/components/MobileNav.jsx","../../src/components/ui/navigation-menu.tsx","../../src/components/ui/avatar.tsx","../../src/components/ui/dropdown-menu.tsx","../../src/components/ui/dialog.tsx","../../src/components/ui/input.tsx","../../src/components/ui/label.tsx","../../src/components/auth/LoginModal.tsx","../../src/components/Header.tsx","../../src/components/ui/SplitText.tsx","../../src/components/ui/Aurora.tsx","../../src/components/HeroSection.tsx","../../src/components/ui/card.tsx","../../src/components/ui/badge.tsx","../../src/components/PropertyCard.tsx","../../src/lib/supabase.ts","../../src/lib/stripe.ts","../../src/components/AuthModal.tsx","../../src/components/ui/tabs.tsx","../../src/components/SubscriptionModal.tsx","../../src/lib/messages.ts","../../src/components/ui/loading-spinner.tsx","../../src/components/MessagesModal.tsx","../../src/components/RandomFact.tsx","../../src/components/Footer.tsx","../../src/components/ui/alert.tsx","../../src/components/LegalDisclaimer.tsx","../../src/lib/properties.ts","../../src/components/ui/Marquee.tsx","../../src/components/LiquidChrome.tsx","../../src/components/PropertyModal.tsx","../../src/components/home.tsx","../../src/components/Layout.tsx","../../src/lib/hooks/useBitcoinPrice.ts","../../src/components/BitcoinPrice.tsx","../../src/lib/users.ts","../../src/lib/propertyScraperService.ts","../../src/components/ui/textarea.tsx","../../src/lib/AuthContextChecker.tsx","../../src/components/PropertyImporter.tsx","../../src/components/Dashboard.tsx","../../src/components/SubscriptionPlans.tsx","../../src/components/PricingPage.tsx","../../src/components/OnboardingModal.jsx","../../src/components/SubscriptionSuccess.tsx","../../src/components/SubscriptionCancel.tsx","../../src/components/AvatarUpload.tsx","../../src/components/AccountSettings.tsx","../../src/components/NotFound.tsx","../../src/lib/market-insights.ts","../../src/components/MarketInsights.tsx","../../src/components/DataVisualization.tsx","../../src/components/MarketInsightsPage.tsx","../../src/lib/chat.ts","../../src/components/MarketTrends.tsx","../../src/components/ui/page-transition.tsx","../../src/components/MarketTrendsPage.tsx","../../src/components/ArticlePage.tsx","../../src/components/ResearchReports.tsx","../../src/lib/deals.ts","../../src/components/ui/skeleton.tsx","../../src/components/DealCard.tsx","../../src/components/ui/select.tsx","../../src/components/ResearchRequests.tsx","../../src/components/ResearchPage.tsx","../../src/components/BlogPage.tsx","../../src/components/HelpSupportPage.tsx","../../src/components/ChatBot.tsx","../../src/components/AuthCallback.tsx","../../src/components/PropertyManagementPage.tsx","../../src/components/ui/slider.tsx","../../src/lib/ai-utils.ts","../../src/components/InvestmentOpportunitiesPage.tsx","../../src/components/AboutUsPage.tsx","../../src/components/DealModal.tsx","../../src/components/DealsPage.tsx","../../src/pages/Messages.tsx","../../src/config.ts","../../src/lib/patmaService.ts","../../src/pages/Listings.tsx","../../src/components/calculators/MortgageCalculator.tsx","../../src/components/ui/checkbox.tsx","../../src/components/calculators/StampDutyCalculator.tsx","../../src/components/calculators/YieldCalculator.tsx","../../src/components/calculators/ROICalculator.tsx","../../src/components/calculators/AffordabilityCalculator.tsx","../../src/pages/Calculators.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["import { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\nexport function formatCurrency(amount: number): string {\n  return new Intl.NumberFormat('en-GB', {\n    style: 'currency',\n    currency: 'GBP',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0,\n  }).format(amount);\n}\n\n// Add any other utility functions you need\nexport function formatDate(date: string | Date): string {\n  return new Intl.DateTimeFormat('en-GB', {\n    day: 'numeric',\n    month: 'long',\n    year: 'numeric',\n  }).format(new Date(date));\n}\n\nexport function formatNumber(number: number): string {\n  return new Intl.NumberFormat('en-GB').format(number);\n}\n","import * as React from \"react\"\nimport { Cross2Icon } from \"@radix-ui/react-icons\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <Cross2Icon className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold [&+div]:text-xs\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","// Inspired by react-hot-toast library\nimport * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","import {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","import { createClient } from '@supabase/supabase-js';\n\n// Get the Supabase URL and key from environment variables\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\nconst supabaseKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\n\n// Validate that the environment variables are set\nif (!supabaseUrl || !supabaseKey) {\n  console.error('Supabase URL or key is missing from environment variables');\n}\n\n// Create the Supabase client\nexport const supabase = createClient(supabaseUrl, supabaseKey);\n\n// Export a function to check if a user is currently authenticated\nexport const isAuthenticated = async () => {\n  const { data } = await supabase.auth.getSession();\n  return !!data.session;\n};\n\n// Debug function to log the current user\nexport const debugCurrentUser = async () => {\n  try {\n    const { data } = await supabase.auth.getSession();\n    console.log('Current session:', data.session);\n    console.log('Current user:', data.session?.user);\n    return data.session?.user;\n  } catch (error) {\n    console.error('Error getting session:', error);\n    return null;\n  }\n}; ","import React, { useState, useEffect, createContext, useContext, ReactNode } from 'react';\nimport { supabase } from './supabaseClient';\nimport { User, Session } from '@supabase/supabase-js';\n\n// Define the types for our user profile\nexport type UserProfile = {\n  id: string;\n  full_name?: string | null;\n  email?: string | null;\n  created_at?: string;\n  role?: \"user\" | \"admin\" | \"moderator\" | null;\n  stripe_customer_id?: string | null;\n  subscription_status?: string | null;\n  subscription_tier?: \"free\" | \"basic\" | \"pro\" | \"premium\" | null;\n  updated_at?: string;\n  avatar_url?: string | null;\n};\n\n// Type for our auth context\ninterface AuthContextType {\n  user: User | null;\n  session: Session | null;\n  profile: UserProfile | null;\n  isLoading: boolean;\n  signOut: () => Promise<void>;\n  refreshSession: () => Promise<void>;\n}\n\n// Create the context with a default value\nconst AuthContext = createContext<AuthContextType>({\n  user: null,\n  session: null,\n  profile: null,\n  isLoading: true,\n  signOut: async () => {},\n  refreshSession: async () => {}\n});\n\n// Helper function to fetch user profile\nconst fetchProfile = async (userId: string): Promise<UserProfile | null> => {\n  try {\n    const { data, error } = await supabase\n      .from('profiles')\n      .select('*')\n      .eq('id', userId)\n      .single();\n\n    if (error) {\n      console.error('Error fetching profile:', error);\n      return null;\n    }\n\n    console.log('Fetched profile data:', data);\n    return data as UserProfile;\n  } catch (error) {\n    console.error('Error in fetchProfile:', error);\n    return null;\n  }\n};\n\n// Provider component\nexport const AuthProvider = ({ children }: { children: ReactNode }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [session, setSession] = useState<Session | null>(null);\n  const [profile, setProfile] = useState<UserProfile | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // Function to refresh the session and user data\n  const refreshSession = async () => {\n    try {\n      setIsLoading(true);\n      console.log('Refreshing session...');\n      \n      const { data, error } = await supabase.auth.getSession();\n      \n      if (error) {\n        throw error;\n      }\n      \n      console.log('Session data:', data);\n      setSession(data.session);\n      setUser(data.session?.user || null);\n      \n      if (data.session?.user) {\n        const profile = await fetchProfile(data.session.user.id);\n        setProfile(profile);\n      } else {\n        setProfile(null);\n      }\n    } catch (error) {\n      console.error('Error refreshing session:', error);\n      setUser(null);\n      setProfile(null);\n      setSession(null);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Sign out function\n  const signOut = async () => {\n    try {\n      setIsLoading(true);\n      const { error } = await supabase.auth.signOut();\n      if (error) {\n        throw error;\n      }\n      setUser(null);\n      setProfile(null);\n      setSession(null);\n    } catch (error) {\n      console.error('Error signing out:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Initialize and set up auth listener\n  useEffect(() => {\n    // First, get the current session\n    const initializeAuth = async () => {\n      setIsLoading(true);\n      console.log('Initializing auth...');\n      \n      try {\n        const { data, error } = await supabase.auth.getSession();\n        \n        if (error) {\n          throw error;\n        }\n        \n        console.log('Initial session data:', data);\n        setSession(data.session);\n        setUser(data.session?.user || null);\n        \n        if (data.session?.user) {\n          const profile = await fetchProfile(data.session.user.id);\n          setProfile(profile);\n        }\n      } catch (error) {\n        console.error('Error initializing auth:', error);\n      } finally {\n        setIsLoading(false);\n      }\n      \n      // Set up the auth state change listener\n      const { data } = supabase.auth.onAuthStateChange(async (event, session) => {\n        console.log('Auth state changed:', event, session);\n        setSession(session);\n        setUser(session?.user || null);\n        \n        if (session?.user) {\n          const profile = await fetchProfile(session.user.id);\n          setProfile(profile);\n        } else {\n          setProfile(null);\n        }\n      });\n      \n      // Return the unsubscribe function\n      return () => {\n        data.subscription.unsubscribe();\n      };\n    };\n\n    const unsubscribe = initializeAuth();\n    \n    // Cleanup\n    return () => {\n      unsubscribe.then(fn => fn && fn());\n    };\n  }, []);\n\n  // Create the context value\n  const contextValue = {\n    user,\n    session,\n    profile,\n    isLoading,\n    signOut,\n    refreshSession\n  };\n\n  return React.createElement(AuthContext.Provider, { value: contextValue }, children);\n};\n\n// Custom hook to use the auth context\nexport function useAuth() {\n  return useContext(AuthContext);\n} ","import * as React from \"react\"\nimport { cn } from \"@/lib/utils\" // Double-check this line!\n\nexport function Loading({ className }: { className?: string }) {\n  return (\n    <div className={cn(\"flex items-center justify-center\", className)}>\n      <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent\" />\n    </div>\n  )\n}\n","import React, { useEffect, useState } from 'react';\n// import NProgress from \"nprogress\"; // Remove this line\n// import \"nprogress/nprogress.css\"; // Also remove this line\n\n// NProgress.configure({ // Remove this block\n//   showSpinner: false,\n//   trickleSpeed: 200,\n//   minimum: 0.08,\n// });\n\ninterface ProgressBarProps {\n  isAnimating: boolean;\n}\n\nexport function ProgressBar({ isAnimating }: ProgressBarProps) {\n  const [progress, setProgress] = useState(0);\n\n  useEffect(() => {\n    if (!isAnimating) {\n      setProgress(0);\n      return;\n    }\n\n    // Start progress animation\n    setProgress(10);\n    \n    const timer1 = setTimeout(() => setProgress(30), 100);\n    const timer2 = setTimeout(() => setProgress(60), 500);\n    const timer3 = setTimeout(() => setProgress(80), 800);\n    const timer4 = setTimeout(() => setProgress(100), 1000);\n    \n    return () => {\n      clearTimeout(timer1);\n      clearTimeout(timer2);\n      clearTimeout(timer3);\n      clearTimeout(timer4);\n    };\n  }, [isAnimating]);\n\n  if (!isAnimating && progress === 0) return null;\n\n  return (\n    <div className=\"fixed top-0 left-0 right-0 z-50\">\n      <div \n        className=\"h-1 bg-primary transition-all duration-300 ease-in-out\"\n        style={{ \n          width: `${progress}%`,\n          opacity: progress === 100 ? 0 : 1\n        }}\n      />\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n);\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean;\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\";\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    );\n  },\n);\nButton.displayName = \"Button\";\n\nexport { Button, buttonVariants };\n","import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","import React from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { X } from \"lucide-react\";\nimport { Button } from \"./ui/button\";\nimport { cn } from \"../lib/utils\";\nimport { ScrollArea } from \"./ui/scroll-area\";\n\nexport function MobileNav({ isOpen, onClose, children }) {\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <>\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            transition={{ duration: 0.2 }}\n            className=\"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm lg:hidden\"\n            onClick={onClose}\n            style={{ width: '100vw' }}\n          />\n          <motion.div\n            initial={{ x: \"100%\" }}\n            animate={{ x: 0 }}\n            exit={{ x: \"100%\" }}\n            transition={{ type: \"spring\", damping: 20, stiffness: 300 }}\n            className={cn(\n              \"fixed inset-y-0 right-0 z-50 w-full max-w-xs bg-white shadow-2xl lg:hidden\",\n              \"flex flex-col\"\n            )}\n          >\n            <div className=\"flex h-16 items-center justify-between border-b px-6\">\n              <a href=\"/\" className=\"hover:opacity-80 transition-opacity\">\n                <img\n                  src=\"https://i.postimg.cc/GpdY6N74/my-1920-x-1080-px-1.png\"\n                  alt=\"MyVGE\"\n                  className=\"h-8\"\n                />\n              </a>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"h-10 w-10 rounded-full hover:bg-muted\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onClose();\n                }}\n              >\n                <X className=\"h-5 w-5\" />\n              </Button>\n            </div>\n            <ScrollArea className=\"flex-1\">\n              <div className=\"flex flex-col p-6 pb-16\">\n                <div className=\"flex-1\">{children}</div>\n                <div className=\"mt-auto pt-6\">\n                  <p className=\"text-sm text-muted-foreground text-center\">\n                    © {new Date().getFullYear()} MyVGE. All rights reserved.\n                  </p>\n                </div>\n              </div>\n            </ScrollArea>\n          </motion.div>\n        </>\n      )}\n    </AnimatePresence>\n  );\n}\n","import * as React from \"react\";\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\";\nimport { cva } from \"class-variance-authority\";\nimport { ChevronDown } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className,\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n));\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName;\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className,\n    )}\n    {...props}\n  />\n));\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName;\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item;\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50\",\n);\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n));\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName;\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className,\n    )}\n    {...props}\n  />\n));\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName;\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link;\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className,\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n));\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName;\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className,\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n));\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName;\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n};\n","import * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport {\n  CheckIcon,\n  ChevronRightIcon,\n  DotFilledIcon,\n} from \"@radix-ui/react-icons\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRightIcon className=\"ml-auto h-4 w-4\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <CheckIcon className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <DotFilledIcon className=\"h-4 w-4 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { Cross2Icon } from \"@radix-ui/react-icons\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <Cross2Icon className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport interface InputProps\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","import React, { useState } from 'react';\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogFooter } from '../ui/dialog';\nimport { Button } from '../ui/button';\nimport { Input } from '../ui/input';\nimport { Label } from '../ui/label';\nimport { useToast } from '../ui/use-toast';\nimport { supabase } from '../../lib/supabaseClient';\n\ninterface LoginModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nexport function LoginModal({ isOpen, onClose, onSuccess }: LoginModalProps) {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const { toast } = useToast();\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    try {\n      console.log(\"Attempting login with:\", email);\n      \n      // Sign in with Supabase\n      const { data, error } = await supabase.auth.signInWithPassword({\n        email,\n        password\n      });\n      \n      if (error) {\n        console.error(\"Supabase auth error:\", error);\n        throw error;\n      }\n      \n      console.log(\"Login successful:\", data);\n\n      toast({\n        title: \"Success\",\n        description: \"You have successfully logged in.\",\n      });\n\n      // Close modal\n      onClose();\n      \n      // This is crucial: complete page reload to ensure auth state is fresh\n      setTimeout(() => {\n        if (onSuccess) {\n          onSuccess();\n        }\n        \n        // Force a complete page reload to refresh all auth states\n        window.location.href = window.location.pathname;\n      }, 300);\n      \n    } catch (error: any) {\n      console.error('Login error:', error);\n      toast({\n        variant: \"destructive\",\n        title: \"Login failed\",\n        description: error.message || \"Please check your credentials and try again.\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-[425px]\">\n        <DialogHeader>\n          <DialogTitle>Login</DialogTitle>\n          <DialogDescription>\n            Enter your credentials to access your account.\n          </DialogDescription>\n        </DialogHeader>\n        <form onSubmit={handleLogin}>\n          <div className=\"grid gap-4 py-4\">\n            <div className=\"grid gap-2\">\n              <Label htmlFor=\"email\">Email</Label>\n              <Input\n                id=\"email\"\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                placeholder=\"your.email@example.com\"\n                autoComplete=\"email\"\n                required\n              />\n            </div>\n            <div className=\"grid gap-2\">\n              <Label htmlFor=\"password\">Password</Label>\n              <Input\n                id=\"password\"\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                autoComplete=\"current-password\"\n                required\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button type=\"submit\" disabled={isLoading}>\n              {isLoading ? 'Logging in...' : 'Login'}\n            </Button>\n          </DialogFooter>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n} ","import React from \"react\";\nimport { Button } from \"./ui/button\";\nimport { LogIn, Menu, MessageCircle } from \"lucide-react\";\nimport { MobileNav } from \"./MobileNav\";\nimport {\n  NavigationMenu,\n  NavigationMenuContent,\n  NavigationMenuItem,\n  NavigationMenuLink,\n  NavigationMenuList,\n  NavigationMenuTrigger,\n} from \"./ui/navigation-menu\";\nimport { cn } from \"../lib/utils\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../lib/auth\";\nimport {\n  UserPlus,\n  LogOut,\n  Settings,\n  LayoutDashboard,\n  Crown,\n} from \"lucide-react\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"../components/ui/avatar\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"./ui/dropdown-menu\";\nimport { LoginModal } from './auth/LoginModal';\n\ninterface HeaderProps {\n  isAuthenticated?: boolean;\n  onSignIn?: () => void;\n  onSignUp?: () => void;\n  onSignOut?: () => Promise<void>;\n  userProfile?: {\n    full_name?: string | null;\n    email?: string | null;\n    created_at?: string;\n    id?: string;\n    role?: \"user\" | \"admin\" | \"moderator\" | null;\n    stripe_customer_id?: string | null;\n    subscription_status?: string | null;\n    subscription_tier?: \"free\" | \"basic\" | \"pro\" | \"premium\" | null;\n    updated_at?: string;\n  };\n}\n\nconst MobileNavLinks = [\n  {\n    title: \"Investment Deals\",\n    href: \"/deals\",\n    icon: \"💼\",\n    requiresAuth: true\n  },\n  {\n    title: \"Listings\",\n    href: \"/listings\",\n    icon: \"🏠\",\n    requiresAuth: false\n  },\n  {\n    title: \"Market\",\n    items: [\n      { title: \"Market Trends\", href: \"/trends\", description: \"Stay updated with the latest real estate market trends\", requiresAuth: true },\n      { title: \"Market Insights\", href: \"/insights\", description: \"Deep dive into property market analytics\", requiresAuth: true },\n      { title: \"Research & Reports\", href: \"/research\", description: \"Access expert analysis and reports\", requiresAuth: false }\n    ],\n    icon: \"📊\"\n  },\n  {\n    title: \"Services\",\n    items: [\n      { title: \"Property Management\", href: \"/property-management\", description: \"Let us take care of your property\", requiresAuth: true },\n      { title: \"Investment Opportunities\", href: \"/investment-opportunities\", description: \"Discover tailored investment strategies\", requiresAuth: true },\n      { title: \"Calculators\", href: \"/calculators\", description: \"Calculate your property investment\", requiresAuth: false }\n    ],\n    icon: \"🏠\"\n  },\n  {\n    title: \"Messages\",\n    href: \"/messages\",\n    icon: \"💬\",\n    requiresAuth: true\n  },\n  {\n    title: \"Pricing\",\n    href: \"/pricing\",\n    icon: \"💎\",\n    requiresAuth: false\n  },\n  {\n    title: \"Support\",\n    href: \"/help\",\n    icon: \"❓\",\n    requiresAuth: false\n  },\n  {\n    title: \"About Us\",\n    href: \"/about-us\",\n    icon: \"ℹ️\",\n    requiresAuth: false\n  }\n];\n\nexport default function Header({\n  isAuthenticated = false,\n  onSignIn,\n  onSignUp,\n  userProfile = {},\n  onSignOut\n}: HeaderProps) {\n  const [showMobileMenu, setShowMobileMenu] = React.useState(false);\n  const [isScrolled, setIsScrolled] = React.useState(false);\n  const [loginModalOpen, setLoginModalOpen] = React.useState(false);\n  const navigate = useNavigate();\n  const auth = useAuth();\n  \n  // Prioritize props but fallback to global auth context if not provided\n  const actualIsAuthenticated = isAuthenticated || !!auth.user;\n  const actualUserProfile = userProfile && Object.keys(userProfile).length > 0 ? userProfile : auth.profile;\n  const actualSignOut = onSignOut || auth.signOut;\n\n  // Add scroll listener\n  React.useEffect(() => {\n    const handleScroll = () => {\n      setIsScrolled(window.scrollY > 20);\n    };\n    window.addEventListener('scroll', handleScroll);\n    return () => window.removeEventListener('scroll', handleScroll);\n  }, []);\n\n  // Handle login click\n  const handleLoginClick = (e: React.MouseEvent) => {\n    e.preventDefault();\n    setLoginModalOpen(true);\n  };\n\n  // Handle sign out with proper page refresh\n  const handleSignOut = async () => {\n    console.log(\"Sign out button clicked\");\n    try {\n      await actualSignOut();\n      // Force page reload to ensure auth state is completely reset\n      window.location.href = \"/\";\n    } catch (error) {\n      console.error(\"Error signing out:\", error);\n    }\n  };\n\n  // Handle click on mobile nav link\n  const handleMobileNavLinkClick = (e: React.MouseEvent<HTMLAnchorElement>, requiresAuth: boolean, href: string) => {\n    // If link requires auth and user is not authenticated, prevent default and show login modal\n    if (requiresAuth && !actualIsAuthenticated) {\n      e.preventDefault();\n      setLoginModalOpen(true);\n      setShowMobileMenu(false); // Close mobile menu when opening login modal\n    } else {\n      // If user is authenticated or link doesn't require auth, just navigate normally\n      setShowMobileMenu(false);\n    }\n  };\n\n  const ListItem = React.forwardRef<\n    React.ElementRef<\"a\">,\n    React.ComponentPropsWithoutRef<\"a\"> & {\n      title: string;\n    }\n  >(({ className, title, children, ...props }, ref) => {\n    return (\n      <li>\n        <NavigationMenuLink asChild>\n          <a\n            ref={ref}\n            className={cn(\n              \"block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground\",\n              className ?? \"\"\n            )}\n            {...props}\n          >\n            <div className=\"text-sm font-medium leading-none\">{title}</div>\n            <p className=\"line-clamp-2 text-sm leading-snug text-muted-foreground\">\n              {children}\n            </p>\n          </a>\n        </NavigationMenuLink>\n      </li>\n    );\n  });\n  ListItem.displayName = \"ListItem\";\n\n  return (\n    <>\n      <header \n        className={cn(\n          \"fixed top-0 left-0 right-0 z-50 transition-all duration-300\",\n          isScrolled ? \"py-2\" : \"py-4\"\n        )}\n      >\n        <div className=\"px-4 mx-auto max-w-7xl\">\n          <div className={cn(\n            \"rounded-full bg-white border transition-all duration-300\",\n            isScrolled \n              ? \"shadow-md border-gray-200/50 backdrop-blur-md bg-white/90\" \n              : \"shadow-sm border-transparent\"\n          )}>\n            <div className=\"h-16 px-6 flex items-center justify-between\">\n              {/* Logo */}\n              <div className=\"flex items-center gap-8\">\n                <a href=\"/\" className=\"hover:opacity-80 transition-opacity\">\n                  <img\n                    src=\"https://i.postimg.cc/GpdY6N74/my-1920-x-1080-px-1.png\"\n                    alt=\"MyVGE\"\n                    className=\"h-8\"\n                  />\n                </a>\n\n                {/* Desktop Navigation */}\n                <NavigationMenu className=\"hidden lg:flex\">\n                  <NavigationMenuList className=\"gap-2\">\n                    <NavigationMenuItem>\n                      <NavigationMenuTrigger \n                        className={cn(\n                          \"text-sm font-medium rounded-full px-4\",\n                          \"bg-transparent hover:bg-gray-100 transition-colors\",\n                          \"data-[state=open]:bg-gray-100\"\n                        )}\n                      >\n                      Market\n                    </NavigationMenuTrigger>\n                    <NavigationMenuContent>\n                        <ul className=\"w-[400px] gap-3 p-4 rounded-2xl\">\n                          {actualIsAuthenticated ? (\n                            <>\n                        <ListItem href=\"/trends\" title=\"Market Trends\">\n                          Stay updated with the latest real estate market trends.\n                        </ListItem>\n                        <ListItem href=\"/insights\" title=\"Market Insights\">\n                          Deep dive into property market analytics and forecasts.\n                        </ListItem>\n                            </>\n                          ) : (\n                            <>\n                              <ListItem \n                                href=\"#\" \n                                onClick={handleLoginClick} \n                                title=\"Market Trends\"\n                              >\n                                Sign in to access market trends.\n                              </ListItem>\n                              <ListItem \n                                href=\"#\" \n                                onClick={handleLoginClick} \n                                title=\"Market Insights\"\n                              >\n                                Sign in to access market insights.\n                              </ListItem>\n                            </>\n                          )}\n                        <ListItem href=\"/research\" title=\"Research & Reports\">\n                          Access expert analysis and reports.\n                        </ListItem>\n                      </ul>\n                    </NavigationMenuContent>\n                  </NavigationMenuItem>\n\n                  <NavigationMenuItem>\n                    <NavigationMenuLink\n                        className={cn(\n                          \"text-sm font-medium rounded-full px-4 py-2\",\n                          \"hover:bg-gray-100 transition-colors\"\n                        )}\n                      href=\"/deals\"\n                    >\n                      Deals\n                    </NavigationMenuLink>\n                  </NavigationMenuItem>\n\n                  <NavigationMenuItem>\n                      <NavigationMenuLink\n                        className={cn(\n                          \"text-sm font-medium rounded-full px-4 py-2\",\n                          \"hover:bg-gray-100 transition-colors\"\n                        )}\n                        href=\"/listings\"\n                      >\n                        Listings\n                      </NavigationMenuLink>\n                    </NavigationMenuItem>\n\n                    <NavigationMenuItem>\n                      <NavigationMenuTrigger \n                        className={cn(\n                          \"text-sm font-medium rounded-full px-4\",\n                          \"bg-transparent hover:bg-gray-100 transition-colors\",\n                          \"data-[state=open]:bg-gray-100\"\n                        )}\n                      >\n                      Services\n                    </NavigationMenuTrigger>\n                    <NavigationMenuContent>\n                        <ul className=\"w-[400px] gap-3 p-4 rounded-2xl\">\n                        <ListItem href=\"/property-management\" title=\"Property Management\">\n                          Let us take care of your property.\n                        </ListItem>\n                        <ListItem href=\"/investment-opportunities\" title=\"Investment Opportunities\">\n                          Discover tailored investment strategies.\n                        </ListItem>\n                        <ListItem href=\"/calculators\" title=\"Calculators\">\n                          Calculate different aspects of your property investment.\n                        </ListItem>\n                      </ul>\n                    </NavigationMenuContent>\n                  </NavigationMenuItem>\n\n                  <NavigationMenuItem>\n                    <NavigationMenuLink\n                        className={cn(\n                          \"text-sm font-medium rounded-full px-4 py-2\",\n                          \"hover:bg-gray-100 transition-colors\"\n                        )}\n                      href=\"/pricing\"\n                    >\n                      Pricing\n                    </NavigationMenuLink>\n                  </NavigationMenuItem>\n                </NavigationMenuList>\n              </NavigationMenu>\n              </div>\n\n              {/* Right Side Actions */}\n              <div className=\"flex items-center gap-2\">\n                {/* Help & Support + About Us - Only show on desktop and when there's enough space */}\n                <nav className=\"hidden lg:flex items-center gap-2\">\n                  <a \n                    href=\"/help\"\n                    className={cn(\n                      \"text-sm font-medium rounded-full px-4 py-2\",\n                      \"hover:bg-gray-100 transition-colors\"\n                    )}\n                  >\n                    Support\n                  </a>\n                  <a \n                    href=\"/about-us\"\n                    className={cn(\n                      \"text-sm font-medium rounded-full px-4 py-2\",\n                      \"hover:bg-gray-100 transition-colors\"\n                    )}\n                  >\n                    About Us\n                  </a>\n                </nav>\n\n                {/* Upgrade Button - Only show on tablet and larger screens */}\n                <Button\n                  variant=\"ghost\"\n                  className=\"hidden md:flex bg-gradient-to-r from-emerald-400 to-cyan-400 text-white hover:from-emerald-500 hover:to-cyan-500 rounded-full border border-emerald-500/20 shadow-lg hover:shadow-emerald-500/20 transition-all duration-300\"\n                  onClick={() => navigate(\"/pricing\")}\n                >\n                  <Crown className=\"mr-2 h-4 w-4\" />\n                  Upgrade\n                </Button>\n\n                {/* Auth Buttons or User Menu */}\n                <div className=\"flex items-center\">\n                  {!actualIsAuthenticated ? (\n                    <div className=\"hidden md:flex items-center gap-2\">\n                      <Button \n                        variant=\"ghost\" \n                        onClick={handleLoginClick} \n                        className=\"rounded-full hover:bg-gray-100\"\n                      >\n                        <LogIn className=\"mr-2 h-4 w-4\" />\n                        Sign In\n                      </Button>\n                      <Button \n                        onClick={() => onSignUp?.()} \n                        className=\"rounded-full bg-black text-white hover:bg-gray-800\"\n                      >\n                        <UserPlus className=\"mr-2 h-4 w-4\" />\n                        Sign Up\n                      </Button>\n                    </div>\n                  ) : (\n                    <DropdownMenu>\n                      <DropdownMenuTrigger asChild>\n                        <Button\n                          variant=\"ghost\"\n                          className=\"relative h-10 w-10 rounded-full\"\n                        >\n                          <Avatar className=\"h-10 w-10\">\n                            <AvatarImage\n                              src={`https://ui-avatars.com/api/?name=${encodeURIComponent(actualUserProfile?.full_name || \"\")}&background=random`}\n                              alt={actualUserProfile?.full_name || \"User avatar\"}\n                            />\n                            <AvatarFallback className=\"bg-primary/10\">\n                              {actualUserProfile?.full_name\n                                ?.split(\" \")\n                                .filter(Boolean)\n                                .map((n) => n[0])\n                                .slice(0, 2)\n                                .join(\"\")\n                                .toUpperCase() || \"U\"}\n                            </AvatarFallback>\n                          </Avatar>\n                        </Button>\n                      </DropdownMenuTrigger>\n                      <DropdownMenuContent \n                        className=\"w-56 mt-2 bg-white border border-gray-200 rounded-2xl shadow-lg\" \n                        align=\"end\" \n                        forceMount\n                      >\n                        <DropdownMenuItem className=\"flex-col items-start\">\n                          <div className=\"font-medium\">\n                            {actualUserProfile?.full_name}\n                          </div>\n                          <div className=\"text-sm text-muted-foreground\">\n                            {actualUserProfile?.email}\n                          </div>\n                        </DropdownMenuItem>\n                        <DropdownMenuSeparator />\n                        <DropdownMenuItem onClick={() => navigate(\"/dashboard\")}>\n                          <LayoutDashboard className=\"mr-2 h-4 w-4\" />\n                          <span>Dashboard</span>\n                        </DropdownMenuItem>\n                        <DropdownMenuItem onClick={() => navigate(\"/account\")}>\n                          <Settings className=\"mr-2 h-4 w-4\" />\n                          <span>Account Settings</span>\n                        </DropdownMenuItem>\n                        <DropdownMenuItem onClick={() => navigate(\"/messages\")}>\n                          <MessageCircle className=\"mr-2 h-4 w-4\" />\n                          <span>Messages</span>\n                        </DropdownMenuItem>\n                        <DropdownMenuSeparator />\n                        <DropdownMenuItem \n                          className=\"text-red-500 focus:text-red-500\" \n                          onClick={handleSignOut}\n                        >\n                          <LogOut className=\"mr-2 h-4 w-4\" />\n                          <span>Log Out</span>\n                        </DropdownMenuItem>\n                      </DropdownMenuContent>\n                    </DropdownMenu>\n                  )}\n                  \n                  {/* Mobile Menu Button - Move closer to avatar */}\n                  <Button\n                    variant=\"ghost\"\n                    className=\"lg:hidden p-2 ml-2\"\n                    onClick={() => setShowMobileMenu(true)}\n                  >\n                    <Menu className=\"h-6 w-6\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* Mobile Navigation */}\n      <MobileNav\n        isOpen={showMobileMenu}\n        onClose={() => setShowMobileMenu(false)}\n      >\n        <nav className=\"space-y-6\">\n          {actualIsAuthenticated && (\n            <div className=\"space-y-4 mb-6\">\n              <div className=\"flex items-center space-x-3 px-2\">\n                <Avatar className=\"h-10 w-10\">\n                  <AvatarImage\n                    src={`https://ui-avatars.com/api/?name=${encodeURIComponent(actualUserProfile?.full_name || \"\")}&background=random`}\n                    alt={actualUserProfile?.full_name || \"User avatar\"}\n                  />\n                  <AvatarFallback className=\"bg-primary/10\">\n                    {actualUserProfile?.full_name\n                      ?.split(\" \")\n                      .filter(Boolean)\n                      .map((n) => n[0])\n                      .slice(0, 2)\n                      .join(\"\")\n                      .toUpperCase() || \"U\"}\n                  </AvatarFallback>\n                </Avatar>\n                <div className=\"flex-1 overflow-hidden\">\n                  <p className=\"text-sm font-medium leading-none truncate\">\n                    {actualUserProfile?.full_name}\n                  </p>\n                  <p className=\"text-sm text-muted-foreground truncate\">\n                    {actualUserProfile?.email}\n                  </p>\n                </div>\n              </div>\n              <div className=\"grid grid-cols-2 gap-2\">\n                <Button\n                  variant=\"outline\"\n                  className=\"justify-center rounded-full\"\n                  onClick={() => {\n                    navigate('/dashboard');\n                    setShowMobileMenu(false);\n                  }}\n                >\n                  <LayoutDashboard className=\"mr-2 h-4 w-4\" />\n                  Dashboard\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"justify-center rounded-full\"\n                  onClick={() => {\n                    navigate('/account');\n                    setShowMobileMenu(false);\n                  }}\n                >\n                  <Settings className=\"mr-2 h-4 w-4\" />\n                  Account\n                </Button>\n              </div>\n              <div className=\"border-b border-border\" />\n            </div>\n          )}\n\n          {MobileNavLinks.map((item, index) => (\n            <div key={index} className=\"space-y-3\">\n              {item.href ? (\n                <a\n                  href={item.href}\n                  className={cn(\n                    \"flex items-center space-x-3 text-lg font-medium transition-colors\",\n                    (!item.requiresAuth || actualIsAuthenticated) \n                      ? \"hover:text-primary\" \n                      : \"text-muted-foreground hover:text-primary/70\"\n                  )}\n                  onClick={(e) => handleMobileNavLinkClick(e, item.requiresAuth, item.href)}\n                >\n                  <span className=\"text-xl\">{item.icon}</span>\n                  <span>{item.title}</span>\n                  {item.requiresAuth && !actualIsAuthenticated && (\n                    <span className=\"ml-2 text-xs text-muted-foreground\">(Sign in required)</span>\n                  )}\n                </a>\n              ) : (\n                <>\n                  <div className=\"flex items-center space-x-3 text-lg font-medium\">\n                    <span className=\"text-xl\">{item.icon}</span>\n                    <span>{item.title}</span>\n                  </div>\n                  <div className=\"space-y-3 pl-9\">\n                    {item.items?.map((subItem, subIndex) => (\n                      <a\n                        key={subIndex}\n                        href={subItem.href}\n                        className={cn(\n                          \"block text-base transition-colors\",\n                          (!subItem.requiresAuth || actualIsAuthenticated) \n                            ? \"text-muted-foreground hover:text-primary\" \n                            : \"text-muted-foreground/70 hover:text-primary/70\"\n                        )}\n                        onClick={(e) => handleMobileNavLinkClick(e, subItem.requiresAuth, subItem.href)}\n                      >\n                        {subItem.title}\n                        {subItem.requiresAuth && !actualIsAuthenticated && (\n                          <span className=\"ml-2 text-xs text-muted-foreground\">(Sign in required)</span>\n                        )}\n                      </a>\n                    ))}\n                  </div>\n                </>\n              )}\n            </div>\n          ))}\n\n          {!actualIsAuthenticated ? (\n            <div className=\"space-y-4 pt-6\">\n              <Button\n                variant=\"outline\"\n                className=\"w-full justify-center rounded-full\"\n                onClick={handleLoginClick}\n              >\n                <LogIn className=\"mr-2 h-4 w-4\" />\n                Sign In\n              </Button>\n              <Button\n                className=\"w-full justify-center rounded-full bg-gradient-to-r from-emerald-400 to-cyan-400 text-white hover:from-emerald-500 hover:to-cyan-500\"\n                onClick={() => {\n                  onSignUp?.();\n                  setShowMobileMenu(false);\n                }}\n              >\n                <UserPlus className=\"mr-2 h-4 w-4\" />\n                Sign Up\n              </Button>\n            </div>\n          ) : (\n            <div className=\"pt-6\">\n              <Button\n                variant=\"outline\"\n                className=\"w-full justify-center rounded-full text-red-500 hover:text-red-600 hover:bg-red-50\"\n                onClick={handleSignOut}\n              >\n                <LogOut className=\"mr-2 h-4 w-4\" />\n                Log Out\n              </Button>\n            </div>\n          )}\n        </nav>\n      </MobileNav>\n\n      <LoginModal \n        isOpen={loginModalOpen}\n        onClose={() => setLoginModalOpen(false)}\n        onSuccess={() => {\n          setLoginModalOpen(false);\n          // Force a reload for the header to recognize the auth state\n          window.location.reload();\n        }}\n      />\n    </>\n  );\n}\n","import { useSprings, animated, SpringConfig } from '@react-spring/web';\nimport { useEffect, useRef, useState } from 'react';\n\ninterface SplitTextProps {\n    text?: string;\n    className?: string;\n    delay?: number;\n    animationFrom?: { opacity: number; transform: string };\n    animationTo?: { opacity: number; transform: string };\n    easing?: SpringConfig['easing'];\n    threshold?: number;\n    rootMargin?: string;\n    textAlign?: 'left' | 'right' | 'center' | 'justify' | 'start' | 'end';\n    onLetterAnimationComplete?: () => void;\n}\n\nconst SplitText: React.FC<SplitTextProps> = ({\n    text = '',\n    className = '',\n    delay = 100,\n    animationFrom = { opacity: 0, transform: 'translate3d(0,40px,0)' },\n    animationTo = { opacity: 1, transform: 'translate3d(0,0,0)' },\n    easing = (t: number) => t,\n    threshold = 0.1,\n    rootMargin = '-100px',\n    textAlign = 'center',\n    onLetterAnimationComplete,\n}) => {\n    const words = text.split(' ').map(word => word.split(''));\n    const letters = words.flat();\n    const [inView, setInView] = useState(false);\n    const ref = useRef<HTMLParagraphElement>(null);\n    const animatedCount = useRef(0);\n\n    useEffect(() => {\n        const observer = new IntersectionObserver(\n            ([entry]) => {\n                if (entry.isIntersecting) {\n                    setInView(true);\n                    if (ref.current) {\n                        observer.unobserve(ref.current);\n                    }\n                }\n            },\n            { threshold, rootMargin }\n        );\n\n        if (ref.current) {\n            observer.observe(ref.current);\n        }\n\n        return () => observer.disconnect();\n    }, [threshold, rootMargin]);\n\n    const springs = useSprings(\n        letters.length,\n        letters.map((_, i) => ({\n            from: animationFrom,\n            to: inView\n                ? async (next: (props: any) => Promise<void>) => {\n                    await next(animationTo);\n                    animatedCount.current += 1;\n                    if (animatedCount.current === letters.length && onLetterAnimationComplete) {\n                        onLetterAnimationComplete();\n                    }\n                }\n                : animationFrom,\n            delay: i * delay,\n            config: { easing },\n        }))\n    );\n\n    return (\n        <p\n            ref={ref}\n            className={`split-parent overflow-hidden inline ${className}`}\n            style={{ textAlign, whiteSpace: 'normal', wordWrap: 'break-word' }}\n        >\n            {words.map((word, wordIndex) => (\n                <span key={wordIndex} style={{ display: 'inline-block', whiteSpace: 'nowrap' }}>\n                    {word.map((letter, letterIndex) => {\n                        const index = words\n                            .slice(0, wordIndex)\n                            .reduce((acc, w) => acc + w.length, 0) + letterIndex;\n\n                        return (\n                            <animated.span\n                                key={index}\n                                style={springs[index] as unknown as React.CSSProperties}\n                                className=\"inline-block transform transition-opacity will-change-transform\"\n                            >\n                                {letter}\n                            </animated.span>\n                        );\n                    })}\n                    <span style={{ display: 'inline-block', width: '0.3em' }}>&nbsp;</span>\n                </span>\n            ))}\n        </p>\n    );\n};\n\nexport default SplitText; ","import { useEffect, useRef } from \"react\";\nimport { Renderer, Program, Mesh, Color, Triangle } from \"ogl\";\n\nconst VERT = `#version 300 es\nin vec2 position;\nvoid main() {\n  gl_Position = vec4(position, 0.0, 1.0);\n}\n`;\n\nconst FRAG = `#version 300 es\nprecision highp float;\n\nuniform float uTime;\nuniform float uAmplitude;\nuniform vec3 uColorStops[3];\nuniform vec2 uResolution;\nuniform float uBlend;\n\nout vec4 fragColor;\n\nvec3 permute(vec3 x) {\n  return mod(((x * 34.0) + 1.0) * x, 289.0);\n}\n\nfloat snoise(vec2 v){\n  const vec4 C = vec4(\n      0.211324865405187, 0.366025403784439,\n      -0.577350269189626, 0.024390243902439\n  );\n  vec2 i  = floor(v + dot(v, C.yy));\n  vec2 x0 = v - i + dot(i, C.xx);\n  vec2 i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n  i = mod(i, 289.0);\n\n  vec3 p = permute(\n      permute(i.y + vec3(0.0, i1.y, 1.0))\n    + i.x + vec3(0.0, i1.x, 1.0)\n  );\n\n  vec3 m = max(\n      0.5 - vec3(\n          dot(x0, x0),\n          dot(x12.xy, x12.xy),\n          dot(x12.zw, x12.zw)\n      ), \n      0.0\n  );\n  m = m * m;\n  m = m * m;\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n  m *= 1.79284291400159 - 0.85373472095314 * (a0*a0 + h*h);\n\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\nstruct ColorStop {\n  vec3 color;\n  float position;\n};\n\n#define COLOR_RAMP(colors, factor, finalColor) {              \\\n  int index = 0;                                            \\\n  for (int i = 0; i < 2; i++) {                               \\\n     ColorStop currentColor = colors[i];                    \\\n     bool isInBetween = currentColor.position <= factor;    \\\n     index = int(mix(float(index), float(i), float(isInBetween))); \\\n  }                                                         \\\n  ColorStop currentColor = colors[index];                   \\\n  ColorStop nextColor = colors[index + 1];                  \\\n  float range = nextColor.position - currentColor.position; \\\n  float lerpFactor = (factor - currentColor.position) / range; \\\n  finalColor = mix(currentColor.color, nextColor.color, lerpFactor); \\\n}\n\nvoid main() {\n  vec2 uv = gl_FragCoord.xy / uResolution;\n  \n  ColorStop colors[3];\n  colors[0] = ColorStop(uColorStops[0], 0.0);\n  colors[1] = ColorStop(uColorStops[1], 0.5);\n  colors[2] = ColorStop(uColorStops[2], 1.0);\n  \n  vec3 rampColor;\n  COLOR_RAMP(colors, uv.x, rampColor);\n  \n  float height = snoise(vec2(uv.x * 2.0 + uTime * 0.1, uTime * 0.25)) * 0.5 * uAmplitude;\n  height = exp(height);\n  height = (uv.y * 2.0 - height + 0.2);\n  float intensity = 0.6 * height;\n  \n  float midPoint = 0.20;\n  float auroraAlpha = smoothstep(midPoint - uBlend * 0.5, midPoint + uBlend * 0.5, intensity);\n  \n  vec3 auroraColor = intensity * rampColor;\n  \n  fragColor = vec4(auroraColor * auroraAlpha, auroraAlpha);\n}\n`;\n\ninterface AuroraProps {\n  colorStops?: string[];\n  amplitude?: number;\n  blend?: number;\n  time?: number;\n  speed?: number;\n}\n\nconst Aurora = (props: AuroraProps) => {\n  const {\n    colorStops = [\"#00d8ff\", \"#7cff67\", \"#00d8ff\"],\n    amplitude = 1.0,\n    blend = 0.5,\n  } = props;\n  const propsRef = useRef<AuroraProps>(props);\n  propsRef.current = props;\n\n  const ctnDom = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const ctn = ctnDom.current;\n    if (!ctn) return;\n\n    const renderer = new Renderer({\n      alpha: true,\n      premultipliedAlpha: true,\n      antialias: true,\n    });\n    const gl = renderer.gl;\n    gl.clearColor(0, 0, 0, 0);\n    gl.enable(gl.BLEND);\n    gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n    gl.canvas.style.backgroundColor = \"transparent\";\n\n    let program: Program | undefined;\n\n    function resize() {\n      if (!ctn) return;\n      const width = ctn.offsetWidth;\n      const height = ctn.offsetHeight;\n      renderer.setSize(width, height);\n      if (program) {\n        program.uniforms.uResolution.value = [width, height];\n      }\n    }\n    window.addEventListener(\"resize\", resize);\n\n    const geometry = new Triangle(gl);\n    if (geometry.attributes.uv) {\n      delete (geometry.attributes as any).uv;\n    }\n\n    const colorStopsArray = colorStops.map((hex) => {\n      const c = new Color(hex);\n      return [c.r, c.g, c.b];\n    });\n\n    program = new Program(gl, {\n      vertex: VERT,\n      fragment: FRAG,\n      uniforms: {\n        uTime: { value: 0 },\n        uAmplitude: { value: amplitude },\n        uColorStops: { value: colorStopsArray },\n        uResolution: { value: [ctn.offsetWidth, ctn.offsetHeight] },\n        uBlend: { value: blend },\n      },\n    });\n\n    const mesh = new Mesh(gl, { geometry, program });\n    ctn.appendChild(gl.canvas);\n\n    let animateId = 0;\n    const update = (t: number) => {\n      animateId = requestAnimationFrame(update);\n      const { time = t * 0.01, speed = 1.0 } = propsRef.current;\n      if (program) {\n        program.uniforms.uTime.value = time * speed * 0.1;\n        program.uniforms.uAmplitude.value = propsRef.current.amplitude ?? 1.0;\n        program.uniforms.uBlend.value = propsRef.current.blend ?? blend;\n        const stops = propsRef.current.colorStops ?? colorStops;\n        program.uniforms.uColorStops.value = stops.map((hex: string) => {\n          const c = new Color(hex);\n          return [c.r, c.g, c.b];\n        });\n        renderer.render({ scene: mesh });\n      }\n    };\n    animateId = requestAnimationFrame(update);\n\n    resize();\n\n    return () => {\n      cancelAnimationFrame(animateId);\n      window.removeEventListener(\"resize\", resize);\n      if (ctn && gl.canvas.parentNode === ctn) {\n        ctn.removeChild(gl.canvas);\n      }\n      gl.getExtension(\"WEBGL_lose_context\")?.loseContext();\n    };\n  }, [amplitude]);\n\n  return <div ref={ctnDom} className=\"w-full h-full\" />;\n};\n\nexport default Aurora; ","import React from \"react\";\nimport { Input } from \"./ui/input\";\nimport { Button } from \"./ui/button\";\nimport { Search } from \"lucide-react\";\nimport SplitText from \"./ui/SplitText\";\nimport Aurora from \"./ui/Aurora\";\n\ninterface HeroSectionProps {\n  onSearch?: (term: string) => void;\n  title?: string;\n  subtitle?: string;\n  showSearch?: boolean;\n  showStats?: boolean;\n  height?: string;\n  image?: string;\n}\n\nconst HeroSection: React.FC<HeroSectionProps> = ({\n  onSearch = () => {},\n  title = \"Find Your Next Investment Property\",\n  subtitle = \"Search through our curated selection of properties\",\n  showSearch = true,\n  showStats = true,\n  height = \"h-[500px]\",\n  image\n}: HeroSectionProps) => {\n  const [searchTerm, setSearchTerm] = React.useState(\"\");\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSearch(searchTerm);\n  };\n\n  const handleAnimationComplete = () => {\n    console.log('Hero text animation completed!');\n  };\n\n  return (\n    <div className={`relative w-full ${height} bg-gray-900 overflow-hidden`}>\n      {/* Aurora Background */}\n      <div className=\"absolute inset-0\">\n        <Aurora\n          colorStops={[\"#004F39\", \"#FEFACA\", \"#151513\"]}\n          blend={0.6}\n          amplitude={1.2}\n          speed={0.3}\n        />\n        <div className=\"absolute inset-0 bg-black/30 backdrop-blur-[2px]\" />\n      </div>\n\n      {/* Content */}\n      <div className=\"relative h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col items-center justify-center text-center py-16 pt-24 animate-fade-in-up\">\n        <SplitText\n          text={title}\n          className=\"text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4\"\n          delay={50}\n          animationFrom={{ opacity: 0, transform: 'translate3d(0,50px,0)' }}\n          animationTo={{ opacity: 1, transform: 'translate3d(0,0,0)' }}\n          easing={(t: number) => 1 - Math.pow(1 - t, 3)} // easeOutCubic function\n          threshold={0.2}\n          rootMargin=\"-50px\"\n          onLetterAnimationComplete={handleAnimationComplete}\n        />\n        <p className=\"text-lg sm:text-xl text-gray-200 mb-6 sm:mb-8 max-w-3xl mx-auto\">\n          {subtitle}\n        </p>\n\n        {/* Search Form */}\n        {showSearch && (\n          <form\n            onSubmit={handleSubmit}\n            className=\"w-full max-w-2xl animate-fade-in-up\"\n          >\n            <div className=\"relative\">\n              <Input\n                type=\"text\"\n                placeholder=\"Enter an address, neighbourhood, city, or postcode\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"w-full h-12 sm:h-14 pl-5 pr-14 text-base sm:text-lg bg-white/90 backdrop-blur-sm text-black border-2 border-transparent focus:border-primary\"\n              />\n              <Button\n                type=\"submit\"\n                size=\"sm\"\n                variant=\"ghost\"\n                className=\"absolute right-2 top-1/2 -translate-y-1/2 hover:bg-transparent\"\n              >\n                <Search className=\"w-6 h-6 text-gray-500 hover:text-primary transition-colors\" />\n              </Button>\n            </div>\n          </form>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport { HeroSection };\nexport default HeroSection;\n","import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-xl border bg-card text-card-foreground shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","import * as React from \"react\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n        success: \"bg-green-500/10 text-green-500 hover:bg-green-500/20\",\n        warning: \"bg-yellow-500/10 text-yellow-500 hover:bg-yellow-500/20\",\n        premium: \"bg-gradient-to-r from-amber-500 to-amber-600 text-white hover:from-amber-600 hover:to-amber-700\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n);\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants };\n","import React from \"react\";\nimport { Card, CardContent, CardHeader } from \"./ui/card\";\nimport { Badge } from \"./ui/badge\";\nimport { formatCurrency, formatDate, formatNumber } from \"../lib/utils\";\nimport { Button } from \"./ui/button\";\nimport { Heart, MessageCircle, Share } from \"lucide-react\";\nimport { UserProfile, User } from \"../lib/auth\";\n\nconst PROPERTY_FALLBACK_IMAGES = [\n  \"https://images.unsplash.com/photo-1518780664697-55e3ad937233?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600\",\n  \"https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600\",\n  \"https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600\",\n  \"https://images.unsplash.com/photo-1570129477492-45c003edd2be?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600\",\n];\n\nconst DEAL_FALLBACK_IMAGES = [\n  \"https://images.unsplash.com/photo-1464938050520-ef2270bb8ce8?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600\",\n  \"https://images.unsplash.com/photo-1497366811353-6870744d04b2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600\",\n  \"https://images.unsplash.com/photo-1497366754035-f200968a6e72?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600\",\n  \"https://images.unsplash.com/photo-1497366216548-37526070297c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600\",\n  \"https://images.unsplash.com/photo-1497366858526-0766cadbe8fa?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=600\",\n];\n\ninterface PropertyCardProps {\n  id?: string;\n  address: string;\n  price: number;\n  squareFootage?: number;\n  bedrooms?: number;\n  bathrooms?: number;\n  isPremium?: boolean;\n  description?: string;\n  propertyType?: string;\n  createdAt: string;\n  updatedAt?: string;\n  author?: {\n    id: string;\n    name: string;\n    avatar?: string;\n  };\n  original_price?: number;\n  potential_profit?: number;\n  roi_percentage?: number;\n  deal_price?: number;\n  deal_type?: string;\n  property?: any;\n  status?: string;\n  type?: \"listing\" | \"deal\";\n  isSubscriber?: boolean;\n  investment_term?: string;\n  onClick?: () => void;\n  onMessageAuthor?: (authorId: string) => void;\n  isDeal?: boolean;\n  images?: string[];\n  currentUser?: User | null;\n  userProfile?: UserProfile | null;\n}\n\nexport function PropertyCard({\n  id,\n  address,\n  price,\n  squareFootage,\n  bedrooms,\n  bathrooms,\n  isPremium = false,\n  propertyType = \"residential\",\n  description,\n  createdAt,\n  author,\n  original_price,\n  roi_percentage,\n  investment_term,\n  deal_type,\n  isSubscriber = false,\n  type = \"listing\",\n  isDeal = false,\n  images = [],\n  onClick,\n  onMessageAuthor,\n  currentUser,\n  userProfile\n}: PropertyCardProps) {\n  const isAuthenticated = !!currentUser;\n  \n  const [isSaved, setIsSaved] = React.useState(false);\n\n  const handleSaveToggle = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    setIsSaved(!isSaved);\n  };\n\n  const handleShare = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    console.log(\"Share property:\", id);\n  };\n\n  const handleMessageAuthor = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (author && onMessageAuthor) {\n      onMessageAuthor(author.id);\n    }\n  };\n\n  const imageUrl = images && images.length > 0 \n    ? images[0] \n    : `https://source.unsplash.com/random/800x600?property,house&sig=${id}`;\n\n  return (\n    <Card \n      className=\"overflow-hidden hover:shadow-md transition-shadow cursor-pointer\"\n      onClick={onClick}\n    >\n      <div className=\"relative aspect-[4/3] overflow-hidden bg-muted\">\n        <img\n          src={imageUrl}\n          alt={address}\n          className=\"object-cover w-full h-full\"\n          loading=\"lazy\"\n        />\n        {isPremium && (\n          <div className=\"absolute top-2 left-2\">\n            <Badge variant=\"secondary\" className=\"bg-primary text-primary-foreground hover:bg-primary/90\">\n              Featured\n            </Badge>\n          </div>\n        )}\n        {isDeal && (\n          <div className=\"absolute top-2 left-2\">\n            <Badge variant=\"secondary\" className=\"bg-emerald-500 text-white hover:bg-emerald-600\">\n              Investment Deal\n            </Badge>\n          </div>\n        )}\n        {roi_percentage && (\n          <div className=\"absolute top-2 right-2\">\n            <Badge className=\"bg-emerald-500 text-white\">\n              {roi_percentage}% ROI\n            </Badge>\n          </div>\n        )}\n      </div>\n\n      <CardHeader className=\"p-4 pb-0\">\n        <div className=\"flex justify-between items-start mb-2\">\n          <h3 className=\"text-lg font-semibold\">{formatCurrency(price)}</h3>\n          {original_price && (\n            <div className=\"text-sm text-muted-foreground line-through\">\n              {formatCurrency(original_price)}\n            </div>\n          )}\n        </div>\n        <p className=\"text-sm text-muted-foreground mb-2\">{address}</p>\n      </CardHeader>\n\n      <CardContent className=\"p-4 pt-2\">\n        {(bedrooms || bathrooms || squareFootage) && (\n          <div className=\"flex justify-between mb-3 text-sm\">\n            {bedrooms !== undefined && (\n              <div>\n                <span className=\"font-medium\">{bedrooms}</span>{\" \"}\n                <span className=\"text-muted-foreground\">\n                  {bedrooms === 1 ? \"Bed\" : \"Beds\"}\n                </span>\n              </div>\n            )}\n            {bathrooms !== undefined && (\n              <div>\n                <span className=\"font-medium\">{bathrooms}</span>{\" \"}\n                <span className=\"text-muted-foreground\">\n                  {bathrooms === 1 ? \"Bath\" : \"Baths\"}\n                </span>\n              </div>\n            )}\n            {squareFootage !== undefined && (\n              <div>\n                <span className=\"font-medium\">{formatNumber(squareFootage)}</span>{\" \"}\n                <span className=\"text-muted-foreground\">sq ft</span>\n              </div>\n            )}\n          </div>\n        )}\n\n        {investment_term && (\n          <div className=\"mb-3\">\n            <span className=\"text-sm text-muted-foreground\">Investment Term: </span>\n            <span className=\"text-sm font-medium\">{investment_term}</span>\n          </div>\n        )}\n\n        {deal_type && (\n          <div className=\"mb-3\">\n            <span className=\"text-sm text-muted-foreground\">Deal Type: </span>\n            <span className=\"text-sm font-medium\">{deal_type}</span>\n          </div>\n        )}\n\n        {description && (\n          <p className=\"text-sm text-muted-foreground mb-4 line-clamp-2\">\n            {description}\n          </p>\n        )}\n\n        <div className=\"flex justify-between items-center mt-2\">\n          <div className=\"text-xs text-muted-foreground\">\n            {formatDate(createdAt)}\n          </div>\n          <div className=\"flex space-x-1\">\n            {isAuthenticated && (\n              <>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-8 w-8\"\n                  onClick={handleSaveToggle}\n                >\n                  <Heart\n                    className={`h-4 w-4 ${\n                      isSaved ? \"fill-red-500 text-red-500\" : \"\"\n                    }`}\n                  />\n                </Button>\n                {author && (\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    className=\"h-8 w-8\"\n                    onClick={handleMessageAuthor}\n                  >\n                    <MessageCircle className=\"h-4 w-4\" />\n                  </Button>\n                )}\n              </>\n            )}\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-8 w-8\"\n              onClick={handleShare}\n            >\n              <Share className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\nconst supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\n\nconsole.log(\"Supabase Anon Key:\", supabaseAnonKey); // Add this line\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error(\"Missing Supabase environment variables\");\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    persistSession: true,\n    storage: window.localStorage,\n    storageKey: 'supabase.auth.token',\n    autoRefreshToken: true,\n    detectSessionInUrl: true,\n    flowType: 'pkce'\n  }\n});\n","import { supabase } from \"./supabase\";\nimport { loadStripe } from \"@stripe/stripe-js\";\n\nexport const SUBSCRIPTION_TIERS = {\n  BASIC: {\n    name: \"Basic\",\n    price: \"£9.99\",\n    priceId: \"price_1QnikACOhalwhG2QDocCWbQj\",\n    features: [\n      \"Basic property search\",\n      \"Save up to 5 properties\",\n      \"Basic market trends\",\n      \"Email support\",\n    ],\n  },\n  PRO: {\n    name: \"Pro\",\n    price: \"£19.99\",\n    priceId: \"price_1QnikPCOhalwhG2QVYfxwG5D\",\n    features: [\n      \"Advanced property search\",\n      \"Save unlimited properties\",\n      \"Detailed market analysis\",\n      \"Premium property insights\",\n      \"Priority support\",\n    ],\n  },\n  PREMIUM: {\n    name: \"Premium\",\n    price: \"£49.99\",\n    priceId: \"price_1QnikjCOhalwhG2QUgRtMAco\",\n    features: [\n      \"All Pro features\",\n      \"AI-powered market predictions\",\n      \"Portfolio analytics\",\n      \"Investment ROI calculator\",\n      \"Dedicated account manager\",\n      \"24/7 phone support\",\n    ],\n  },\n};\n\nexport async function createCheckoutSession(priceId: string, userId: string) {\n  try {\n    const response = await fetch(\n      \"https://clever-chaplygin6-vbfae.dev.tempolabs.ai/.netlify/functions/create-checkout-session\",\n      {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          priceId,\n          userId,\n        }),\n      },\n    );\n\n    const { sessionId } = await response.json();\n    const stripe = await loadStripe(import.meta.env.VITE_STRIPE_PUBLIC_KEY);\n\n    if (stripe) {\n      await stripe.redirectToCheckout({ sessionId });\n    }\n  } catch (error) {\n    console.error(\"Error creating checkout session:\", error);\n    throw error;\n  }\n}\n\nexport async function updateSubscription(userId: string, tier: string) {\n  const { error } = await supabase\n    .from(\"profiles\")\n    .update({\n      subscription_tier: tier,\n      subscription_status: \"active\",\n      updated_at: new Date().toISOString(),\n    })\n    .eq(\"id\", userId);\n\n  if (error) throw error;\n}\n","import React from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"./ui/dialog\";\nimport { Button } from \"./ui/button\";\nimport { Input } from \"./ui/input\";\nimport { Label } from \"./ui/label\";\nimport { useToast } from \"./ui/use-toast\";\nimport { useAuth } from \"../lib/auth\";\nimport { createCheckoutSession } from \"../lib/stripe\";\n\ntype AuthMode = \"signin\" | \"signup\";\n\ninterface AuthModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  defaultMode?: AuthMode;\n}\n\nexport function AuthModal({\n  isOpen,\n  onClose,\n  defaultMode = \"signin\",\n}: AuthModalProps) {\n  const [mode, setMode] = React.useState<AuthMode>(defaultMode);\n  React.useEffect(() => {\n    setMode(defaultMode);\n  }, [defaultMode]);\n  const [isSubmitting, setIsSubmitting] = React.useState(false);\n  const [showConfirmation, setShowConfirmation] = React.useState(false);\n  const { signIn, signUp, signInWithGoogle } = useAuth();\n  const { toast } = useToast();\n\n  const [formData, setFormData] = React.useState({\n    email: \"\",\n    password: \"\",\n    firstName: \"\",\n    lastName: \"\",\n  });\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsSubmitting(true);\n\n    try {\n      if (mode === \"signin\") {\n        const user = await signIn(formData.email, formData.password);\n        if (user) {\n          toast({\n            title: \"Welcome back!\",\n            description: \"You have successfully signed in.\",\n          });\n          setTimeout(() => onClose(), 500);\n        }\n      } else {\n        const user = await signUp(\n          formData.email,\n          formData.password,\n          formData.firstName,\n          formData.lastName,\n        );\n\n        // Check if there's a pending subscription\n        const pendingPriceId = localStorage.getItem(\n          \"pending_subscription_price_id\",\n        );\n        if (pendingPriceId && user && 'id' in user) {\n          localStorage.removeItem(\"pending_subscription_price_id\");\n          await createCheckoutSession(pendingPriceId, user.id);\n        } else {\n          setShowConfirmation(true);\n          toast({\n            title: \"Welcome to MyVGE Alpha!\",\n            description:\n              \"Thank you for joining us during our alpha testing phase.\",\n          });\n        }\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"An error occurred\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  if (showConfirmation) {\n    return (\n      <Dialog open={isOpen} onOpenChange={onClose}>\n        <DialogContent className=\"sm:max-w-[425px]\">\n          <DialogHeader>\n            <DialogTitle>Welcome to MyVGE Alpha!</DialogTitle>\n            <DialogDescription className=\"space-y-2\">\n              <p className=\"text-lg font-medium text-primary\">\n                Thank you for joining MyVGE during our alpha testing phase!\n              </p>\n              <p>\n                We've sent a confirmation email to your inbox. Please click the\n                verification link to activate your account and start exploring\n                MyVGE.\n              </p>\n              <p className=\"text-sm text-muted-foreground\">\n                Note: You must confirm your email before signing in. Please\n                check your spam folder if you don't see the email.\n              </p>\n              <div className=\"mt-4 p-4 bg-primary/10 rounded-lg\">\n                <p className=\"text-sm font-medium\">\n                  As an alpha tester, your feedback is invaluable to us. We're\n                  excited to have you on board and look forward to your insights\n                  as we continue to improve the platform.\n                </p>\n              </div>\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"flex flex-col space-y-4 pt-4\">\n            <Button\n              onClick={() => {\n                setShowConfirmation(false);\n                onClose();\n              }}\n            >\n              Close\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    );\n  }\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-[425px]\">\n        <DialogHeader>\n          <DialogTitle>\n            {mode === \"signin\" ? \"Sign In\" : \"Create Account\"}\n          </DialogTitle>\n          <DialogDescription>\n            {mode === \"signin\"\n              ? \"Welcome back! Please sign in to continue.\"\n              : \"Join MyVGE and start exploring properties.\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4 pt-4\">\n          {mode === \"signup\" && (\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"firstName\">First Name</Label>\n                <Input\n                  id=\"firstName\"\n                  value={formData.firstName}\n                  onChange={(e) =>\n                    setFormData((prev) => ({\n                      ...prev,\n                      firstName: e.target.value,\n                    }))\n                  }\n                  required\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"lastName\">Last Name</Label>\n                <Input\n                  id=\"lastName\"\n                  value={formData.lastName}\n                  onChange={(e) =>\n                    setFormData((prev) => ({\n                      ...prev,\n                      lastName: e.target.value,\n                    }))\n                  }\n                  required\n                />\n              </div>\n            </div>\n          )}\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"email\">Email</Label>\n            <Input\n              id=\"email\"\n              type=\"email\"\n              value={formData.email}\n              onChange={(e) =>\n                setFormData((prev) => ({ ...prev, email: e.target.value }))\n              }\n              required\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"password\">Password</Label>\n            <Input\n              id=\"password\"\n              type=\"password\"\n              value={formData.password}\n              onChange={(e) =>\n                setFormData((prev) => ({ ...prev, password: e.target.value }))\n              }\n              required\n            />\n          </div>\n\n          <div className=\"flex flex-col space-y-4 pt-4\">\n            <Button type=\"submit\" disabled={isSubmitting}>\n              {isSubmitting\n                ? \"Loading...\"\n                : mode === \"signin\"\n                  ? \"Sign In\"\n                  : \"Create Account\"}\n            </Button>\n\n            <Button type=\"button\" variant=\"link\" onClick={() => signInWithGoogle()} disabled={isSubmitting}>\n              Sign In with Google\n            </Button>\n\n            <Button\n              type=\"button\"\n              variant=\"link\"\n              onClick={() => setMode(mode === \"signin\" ? \"signup\" : \"signin\")}\n            >\n              {mode === \"signin\"\n                ? \"Don't have an account? Sign up\"\n                : \"Already have an account? Sign in\"}\n            </Button>\n          </div>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","import React from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"./ui/dialog\";\nimport { Button } from \"./ui/button\";\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from \"./ui/tabs\";\nimport { CheckIcon } from \"lucide-react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { UserProfile } from \"../lib/auth\";\nimport { User } from \"@supabase/supabase-js\";\n\ninterface SubscriptionModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  currentUser?: User | null;\n  userProfile?: UserProfile | null;\n}\n\nexport function SubscriptionModal({ isOpen, onClose, currentUser, userProfile }: SubscriptionModalProps) {\n  const navigate = useNavigate();\n\n  const handleSubscribe = (tier: string) => {\n    console.log(`Subscribing to ${tier} tier`);\n    navigate(`/checkout?tier=${tier}`);\n      onClose();\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"text-2xl\">\n            Upgrade Your Experience\n          </DialogTitle>\n        </DialogHeader>\n\n        <Tabs defaultValue=\"monthly\" className=\"mt-4\">\n          <TabsList className=\"grid w-full grid-cols-2 mb-6\">\n            <TabsTrigger value=\"monthly\">Monthly</TabsTrigger>\n            <TabsTrigger value=\"yearly\">\n              Yearly <span className=\"ml-2 text-emerald-500\">Save 20%</span>\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"monthly\">\n            <div className=\"grid gap-6 sm:grid-cols-2 mt-4\">\n              <div className=\"border rounded-lg p-6 space-y-4 relative overflow-hidden\">\n                <div className=\"space-y-2\">\n                  <h3 className=\"text-xl font-semibold\">Basic</h3>\n                  <p className=\"text-muted-foreground text-sm\">\n                    Essential property insights for casual investors.\n                  </p>\n                  <div className=\"flex items-baseline gap-1\">\n                    <span className=\"text-3xl font-bold\">£9.99</span>\n                    <span className=\"text-muted-foreground\">/month</span>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">Basic property data</span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">5 saved properties</span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">Limited market insights</span>\n                  </div>\n                </div>\n\n                <Button\n                  className=\"w-full\"\n                  onClick={() => handleSubscribe(\"basic\")}\n                >\n                  {userProfile?.subscription_tier === \"basic\" ? \"Current Plan\" : \"Subscribe\"}\n                </Button>\n              </div>\n\n              <div className=\"border rounded-lg p-6 space-y-4 relative overflow-hidden bg-gradient-to-b from-blue-50 to-white dark:from-blue-950 dark:to-background\">\n                <div className=\"absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 text-xs font-medium rounded-bl-lg\">\n                  POPULAR\n                </div>\n                <div className=\"space-y-2\">\n                  <h3 className=\"text-xl font-semibold\">Pro</h3>\n                  <p className=\"text-muted-foreground text-sm\">\n                    Advanced tools for serious property investors.\n                  </p>\n                  <div className=\"flex items-baseline gap-1\">\n                    <span className=\"text-3xl font-bold\">£29.99</span>\n                    <span className=\"text-muted-foreground\">/month</span>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">\n                      <span className=\"font-medium\">Everything in Basic</span>\n                    </span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">Detailed investment metrics</span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">50 saved properties</span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">Full market insights access</span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">Priority customer support</span>\n                  </div>\n                </div>\n\n                <Button\n                  className=\"w-full bg-blue-600 hover:bg-blue-700\"\n                  onClick={() => handleSubscribe(\"pro\")}\n                >\n                  {userProfile?.subscription_tier === \"pro\" ? \"Current Plan\" : \"Subscribe\"}\n                </Button>\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"yearly\">\n            <div className=\"grid gap-6 sm:grid-cols-2 mt-4\">\n              <div className=\"border rounded-lg p-6 space-y-4 relative overflow-hidden\">\n                <div className=\"absolute -top-1 -right-1 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100 px-3 py-1 text-xs font-medium transform rotate-12\">\n                  SAVE 20%\n                </div>\n                <div className=\"space-y-2\">\n                  <h3 className=\"text-xl font-semibold\">Basic Annual</h3>\n                  <p className=\"text-muted-foreground text-sm\">\n                    Essential property insights for casual investors.\n                  </p>\n                  <div className=\"flex items-baseline gap-1\">\n                    <span className=\"text-3xl font-bold\">£95.90</span>\n                    <span className=\"text-muted-foreground\">/year</span>\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Equivalent to £7.99/month\n                  </p>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">Basic property data</span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">5 saved properties</span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">Limited market insights</span>\n                  </div>\n                </div>\n\n                <Button\n                  className=\"w-full\"\n                  onClick={() => handleSubscribe(\"basic-annual\")}\n                >\n                  {userProfile?.subscription_tier === \"basic\" && userProfile?.subscription_status === \"yearly\" \n                    ? \"Current Plan\" \n                    : \"Subscribe\"}\n                </Button>\n              </div>\n\n              <div className=\"border rounded-lg p-6 space-y-4 relative overflow-hidden bg-gradient-to-b from-blue-50 to-white dark:from-blue-950 dark:to-background\">\n                <div className=\"absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 text-xs font-medium rounded-bl-lg\">\n                  BEST VALUE\n                </div>\n                <div className=\"absolute -top-1 -right-12 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100 px-3 py-1 text-xs font-medium transform rotate-12\">\n                  SAVE 20%\n                </div>\n                <div className=\"space-y-2\">\n                  <h3 className=\"text-xl font-semibold\">Pro Annual</h3>\n                  <p className=\"text-muted-foreground text-sm\">\n                    Advanced tools for serious property investors.\n                  </p>\n                  <div className=\"flex items-baseline gap-1\">\n                    <span className=\"text-3xl font-bold\">£287.90</span>\n                    <span className=\"text-muted-foreground\">/year</span>\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Equivalent to £23.99/month\n                  </p>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">\n                      <span className=\"font-medium\">Everything in Basic</span>\n                    </span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">Detailed investment metrics</span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">50 saved properties</span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">Full market insights access</span>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <CheckIcon className=\"h-5 w-5 text-emerald-500 flex-shrink-0\" />\n                    <span className=\"text-sm\">Priority customer support</span>\n                  </div>\n                </div>\n\n                <Button\n                  className=\"w-full bg-blue-600 hover:bg-blue-700\"\n                  onClick={() => handleSubscribe(\"pro-annual\")}\n                >\n                  {userProfile?.subscription_tier === \"pro\" && userProfile?.subscription_status === \"yearly\" \n                    ? \"Current Plan\" \n                    : \"Subscribe\"}\n                </Button>\n              </div>\n            </div>\n          </TabsContent>\n        </Tabs>\n\n        <DialogFooter className=\"mt-6\">\n          <Button variant=\"outline\" onClick={onClose}>\n            Cancel\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import { supabase } from './supabase';\nimport { User } from '@supabase/supabase-js';\nimport { Deal } from './deals';\n\nconst profanityList = [\n  \"badword1\",\n  \"badword2\",\n  // Add more profanity words here\n];\n\nfunction filterProfanity(text: string): string {\n  let filteredText = text.toLowerCase();\n  profanityList.forEach((word) => {\n    const regex = new RegExp(word, \"gi\");\n    filteredText = filteredText.replace(regex, \"*\".repeat(word.length));\n  });\n  return filteredText;\n}\n\nexport interface Message {\n  id: string;\n  sender_id: string;\n  receiver_id: string;\n  content: string;\n  deal_id?: string;\n  created_at: string;\n  is_read: boolean;\n}\n\nexport interface MessageWithProfiles extends Message {\n  sender: {\n    id: string;\n    full_name: string;\n    avatar_url?: string;\n  };\n  receiver: {\n    id: string;\n    full_name: string;\n    avatar_url?: string;\n  };\n  deal?: Deal;\n}\n\n// Define User interface for consistent typing\nexport interface User {\n  id: string;\n  full_name?: string;\n  email?: string;\n  avatar_url?: string;\n}\n\n// Define Conversation interface with proper User typing\nexport interface Conversation {\n  user: User;\n  lastMessage: MessageWithProfiles | null;\n  unreadCount: number;\n}\n\n// Send a new message\nexport async function sendMessage(receiverId: string, content: string, dealId?: string): Promise<MessageWithProfiles | null> {\n  try {\n    const { data: user, error: userError } = await supabase.auth.getUser();\n    if (userError || !user.user) {\n      console.error('Authentication error:', userError);\n      throw new Error('User not authenticated');\n    }\n\n    console.log('Sending message:', {\n      sender_id: user.user.id,\n      receiver_id: receiverId,\n      deal_id: dealId,\n      content: content.substring(0, 20) + '...' // Log first 20 chars for privacy\n    });\n\n    const { data, error } = await supabase\n      .from('messages')\n      .insert({\n        sender_id: user.user.id,\n        receiver_id: receiverId,\n        content: filterProfanity(content),\n        deal_id: dealId,\n        is_read: false\n      })\n      .select(`\n        *,\n        sender:profiles!sender_id(id, full_name, avatar_url),\n        receiver:profiles!receiver_id(id, full_name, avatar_url),\n        deal:deals(*)\n      `)\n      .single();\n\n    if (error) {\n      console.error('Database error:', error);\n      throw error;\n    }\n\n    if (!data) {\n      console.error('No data returned from insert');\n      throw new Error('Failed to send message');\n    }\n\n    console.log('Message sent successfully:', { messageId: data.id });\n    return data;\n  } catch (error) {\n    console.error('Error sending message:', error);\n    return null;\n  }\n}\n\n// Get conversations for the current user\nexport async function getConversations(): Promise<Conversation[]> {\n  try {\n    // Get the current user session\n    const { data: { session }, error: sessionError } = await supabase.auth.getSession();\n    \n    if (sessionError) {\n      console.error('Session error in getConversations:', sessionError);\n      return [];\n    }\n    \n    // If no session from getSession, try getUser as fallback\n    if (!session) {\n      console.log('No active session found in getConversations - trying getUser fallback');\n      const { data: userData, error: userError } = await supabase.auth.getUser();\n      \n      if (userError || !userData?.user) {\n        console.error('User not authenticated in getConversations:', userError || 'No user data');\n        return [];\n      }\n      \n      const userId = userData.user.id;\n      console.log(`Found user via getUser: ${userId}`);\n      \n      return await fetchConversationsForUser(userId);\n    }\n    \n    // We have a session, use it for the query\n    const userId = session.user.id;\n    console.log(`Using session user for conversations: ${userId}`);\n    \n    return await fetchConversationsForUser(userId);\n  } catch (error) {\n    console.error('Error getting conversations:', error);\n    return [];\n  }\n}\n\n// Helper function to fetch conversations for a specific user ID\nasync function fetchConversationsForUser(userId: string): Promise<Conversation[]> {\n  // Use the .filter() method with proper parameters\n  const { data, error } = await supabase\n    .from('messages')\n    .select(`\n      *,\n      sender:profiles!sender_id(id, full_name, avatar_url),\n      receiver:profiles!receiver_id(id, full_name, avatar_url),\n      deal:deals(*)\n    `)\n    .filter('sender_id', 'eq', userId)\n    .filter('receiver_id', 'eq', userId, { foreignTable: 'or' })\n    .order('created_at', { ascending: false });\n\n  if (error) {\n    console.error('Error fetching conversations:', error);\n    return [];\n  }\n\n  // Process conversations\n  const conversationsMap = new Map<string, Conversation>();\n  \n  data?.forEach((message: MessageWithProfiles) => {\n    const otherUser = message.sender_id === userId ? message.receiver : message.sender;\n    const conversationId = otherUser.id;\n\n    if (!conversationsMap.has(conversationId)) {\n      conversationsMap.set(conversationId, {\n        user: otherUser,\n        lastMessage: message,\n        unreadCount: message.receiver_id === userId && !message.is_read ? 1 : 0\n      });\n    } else if (message.receiver_id === userId && !message.is_read) {\n      const conversation = conversationsMap.get(conversationId)!;\n      conversation.unreadCount++;\n    }\n  });\n\n  return Array.from(conversationsMap.values());\n}\n\n// Get messages between current user and another user\nexport async function getMessages(otherUserId: string): Promise<MessageWithProfiles[]> {\n  try {\n    const { data: user, error: userError } = await supabase.auth.getUser();\n    if (userError || !user.user) {\n      console.error('Authentication error:', userError);\n      throw new Error('User not authenticated');\n    }\n\n    console.log('Fetching messages with user:', otherUserId);\n\n    const { data, error } = await supabase\n      .from('messages')\n      .select(`\n        *,\n        sender:profiles!sender_id(id, full_name, avatar_url),\n        receiver:profiles!receiver_id(id, full_name, avatar_url),\n        deal:deals(*)\n      `)\n      .or(`and(sender_id.eq.${user.user.id},receiver_id.eq.${otherUserId}),and(sender_id.eq.${otherUserId},receiver_id.eq.${user.user.id})`)\n      .order('created_at', { ascending: true });\n\n    if (error) {\n      console.error('Database error:', error);\n      throw error;\n    }\n\n    console.log(`Found ${data?.length || 0} messages`);\n\n    // Mark messages as read\n    const unreadMessages = data?.filter(\n      (message) => message.receiver_id === user.user.id && !message.is_read\n    ) || [];\n\n    if (unreadMessages.length > 0) {\n      console.log(`Marking ${unreadMessages.length} messages as read`);\n      const { error: updateError } = await supabase\n        .from('messages')\n        .update({ is_read: true })\n        .in('id', unreadMessages.map((m) => m.id));\n\n      if (updateError) {\n        console.error('Error marking messages as read:', updateError);\n      }\n    }\n\n    return data || [];\n  } catch (error) {\n    console.error('Error getting messages:', error);\n    return [];\n  }\n}\n\n// Subscribe to new messages\nexport function subscribeToMessages(callback: (message: MessageWithProfiles) => void) {\n  try {\n    const subscription = supabase\n      .channel('messages')\n      .on(\n        'postgres_changes',\n        {\n          event: 'INSERT',\n          schema: 'public',\n          table: 'messages'\n        },\n        async (payload) => {\n          // Fetch the complete message with profiles and deal\n          const { data, error } = await supabase\n            .from('messages')\n            .select(`\n              *,\n              sender:profiles!sender_id(id, full_name, avatar_url),\n              receiver:profiles!receiver_id(id, full_name, avatar_url),\n              deal:deals(*)\n            `)\n            .eq('id', payload.new.id)\n            .single();\n\n          if (!error && data) {\n            callback(data);\n          }\n        }\n      )\n      .subscribe();\n\n    return subscription;\n  } catch (error) {\n    console.error('Error subscribing to messages:', error);\n    return null;\n  }\n}\n\n// Mark message as read\nexport async function markMessageAsRead(messageId: string) {\n  try {\n    const { error } = await supabase\n      .from('messages')\n      .update({ is_read: true })\n      .eq('id', messageId);\n\n    if (error) throw error;\n    return true;\n  } catch (error) {\n    console.error('Error marking message as read:', error);\n    return false;\n  }\n}\n\n// Search users - helper function for finding users to message\nexport async function searchUsers(searchTerm: string) {\n  try {\n    let userId: string;\n    \n    // Try to get authentication info using both methods\n    const { data: { session } } = await supabase.auth.getSession();\n    \n    if (session) {\n      userId = session.user.id;\n      console.log(`Using session user for search: ${userId}`);\n    } else {\n      // Fallback to getUser\n      const { data: userData, error: userError } = await supabase.auth.getUser();\n      \n      if (userError || !userData?.user) {\n        console.error('Failed to get authenticated user:', userError);\n        throw new Error('Authentication required to search users');\n      }\n      \n      userId = userData.user.id;\n      console.log(`Using getUser result for search: ${userId}`);\n    }\n    \n    // Start with the base query\n    let query = supabase\n      .from('profiles')\n      .select('id, full_name, email, avatar_url')\n      .neq('id', userId);\n    \n    // Add search filter if term is provided\n    if (searchTerm && searchTerm.trim()) {\n      const formattedTerm = `%${searchTerm.trim()}%`;\n      \n      // Use multiple .ilike() calls instead of .or() with string interpolation\n      query = query.or(\n        `full_name.ilike.${formattedTerm},email.ilike.${formattedTerm}`\n      );\n    }\n    \n    // Execute the query\n    const { data, error } = await query;\n    \n    if (error) {\n      console.error('Database error in searchUsers:', error);\n      return [];\n    }\n    \n    console.log(`Search found ${data?.length || 0} users`);\n    return data || [];\n  } catch (error) {\n    console.error('Error in searchUsers:', error);\n    return [];\n  }\n}\n","import React from 'react';\nimport { cn } from '@/lib/utils';\n\ninterface LoadingSpinnerProps {\n  size?: 'sm' | 'md' | 'lg';\n  className?: string;\n}\n\nexport function LoadingSpinner({ size = 'md', className }: LoadingSpinnerProps) {\n  const sizeClasses = {\n    sm: 'h-4 w-4',\n    md: 'h-6 w-6',\n    lg: 'h-8 w-8',\n  };\n\n  return (\n    <div\n      className={cn(\n        'animate-spin rounded-full border-2 border-current border-t-transparent',\n        sizeClasses[size],\n        className\n      )}\n    />\n  );\n} ","import React, { useEffect, useState, useRef } from 'react';\nimport { useAuth } from '../lib/auth';\nimport { sendMessage, getMessages, MessageWithProfiles } from '../lib/messages';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from './ui/dialog';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Avatar, AvatarFallback, AvatarImage } from './ui/avatar';\nimport { ScrollArea } from './ui/scroll-area';\nimport { LoadingSpinner } from './ui/loading-spinner';\nimport { Send } from 'lucide-react';\nimport { formatDistanceToNow } from 'date-fns';\n\ninterface MessagesModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  receiverId?: string;\n  dealId?: string;\n}\n\nexport const MessagesModal: React.FC<MessagesModalProps> = ({\n  isOpen,\n  onClose,\n  receiverId,\n  dealId\n}) => {\n  const { user } = useAuth();\n  const [messages, setMessages] = useState<MessageWithProfiles[]>([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [receiver, setReceiver] = useState<any>(null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (isOpen && receiverId) {\n      loadMessages();\n    } else {\n      setMessages([]);\n      setNewMessage('');\n    }\n  }, [isOpen, receiverId]);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const loadMessages = async () => {\n    if (!receiverId) return;\n    \n    try {\n      setIsLoading(true);\n      const data = await getMessages(receiverId);\n      setMessages(data);\n      \n      // Set receiver info from the first message\n      if (data.length > 0) {\n        const msg = data[0];\n        const receiverData = msg.sender_id === user?.id ? msg.receiver : msg.sender;\n        setReceiver(receiverData);\n      }\n    } catch (error) {\n      console.error('Error loading messages:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleSendMessage = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!receiverId || !newMessage.trim()) return;\n\n    try {\n      const message = await sendMessage(receiverId, newMessage.trim(), dealId);\n      if (message) {\n        setMessages(prev => [...prev, message]);\n        setNewMessage('');\n      }\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\n      <DialogContent className=\"max-w-screen-md w-full\">\n        <DialogHeader>\n          <DialogTitle>\n            {receiver ? `Messages with ${receiver.full_name}` : 'Messages'}\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"h-[400px] flex flex-col\">\n          {isLoading ? (\n            <div className=\"flex-1 flex justify-center items-center\">\n              <LoadingSpinner />\n            </div>\n          ) : (\n            <ScrollArea className=\"flex-1 pr-4 mb-4\">\n              {messages.length === 0 ? (\n                <div className=\"h-full flex items-center justify-center text-muted-foreground\">\n                  No messages yet. Send a message to start the conversation.\n                </div>\n              ) : (\n                messages.map(message => (\n                  <div\n                    key={message.id}\n                    className={`flex mb-4 ${\n                      message.sender_id === user?.id ? 'justify-end' : 'justify-start'\n                    }`}\n                  >\n                    {message.sender_id !== user?.id && (\n                      <Avatar className=\"mr-2 mt-1\">\n                        <AvatarImage src={message.sender.avatar_url} />\n                        <AvatarFallback>\n                          {message.sender.full_name.charAt(0)}\n                        </AvatarFallback>\n                      </Avatar>\n                    )}\n                    <div\n                      className={`max-w-[70%] ${\n                        message.sender_id === user?.id\n                          ? 'bg-primary text-primary-foreground'\n                          : 'bg-muted'\n                      } rounded-lg p-3`}\n                    >\n                      <p>{message.content}</p>\n                      <p className=\"text-xs mt-1 opacity-70\">\n                        {formatDistanceToNow(new Date(message.created_at), { addSuffix: true })}\n                      </p>\n                    </div>\n                  </div>\n                ))\n              )}\n              <div ref={messagesEndRef} />\n            </ScrollArea>\n          )}\n\n          <form onSubmit={handleSendMessage} className=\"flex gap-2\">\n            <Input\n              value={newMessage}\n              onChange={e => setNewMessage(e.target.value)}\n              placeholder=\"Type a message...\"\n              autoFocus\n            />\n            <Button type=\"submit\" size=\"icon\">\n              <Send className=\"h-4 w-4\" />\n            </Button>\n          </form>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import React from \"react\";\nimport { Lightbulb } from \"lucide-react\";\n\nexport function RandomFact() {\n  const [fact, setFact] = React.useState<string>(\"\");\n\n  React.useEffect(() => {\n    fetch(\"https://uselessfacts.jsph.pl/api/v2/facts/random?language=en\")\n      .then((response) => response.json())\n      .then((data) => setFact(data.text))\n      .catch((error) => console.error(\"Error fetching random fact:\", error));\n  }, []);\n\n  if (!fact) return null;\n\n  return (\n    <div className=\"flex items-center gap-2 text-gray-400 text-sm\">\n      <Lightbulb className=\"w-4 h-4\" />\n      <p>{fact}</p>\n    </div>\n  );\n}\n","import { RandomFact } from \"./RandomFact\";\n\nexport function Footer() {\n  return (\n    <footer className=\"bg-gray-900 text-white py-8 sm:py-12\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-8\">\n          <div>\n            <h3 className=\"text-lg font-semibold mb-4\">About Us</h3>\n            <p className=\"text-gray-400\">\n              Your trusted source for property search and market analysis.\n            </p>\n          </div>\n          <div>\n            <h3 className=\"text-lg font-semibold mb-4\">Legal</h3>\n            <ul className=\"space-y-2 text-gray-400\">\n              <li>\n                <a href=\"/terms\" className=\"hover:text-white\">\n                  Terms of Service\n                </a>\n              </li>\n              <li>\n                <a href=\"/privacy\" className=\"hover:text-white\">\n                  Privacy Policy\n                </a>\n              </li>\n              <li>\n                <a href=\"/disclaimer\" className=\"hover:text-white\">\n                  Legal Disclaimer\n                </a>\n              </li>\n              <li>\n                <a href=\"/gdpr\" className=\"hover:text-white\">\n                  GDPR Compliance\n                </a>\n              </li>\n            </ul>\n          </div>\n          <div>\n            <h3 className=\"text-lg font-semibold mb-4\">Contact</h3>\n            <ul className=\"space-y-2 text-gray-400\">\n              <li>info@myvge.com</li>\n              <li>Lytchett House, 13 Freeland Park, Poole, Dorset, England, BH16 6FA</li>\n            </ul>\n          </div>\n          <div>\n            <h3 className=\"text-lg font-semibold mb-4\">Compliance</h3>\n            <ul className=\"space-y-2 text-gray-400\">\n              <li>Company No: 15271126</li>\n            </ul>\n          </div>\n        </div>\n        <div className=\"mt-8 pt-8 border-t border-gray-800 space-y-4\">\n          <RandomFact />\n          <div className=\"text-center text-gray-400 space-y-2\">\n            <p className=\"text-xs\">\n              MyVGE is registered in England and Wales. Registered office: Lytchett House, 13 Freeland Park, Poole, Dorset, England, BH16 6FA. Company No: 15271126\n            </p>\n            <p className=\"text-xs\">\n              The information on this website is for general information\n              purposes only and does not constitute financial advice.\n            </p>\n            <p>&copy; {new Date().getFullYear()} MyVGE. All rights reserved.</p>\n          </div>\n        </div>\n      </div>\n    </footer>\n  );\n}\n","import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","import React from \"react\";\nimport { Alert, AlertDescription } from \"./ui/alert\";\nimport { Info } from \"lucide-react\";\n\nexport function LegalDisclaimer() {\n  return (\n    <Alert className=\"bg-muted/50 border-muted-foreground/20\">\n      <Info className=\"h-4 w-4\" />\n      <AlertDescription className=\"text-xs text-muted-foreground\">\n        The information provided on this website is for general informational\n        purposes only and should not be considered as financial or investment\n        advice. Property investments carry risks and values can go down as well\n        as up. Always seek professional advice before making investment\n        decisions.\n      </AlertDescription>\n    </Alert>\n  );\n}\n","import { supabase } from './supabaseClient';\nimport { useQuery, useInfiniteQuery } from '@tanstack/react-query';\n\nexport interface Property {\n  id: string;\n  title: string;\n  description: string | null;\n  location: string;\n  price: number;\n  beds: number;\n  baths: number;\n  sqft: number;\n  image_url: string;\n  is_featured: boolean;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface SavedProperty {\n  id: string;\n  user_id: string;\n  property_id: string;\n  notes: string;\n  created_at: string;\n}\n\nexport interface Deal {\n  id: string;\n  title: string;\n  description: string;\n  location: string;\n  price: number;\n  roi_percentage: number;\n  investment_term: string;\n  property_type: string;\n  deal_type: string;\n  image_url: string;\n  created_at: string;\n  updated_at: string;\n}\n\nexport async function getFeaturedProperties(page: number, perPage: number) {\n  try {\n    const start = (page - 1) * perPage;\n    \n    console.log('Production URL:', import.meta.env.VITE_SUPABASE_URL);\n    console.log('Fetching properties with params:', { page, perPage, start });\n    \n    const { data, error } = await supabase\n      .from('properties')\n      .select(`\n        id,\n        title,\n        description,\n        location,\n        price,\n        beds,\n        baths,\n        sqft,\n        image_url,\n        is_featured,\n        created_at,\n        updated_at\n      `)\n      .eq('is_featured', true)\n      .range(start, start + perPage - 1)\n      .order('created_at', { ascending: false });\n\n    console.log('Raw Supabase response:', { data, error });\n\n    if (error) {\n      console.error('Supabase error:', error);\n      throw error;\n    }\n\n    if (!data || data.length === 0) {\n      console.log('No properties found');\n      return [];\n    }\n\n    // Map the data to ensure all required fields are present\n    const properties = data.map(p => ({\n      id: p.id || '',\n      title: p.title || '',\n      description: p.description || '',\n      location: p.location || '',\n      price: Number(p.price) || 0,\n      beds: Number(p.beds) || 0,\n      baths: Number(p.baths) || 0,\n      sqft: Number(p.sqft) || 0,\n      image_url: p.image_url || '',\n      is_featured: Boolean(p.is_featured),\n      created_at: p.created_at || new Date().toISOString(),\n      updated_at: p.updated_at || new Date().toISOString()\n    }));\n\n    console.log('Mapped properties:', properties);\n    return properties;\n\n  } catch (error) {\n    console.error('Error in getFeaturedProperties:', error);\n    return [];\n  }\n}\n\nexport const useFeaturedProperties = (limit = 6) => {\n  return useInfiniteQuery({\n    queryKey: ['featuredProperties'],\n    queryFn: ({ pageParam = 1 }) => getFeaturedProperties(pageParam, limit),\n    getNextPageParam: (lastPage, allPages) => {\n      return lastPage.length === limit ? allPages.length + 1 : undefined;\n    },\n    staleTime: 5 * 60 * 1000, // Data considered fresh for 5 minutes\n    cacheTime: 30 * 60 * 1000, // Cache data for 30 minutes\n  });\n};\n\nexport async function searchProperties(searchTerm: string): Promise<Property[]> {\n  try {\n    const { data, error } = await supabase\n      .from('properties')\n      .select(`\n        id,\n        title,\n        location,\n        price,\n        sqft,\n        beds,\n        baths,\n        description,\n        image_url,\n        is_featured,\n        created_at,\n        updated_at\n      `)\n      .or(`\n        location.ilike.%${searchTerm}%,\n        description.ilike.%${searchTerm}%,\n        title.ilike.%${searchTerm}%\n      `)\n      .order('created_at', { ascending: false });\n\n    if (error) throw error;\n    return data || [];\n  } catch (error) {\n    console.error('Error searching properties:', error);\n    return [];\n  }\n}\n\nexport async function getProperty(id: string): Promise<Property | null> {\n  const { data, error } = await supabase\n    .from(\"properties\")\n    .select(`\n      id,\n      title,\n      location,\n      price,\n      sqft,\n      beds,\n      baths,\n      description,\n      image_url,\n      is_featured,\n      created_at,\n      updated_at\n    `)\n    .eq(\"id\", id)\n    .single();\n\n  if (error) throw error;\n  return data;\n}\n\nexport async function saveProperty(\n  propertyId: string,\n  userId: string,\n  notes: string = \"\",\n) {\n  const { data, error } = await supabase\n    .from(\"saved_properties\")\n    .insert([\n      {\n        property_id: propertyId,\n        user_id: userId,\n        notes,\n      },\n    ])\n    .select()\n    .single();\n\n  if (error) throw error;\n  return data as SavedProperty;\n}\n\nexport async function getSavedProperties(userId: string) {\n  const { data, error } = await supabase\n    .from(\"saved_properties\")\n    .select(\n      `\n      *,\n      property:properties(*)\n    `,\n    )\n    .eq(\"user_id\", userId);\n\n  if (error) throw error;\n  return data;\n}\n\nexport async function getDeals(page: number, perPage: number) {\n  try {\n    const start = (page - 1) * perPage;\n    \n    console.log('Fetching deals with params:', { page, perPage, start });\n    \n    const { data, error } = await supabase\n      .from('deals')\n      .select(`\n        id,\n        title,\n        description,\n        location,\n        price,\n        roi_percentage,\n        investment_term,\n        property_type,\n        deal_type,\n        image_url,\n        created_at,\n        updated_at\n      `)\n      .range(start, start + perPage - 1)\n      .order('created_at', { ascending: false });\n\n    console.log('Raw Supabase deals response:', { data, error });\n\n    if (error) {\n      console.error('Supabase error:', error);\n      throw error;\n    }\n\n    if (!data || data.length === 0) {\n      console.log('No deals found');\n      return [];\n    }\n\n    // Map the data to ensure all required fields are present\n    const deals = data.map(d => ({\n      id: d.id || '',\n      title: d.title || '',\n      description: d.description || '',\n      location: d.location || '',\n      price: Number(d.price) || 0,\n      roi_percentage: Number(d.roi_percentage) || 0,\n      investment_term: d.investment_term || '',\n      property_type: d.property_type || '',\n      deal_type: d.deal_type || '',\n      image_url: d.image_url || '',\n      created_at: d.created_at || new Date().toISOString(),\n      updated_at: d.updated_at || new Date().toISOString()\n    }));\n\n    console.log('Mapped deals:', deals);\n    return deals;\n\n  } catch (error) {\n    console.error('Error in getDeals:', error);\n    return [];\n  }\n}\n\nexport const useDeals = (limit = 6) => {\n  return useInfiniteQuery({\n    queryKey: ['deals'],\n    queryFn: ({ pageParam = 1 }) => getDeals(pageParam, limit),\n    getNextPageParam: (lastPage, allPages) => {\n      return lastPage.length === limit ? allPages.length + 1 : undefined;\n    },\n    staleTime: 5 * 60 * 1000,\n    cacheTime: 30 * 60 * 1000,\n  });\n};\n","import { cn } from \"@/lib/utils\";\nimport React from \"react\";\n\ninterface MarqueeProps {\n  children: React.ReactNode;\n  direction?: \"left\" | \"right\" | \"up\" | \"down\";\n  pauseOnHover?: boolean;\n  reverse?: boolean;\n  fade?: boolean;\n  className?: string;\n  vertical?: boolean;\n}\n\nexport const Marquee = ({\n  children,\n  direction = \"left\",\n  pauseOnHover = false,\n  reverse = false,\n  fade = false,\n  className,\n  vertical = false,\n}: MarqueeProps) => {\n  return (\n    <div\n      className={cn(\n        \"group flex gap-4 overflow-hidden\",\n        vertical ? \"flex-col\" : \"flex-row\",\n        className\n      )}\n    >\n      <div\n        className={cn(\n          \"flex min-w-full shrink-0 animate-marquee items-center justify-around gap-4\",\n          vertical ? \"flex-col\" : \"flex-row\",\n          pauseOnHover && \"group-hover:[animation-play-state:paused]\",\n          reverse && \"animate-marquee-reverse\"\n        )}\n      >\n        {children}\n      </div>\n      <div\n        className={cn(\n          \"flex min-w-full shrink-0 animate-marquee items-center justify-around gap-4\",\n          vertical ? \"flex-col\" : \"flex-row\",\n          pauseOnHover && \"group-hover:[animation-play-state:paused]\",\n          reverse && \"animate-marquee-reverse\"\n        )}\n      >\n        {children}\n      </div>\n    </div>\n  );\n}; ","import React, { useRef, useEffect } from \"react\";\nimport { Renderer, Program, Mesh, Triangle } from \"ogl\";\n\ninterface LiquidChromeProps extends React.HTMLAttributes<HTMLDivElement> {\n  baseColor?: [number, number, number];\n  speed?: number;\n  amplitude?: number;\n  frequencyX?: number;\n  frequencyY?: number;\n  interactive?: boolean;\n}\n\nexport const LiquidChrome: React.FC<LiquidChromeProps> = ({\n  baseColor = [0.1, 0.1, 0.1],\n  speed = 0.2,\n  amplitude = 0.5,\n  frequencyX = 3,\n  frequencyY = 2,\n  interactive = true,\n  ...props\n}) => {\n  const containerRef = useRef<HTMLDivElement | null>(null);\n\n  useEffect(() => {\n    if (!containerRef.current) return;\n\n    const container = containerRef.current;\n    const renderer = new Renderer({ antialias: true });\n    const gl = renderer.gl;\n    gl.clearColor(1, 1, 1, 1);\n\n    const vertexShader = `\n      attribute vec2 position;\n      attribute vec2 uv;\n      varying vec2 vUv;\n      void main() {\n        vUv = uv;\n        gl_Position = vec4(position, 0.0, 1.0);\n      }\n    `;\n\n    const fragmentShader = `\n      precision highp float;\n      uniform float uTime;\n      uniform vec3 uResolution;\n      uniform vec3 uBaseColor;\n      uniform float uAmplitude;\n      uniform float uFrequencyX;\n      uniform float uFrequencyY;\n      uniform vec2 uMouse;\n      varying vec2 vUv;\n\n      vec4 renderImage(vec2 uvCoord) {\n          vec2 fragCoord = uvCoord * uResolution.xy;\n          vec2 uv = (2.0 * fragCoord - uResolution.xy) / min(uResolution.x, uResolution.y);\n\n          for (float i = 1.0; i < 10.0; i++){\n              uv.x += uAmplitude / i * cos(i * uFrequencyX * uv.y + uTime + uMouse.x * 3.14159);\n              uv.y += uAmplitude / i * cos(i * uFrequencyY * uv.x + uTime + uMouse.y * 3.14159);\n          }\n\n          vec2 diff = (uvCoord - uMouse);\n          float dist = length(diff);\n          float falloff = exp(-dist * 20.0);\n          float ripple = sin(10.0 * dist - uTime * 2.0) * 0.03;\n          uv += (diff / (dist + 0.0001)) * ripple * falloff;\n\n          vec3 color = uBaseColor / abs(sin(uTime - uv.y - uv.x));\n          return vec4(color, 1.0);\n      }\n\n      void main() {\n          vec4 col = vec4(0.0);\n          int samples = 0;\n          for (int i = -1; i <= 1; i++){\n              for (int j = -1; j <= 1; j++){\n                  vec2 offset = vec2(float(i), float(j)) * (1.0 / min(uResolution.x, uResolution.y));\n                  col += renderImage(vUv + offset);\n                  samples++;\n              }\n          }\n          gl_FragColor = col / float(samples);\n      }\n    `;\n\n    const geometry = new Triangle(gl);\n    const program = new Program(gl, {\n      vertex: vertexShader,\n      fragment: fragmentShader,\n      uniforms: {\n        uTime: { value: 0 },\n        uResolution: {\n          value: new Float32Array([\n            gl.canvas.width,\n            gl.canvas.height,\n            gl.canvas.width / gl.canvas.height,\n          ]),\n        },\n        uBaseColor: { value: new Float32Array(baseColor) },\n        uAmplitude: { value: amplitude },\n        uFrequencyX: { value: frequencyX },\n        uFrequencyY: { value: frequencyY },\n        uMouse: { value: new Float32Array([0, 0]) },\n      },\n    });\n    const mesh = new Mesh(gl, { geometry, program });\n\n    function resize() {\n      const scale = 1;\n      renderer.setSize(\n        container.offsetWidth * scale,\n        container.offsetHeight * scale\n      );\n      const resUniform = program.uniforms.uResolution.value as Float32Array;\n      resUniform[0] = gl.canvas.width;\n      resUniform[1] = gl.canvas.height;\n      resUniform[2] = gl.canvas.width / gl.canvas.height;\n    }\n    window.addEventListener(\"resize\", resize);\n    resize();\n\n    function handleMouseMove(event: MouseEvent) {\n      const rect = container.getBoundingClientRect();\n      const x = (event.clientX - rect.left) / rect.width;\n      const y = 1 - (event.clientY - rect.top) / rect.height;\n      const mouseUniform = program.uniforms.uMouse.value as Float32Array;\n      mouseUniform[0] = x;\n      mouseUniform[1] = y;\n    }\n\n    function handleTouchMove(event: TouchEvent) {\n      if (event.touches.length > 0) {\n        const touch = event.touches[0];\n        const rect = container.getBoundingClientRect();\n        const x = (touch.clientX - rect.left) / rect.width;\n        const y = 1 - (touch.clientY - rect.top) / rect.height;\n        const mouseUniform = program.uniforms.uMouse.value as Float32Array;\n        mouseUniform[0] = x;\n        mouseUniform[1] = y;\n      }\n    }\n\n    if (interactive) {\n      container.addEventListener(\"mousemove\", handleMouseMove);\n      container.addEventListener(\"touchmove\", handleTouchMove);\n    }\n\n    let animationId: number;\n    function update(t: number) {\n      animationId = requestAnimationFrame(update);\n      program.uniforms.uTime.value = t * 0.001 * speed;\n      renderer.render({ scene: mesh });\n    }\n    animationId = requestAnimationFrame(update);\n\n    container.appendChild(gl.canvas);\n\n    return () => {\n      cancelAnimationFrame(animationId);\n      window.removeEventListener(\"resize\", resize);\n      if (interactive) {\n        container.removeEventListener(\"mousemove\", handleMouseMove);\n        container.removeEventListener(\"touchmove\", handleTouchMove);\n      }\n      if (gl.canvas.parentElement) {\n        gl.canvas.parentElement.removeChild(gl.canvas);\n      }\n      gl.getExtension(\"WEBGL_lose_context\")?.loseContext();\n    };\n  }, [baseColor, speed, amplitude, frequencyX, frequencyY, interactive]);\n\n  return (\n    <div\n      ref={containerRef}\n      className=\"w-full h-full\"\n      {...props}\n    />\n  );\n};\n\nexport default LiquidChrome; ","import React from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n} from \"./ui/dialog\";\nimport { Button } from \"./ui/button\";\nimport { Badge } from \"./ui/badge\";\nimport { formatCurrency, formatDate, formatNumber } from \"../lib/utils\";\nimport {\n  Bed,\n  Bath,\n  Square,\n  Home,\n  Calendar,\n  User,\n  Phone,\n  Mail,\n  MapPin,\n  Clock,\n  ArrowUpRight,\n  ArrowDownRight,\n  Percent,\n  PoundSterling,\n  Building,\n  Compass,\n  FileText,\n  Info,\n} from \"lucide-react\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"./ui/tabs\";\nimport { UserProfile } from \"../lib/auth\";\nimport { User as AuthUser } from \"@supabase/supabase-js\";\n\ninterface PropertyModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  property: any;\n  currentUser?: AuthUser | null;\n  userProfile?: UserProfile | null;\n}\n\nexport function PropertyModal({\n  isOpen,\n  onClose,\n  property,\n  currentUser,\n  userProfile\n}: PropertyModalProps) {\n  // Remove the useAuth hook\n  // const { user } = useAuth();\n  const isAuthenticated = !!currentUser;\n  \n  const isSubscriber = userProfile?.subscription_tier === \"pro\";\n\n  if (!property) return null;\n\n  // Format price for display\n  const price = property.price\n    ? formatCurrency(Number(property.price))\n    : \"Price on application\";\n\n  // Determine address components\n  let address = property.location || property.address || \"Address not available\";\n  let postcode = property.postcode || property.location?.match(/[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}/i)?.[0] || \"\";\n\n  // Extract property details\n  const propertyType = property.property_type || \"Residential\";\n  const bedrooms = property.beds || property.bedrooms || 0;\n  const bathrooms = property.baths || property.bathrooms || 0;\n  const squareFootage = property.square_footage || property.sqft || 0;\n  const tenure = property.tenure || \"Freehold\";\n  const description = property.description || \"No description available\";\n\n  // Sale history processing\n  const saleHistory = property.sale_history || [];\n  \n  // Filter out sale history entries with invalid or undefined prices\n  const validSaleHistory = saleHistory\n    .filter((sale: any) => sale && sale.sale_price && !isNaN(Number(sale.sale_price)))\n    .sort((a: any, b: any) => new Date(b.sale_date).getTime() - new Date(a.sale_date).getTime());\n\n  // Calculate price growth percentage if there are multiple valid sales\n  let priceGrowthPercentage = 0;\n  if (validSaleHistory.length > 1) {\n    const mostRecentPrice = Number(validSaleHistory[0].sale_price);\n    const oldestPrice = Number(validSaleHistory[validSaleHistory.length - 1].sale_price);\n    priceGrowthPercentage = ((mostRecentPrice - oldestPrice) / oldestPrice) * 100;\n  }\n\n  // Calculate mortgage estimates\n  const calculateMortgage = (price: number, downPaymentPercent: number, interestRate: number, termYears: number) => {\n    const loanAmount = price * (1 - downPaymentPercent / 100);\n    const monthlyRate = interestRate / 100 / 12;\n    const numPayments = termYears * 12;\n    \n    const monthlyPayment = (loanAmount * monthlyRate * Math.pow(1 + monthlyRate, numPayments)) / \n                          (Math.pow(1 + monthlyRate, numPayments) - 1);\n    \n    return {\n      monthlyPayment,\n      totalInterest: (monthlyPayment * numPayments) - loanAmount,\n      totalCost: monthlyPayment * numPayments,\n    };\n  };\n  \n  // Default mortgage calculation (assuming 20% down, 4.5% interest, 25 year term)\n  const mortgage = calculateMortgage(\n    Number(property.price) || 0,\n    20,\n    4.5,\n    25\n  );\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto p-0\">\n        <div className=\"relative h-72 overflow-hidden\">\n          <img\n            src={\n              property.image_url ||\n              `https://source.unsplash.com/random/1200x600?property,house&sig=${property.id}`\n            }\n            alt={address}\n            className=\"w-full h-full object-cover\"\n          />\n          <div className=\"absolute top-4 left-4 flex gap-2\">\n            <Badge className=\"bg-primary text-white\">\n              {propertyType}\n            </Badge>\n            {property.status && (\n              <Badge variant=\"secondary\">{property.status}</Badge>\n            )}\n          </div>\n          </div>\n\n        <div className=\"p-6\">\n          <DialogHeader className=\"mb-6\">\n            <div className=\"flex justify-between items-start\">\n              <DialogTitle className=\"text-2xl font-bold\">\n                {price}\n              </DialogTitle>\n              <div className=\"flex items-center gap-1\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"text-sm\"\n                  onClick={(e) => e.stopPropagation()}\n                >\n                  Save\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"text-sm\"\n                  onClick={(e) => e.stopPropagation()}\n                >\n                  Share\n                </Button>\n              </div>\n            </div>\n            <DialogDescription className=\"text-base font-medium text-foreground mt-1\">\n              {address}\n            </DialogDescription>\n          </DialogHeader>\n\n          <Tabs defaultValue=\"details\" className=\"mt-6\">\n            <TabsList className=\"grid grid-cols-3 mb-6\">\n              <TabsTrigger value=\"details\">Property Details</TabsTrigger>\n              <TabsTrigger value=\"investment\">Investment Metrics</TabsTrigger>\n              <TabsTrigger value=\"history\">History & Area</TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"details\" className=\"space-y-6\">\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                <div className=\"flex flex-col items-center justify-center p-3 bg-muted rounded-lg\">\n                  <Bed className=\"h-5 w-5 mb-1 text-muted-foreground\" />\n                  <span className=\"text-sm font-medium\">{bedrooms} Bedrooms</span>\n                </div>\n                <div className=\"flex flex-col items-center justify-center p-3 bg-muted rounded-lg\">\n                  <Bath className=\"h-5 w-5 mb-1 text-muted-foreground\" />\n                  <span className=\"text-sm font-medium\">{bathrooms} Bathrooms</span>\n                </div>\n                <div className=\"flex flex-col items-center justify-center p-3 bg-muted rounded-lg\">\n                  <Square className=\"h-5 w-5 mb-1 text-muted-foreground\" />\n                  <span className=\"text-sm font-medium\">{formatNumber(squareFootage)} sq ft</span>\n                </div>\n                <div className=\"flex flex-col items-center justify-center p-3 bg-muted rounded-lg\">\n                  <Building className=\"h-5 w-5 mb-1 text-muted-foreground\" />\n                  <span className=\"text-sm font-medium\">{tenure}</span>\n                </div>\n              </div>\n\n              <div>\n                <h3 className=\"text-lg font-semibold mb-2 flex items-center\">\n                  <MapPin className=\"h-5 w-5 mr-2 text-muted-foreground\" />\n                  Location\n                </h3>\n                <div className=\"bg-muted rounded-lg p-4\">\n                  <p className=\"text-sm mb-1\">\n                    <span className=\"font-medium\">Address:</span> {address}\n                  </p>\n                  {postcode && (\n                    <p className=\"text-sm\">\n                      <span className=\"font-medium\">Postcode:</span> {postcode}\n                    </p>\n                  )}\n                </div>\n              </div>\n\n              <div>\n                <h3 className=\"text-lg font-semibold mb-2 flex items-center\">\n                  <Info className=\"h-5 w-5 mr-2 text-muted-foreground\" />\n                  Description\n                </h3>\n                <div className=\"bg-muted rounded-lg p-4\">\n                  <p className=\"text-sm whitespace-pre-line\">{description}</p>\n              </div>\n            </div>\n\n            <div>\n                <h3 className=\"text-lg font-semibold mb-2 flex items-center\">\n                  <FileText className=\"h-5 w-5 mr-2 text-muted-foreground\" />\n                  Property Documents\n                </h3>\n                <div className=\"bg-muted rounded-lg p-4\">\n                  <p className=\"text-sm mb-2\">\n                    {isAuthenticated && isSubscriber ? (\n                      <ul className=\"space-y-2\">\n                        <li className=\"flex items-center\">\n                          <FileText className=\"h-4 w-4 mr-2 text-muted-foreground\" />\n                          <span className=\"text-primary underline cursor-pointer\">\n                            Energy Performance Certificate (EPC)\n                          </span>\n                        </li>\n                        <li className=\"flex items-center\">\n                          <FileText className=\"h-4 w-4 mr-2 text-muted-foreground\" />\n                          <span className=\"text-primary underline cursor-pointer\">\n                            Floor Plan\n                          </span>\n                        </li>\n                        <li className=\"flex items-center\">\n                          <FileText className=\"h-4 w-4 mr-2 text-muted-foreground\" />\n                          <span className=\"text-primary underline cursor-pointer\">\n                            Property Brochure\n                          </span>\n                        </li>\n                      </ul>\n                    ) : (\n                      <div className=\"text-center py-2\">\n                        <p className=\"text-muted-foreground mb-2\">\n                          Upgrade to PRO to access property documents\n                        </p>\n                        <Button className=\"text-sm\" size=\"sm\">\n                          Upgrade Now\n                        </Button>\n            </div>\n                    )}\n              </p>\n            </div>\n          </div>\n            </TabsContent>\n\n            <TabsContent value=\"investment\" className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-3 flex items-center\">\n                    <PoundSterling className=\"h-5 w-5 mr-2 text-muted-foreground\" />\n                    Investment Metrics\n                  </h3>\n                  <div className=\"bg-muted rounded-lg p-4 space-y-3\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Estimated Monthly Rent</span>\n                      <span className=\"font-medium\">\n                        {formatCurrency(property.estimated_rent || property.price * 0.004)}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Rental Yield</span>\n                      <span className=\"font-medium\">\n                        {property.rental_yield ? property.rental_yield.toFixed(2) : ((property.price * 0.004 * 12) / property.price * 100).toFixed(2)}%\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Estimated ROI (5yr)</span>\n                      <span className=\"font-medium\">\n                        {property.roi ? property.roi.toFixed(2) : ((property.price * 0.25) / property.price * 100).toFixed(2)}%\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Price per sq ft</span>\n                      <span className=\"font-medium\">\n                        {squareFootage > 0 ? formatCurrency(property.price / squareFootage) : \"N/A\"}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-3 flex items-center\">\n                    <Compass className=\"h-5 w-5 mr-2 text-muted-foreground\" />\n                    Area Insights\n                  </h3>\n                  <div className=\"bg-muted rounded-lg p-4 space-y-3\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Average Area Price</span>\n                      <span className=\"font-medium\">\n                        {formatCurrency(property.area_avg_price || property.price * 1.1)}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Price vs. Area Average</span>\n                      <div className=\"flex items-center\">\n                        {property.price < (property.area_avg_price || property.price * 1.1) ? (\n                          <>\n                            <ArrowDownRight className=\"h-4 w-4 text-green-500 mr-1\" />\n                            <span className=\"text-green-500 font-medium\">\n                              {(((property.area_avg_price || property.price * 1.1) - property.price) / (property.area_avg_price || property.price * 1.1) * 100).toFixed(1)}% below\n                            </span>\n                          </>\n                        ) : (\n                          <>\n                            <ArrowUpRight className=\"h-4 w-4 text-amber-500 mr-1\" />\n                            <span className=\"text-amber-500 font-medium\">\n                              {((property.price - (property.area_avg_price || property.price * 0.9)) / (property.area_avg_price || property.price * 0.9) * 100).toFixed(1)}% above\n                            </span>\n                          </>\n                        )}\n                      </div>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">12-month Price Trend</span>\n                      <div className=\"flex items-center\">\n                        <ArrowUpRight className=\"h-4 w-4 text-green-500 mr-1\" />\n                        <span className=\"text-green-500 font-medium\">+4.2%</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                </div>\n\n              <div>\n                <h3 className=\"text-lg font-semibold mb-3 flex items-center\">\n                  <PoundSterling className=\"h-5 w-5 mr-2 text-muted-foreground\" />\n                  Mortgage Calculator\n                </h3>\n                <div className=\"bg-muted rounded-lg p-4\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">\n                    <div>\n                      <p className=\"text-sm mb-1\">Property Price</p>\n                      <p className=\"text-lg font-medium\">{formatCurrency(Number(property.price) || 0)}</p>\n                    </div>\n                    <div>\n                      <p className=\"text-sm mb-1\">Monthly Payment</p>\n                      <p className=\"text-lg font-medium\">{formatCurrency(mortgage.monthlyPayment)}</p>\n                    </div>\n                <div>\n                      <p className=\"text-sm mb-1\">Total Interest</p>\n                      <p className=\"text-lg font-medium\">{formatCurrency(mortgage.totalInterest)}</p>\n                    </div>\n                  </div>\n                  <p className=\"text-xs text-muted-foreground text-center mt-2\">\n                    Based on 20% down payment, 4.5% interest rate, 25-year term\n                  </p>\n                </div>\n                </div>\n\n                <div>\n                <h3 className=\"text-lg font-semibold mb-3 flex items-center\">\n                  <PoundSterling className=\"h-5 w-5 mr-2 text-muted-foreground\" />\n                  Cash Flow Analysis\n                </h3>\n                <div className=\"bg-muted rounded-lg p-4\">\n                  <div className=\"space-y-3\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Monthly Rental Income</span>\n                      <span className=\"font-medium\">\n                        {formatCurrency(property.estimated_rent || property.price * 0.004)}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Mortgage Payment</span>\n                      <span className=\"font-medium text-red-500\">\n                        -{formatCurrency(mortgage.monthlyPayment)}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Est. Maintenance (10%)</span>\n                      <span className=\"font-medium text-red-500\">\n                        -{formatCurrency((property.estimated_rent || property.price * 0.004) * 0.1)}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Est. Management (5%)</span>\n                      <span className=\"font-medium text-red-500\">\n                        -{formatCurrency((property.estimated_rent || property.price * 0.004) * 0.05)}\n                      </span>\n                    </div>\n                    <div className=\"border-t pt-2 mt-2 flex justify-between items-center\">\n                      <span className=\"text-sm font-medium\">Monthly Cash Flow</span>\n                      <span className=\"font-medium\">\n                        {formatCurrency(\n                          (property.estimated_rent || property.price * 0.004) - \n                          mortgage.monthlyPayment - \n                          (property.estimated_rent || property.price * 0.004) * 0.15\n                        )}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </TabsContent>\n\n            <TabsContent value=\"history\" className=\"space-y-6\">\n              <div>\n                <h3 className=\"text-lg font-semibold mb-3 flex items-center\">\n                  <Calendar className=\"h-5 w-5 mr-2 text-muted-foreground\" />\n                  Sale History\n                </h3>\n                {validSaleHistory.length > 0 ? (\n                  <div className=\"bg-muted rounded-lg p-4\">\n                    <div className=\"mb-4\">\n                      {priceGrowthPercentage !== 0 && (\n                        <div className=\"mb-3 text-sm\">\n                          <span className=\"font-medium\">Total price growth: </span>\n                          <span className={priceGrowthPercentage >= 0 ? \"text-green-500\" : \"text-red-500\"}>\n                            {priceGrowthPercentage >= 0 ? \"+\" : \"\"}{priceGrowthPercentage.toFixed(2)}%\n                          </span>\n                        </div>\n                      )}\n                      \n                      {/* Sale History Chart */}\n                      <div className=\"relative h-24 mt-6 mb-2\">\n                        {validSaleHistory.map((sale: any, index: number) => {\n                          const maxPrice = Math.max(...validSaleHistory.map((s: any) => Number(s.sale_price)));\n                          const height = (Number(sale.sale_price) / maxPrice) * 100;\n                          const width = 100 / validSaleHistory.length;\n                          const position = index * width;\n                          \n                          return (\n                            <div \n                              key={index}\n                              className=\"absolute bottom-0 bg-primary hover:bg-primary/80 rounded-t transition-all cursor-pointer group\"\n                              style={{\n                                height: `${height}%`,\n                                width: `${width - 5}%`,\n                                left: `${position}%`\n                              }}\n                              title={`${formatDate(sale.sale_date)}: ${formatCurrency(Number(sale.sale_price))}`}\n                            >\n                              <div className=\"opacity-0 group-hover:opacity-100 absolute -top-10 left-1/2 transform -translate-x-1/2 bg-background border p-2 rounded text-xs whitespace-nowrap z-10\">\n                                {formatDate(sale.sale_date)}: {formatCurrency(Number(sale.sale_price))}\n                              </div>\n                            </div>\n                          );\n                        })}\n                      </div>\n                    </div>\n                    \n                    <div className=\"space-y-3\">\n                      {validSaleHistory.map((sale: any, index: number) => (\n                        <div key={index} className=\"flex justify-between items-center py-1\">\n                          <div className=\"flex items-center\">\n                            <Calendar className=\"h-4 w-4 mr-2 text-muted-foreground\" />\n                            <span className=\"text-sm\">{formatDate(sale.sale_date)}</span>\n                          </div>\n                          <span className=\"font-medium\">{formatCurrency(Number(sale.sale_price))}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"bg-muted rounded-lg p-4 text-center\">\n                    <p className=\"text-muted-foreground\">No sale history available</p>\n                  </div>\n                )}\n              </div>\n\n              <div>\n                <h3 className=\"text-lg font-semibold mb-3 flex items-center\">\n                  <Compass className=\"h-5 w-5 mr-2 text-muted-foreground\" />\n                  Neighborhood Information\n                </h3>\n                {isAuthenticated && isSubscriber ? (\n                  <div className=\"bg-muted rounded-lg p-4 space-y-3\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Local Schools</span>\n                      <Badge variant=\"outline\">Good</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Transport Links</span>\n                      <Badge variant=\"outline\">Excellent</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Local Amenities</span>\n                      <Badge variant=\"outline\">Good</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm\">Crime Rate</span>\n                      <Badge variant=\"outline\">Low</Badge>\n                    </div>\n                    <div className=\"mt-2 pt-2 border-t\">\n                      <p className=\"text-sm text-muted-foreground\">\n                        This property is located in a well-established residential area with good \n                        local schools and excellent transport links. The neighborhood has seen \n                        steady property value growth over the past 5 years.\n                      </p>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"bg-muted rounded-lg p-4 text-center\">\n                    <p className=\"text-muted-foreground mb-2\">\n                      Upgrade to PRO to access detailed neighborhood information\n                    </p>\n                    <Button className=\"text-sm\" size=\"sm\">\n                      Upgrade Now\n                    </Button>\n                  </div>\n                )}\n          </div>\n            </TabsContent>\n          </Tabs>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n} ","import React from \"react\";\nimport Header from \"./Header\";\nimport HeroSection from \"./HeroSection\";\nimport { PropertyCard } from \"./PropertyCard\";\nimport { AuthModal } from \"./AuthModal\";\nimport { SubscriptionModal } from \"./SubscriptionModal\";\nimport { MessagesModal } from \"./MessagesModal\";\nimport { Footer } from \"./Footer\";\nimport { LegalDisclaimer } from \"./LegalDisclaimer\";\nimport { useAuth } from \"../lib/auth\";\nimport { searchProperties, getFeaturedProperties, Property, useDeals } from \"../lib/properties\";\nimport { Marquee } from \"./ui/Marquee\";\nimport { cn } from \"../lib/utils\";\nimport { LiquidChrome } from \"./LiquidChrome\";\nimport { PropertyModal } from \"./PropertyModal\";\nimport { LoadingSpinner } from \"./ui/loading-spinner\";\n\ntype AuthMode = \"signin\" | \"signup\";\n\nconst reviews = [\n  {\n    name: \"Savills\",\n    username: \"@savills\",\n    body: \"Leading the way in property investment and market analysis.\",\n    img: \"https://avatar.vercel.sh/savills\",\n  },\n  {\n    name: \"Knight Frank\",\n    username: \"@knightfrank\",\n    body: \"Exceptional platform for property investment insights.\",\n    img: \"https://avatar.vercel.sh/knightfrank\",\n  },\n  {\n    name: \"JLL\",\n    username: \"@jll\",\n    body: \"Revolutionary approach to property investment analytics.\",\n    img: \"https://avatar.vercel.sh/jll\",\n  },\n];\n\nconst firstRow = reviews.slice(0, reviews.length / 2);\nconst secondRow = reviews.slice(reviews.length / 2);\nconst thirdRow = reviews.slice(0, reviews.length / 2);\nconst fourthRow = reviews.slice(reviews.length / 2);\n\nconst ReviewCard = ({\n  img,\n  name,\n  username,\n  body,\n}: {\n  img: string;\n  name: string;\n  username: string;\n  body: string;\n}) => {\n  return (\n    <figure\n      className={cn(\n        \"relative h-full w-36 cursor-pointer overflow-hidden rounded-xl border p-4\",\n        \"border-gray-950/[.1] bg-gray-950/[.01] hover:bg-gray-950/[.05]\",\n        \"dark:border-gray-50/[.1] dark:bg-gray-50/[.10] dark:hover:bg-gray-50/[.15]\",\n      )}\n    >\n      <div className=\"flex flex-row items-center gap-2\">\n        <img className=\"rounded-full\" width=\"32\" height=\"32\" alt=\"\" src={img} />\n        <div className=\"flex flex-col\">\n          <figcaption className=\"text-sm font-medium dark:text-white\">\n            {name}\n          </figcaption>\n          <p className=\"text-xs font-medium dark:text-white/40\">{username}</p>\n        </div>\n      </div>\n      <blockquote className=\"mt-2 text-sm\">{body}</blockquote>\n    </figure>\n  );\n};\n\nconst Home = () => {\n  const { user, profile, signOut } = useAuth();\n  const [isInitialLoad, setIsInitialLoad] = React.useState(true);\n  const [searchResults, setSearchResults] = React.useState<Property[]>([]);\n  const [isSearching, setIsSearching] = React.useState(false);\n  const [isAuthModalOpen, setIsAuthModalOpen] = React.useState(false);\n  const [isSubscriptionModalOpen, setIsSubscriptionModalOpen] =\n    React.useState(false);\n  const [authMode, setAuthMode] = React.useState(\"signin\");\n  const [isMessagesModalOpen, setIsMessagesModalOpen] = React.useState(false);\n  const [selectedReceiverId] = React.useState();\n  const [page, setPage] = React.useState(1);\n  const [hasMore, setHasMore] = React.useState(true);\n  const PROPERTIES_PER_PAGE = 6;\n  const [isLoading, setIsLoading] = React.useState(true);\n  const [isFetchingMore, setIsFetchingMore] = React.useState(false);\n  const [selectedProperty, setSelectedProperty] = React.useState<Property | null>(null);\n  const [isPropertyModalOpen, setIsPropertyModalOpen] = React.useState(false);\n  const observerTarget = React.useRef<HTMLDivElement>(null);\n  const loadingRef = React.useRef(false);\n  const { data: dealsData, isLoading: isLoadingDeals } = useDeals();\n\n  const loadFeaturedProperties = async (pageNum = 1, isLoadingMore = false) => {\n    if (loadingRef.current) return;\n    loadingRef.current = true;\n\n    try {\n      if (!isLoadingMore) {\n        setIsLoading(true);\n      } else {\n        setIsFetchingMore(true);\n      }\n      \n      console.log('Fetching page:', pageNum);\n      const properties = await getFeaturedProperties(pageNum, PROPERTIES_PER_PAGE);\n      console.log('Received properties:', properties);\n      \n      if (pageNum === 1) {\n        setSearchResults(properties);\n      } else {\n        setSearchResults(prev => [...prev, ...properties]);\n      }\n      \n      setHasMore(properties.length === PROPERTIES_PER_PAGE);\n      setPage(pageNum);\n      setIsInitialLoad(false);\n    } catch (error) {\n      console.error(\"Error loading properties:\", error);\n    } finally {\n      setIsLoading(false);\n      setIsFetchingMore(false);\n      loadingRef.current = false;\n    }\n  };\n\n  React.useEffect(() => {\n    if (isInitialLoad) {\n      loadFeaturedProperties(1, false);\n    }\n  }, [isInitialLoad]);\n\n  React.useEffect(() => {\n    if (!observerTarget.current || isInitialLoad || isSearching) return;\n\n    const observer = new IntersectionObserver(\n      entries => {\n        if (entries[0].isIntersecting && hasMore && !loadingRef.current) {\n          loadFeaturedProperties(page + 1, true);\n        }\n      },\n      { \n        rootMargin: '200px',\n        threshold: 0.1\n      }\n    );\n\n    observer.observe(observerTarget.current);\n    return () => observer.disconnect();\n  }, [hasMore, page, isInitialLoad, isSearching]);\n\n  const handleSearch = async (term: string) => {\n    if (!term.trim()) {\n      // Reset all states when clearing search\n      setSearchResults([]);\n      setIsSearching(false);\n      setPage(1);\n      setHasMore(true);\n      setIsLoading(true);\n      try {\n        const properties = await getFeaturedProperties(1, PROPERTIES_PER_PAGE);\n        setSearchResults(properties);\n        setHasMore(properties.length === PROPERTIES_PER_PAGE);\n      } catch (error) {\n        console.error(\"Error loading properties:\", error);\n      } finally {\n        setIsLoading(false);\n      }\n      return;\n    }\n\n    setIsSearching(true);\n    setSearchResults([]); // Clear existing results before search\n    try {\n      const results = await searchProperties(term);\n      // Map the results to match the Property interface\n      const mappedResults = results.map(p => ({\n        id: p.id,\n        title: p.title,\n        location: p.location,\n        price: p.price,\n        sqft: p.sqft,\n        beds: p.beds,\n        baths: p.baths,\n        description: p.description,\n        image_url: p.image_url,\n        is_featured: p.is_featured,\n        created_at: p.created_at,\n        updated_at: p.updated_at\n      }));\n      \n      setSearchResults(mappedResults);\n      setHasMore(false); // Disable infinite scroll for search results\n      setPage(1); // Reset page number\n    } catch (error) {\n      console.error(\"Error searching properties:\", error);\n      setSearchResults([]); // Clear results on error\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  // Render conditions\n  const showLoading = isLoading;\n  const showProperties = searchResults && searchResults.length > 0;\n  console.log('Render state:', { \n    isLoading, \n    searchResultsLength: searchResults?.length,\n    showLoading,\n    showProperties \n  });\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Header\n        isAuthenticated={!!user}\n        userProfile={profile || undefined}\n        onSignIn={() => {\n          setAuthMode(\"signin\");\n          setIsAuthModalOpen(true);\n        }}\n        onSignUp={() => {\n          setAuthMode(\"signup\");\n          setIsAuthModalOpen(true);\n        }}\n        onSignOut={async () => {\n          try {\n            await signOut();\n            window.location.href = \"/\";\n          } catch (error) {\n            console.error(\"Error signing out:\", error);\n          }\n        }}\n      />\n\n      <main>\n        <HeroSection onSearch={handleSearch} />\n\n        <div className=\"w-full bg-background py-8\">\n          <div className=\"max-w-[1200px] mx-auto px-4 sm:px-8\">\n            <h2 className=\"text-2xl font-bold mb-6\">\n              {isSearching ? \"Search Results\" : \"Featured Properties\"}\n            </h2>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8\">\n              {showLoading ? (\n                Array(3).fill(0).map((_, i) => (\n                  <div\n                    key={i}\n                    className=\"w-full h-[420px] bg-muted rounded-lg animate-pulse\"\n                  />\n                ))\n              ) : showProperties ? (\n                searchResults.map((property) => (\n                  <div \n                    key={property.id || Math.random().toString()} \n                    onClick={() => {\n                      setSelectedProperty(property);\n                      setIsPropertyModalOpen(true);\n                    }}\n                    className=\"cursor-pointer hover:opacity-90 transition-opacity\"\n                  >\n                    <PropertyCard\n                      id={property.id}\n                      address={property.location || 'Location not available'}\n                      price={Number(property.price) || 0}\n                      squareFootage={Number(property.sqft) || 0}\n                      bedrooms={Number(property.beds) || 0}\n                      bathrooms={Number(property.baths) || 0}\n                      isPremium={Boolean(property.is_featured)}\n                      propertyType=\"residential\"\n                      description={property.description || ''}\n                      createdAt={property.created_at || new Date().toISOString()}\n                      images={property.image_url ? [property.image_url] : []}\n                      currentUser={user}\n                      userProfile={profile}\n                    />\n                  </div>\n                ))\n              ) : (\n                <div className=\"col-span-3 text-center py-8 text-muted-foreground\">\n                  No properties found\n                </div>\n              )}\n            </div>\n            \n            {hasMore && !isLoading && !isSearching && (\n              <div \n                ref={observerTarget} \n                className=\"h-24 flex items-center justify-center my-8\"\n              >\n                {isFetchingMore ? (\n                  <div className=\"flex flex-col items-center gap-2\">\n                    <LoadingSpinner />\n                    <p className=\"text-sm text-muted-foreground\">Loading more properties...</p>\n                  </div>\n                ) : (\n                  <div className=\"h-8\" />\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Investment Deals Section */}\n        <div className=\"w-full bg-background py-8\">\n          <div className=\"max-w-[1200px] mx-auto px-4 sm:px-8\">\n            <h2 className=\"text-2xl font-bold mb-6\">Investment Deals</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {isLoadingDeals ? (\n                Array(3).fill(0).map((_, i) => (\n                  <div key={i} className=\"w-full h-[420px] bg-muted rounded-lg animate-pulse\" />\n                ))\n              ) : dealsData?.pages?.[0] && Array.isArray(dealsData.pages[0]) ? (\n                dealsData.pages[0].map((deal: any) => (\n                  <PropertyCard\n                    key={deal.id}\n                    id={deal.id}\n                    address={deal.location}\n                    price={deal.price}\n                    description={deal.description}\n                    propertyType={deal.property_type}\n                    createdAt={deal.created_at}\n                    images={[deal.image_url]}\n                    isDeal={true}\n                    roi_percentage={deal.roi_percentage}\n                    investment_term={deal.investment_term}\n                    deal_type={deal.deal_type}\n                    isPremium={true}\n                    currentUser={user}\n                    userProfile={profile}\n                  />\n                ))\n              ) : (\n                <div className=\"col-span-3 text-center py-8 text-muted-foreground\">\n                  No investment deals available\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Trusted by Industry Leaders Section */}\n        <section className=\"w-full py-12 bg-background\">\n          <div className=\"container mx-auto text-center mb-8\">\n            <h2 className=\"text-3xl font-bold mb-4\">Trusted by Industry Leaders</h2>\n  \n          </div>\n          <div className=\"relative flex h-96 w-full flex-row items-center justify-center gap-4 overflow-hidden [perspective:300px]\">\n            <div\n              className=\"flex flex-row items-center gap-4\"\n              style={{\n                transform:\n                  \"translateX(-100px) translateY(0px) translateZ(-100px) rotateX(20deg) rotateY(-10deg) rotateZ(20deg)\",\n              }}\n            >\n              <Marquee pauseOnHover vertical className=\"[--duration:20s]\">\n                {firstRow.map((review) => (\n                  <ReviewCard key={review.username} {...review} />\n                ))}\n              </Marquee>\n              <Marquee reverse pauseOnHover className=\"[--duration:20s]\" vertical>\n                {secondRow.map((review) => (\n                  <ReviewCard key={review.username} {...review} />\n                ))}\n              </Marquee>\n              <Marquee reverse pauseOnHover className=\"[--duration:20s]\" vertical>\n                {thirdRow.map((review) => (\n                  <ReviewCard key={review.username} {...review} />\n                ))}\n              </Marquee>\n              <Marquee pauseOnHover className=\"[--duration:20s]\" vertical>\n                {fourthRow.map((review) => (\n                  <ReviewCard key={review.username} {...review} />\n                ))}\n              </Marquee>\n            </div>\n\n            <div className=\"pointer-events-none absolute inset-x-0 top-0 h-1/4 bg-gradient-to-b from-background\"></div>\n            <div className=\"pointer-events-none absolute inset-x-0 bottom-0 h-1/4 bg-gradient-to-t from-background\"></div>\n            <div className=\"pointer-events-none absolute inset-y-0 left-0 w-1/4 bg-gradient-to-r from-background\"></div>\n            <div className=\"pointer-events-none absolute inset-y-0 right-0 w-1/4 bg-gradient-to-l from-background\"></div>\n          </div>\n        </section>\n\n        <div className=\"w-full bg-background py-8\">\n          <div className=\"max-w-[1200px] mx-auto px-4 sm:px-8\">\n            <div className=\"mb-8\">\n              <LegalDisclaimer />\n            </div>\n          </div>\n        </div>\n\n        {(!profile || profile.subscription_tier === \"free\") && (\n          <div className=\"w-full bg-background py-16\">\n            <div className=\"max-w-[1200px] mx-auto px-4 sm:px-8\">\n              <div className=\"relative w-full rounded-3xl overflow-hidden\">\n                {/* LiquidChrome Background */}\n                <div className=\"absolute inset-0\">\n                  <LiquidChrome\n                    baseColor={[0.1, 0.1, 0.1]}\n                    speed={1}\n                    amplitude={0.6}\n                    interactive={true}\n                  />\n                </div>\n                \n                {/* Background Overlay with Blur */}\n                <div className=\"absolute inset-0 bg-black/40 backdrop-blur-[8px]\" />\n                \n                {/* Content */}\n                <div className=\"relative z-10 text-center py-12 px-8\">\n                  <h2 className=\"text-3xl font-bold mb-4 text-white\">\n                    Unlock Premium Property Insights\n                  </h2>\n                  <p className=\"text-lg text-gray-300 mb-8 max-w-2xl mx-auto\">\n                    Get access to detailed property analysis, market comparisons, and investment metrics to make informed decisions.\n                  </p>\n                  <button\n                    onClick={() => setIsSubscriptionModalOpen(true)}\n                    className=\"px-8 py-3 rounded-full bg-primary text-primary-foreground hover:bg-primary/90 transition-colors\"\n                  >\n                    Upgrade Now\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n\n      </main>\n\n      <Footer />\n\n      <AuthModal\n        isOpen={isAuthModalOpen}\n        onClose={() => setIsAuthModalOpen(false)}\n        defaultMode={authMode as AuthMode}\n      />\n\n      <SubscriptionModal\n        isOpen={isSubscriptionModalOpen}\n        onClose={() => setIsSubscriptionModalOpen(false)}\n        currentUser={user}\n        userProfile={profile}\n      />\n\n      <MessagesModal\n        isOpen={isMessagesModalOpen}\n        onClose={() => setIsMessagesModalOpen(false)}\n        receiverId={selectedReceiverId}\n        currentUser={user}\n        userProfile={profile}\n      />\n\n      <PropertyModal\n        isOpen={isPropertyModalOpen}\n        onClose={() => {\n          setIsPropertyModalOpen(false);\n          setTimeout(() => setSelectedProperty(null), 300);\n        }}\n        property={selectedProperty}\n        currentUser={user}\n        userProfile={profile}\n      />\n    </div>\n  );\n};\n\nexport default Home;\n","import React from \"react\";\nimport { Footer } from \"./Footer\";\nimport Header from \"./Header\";\nimport { AuthModal } from \"./AuthModal\";\nimport { useAuth } from \"../lib/auth\";\n\ninterface LayoutProps {\n  children: React.ReactNode;\n}\n\nexport function Layout({ children }: LayoutProps) {\n  const { user, profile, signOut, isLoading } = useAuth();\n  const [isAuthModalOpen, setIsAuthModalOpen] = React.useState(false);\n  const [authMode, setAuthMode] = React.useState<\"signin\" | \"signup\">(\"signin\");\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <Header\n        isAuthenticated={!!user}\n        userProfile={profile}\n        onSignIn={() => window.location.href = '/login'}\n        onSignUp={() => window.location.href = '/signup'}\n        onSignOut={signOut}\n      />\n      \n      <main className=\"flex-1\">\n        {children}\n      </main>\n      \n      <Footer />\n\n      <AuthModal\n        isOpen={isAuthModalOpen}\n        onClose={() => setIsAuthModalOpen(false)}\n        defaultMode={authMode}\n      />\n    </div>\n  );\n}\n","import { useState, useEffect } from \"react\";\n\nexport function useBitcoinPrice() {\n  const [btcPrice, setBtcPrice] = useState<number | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchPrice = async () => {\n      try {\n        const response = await fetch(\n          `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${import.meta.env.VITE_GEMINI_API_KEY}`,\n          {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({\n              contents: [\n                {\n                  parts: [\n                    {\n                      text: \"What is the current Bitcoin price in GBP? Return ONLY the number, no text or currency symbols.\",\n                    },\n                  ],\n                },\n              ],\n            }),\n          },\n        );\n\n        const data = await response.json();\n        const priceText = data.candidates[0].content.parts[0].text;\n        const price = parseFloat(priceText.replace(/[^0-9.]/g, \"\"));\n\n        if (!isNaN(price)) {\n          setBtcPrice(price);\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error(\"Error fetching Bitcoin price:\", error);\n      }\n    };\n\n    fetchPrice();\n    const interval = setInterval(fetchPrice, 60000); // Update every minute\n\n    return () => clearInterval(interval);\n  }, []);\n\n  const convertGBPtoBTC = (gbpAmount: number) => {\n    if (!btcPrice) return null;\n    return gbpAmount / btcPrice;\n  };\n\n  return { btcPrice, loading, convertGBPtoBTC };\n}\n","import React from \"react\";\nimport { useBitcoinPrice } from \"../lib/hooks/useBitcoinPrice\";\nimport { Bitcoin } from \"lucide-react\";\n\ninterface BitcoinPriceProps {\n  amount: number;\n}\n\nexport function BitcoinPrice({ amount }: BitcoinPriceProps) {\n  const { btcPrice, loading, convertGBPtoBTC } = useBitcoinPrice();\n  const btcAmount = convertGBPtoBTC(amount);\n\n  if (loading) return <span className=\"text-muted-foreground\">Loading...</span>;\n  if (!btcAmount) return null;\n\n  return (\n    <span className=\"inline-flex items-center gap-1\">\n      <Bitcoin className=\"h-4 w-4 text-[#F7931A]\" />\n      {btcAmount.toFixed(2)}\n    </span>\n  );\n}\n","import { supabase } from './supabase';\n\nexport async function updateUserProfile(\n  userId: string,\n  updates: {\n    role?: 'user' | 'moderator' | 'admin';\n    subscription_tier?: 'free' | 'basic' | 'pro' | 'premium';\n    subscription_status?: 'active' | 'inactive' | 'cancelled';\n  }\n) {\n  try {\n    console.log('Starting profile update for user:', userId);\n    console.log('Updates to apply:', updates);\n\n    // Check if current user is admin\n    const { data: adminProfiles, error: adminCheckError } = await supabase\n      .from('profiles')\n      .select('role')\n      .eq('id', (await supabase.auth.getUser()).data.user?.id);\n\n    if (adminCheckError) {\n      console.error('Admin check error:', adminCheckError);\n      throw adminCheckError;\n    }\n\n    if (!adminProfiles?.length || adminProfiles[0].role !== 'admin') {\n      throw new Error('Unauthorized: Only admins can update user profiles');\n    }\n\n    // First verify the user exists\n    const { data: existingUsers, error: existingError } = await supabase\n      .from('profiles')\n      .select('*')\n      .eq('id', userId);\n\n    if (existingError) {\n      console.error('User verification error:', existingError);\n      throw existingError;\n    }\n\n    if (!existingUsers?.length) {\n      throw new Error('User not found');\n    }\n\n    console.log('Existing user:', existingUsers[0]);\n\n    // Prepare update data\n    const updateData = {\n      ...updates,\n      updated_at: new Date().toISOString()\n    };\n\n    console.log('Applying updates:', updateData);\n\n    // Update profile\n    const { data, error: updateError } = await supabase\n      .from('profiles')\n      .update(updateData)\n      .eq('id', userId)\n      .select();\n\n    if (updateError) {\n      console.error('Profile update error:', updateError);\n      throw updateError;\n    }\n\n    if (!data?.length) {\n      console.error('No data returned from update');\n      throw new Error('Update failed - no data returned');\n    }\n\n    console.log('Profile updated successfully:', data[0]);\n\n    // Only update role in auth metadata if role is being changed\n    if (updates.role) {\n      try {\n        await supabase.auth.admin.updateUserById(userId, {\n          user_metadata: {\n            role: updates.role\n          }\n        });\n        console.log('Auth metadata updated for role change');\n      } catch (error) {\n        console.warn('Failed to update auth metadata (non-critical):', error);\n      }\n    }\n\n    return data[0];\n  } catch (error) {\n    console.error('Error in updateUserProfile:', error);\n    throw error;\n  }\n}\n\nexport async function getAllUsers() {\n  try {\n    // Get all profiles with their subscription data\n    const { data: profiles, error: profilesError } = await supabase\n      .from('profiles')\n      .select(`\n        *,\n        subscription_tier,\n        subscription_status,\n        role\n      `)\n      .order('created_at', { ascending: false });\n\n    if (profilesError) {\n      console.error('Profiles fetch error:', profilesError);\n      throw profilesError;\n    }\n\n    if (!profiles) return [];\n\n    return profiles.map(profile => ({\n      ...profile,\n      role: profile.role || 'user',\n      subscription_tier: profile.subscription_tier || 'free',\n      subscription_status: profile.subscription_status || 'active'\n    }));\n  } catch (error) {\n    console.error('Error fetching users:', error);\n    throw error;\n  }\n} ","import { supabase } from './supabase';\n\nexport interface ScrapedProperty {\n  id: string;\n  title: string;\n  price: number;\n  description: string;\n  location: string;\n  bedrooms: number;\n  bathrooms: number;\n  sqft: number;\n  image_url: string;\n  property_type: string;\n  source_url: string;\n  added_by_user_id: string;\n  is_featured: boolean;\n}\n\nexport interface SearchResults {\n  properties: ScrapedProperty[];\n  totalResults: number;\n  currentPage: number;\n  totalPages: number;\n}\n\n// Use production URL in production, fallback to localhost for development\nconst API_URL = import.meta.env.PROD \n  ? 'https://api.myvge.com'  // Production API URL\n  : 'http://localhost:3001';  // Development URL\n\nexport async function searchProperties(location: string, page = 1): Promise<SearchResults> {\n  try {\n    console.log('Searching properties:', { location, page, apiUrl: API_URL });\n    const response = await fetch(`${API_URL}/api/scrape-properties`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Origin': 'https://myvge.com'\n      },\n      body: JSON.stringify({ location, page }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      console.error('Server error:', error);\n      throw new Error(error.message || 'Failed to fetch properties');\n    }\n\n    const data = await response.json();\n    console.log('Search results:', data);\n    return data;\n  } catch (error) {\n    console.error('Error searching properties:', error);\n    throw error;\n  }\n}\n\nexport async function importProperties(properties: ScrapedProperty[], userId: string) {\n  try {\n    console.log('Importing properties:', { count: properties.length, userId });\n    const { data, error } = await supabase\n      .from('properties')\n      .insert(\n        properties.map(property => ({\n          ...property,\n          added_by_user_id: userId,\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString(),\n        }))\n      );\n\n    if (error) {\n      console.error('Supabase error:', error);\n      throw error;\n    }\n    \n    console.log('Import successful:', data);\n    return data;\n  } catch (error) {\n    console.error('Error importing properties:', error);\n    throw error;\n  }\n} ","import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport interface TextareaProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","import React, { useState, useEffect } from 'react';\nimport { useAuth } from './auth';\nimport { Button } from '../components/ui/button';\nimport { RefreshCw } from 'lucide-react';\n\ninterface AuthContextCheckerProps {\n  children: React.ReactNode;\n}\n\n// A component that safely checks if the auth context is available\nexport function AuthContextChecker({ children }: AuthContextCheckerProps) {\n  const [hasAuthContext, setHasAuthContext] = useState<boolean>(false);\n  const [isChecking, setIsChecking] = useState<boolean>(true);\n\n  useEffect(() => {\n    checkAuthContext();\n  }, []);\n\n  const checkAuthContext = () => {\n    setIsChecking(true);\n    try {\n      // This will throw an error if auth context isn't available\n      const auth = useAuth();\n      setHasAuthContext(true);\n    } catch (error) {\n      console.error('Auth context not available:', error);\n      setHasAuthContext(false);\n    } finally {\n      setIsChecking(false);\n    }\n  };\n\n  if (isChecking) {\n    return (\n      <div className=\"flex items-center justify-center min-h-[200px]\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Checking authentication...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!hasAuthContext) {\n    return (\n      <div className=\"flex items-center justify-center min-h-[300px]\">\n        <div className=\"text-center max-w-md p-6 border rounded-lg bg-muted/50\">\n          <h3 className=\"text-lg font-medium mb-2\">Authentication Error</h3>\n          <p className=\"text-muted-foreground mb-4\">\n            Unable to access authentication. This may be due to a temporary issue or your session has expired.\n          </p>\n          <Button \n            variant=\"outline\" \n            onClick={() => {\n              window.location.reload();\n            }}\n            className=\"inline-flex items-center gap-2\"\n          >\n            <RefreshCw className=\"h-4 w-4\" /> Refresh Page\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  // Auth context is available, render children\n  return <>{children}</>;\n}\n\n// Component that handles the inner content and safely uses auth context\nexport function createAuthProtectedComponent<P extends object>(\n  Component: React.ComponentType<P>\n): React.FC<P> {\n  return (props: P) => (\n    <AuthContextChecker>\n      <Component {...props} />\n    </AuthContextChecker>\n  );\n} ","import React, { useState, useEffect } from 'react';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent } from './ui/card';\nimport { Checkbox } from './ui/checkbox';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from './ui/dialog';\nimport { LoadingSpinner } from './ui/loading-spinner';\nimport { useToast } from './ui/use-toast';\nimport { ScrapedProperty, searchProperties, importProperties } from '../lib/propertyScraperService';\nimport { useAuth } from '../lib/auth';\nimport { Badge } from './ui/badge';\nimport { Bed, Bath, Home, MapPin, Upload, CheckCircle2, AlertCircle, Info, RefreshCw } from 'lucide-react';\nimport { Textarea } from './ui/textarea';\nimport { Label } from './ui/label';\nimport { Alert, AlertTitle, AlertDescription } from './ui/alert';\nimport { AuthContextChecker } from '../lib/AuthContextChecker';\n\n// Component that safely uses auth context\nfunction PropertyImporterContent() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [location, setLocation] = useState('');\n  const [isSearching, setIsSearching] = useState(false);\n  const [isImporting, setIsImporting] = useState(false);\n  const [searchResults, setSearchResults] = useState<ScrapedProperty[]>([]);\n  const [selectedProperties, setSelectedProperties] = useState<Set<string>>(new Set());\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [totalResults, setTotalResults] = useState(0);\n  const [fileData, setFileData] = useState<File | null>(null);\n  const [jsonData, setJsonData] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [importStatus, setImportStatus] = useState<'idle' | 'success' | 'error'>('idle');\n  const [statusMessage, setStatusMessage] = useState('');\n  \n  const { user } = useAuth();\n  const { toast } = useToast();\n\n  // Reset state when modal closes\n  useEffect(() => {\n    if (!isOpen) {\n      setSearchResults([]);\n      setSelectedProperties(new Set());\n      setCurrentPage(1);\n      setTotalPages(1);\n      setTotalResults(0);\n      setLocation('');\n    }\n  }, [isOpen]);\n\n  const handleSearch = async () => {\n    if (!location.trim()) return;\n\n    try {\n      setIsSearching(true);\n      const results = await searchProperties(location, currentPage);\n      setSearchResults(results.properties);\n      setTotalPages(results.totalPages);\n      setTotalResults(results.totalResults);\n      toast({\n        title: \"Properties Found\",\n        description: `Found ${results.totalResults.toLocaleString()} properties in ${location}`,\n      });\n    } catch (error) {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: \"Failed to search properties. Please try again.\",\n      });\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  const handleImport = async () => {\n    if (!user?.id || selectedProperties.size === 0) return;\n\n    try {\n      setIsImporting(true);\n      const propertiesToImport = searchResults.filter(p => selectedProperties.has(p.id));\n      await importProperties(propertiesToImport, user.id);\n      \n      toast({\n        title: \"Success\",\n        description: `Imported ${selectedProperties.size} properties successfully`,\n      });\n      setIsOpen(false);\n    } catch (error) {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: \"Failed to import properties. Please try again.\",\n      });\n    } finally {\n      setIsImporting(false);\n    }\n  };\n\n  const toggleProperty = (propertyId: string) => {\n    const newSelected = new Set(selectedProperties);\n    if (newSelected.has(propertyId)) {\n      newSelected.delete(propertyId);\n    } else {\n      newSelected.add(propertyId);\n    }\n    setSelectedProperties(newSelected);\n  };\n\n  const handlePageChange = async (newPage: number) => {\n    setCurrentPage(newPage);\n    await handleSearch();\n  };\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files.length > 0) {\n      setFileData(e.target.files[0]);\n      // Reset JSON input when file is selected\n      setJsonData('');\n    }\n  };\n\n  const handleJsonChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setJsonData(e.target.value);\n    // Reset file input when JSON is entered\n    setFileData(null);\n  };\n\n  return (\n    <div className=\"container mx-auto px-4 py-8 max-w-4xl\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-3xl font-bold mb-2\">Property Importer</h1>\n        <p className=\"text-muted-foreground\">\n          Import properties from external sources by uploading a JSON file or pasting JSON data.\n        </p>\n      </div>\n      \n      <div className=\"grid gap-6 md:grid-cols-2\">\n        <Card>\n          <CardHeader>\n            <CardTitle>Upload JSON File</CardTitle>\n            <CardDescription>\n              Import properties from a JSON file\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              <div className=\"border-2 border-dashed border-muted-foreground/25 rounded-lg p-6 text-center hover:bg-muted/50 transition-colors\">\n                <Upload className=\"h-10 w-10 text-muted-foreground mx-auto mb-4\" />\n                <p className=\"text-sm text-muted-foreground mb-2\">\n                  Drag and drop a JSON file here, or click to browse\n                </p>\n                <Input\n                  type=\"file\"\n                  accept=\".json\"\n                  onChange={handleFileChange}\n                  className=\"hidden\"\n                  id=\"file-upload\"\n                />\n                <Label htmlFor=\"file-upload\" className=\"cursor-pointer\">\n                  <Button variant=\"outline\" type=\"button\">Browse Files</Button>\n                </Label>\n              </div>\n              \n              {fileData && (\n                <div className=\"bg-muted p-3 rounded text-sm\">\n                  <p className=\"font-medium mb-1\">Selected file:</p>\n                  <p className=\"text-muted-foreground\">{fileData.name} ({Math.round(fileData.size / 1024)} KB)</p>\n                </div>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n        \n        <Card>\n          <CardHeader>\n            <CardTitle>Paste JSON Data</CardTitle>\n            <CardDescription>\n              Paste your JSON data directly\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              <Textarea\n                placeholder='{\"properties\": [{\"address\": \"123 Main St\", \"price\": 250000, ...}]}'\n                rows={8}\n                value={jsonData}\n                onChange={handleJsonChange}\n                className=\"font-mono text-sm\"\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                JSON must be properly formatted and contain property data.\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n      \n      <div className=\"mt-8 flex justify-end\">\n        <Button \n          onClick={handleImport} \n          disabled={isSubmitting || (!fileData && !jsonData)}\n          className=\"px-8\"\n        >\n          {isSubmitting ? 'Importing...' : 'Import Properties'}\n        </Button>\n      </div>\n      \n      {importStatus !== 'idle' && (\n        <Alert \n          variant={importStatus === 'success' ? 'default' : 'destructive'} \n          className=\"mt-6\"\n        >\n          {importStatus === 'success' ? (\n            <CheckCircle2 className=\"h-4 w-4\" />\n          ) : (\n            <AlertCircle className=\"h-4 w-4\" />\n          )}\n          <AlertTitle>\n            {importStatus === 'success' ? 'Import Successful' : 'Import Failed'}\n          </AlertTitle>\n          <AlertDescription>{statusMessage}</AlertDescription>\n        </Alert>\n      )}\n      \n      <Card className=\"mt-8\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Info className=\"h-5 w-5\" />\n            Import Format Guidelines\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            <p className=\"text-sm text-muted-foreground\">\n              Your JSON data should follow this structure:\n            </p>\n            <pre className=\"bg-muted p-4 rounded-md text-xs overflow-auto\">\n{`{\n  \"properties\": [\n    {\n      \"address\": \"123 Main Street, London, E1 6AN\",\n      \"price\": 450000,\n      \"type\": \"flat\",\n      \"bedrooms\": 2,\n      \"bathrooms\": 1,\n      \"size_sqft\": 750,\n      \"description\": \"A spacious 2 bedroom flat...\",\n      \"images\": [\"image1.jpg\", \"image2.jpg\"]\n    },\n    {\n      // Additional properties...\n    }\n  ]\n}`}\n            </pre>\n            <p className=\"text-sm text-muted-foreground\">\n              You can also import a simple array of property objects.\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\n// Main component that handles auth context checking\nexport function PropertyImporter() {\n  return (\n    <AuthContextChecker>\n      <PropertyImporterContent />\n    </AuthContextChecker>\n  );\n} ","import React from \"react\";\nimport { useAuth } from \"../lib/auth\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Button } from \"./ui/button\";\nimport { Card, CardContent } from \"./ui/card\";\nimport {\n  Building2,\n  Star,\n  TrendingUp,\n  PoundSterling,\n  Users,\n  Bitcoin,\n} from \"lucide-react\";\nimport { getSavedProperties } from \"../lib/properties\";\nimport { PropertyCard } from \"./PropertyCard\";\nimport { supabase } from \"../lib/supabase\";\nimport { Layout } from \"./Layout\";\nimport { BitcoinPrice } from \"./BitcoinPrice\";\nimport { updateUserProfile, getAllUsers } from '../lib/users';\nimport { PropertyImporter } from './PropertyImporter';\n\nexport default function Dashboard() {\n  const { user, profile } = useAuth();\n  const navigate = useNavigate();\n  const [savedProperties, setSavedProperties] = React.useState<any[]>([]);\n  const [addedProperties, setAddedProperties] = React.useState<any[]>([]);\n  const [users, setUsers] = React.useState<any[]>([]);\n  const [portfolioStats, setPortfolioStats] = React.useState({\n    totalProperties: 0,\n    totalValue: 0,\n    averagePrice: 0,\n    totalProfit: 0,\n    monthlyIncome: 0,\n  });\n  const [isLoading, setIsLoading] = React.useState(true);\n  const [error, setError] = React.useState<string | null>(null);\n\n  const loadUsers = React.useCallback(async () => {\n    if (!user || profile?.role !== \"admin\") return;\n    try {\n      const data = await getAllUsers();\n      setUsers(data);\n    } catch (error) {\n      console.error('Error loading users:', error);\n      setError('Failed to load users');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user, profile]);\n\n  const handleUserUpdate = async (userId: string, updates: any) => {\n    try {\n      setIsLoading(true);\n      console.log('Attempting to update user:', userId);\n      console.log('Updates:', updates);\n\n      const updatedProfile = await updateUserProfile(userId, updates);\n      console.log('Update successful:', updatedProfile);\n\n      // Refresh the users list\n      const updatedUsers = await getAllUsers();\n      setUsers(updatedUsers);\n      \n      alert('User updated successfully');\n    } catch (error: any) {\n      console.error('Error updating user:', error);\n      alert(error.message || 'Failed to update user. Please check console for details.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const loadProperties = React.useCallback(async () => {\n    if (!user) return;\n    try {\n      const [saved, { data: added }] = await Promise.all([\n        getSavedProperties(user.id),\n        supabase\n          .from(\"properties\")\n          .select(\n            `*,\n            assigned_user:profiles!properties_assigned_user_id_fkey(full_name, email),\n            author:profiles!properties_created_by_fkey(full_name, email)`,\n          )\n          .eq(\"created_by\", user.id),\n      ]);\n\n      setAddedProperties(added || []);\n      setSavedProperties(saved);\n\n      // Calculate portfolio stats\n      const totalProperties = (added || []).length + saved.length;\n      const totalValue = [...(added || []), ...saved].reduce(\n        (sum, prop) => sum + (prop.price || 0),\n        0,\n      );\n      const averagePrice = totalValue / (totalProperties || 1);\n      const totalProfit = [...(added || []), ...saved].reduce(\n        (sum, prop) => sum + (prop.potential_profit || 0),\n        0,\n      );\n      const monthlyIncome = [...(added || []), ...saved].reduce(\n        (sum, prop) => sum + (prop.monthly_income || 0),\n        0,\n      );\n\n      setPortfolioStats({\n        totalProperties,\n        totalValue,\n        averagePrice,\n        totalProfit,\n        monthlyIncome,\n      });\n    } catch (error) {\n      console.error(\"Error loading properties:\", error);\n    }\n  }, [user]);\n\n  React.useEffect(() => {\n    if (!user) {\n      navigate(\"/\");\n      return;\n    }\n    loadProperties();\n    loadUsers();\n  }, [user, navigate, loadProperties, loadUsers]);\n\n  if (!user) {\n    navigate(\"/\");\n    return null;\n  }\n\n  return (\n    <Layout>\n      <main className=\"container mx-auto px-4 py-8 pt-24\">\n        <div className=\"max-w-7xl mx-auto space-y-8\">\n          <div className=\"flex items-center justify-between\">\n            <h1 className=\"text-3xl font-bold\">Dashboard</h1>\n            <PropertyImporter />\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            <Card>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-lg font-semibold\">Portfolio Value</h3>\n                  <PoundSterling className=\"w-5 h-5 text-primary\" />\n                </div>\n                <p className=\"text-3xl font-bold\">\n                  £{portfolioStats.totalValue.toLocaleString()}\n                </p>\n                <p className=\"text-sm text-muted-foreground mt-2\">\n                  {portfolioStats.totalProperties} properties\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-lg font-semibold\">Average Price</h3>\n                  <Building2 className=\"w-5 h-5 text-primary\" />\n                </div>\n                <p className=\"text-3xl font-bold\">\n                  £{portfolioStats.averagePrice.toLocaleString()}\n                </p>\n                <p className=\"text-sm text-muted-foreground mt-2\">\n                  Per property\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-lg font-semibold\">Total Profit</h3>\n                  <TrendingUp className=\"w-5 h-5 text-primary\" />\n                </div>\n                <p className=\"text-3xl font-bold\">\n                  £{portfolioStats.totalProfit.toLocaleString()}\n                </p>\n                <p className=\"text-sm text-muted-foreground mt-2\">\n                  Estimated profit\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-lg font-semibold\">BTC Value</h3>\n                  <Bitcoin className=\"w-5 h-5 text-[#F7931A]\" />\n                </div>\n                <BitcoinPrice amount={portfolioStats.totalValue} />\n                <p className=\"text-sm text-muted-foreground mt-2\">\n                  Portfolio in BTC\n                </p>\n              </CardContent>\n            </Card>\n          </div>\n\n          {profile?.role === 'admin' && (\n            <div className=\"space-y-6\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-2xl font-semibold flex items-center gap-2\">\n                  <Users className=\"w-5 h-5\" /> User Management\n                </h2>\n              </div>\n              {error && <div className=\"text-red-500 mb-4\">{error}</div>}\n              {isLoading ? (\n                <div>Loading...</div>\n              ) : (\n                <div className=\"grid gap-4\">\n                  {users.map((user) => (\n                    <div key={user.id} className=\"border p-4 rounded-lg\">\n                      <div className=\"flex justify-between items-center\">\n                        <div>\n                          <p className=\"font-semibold\">{user.full_name}</p>\n                          <p className=\"text-sm text-gray-600\">{user.email}</p>\n                        </div>\n                        <div className=\"flex gap-2\">\n                          <select\n                            value={user.role}\n                            onChange={(e) => handleUserUpdate(user.id, { role: e.target.value })}\n                            className=\"border rounded p-1\"\n                          >\n                            <option value=\"user\">User</option>\n                            <option value=\"moderator\">Moderator</option>\n                            <option value=\"admin\">Admin</option>\n                          </select>\n                          <select\n                            value={user.subscription_tier}\n                            onChange={(e) => handleUserUpdate(user.id, { subscription_tier: e.target.value })}\n                            className=\"border rounded p-1\"\n                          >\n                            <option value=\"free\">Free</option>\n                            <option value=\"basic\">Basic</option>\n                            <option value=\"pro\">Pro</option>\n                            <option value=\"premium\">Premium</option>\n                          </select>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n            <div className=\"space-y-6\">\n              <h2 className=\"text-2xl font-semibold flex items-center gap-2\">\n                <Star className=\"w-5 h-5\" /> Saved Properties\n              </h2>\n              <div className=\"space-y-4\">\n                {savedProperties.map((saved: any) => (\n                  <PropertyCard\n                    key={saved.property.id}\n                    {...saved.property}\n                    isSubscriber={profile?.subscription_tier !== 'free'}\n                  />\n                ))}\n              </div>\n            </div>\n\n            <div className=\"space-y-6\">\n              <h2 className=\"text-2xl font-semibold flex items-center gap-2\">\n                <Building2 className=\"w-5 h-5\" /> Added Properties\n              </h2>\n              <div className=\"space-y-4\">\n                {addedProperties.map((property: any) => (\n                  <PropertyCard\n                    key={property.id}\n                    {...property}\n                    isSubscriber={profile?.subscription_tier !== 'free'}\n                  />\n                ))}\n              </div>\n            </div>\n          </div>\n        </div>\n      </main>\n    </Layout>\n  );\n}\n","import React from \"react\";\nimport { Card, CardContent, CardFooter, CardHeader } from \"./ui/card\";\nimport { Button } from \"./ui/button\";\nimport { Check, Crown } from \"lucide-react\";\nimport { SUBSCRIPTION_TIERS } from \"../lib/stripe\";\nimport { useAuth } from \"../lib/auth\";\n\ninterface SubscriptionPlansProps {\n  onSubscribe: (priceId: string) => void;\n}\n\nexport function SubscriptionPlans({ onSubscribe }: SubscriptionPlansProps) {\n  const { profile } = useAuth();\n  const currentTier = profile?.subscription_tier || \"free\";\n\n  return (\n    <div className=\"py-16 bg-background\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"text-center mb-12\">\n          <h2 className=\"text-3xl font-bold mb-4\">Choose Your Plan</h2>\n          <p className=\"text-gray-600 max-w-2xl mx-auto\">\n            Select the perfect plan for your property investment journey\n          </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-7xl mx-auto\">\n          {Object.entries(SUBSCRIPTION_TIERS).map(([key, tier]) => (\n            <Card\n              key={key}\n              className={`relative ${key === \"PRO\" ? \"border-primary shadow-lg scale-105 bg-gradient-to-r from-emerald-400/10 to-cyan-400/10\" : \"\"}`}\n            >\n              {key === \"PRO\" && (\n                <div className=\"absolute -top-4 left-1/2 -translate-x-1/2 bg-gradient-to-r from-emerald-400 to-cyan-400 text-white px-4 py-1 rounded-full text-sm font-medium border border-emerald-500/20 shadow-lg\">\n                  Most Popular\n                </div>\n              )}\n\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <h3 className=\"text-2xl font-bold\">{tier.name}</h3>\n                  {key === \"PREMIUM\" && (\n                    <Crown className=\"h-6 w-6 text-yellow-500\" />\n                  )}\n                </div>\n                <div className=\"mt-4\">\n                  <span className=\"text-4xl font-bold\">{tier.price}</span>\n                  <span className=\"text-gray-600 ml-2\">/month</span>\n                </div>\n              </CardHeader>\n\n              <CardContent>\n                <ul className=\"space-y-3\">\n                  {tier.features.map((feature, index) => (\n                    <li key={index} className=\"flex items-start gap-3\">\n                      <Check className=\"h-5 w-5 text-green-500 mt-0.5\" />\n                      <span>{feature}</span>\n                    </li>\n                  ))}\n                </ul>\n              </CardContent>\n\n              <CardFooter>\n                <Button\n                  className=\"w-full\"\n                  variant={key === \"PRO\" ? \"default\" : \"outline\"}\n                  onClick={() => onSubscribe(tier.priceId)}\n                  disabled={currentTier === key.toLowerCase()}\n                >\n                  {currentTier === key.toLowerCase()\n                    ? \"Current Plan\"\n                    : \"Subscribe\"}\n                </Button>\n              </CardFooter>\n            </Card>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport Header from \"./Header\";\nimport HeroSection from \"./HeroSection\";\nimport { SubscriptionPlans } from \"./SubscriptionPlans\";\nimport { createCheckoutSession } from \"../lib/stripe\";\nimport { useAuth } from \"../lib/auth\";\nimport { useToast } from \"./ui/use-toast\";\nimport { LegalDisclaimer } from \"./LegalDisclaimer\";\nimport { Footer } from \"./Footer\";\nimport { AuthModal } from \"./AuthModal\";\n\nexport default function PricingPage() {\n  const { user, profile, signOut } = useAuth();\n  const { toast } = useToast();\n  const [isAuthModalOpen, setIsAuthModalOpen] = React.useState(false);\n  const [authMode, setAuthMode] = React.useState<\"signin\" | \"signup\">(\"signin\");\n\n  const handleSubscribe = async (priceId: string) => {\n    if (!user) {\n      // Store the selected price ID in localStorage\n      localStorage.setItem(\"pending_subscription_price_id\", priceId);\n\n      // Trigger sign up modal\n      setAuthMode(\"signup\");\n      setIsAuthModalOpen(true);\n      return;\n    }\n\n    try {\n      await createCheckoutSession(priceId, user.id);\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to start subscription process. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Header\n        isAuthenticated={!!user}\n        userProfile={profile || undefined}\n        onSignIn={() => {\n          setAuthMode(\"signin\");\n          setIsAuthModalOpen(true);\n        }}\n        onSignUp={() => {\n          setAuthMode(\"signup\");\n          setIsAuthModalOpen(true);\n        }}\n        onSignOut={async () => {\n          try {\n            await signOut();\n            window.location.href = \"/\";\n          } catch (error) {\n            console.error(\"Error signing out:\", error);\n          }\n        }}\n      />\n      <HeroSection\n        title=\"Choose Your Perfect Plan\"\n        subtitle=\"Select the perfect subscription plan to unlock premium features and detailed property insights\"\n        backgroundImage=\"https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?ixlib=rb-4.0.3\"\n        showSearch={false}\n        showStats={false}\n        height=\"h-[400px]\"\n      />\n      <main>\n        <SubscriptionPlans onSubscribe={handleSubscribe} />\n        <div className=\"container mx-auto px-4 py-12\">\n          <div className=\"max-w-4xl mx-auto prose dark:prose-invert mb-16\">\n            <h2 className=\"text-3xl font-bold mb-6\">\n              Investment Plans for Every Property Investor\n            </h2>\n            <p>\n              Choose from our range of subscription plans designed to meet the\n              needs of property investors at every level. From market analysis\n              to detailed property insights, our plans provide the tools you\n              need to make informed investment decisions.\n            </p>\n\n            <h3 className=\"text-2xl font-semibold mt-8 mb-4\">Plan Benefits</h3>\n            <ul>\n              <li>\n                Access to comprehensive property market data and analytics\n              </li>\n              <li>Real-time market insights and trend analysis</li>\n              <li>Advanced property search and filtering capabilities</li>\n              <li>Investment calculators and ROI projections</li>\n              <li>Portfolio tracking and management tools</li>\n            </ul>\n\n            <h3 className=\"text-2xl font-semibold mt-8 mb-4\">Why Subscribe?</h3>\n            <p>\n              Our subscription plans give you access to premium features and\n              insights that help you stay ahead in the property market. From\n              basic market analysis to advanced AI-powered predictions, we\n              provide the tools you need to make successful property\n              investments.\n            </p>\n\n            <h3 className=\"text-2xl font-semibold mt-8 mb-4\">\n              Money-Back Guarantee\n            </h3>\n            <p>\n              We're confident in the value our platform provides. If you're not\n              satisfied with your subscription within the first 30 days, we'll\n              provide a full refund, no questions asked.\n            </p>\n          </div>\n          <LegalDisclaimer />\n        </div>\n      </main>\n      <Footer />\n\n      <AuthModal\n        isOpen={isAuthModalOpen}\n        onClose={() => setIsAuthModalOpen(false)}\n        defaultMode={authMode}\n      />\n    </div>\n  );\n}\n","import React from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"./ui/dialog\";\nimport { Button } from \"./ui/button\";\nimport { Input } from \"./ui/input\";\nimport { Label } from \"./ui/label\";\nimport { useToast } from \"./ui/use-toast\";\nimport { supabase } from \"../lib/supabase\";\nimport { useAuth } from \"../lib/auth\";\n\nexport function OnboardingModal(props) {\n  const [step, setStep] = React.useState(0);\n  const [loading, setLoading] = React.useState(false);\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [formData, setFormData] = React.useState({\n    profileImage: \"\",\n    bannerImage: \"\",\n    selectedWidgets: [],\n  });\n\n  const handleComplete = async () => {\n    if (!user) return;\n    setLoading(true);\n\n    try {\n      const { error } = await supabase\n        .from(\"profiles\")\n        .update({\n          avatar_url:\n            formData.profileImage ||\n            `https://api.dicebear.com/7.x/avataaars/svg?seed=${user.email}`,\n          banner_url:\n            formData.bannerImage ||\n            \"https://images.unsplash.com/photo-1486406146926-c627a92ad1ab\",\n          dashboard_widgets: formData.selectedWidgets,\n          onboarding_completed: true,\n        })\n        .eq(\"id\", user.id);\n\n      if (error) throw error;\n\n      toast({\n        title: \"Setup Complete!\",\n        description: \"Your profile has been updated successfully.\",\n      });\n      props.onClose();\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update profile. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const steps = [\n    {\n      title: \"Profile Image\",\n      description: \"Add a profile image to personalize your account\",\n      component: (\n        <div className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label>Profile Image URL</Label>\n            <Input\n              placeholder=\"Enter image URL or leave blank for default avatar\"\n              value={formData.profileImage}\n              onChange={(e) =>\n                setFormData((prev) => ({\n                  ...prev,\n                  profileImage: e.target.value,\n                }))\n              }\n            />\n          </div>\n          {formData.profileImage && (\n            <img\n              src={formData.profileImage}\n              alt=\"Profile Preview\"\n              className=\"w-24 h-24 rounded-full object-cover mx-auto\"\n            />\n          )}\n        </div>\n      ),\n    },\n    {\n      title: \"Dashboard Banner\",\n      description: \"Choose a banner image for your dashboard\",\n      component: (\n        <div className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label>Banner Image URL</Label>\n            <Input\n              placeholder=\"Enter banner image URL or leave blank for default\"\n              value={formData.bannerImage}\n              onChange={(e) =>\n                setFormData((prev) => ({\n                  ...prev,\n                  bannerImage: e.target.value,\n                }))\n              }\n            />\n          </div>\n          {formData.bannerImage && (\n            <img\n              src={formData.bannerImage}\n              alt=\"Banner Preview\"\n              className=\"w-full h-32 object-cover rounded-md\"\n            />\n          )}\n        </div>\n      ),\n    },\n    {\n      title: \"Dashboard Widgets\",\n      description: \"Select the widgets you want to see on your dashboard\",\n      component: (\n        <div className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            {[\n              \"market_trends\",\n              \"property_news\",\n              \"saved_properties\",\n              \"price_alerts\",\n              \"market_insights\",\n              \"investment_calculator\",\n            ].map((widget) => (\n              <Button\n                key={widget}\n                variant={\n                  formData.selectedWidgets.includes(widget)\n                    ? \"default\"\n                    : \"outline\"\n                }\n                onClick={() =>\n                  setFormData((prev) => ({\n                    ...prev,\n                    selectedWidgets: prev.selectedWidgets.includes(widget)\n                      ? prev.selectedWidgets.filter((w) => w !== widget)\n                      : [...prev.selectedWidgets, widget],\n                  }))\n                }\n                className=\"h-auto py-4 px-6 text-left flex flex-col items-start space-y-2\"\n              >\n                <span className=\"font-medium capitalize\">\n                  {widget.replace(\"_\", \" \")}\n                </span>\n              </Button>\n            ))}\n          </div>\n        </div>\n      ),\n    },\n  ];\n\n  return (\n    <Dialog open={props.isOpen} onOpenChange={props.onClose}>\n      <DialogContent className=\"sm:max-w-[600px]\">\n        <DialogHeader>\n          <DialogTitle>{steps[step].title}</DialogTitle>\n          <DialogDescription>{steps[step].description}</DialogDescription>\n        </DialogHeader>\n\n        <div className=\"py-6\">{steps[step].component}</div>\n\n        <div className=\"flex justify-between\">\n          <Button\n            variant=\"outline\"\n            onClick={() => setStep((s) => Math.max(0, s - 1))}\n            disabled={step === 0}\n          >\n            Previous\n          </Button>\n          <Button\n            onClick={() => {\n              if (step === steps.length - 1) {\n                handleComplete();\n              } else {\n                setStep((s) => Math.min(steps.length - 1, s + 1));\n              }\n            }}\n            disabled={loading}\n          >\n            {step === steps.length - 1 ? \"Complete Setup\" : \"Next\"}\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import { useEffect, useState } from \"react\";\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\nimport { useToast } from \"./ui/use-toast\";\nimport { useAuth } from \"../lib/auth\";\nimport { OnboardingModal } from \"./OnboardingModal\";\n\nexport default function SubscriptionSuccess() {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const { toast } = useToast();\n  const { user } = useAuth();\n  const [showOnboarding, setShowOnboarding] = useState(true);\n\n  useEffect(() => {\n    const sessionId = searchParams.get(\"session_id\");\n    if (sessionId) {\n      toast({\n        title: \"Subscription Successful!\",\n        description:\n          \"Thank you for subscribing. Your premium features are now available.\",\n      });\n    }\n\n    // Only redirect if onboarding is skipped or completed\n    if (!showOnboarding) {\n      navigate(\"/dashboard\");\n    }\n  }, [showOnboarding, navigate, searchParams, toast]);\n\n  return (\n    <>\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"max-w-md w-full mx-auto p-8\">\n          <div className=\"bg-white shadow-lg rounded-lg p-6 text-center\">\n            <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <svg\n                className=\"w-8 h-8 text-green-500\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M5 13l4 4L19 7\"\n                />\n              </svg>\n            </div>\n            <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">\n              Subscription Successful!\n            </h2>\n            <p className=\"text-gray-600 mb-4\">\n              Thank you for subscribing. Your premium features are now\n              available.\n            </p>\n            <p className=\"text-sm text-gray-500\">\n              Setting up your preferences...\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <OnboardingModal\n        isOpen={showOnboarding}\n        onClose={() => {\n          setShowOnboarding(false);\n          navigate(\"/dashboard\");\n        }}\n      />\n    </>\n  );\n}\n","import { useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useToast } from \"./ui/use-toast\";\n\nexport default function SubscriptionCancel() {\n  const navigate = useNavigate();\n  const { toast } = useToast();\n\n  useEffect(() => {\n    toast({\n      title: \"Subscription Cancelled\",\n      description:\n        \"Your subscription process was cancelled. Please try again if this was a mistake.\",\n      variant: \"destructive\",\n    });\n\n    // Redirect to home after a short delay\n    const timer = setTimeout(() => {\n      navigate(\"/\");\n    }, 3000);\n\n    return () => clearTimeout(timer);\n  }, []);\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n      <div className=\"max-w-md w-full mx-auto p-8\">\n        <div className=\"bg-white shadow-lg rounded-lg p-6 text-center\">\n          <div className=\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <svg\n              className=\"w-8 h-8 text-red-500\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M6 18L18 6M6 6l12 12\"\n              />\n            </svg>\n          </div>\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">\n            Subscription Cancelled\n          </h2>\n          <p className=\"text-gray-600 mb-4\">\n            Your subscription process was cancelled. Please try again if this\n            was a mistake.\n          </p>\n          <p className=\"text-sm text-gray-500\">\n            Redirecting you to the homepage...\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React, { useState } from 'react';\nimport { Button } from './ui/button';\nimport { Avatar, AvatarFallback, AvatarImage } from './ui/avatar';\nimport { useToast } from './ui/use-toast';\n\ninterface AvatarUploadProps {\n  currentAvatarUrl?: string;\n  onUpload: (file: File) => Promise<void>;\n  userInitials: string;\n}\n\nconst MAX_FILE_SIZE = 5 * 1024 * 1024; // 5MB\nconst ALLOWED_FILE_TYPES = ['image/jpeg', 'image/png', 'image/webp'];\n\nexport function AvatarUpload({ currentAvatarUrl, onUpload, userInitials }: AvatarUploadProps) {\n  const [isUploading, setIsUploading] = useState(false);\n  const { toast } = useToast();\n  const fileInputRef = React.useRef<HTMLInputElement>(null);\n\n  const handleFileSelect = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Validate file size\n    if (file.size > MAX_FILE_SIZE) {\n      toast({\n        title: \"File too large\",\n        description: \"Please select an image under 5MB\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    // Validate file type\n    if (!ALLOWED_FILE_TYPES.includes(file.type)) {\n      toast({\n        title: \"Invalid file type\",\n        description: \"Please select a JPEG, PNG or WebP image\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    try {\n      setIsUploading(true);\n      await onUpload(file);\n      toast({\n        title: \"Success\",\n        description: \"Profile picture updated successfully\"\n      });\n    } catch (error) {\n      console.error('Error uploading avatar:', error);\n      toast({\n        title: \"Upload failed\",\n        description: \"Failed to update profile picture. Please try again.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col items-center gap-4\">\n      <Avatar className=\"h-24 w-24\">\n        <AvatarImage src={currentAvatarUrl} />\n        <AvatarFallback>{userInitials}</AvatarFallback>\n      </Avatar>\n      <input\n        type=\"file\"\n        ref={fileInputRef}\n        className=\"hidden\"\n        accept={ALLOWED_FILE_TYPES.join(',')}\n        onChange={handleFileSelect}\n      />\n      <Button \n        variant=\"outline\" \n        onClick={() => fileInputRef.current?.click()}\n        disabled={isUploading}\n      >\n        {isUploading ? 'Uploading...' : 'Change Profile Picture'}\n      </Button>\n      <p className=\"text-sm text-muted-foreground\">\n        Maximum file size: 5MB. Supported formats: JPEG, PNG, WebP\n      </p>\n    </div>\n  );\n} ","import React, { useState } from 'react';\nimport { useAuth } from '../lib/auth';\nimport { Layout } from './Layout';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Label } from './ui/label';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { AvatarUpload } from './AvatarUpload';\nimport { supabase } from '../lib/supabase';\nimport { useToast } from './ui/use-toast';\n\nexport default function AccountSettings() {\n  const { user, profile } = useAuth();\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n  const [formData, setFormData] = useState({\n    fullName: profile?.full_name || '',\n    currentPassword: '',\n    newPassword: '',\n    confirmPassword: '',\n  });\n\n  const handleAvatarUpload = async (file: File) => {\n    if (!user) return;\n\n    try {\n      // Create a unique file name\n      const fileExt = file.name.split('.').pop();\n      const fileName = `${user.id}-${Date.now()}.${fileExt}`;\n      const filePath = `${user.id}/${fileName}`;\n\n      // Upload the file to Supabase storage\n      const { error: uploadError, data } = await supabase.storage\n        .from('avatars')\n        .upload(filePath, file, {\n          cacheControl: '3600',\n          upsert: true\n        });\n\n      if (uploadError) {\n        console.error('Upload error:', uploadError);\n        throw uploadError;\n      }\n\n      // Get the public URL\n      const {\n        data: { publicUrl },\n      } = supabase.storage\n        .from('avatars')\n        .getPublicUrl(filePath);\n\n      console.log('File uploaded, public URL:', publicUrl);\n\n      // Update the user's profile with the new avatar URL\n      const { error: updateError } = await supabase\n        .from('profiles')\n        .update({\n          avatar_url: publicUrl,\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', user.id);\n\n      if (updateError) {\n        console.error('Profile update error:', updateError);\n        throw updateError;\n      }\n\n      // Verify the update\n      const { data: updatedProfile, error: verifyError } = await supabase\n        .from('profiles')\n        .select('avatar_url')\n        .eq('id', user.id)\n        .single();\n\n      if (verifyError) {\n        console.error('Verification error:', verifyError);\n        throw verifyError;\n      }\n\n      console.log('Profile updated with new avatar:', updatedProfile);\n\n      // Force a page refresh to show the new avatar\n      window.location.reload();\n\n    } catch (error) {\n      console.error('Error in handleAvatarUpload:', error);\n      throw error;\n    }\n  };\n\n  const handleUpdateProfile = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!user) return;\n\n    try {\n      setIsLoading(true);\n\n      // Update full name\n      if (formData.fullName !== profile?.full_name) {\n        const { error: updateError } = await supabase\n          .from('profiles')\n          .update({ full_name: formData.fullName })\n          .eq('id', user.id);\n\n        if (updateError) throw updateError;\n      }\n\n      // Update password if provided\n      if (formData.newPassword) {\n        if (formData.newPassword !== formData.confirmPassword) {\n          throw new Error('New passwords do not match');\n        }\n\n        const { error: passwordError } = await supabase.auth.updateUser({\n          password: formData.newPassword\n        });\n\n        if (passwordError) throw passwordError;\n      }\n\n      toast({\n        title: \"Success\",\n        description: \"Profile updated successfully\"\n      });\n\n      // Clear password fields\n      setFormData(prev => ({\n        ...prev,\n        currentPassword: '',\n        newPassword: '',\n        confirmPassword: ''\n      }));\n    } catch (error: any) {\n      console.error('Error updating profile:', error);\n      toast({\n        title: \"Update failed\",\n        description: error.message || \"Failed to update profile\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const userInitials = profile?.full_name\n    ?.split(' ')\n    .map(n => n[0])\n    .join('')\n    .toUpperCase() || '??';\n\n  return (\n    <Layout>\n      <div className=\"container mx-auto px-4 py-8 pt-24\">\n        <div className=\"max-w-2xl mx-auto space-y-8\">\n          <h1 className=\"text-3xl font-bold\">Account Settings</h1>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Profile Picture</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <AvatarUpload\n                currentAvatarUrl={profile?.avatar_url}\n                onUpload={handleAvatarUpload}\n                userInitials={userInitials}\n              />\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Profile Information</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <form onSubmit={handleUpdateProfile} className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"fullName\">Full Name</Label>\n                  <Input\n                    id=\"fullName\"\n                    value={formData.fullName}\n                    onChange={e => setFormData(prev => ({ ...prev, fullName: e.target.value }))}\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"email\">Email</Label>\n                  <Input\n                    id=\"email\"\n                    value={user?.email || ''}\n                    disabled\n                  />\n                </div>\n\n                <div className=\"pt-4\">\n                  <h3 className=\"text-lg font-semibold mb-4\">Change Password</h3>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <Label htmlFor=\"currentPassword\">Current Password</Label>\n                      <Input\n                        id=\"currentPassword\"\n                        type=\"password\"\n                        value={formData.currentPassword}\n                        onChange={e => setFormData(prev => ({ ...prev, currentPassword: e.target.value }))}\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"newPassword\">New Password</Label>\n                      <Input\n                        id=\"newPassword\"\n                        type=\"password\"\n                        value={formData.newPassword}\n                        onChange={e => setFormData(prev => ({ ...prev, newPassword: e.target.value }))}\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"confirmPassword\">Confirm New Password</Label>\n                      <Input\n                        id=\"confirmPassword\"\n                        type=\"password\"\n                        value={formData.confirmPassword}\n                        onChange={e => setFormData(prev => ({ ...prev, confirmPassword: e.target.value }))}\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                <Button type=\"submit\" disabled={isLoading}>\n                  {isLoading ? 'Saving...' : 'Save Changes'}\n                </Button>\n              </form>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </Layout>\n  );\n}\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { Button } from './ui/button';\nimport { Home } from 'lucide-react';\n\nconst NotFound = () => {\n  return (\n    <div className=\"flex flex-col items-center justify-center min-h-[80vh] px-4\">\n      <div className=\"text-center space-y-6 max-w-2xl\">\n        <h1 className=\"text-4xl font-bold tracking-tight sm:text-6xl text-primary\">\n          404\n        </h1>\n        <h2 className=\"text-2xl font-semibold tracking-tight sm:text-3xl\">\n          Page Not Found\n        </h2>\n        <p className=\"text-muted-foreground text-lg\">\n          Sorry, we couldn't find the page you're looking for. The page might have been removed, renamed, or doesn't exist.\n        </p>\n        \n        <div className=\"flex justify-center gap-4 pt-4\">\n          <Button asChild>\n            <Link to=\"/\" className=\"flex items-center gap-2\">\n              <Home className=\"h-4 w-4\" />\n              Back to Home\n            </Link>\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default NotFound; ","import { supabase } from \"./supabaseClient\";\n\n// Define the SQL constant directly in this file instead of re-exporting it\nexport const CREATE_MARKET_INSIGHTS_TABLE_SQL = `\n-- Function to create the market_insights table\nCREATE OR REPLACE FUNCTION create_market_insights_table()\nRETURNS VOID AS $$\nBEGIN\n  -- Check if the table already exists\n  IF NOT EXISTS (\n    SELECT FROM information_schema.tables \n    WHERE table_schema = 'public' \n    AND table_name = 'market_insights'\n  ) THEN\n    -- Create the table\n    CREATE TABLE public.market_insights (\n      id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n      content TEXT NOT NULL,\n      generated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n      created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n    );\n    \n    -- Add appropriate indexes\n    CREATE INDEX market_insights_generated_at_idx ON public.market_insights (generated_at);\n    \n    -- Set up RLS (Row Level Security)\n    ALTER TABLE public.market_insights ENABLE ROW LEVEL SECURITY;\n    \n    -- Create policies\n    CREATE POLICY \"Allow anonymous read access\" \n      ON public.market_insights FOR SELECT \n      USING (true);\n      \n    CREATE POLICY \"Allow authenticated insert\" \n      ON public.market_insights FOR INSERT \n      TO authenticated \n      WITH CHECK (true);\n  END IF;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Function to check if the user has admin privileges\nCREATE OR REPLACE FUNCTION check_admin_privileges()\nRETURNS BOOLEAN AS $$\nBEGIN\n  -- Try to create a temporary table as a privilege check\n  BEGIN\n    CREATE TEMPORARY TABLE privilege_check (id INT);\n    DROP TABLE privilege_check;\n    RETURN TRUE;\n  EXCEPTION\n    WHEN insufficient_privilege THEN\n      RETURN FALSE;\n  END;\nEND;\n$$ LANGUAGE plpgsql;\n`;\n\n// Mock data for when API calls fail\nconst MOCK_NEWS = [\n  {\n    title: \"UK House Prices Show Resilience Despite Economic Pressures\",\n    source: \"Property News UK\",\n    published_at: new Date().toISOString(),\n    url: \"#\",\n    excerpt: \"The latest data shows UK house prices maintaining stability with regional variations in growth rates.\"\n  },\n  {\n    title: \"New Rental Reforms Set to Transform Landlord-Tenant Relationships\",\n    source: \"Real Estate Times\",\n    published_at: new Date(Date.now() - 86400000).toISOString(),\n    url: \"#\",\n    excerpt: \"The government's proposed rental reforms aim to provide greater security for tenants while maintaining landlord rights.\"\n  },\n  {\n    title: \"Property Investment Shifts: Where Buyers Are Looking in 2024\",\n    source: \"Investment Quarterly\",\n    published_at: new Date(Date.now() - 172800000).toISOString(),\n    url: \"#\",\n    excerpt: \"Investor focus is moving toward emerging regional hotspots as work patterns continue to evolve post-pandemic.\"\n  },\n  {\n    title: \"Interest Rate Forecast and Impact on Mortgage Market\",\n    source: \"Financial Property Review\",\n    published_at: new Date(Date.now() - 259200000).toISOString(),\n    url: \"#\",\n    excerpt: \"Analysts predict stabilizing interest rates may provide relief for mortgage holders in the coming quarters.\"\n  },\n  {\n    title: \"Green Homes Grant: What Property Owners Need to Know\",\n    source: \"Sustainable Housing\",\n    published_at: new Date(Date.now() - 345600000).toISOString(),\n    url: \"#\",\n    excerpt: \"The latest initiatives for improving energy efficiency in UK homes and the financial incentives available.\"\n  }\n];\n\nconst MOCK_MARKET_INSIGHTS = `\n# UK Property Market Insights: July 2024\n\n## Latest Tax Law Changes\n\nThe UK property market continues to adapt to recent regulatory changes. In April 2024, the government implemented adjustments to Capital Gains Tax (CGT) rates for property investors, with the higher rate increasing from 28% to 30% for residential property disposals. Buy-to-let landlords face additional reporting requirements for rental income above £10,000 annually.\n\nThe Stamp Duty Land Tax (SDLT) thresholds remain unchanged from last year's autumn statement, with first-time buyers enjoying relief up to £425,000 (down from £625,000 in 2023).\n\n## Landlord Regulations\n\nLicensing requirements have expanded to include mandatory electrical safety certificates (EICR) renewals every five years, and the new Decent Homes Standard now applies to the private rental sector. Tenant rights have strengthened with the Renters Reform Bill provisions now in effect, limiting no-fault evictions and establishing stronger grounds for possession.\n\nProperty safety regulations now include stricter rules for carbon monoxide alarms, with mandatory installation in all rooms with fixed combustion appliances.\n\n## Government Policies\n\nThe Housing Ministry has announced a target of 300,000 new homes annually by 2026, with planning reforms to streamline development in designated growth zones. The Help to Buy equity loan scheme has been replaced with the First Homes initiative, offering 30-50% discounts on market value for first-time buyers.\n\nRegional variations exist in Scotland's Private Housing (Tenancies) Act and Wales' Renting Homes Act, creating a patchwork regulatory landscape.\n\n## Market Impact Analysis\n\nThese regulatory changes are creating downward pressure on rental yields, with the average UK yield dropping from 5.8% to 5.2% over the past year. Property values in commuter belts have shown greater resilience (+3.2%) compared to city centers (+1.7%).\n\nInvestment strategy adjustments should focus on regions with strong infrastructure investment and employment growth, particularly the Midlands and Northern England which offer better yields despite regulatory pressures.\n`;\n\nconst MOCK_RISK_ASSESSMENT = `\n# Market Risk Assessment: UK Property Sector\n\n## Current Risk Level: Moderate\n\n### Interest Rate Risk\nThe Bank of England's current base rate of 4.25% represents a stabilization after the peak of 5.25% in late 2023. While further cuts are anticipated, they are expected to be gradual, maintaining moderate pressure on mortgage affordability.\n\n### Regulatory Risk\nThe implementation phase of the Renters Reform Bill creates temporary uncertainty for landlords adapting to new requirements. Compliance costs have increased approximately 12% year-over-year.\n\n### Market Liquidity Risk\nTransaction volumes remain 15% below pre-pandemic levels, extending the average time to sell from 45 to 63 days. Regional variations are significant, with London experiencing greater liquidity constraints than the North East.\n\n### Recommendation\nInvestors should focus on properties with strong fundamentals that can weather short-term market fluctuations, particularly those in areas with diverse economic bases and strong rental demand.\n`;\n\nconst MOCK_PERSONALIZED_OPPORTUNITIES = [\n  {\n    area: \"Manchester - Salford Quays\",\n    propertyType: \"2-bedroom apartments\",\n    averagePrice: 210000,\n    expectedYield: 5.8,\n    growthPotential: \"High\",\n    keyFactors: [\n      \"Tech industry expansion\",\n      \"Transport improvements\",\n      \"Regeneration projects\"\n    ]\n  },\n  {\n    area: \"Birmingham - Jewellery Quarter\",\n    propertyType: \"1-2 bedroom converted industrial\",\n    averagePrice: 185000,\n    expectedYield: 5.4,\n    growthPotential: \"Medium-High\",\n    keyFactors: [\n      \"HS2 development impact\",\n      \"Growing young professional population\",\n      \"Cultural district revival\"\n    ]\n  },\n  {\n    area: \"Leeds - South Bank\",\n    propertyType: \"New build city apartments\",\n    averagePrice: 195000,\n    expectedYield: 5.9,\n    growthPotential: \"High\",\n    keyFactors: [\n      \"Major regeneration area\",\n      \"Financial sector growth\",\n      \"University expansion\"\n    ]\n  }\n];\n\n// Check if the market_insights table exists, create it if it doesn't\nasync function ensureMarketInsightsTable() {\n  try {\n    // First check if the table exists\n    const { error: checkError } = await supabase\n      .from('market_insights')\n      .select('id')\n      .limit(1);\n    \n    // If the table doesn't exist, we'll get a specific error\n    if (checkError && checkError.code === '42P01') {\n      console.log('Market insights table does not exist, attempting to create it...');\n      \n      // Using SQL to create the table - note this requires higher privileges,\n      // so it might not work with the client's credentials\n      const { error: createError } = await supabase.rpc('create_market_insights_table');\n      \n      if (createError) {\n        console.error('Failed to create market_insights table:', createError);\n        return false;\n      }\n      \n      console.log('Market insights table created successfully');\n      return true;\n    }\n    \n    // Table exists\n    return true;\n  } catch (error) {\n    console.error('Error checking/creating market_insights table:', error);\n    return false;\n  }\n}\n\n// Modified to use mock data when API fails\nexport async function fetchPropertyNews() {\n  try {\n    // Try to fetch from real API\n    const response = await fetch(\n      \"https://newsapi.org/v2/everything?q=uk+property+market&sortBy=publishedAt&apiKey=YOUR_API_KEY&pageSize=10\"\n    );\n    \n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    \n    const data = await response.json();\n    if (data.articles && data.articles.length > 0) {\n      return data.articles.map((article: any) => ({\n        title: article.title,\n        source: article.source.name,\n        published_at: article.publishedAt,\n        url: article.url,\n        excerpt: article.description\n      }));\n    }\n    \n    // Fallback to mock data if no articles\n    console.log('No articles found in API response, using mock data');\n    return MOCK_NEWS;\n  } catch (error) {\n    console.error(\"Error fetching property news:\", error);\n    // Return mock data on error\n    return MOCK_NEWS;\n  }\n}\n\n// Modified to use mock data when API fails\nexport async function generateMarketInsights(prompt: string) {\n  try {\n    // Check if the API key is valid\n    const apiKey = \"AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo\";\n    if (!apiKey || apiKey.includes(\"YOUR_API_KEY\")) {\n      console.warn(\"Using mock data: No valid API key provided for Gemini\");\n      return MOCK_MARKET_INSIGHTS;\n    }\n    \n    // Try to use the real API\n    const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`;\n    \n    const response = await fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        contents: [\n          {\n            parts: [\n              {\n                text: prompt,\n              },\n            ],\n          },\n        ],\n        generationConfig: {\n          temperature: 0.7,\n          maxOutputTokens: 1024,\n        },\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n\n    const data = await response.json();\n    \n    // Extract the text from the response, handling different response structures\n    let generatedText = \"\";\n    if (data.candidates && data.candidates[0] && data.candidates[0].content) {\n      const textParts = data.candidates[0].content.parts.filter(\n        (part: any) => part.text\n      );\n      generatedText = textParts.map((part: any) => part.text).join(\"\\n\");\n    } else if (data.text) {\n      generatedText = data.text;\n    }\n\n    if (!generatedText) {\n      console.warn(\"Empty response from Gemini API, using mock data\");\n      return MOCK_MARKET_INSIGHTS;\n    }\n\n    return generatedText;\n  } catch (error) {\n    console.error(\"Error generating insights:\", error);\n    // Return mock data on error\n    return MOCK_MARKET_INSIGHTS;\n  }\n}\n\nexport async function formatMessage(text: string) {\n  // Simple markdown-to-html conversion for basic formatting\n  if (!text) return \"<p>No data available</p>\";\n  \n  return text\n    .replace(/^# (.*$)/gm, '<h1 class=\"text-2xl font-bold mb-4 mt-6\">$1</h1>')\n    .replace(/^## (.*$)/gm, '<h2 class=\"text-xl font-semibold mb-3 mt-5\">$1</h2>')\n    .replace(/^### (.*$)/gm, '<h3 class=\"text-lg font-medium mb-2 mt-4\">$1</h3>')\n    .replace(/\\*\\*(.*)\\*\\*/gm, '<strong>$1</strong>')\n    .replace(/\\*(.*)\\*/gm, '<em>$1</em>')\n    .replace(/\\n- (.*)/gm, '\\n<li>$1</li>')\n    .replace(/<\\/li>\\n<li>/gm, '</li><li>')\n    .replace(/\\n<li>/gm, '\\n<ul class=\"list-disc pl-5 mb-4\"><li>')\n    .replace(/<\\/li>\\n\\n/gm, '</li></ul>\\n\\n')\n    .replace(/<\\/li>\\n([^<])/gm, '</li></ul>\\n$1')\n    .replace(/\\n\\n/gm, '</p><p class=\"mb-4\">')\n    .replace(/^(.+)$/gm, '<p class=\"mb-4\">$1</p>')\n    .replace(/<p>\\s*<\\/p>/g, '')\n    .replace(/<p><h/g, '<h')\n    .replace(/<\\/h.*?><\\/p>/g, '</h>');\n}\n\nexport async function getLatestMarketInsights() {\n  try {\n    await ensureMarketInsightsTable();\n    \n    const { data, error } = await supabase\n      .from(\"market_insights\")\n      .select(\"*\")\n      .order(\"generated_at\", { ascending: false })\n      .limit(1);\n\n    if (error) {\n      console.error(\"Error fetching market insights:\", error);\n      // Return a mock response instead of throwing\n      return {\n        id: \"mock-id\",\n        content: MOCK_MARKET_INSIGHTS,\n        generated_at: new Date().toISOString(),\n      };\n    }\n\n    return data && data.length > 0 ? data[0] : null;\n  } catch (error) {\n    console.error(\"Error in getLatestMarketInsights:\", error);\n    // Return a mock response on error\n    return {\n      id: \"mock-id\",\n      content: MOCK_MARKET_INSIGHTS,\n      generated_at: new Date().toISOString(),\n    };\n  }\n}\n\nexport async function storeMarketInsights(content: string) {\n  try {\n    await ensureMarketInsightsTable();\n    \n    const { data, error } = await supabase\n      .from(\"market_insights\")\n      .insert([\n        {\n          content,\n          generated_at: new Date().toISOString(),\n        },\n      ])\n      .select();\n\n    if (error) {\n      console.error(\"Error storing market insights:\", error);\n      return null;\n    }\n\n    return data && data.length > 0 ? data[0] : null;\n  } catch (error) {\n    console.error(\"Error in storeMarketInsights:\", error);\n    return null;\n  }\n}\n\nexport async function getRiskAssessment() {\n  try {\n    // This could be fetched from an API or database in the future\n    return MOCK_RISK_ASSESSMENT;\n  } catch (error) {\n    console.error(\"Error fetching risk assessment:\", error);\n    return MOCK_RISK_ASSESSMENT;\n  }\n}\n\nexport async function getPersonalizedOpportunities() {\n  try {\n    // This could be fetched from an API or database in the future\n    return MOCK_PERSONALIZED_OPPORTUNITIES;\n  } catch (error) {\n    console.error(\"Error fetching personalized opportunities:\", error);\n    return MOCK_PERSONALIZED_OPPORTUNITIES;\n  }\n}\n\nexport async function getPredictiveAnalytics(region = \"UK\") {\n  try {\n    // This would connect to a real predictive API in the future\n    return {\n      region: region,\n      currentAveragePrice: 290000,\n      predictedGrowthRate: 3.8,\n      confidenceScore: 82,\n      timeframe: \"12 months\",\n      factors: [\n        \"Interest rate stabilization\",\n        \"Housing supply constraints\",\n        \"Regional economic development\"\n      ]\n    };\n  } catch (error) {\n    console.error(\"Error fetching predictive analytics:\", error);\n    return {\n      region: region,\n      currentAveragePrice: 290000,\n      predictedGrowthRate: 3.2,\n      confidenceScore: 75,\n      timeframe: \"12 months\",\n      factors: [\n        \"Mock data - API unavailable\",\n        \"Contact administrator for actual predictions\"\n      ]\n    };\n  }\n}\n","import React from \"react\";\nimport { Card, CardContent, CardHeader } from \"./ui/card\";\nimport {\n  fetchPropertyNews,\n  generateMarketInsights,\n  getLatestMarketInsights,\n  getRiskAssessment,\n  getPersonalizedOpportunities,\n  getPredictiveAnalytics,\n} from \"../lib/market-insights\";\nimport { cn } from \"../lib/utils\";\nimport { Button } from \"./ui/button\";\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\nimport HeroSection from \"./HeroSection\";\n\ninterface MarketInsightsProps {\n  user?: any;\n  profile?: any;\n  className?: string;\n  showHero?: boolean;\n}\n\nexport function MarketInsights({ user, profile, className, showHero = true }: MarketInsightsProps) {\n  const [news, setNews] = React.useState<any[]>([]);\n  const [insights, setInsights] = React.useState<string>(\"\");\n  const [riskAssessment, setRiskAssessment] = React.useState<string>(\"No risk assessment data available.\");\n  const [personalizedOpportunities, setPersonalizedOpportunities] = React.useState<any[]>([]);\n  const [loading, setLoading] = React.useState(true);\n  const [error, setError] = React.useState<string | null>(null);\n\n  React.useEffect(() => {\n    const loadData = async () => {\n      try {\n        // Fetch news\n        const newsData = await fetchPropertyNews();\n        setNews(newsData.slice(0, 5));\n\n        // Get latest insights from Supabase\n        const latestInsights = await getLatestMarketInsights();\n        if (latestInsights) {\n          setInsights(latestInsights.content);\n        } else {\n          // Generate new insights if none exist\n          const newInsights = await generateMarketInsights(\n            \"Provide a concise analysis of the current UK property market trends, focusing on interest rates, price movements, and market sentiment. Include key statistics and recommendations for investors.\",\n          );\n          setInsights(newInsights);\n        }\n\n        // Fetch risk assessment\n        const riskData = await getRiskAssessment();\n        setRiskAssessment(riskData);\n\n        // Fetch personalized investment opportunities\n        const opportunitiesData = await getPersonalizedOpportunities();\n        setPersonalizedOpportunities(opportunitiesData);\n\n        // Fetch predictive analytics\n        const predictiveData = await getPredictiveAnalytics();\n        // Handle predictive data as needed\n      } catch (error) {\n        console.error(\"Error loading market data:\", error);\n        setError(\"Failed to load market data.\");\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadData();\n  }, []);\n\n  // Sample data for demonstration\n  const priceData = [\n    { month: 'Jan', price: 320000 },\n    { month: 'Feb', price: 325000 },\n    { month: 'Mar', price: 329000 },\n    { month: 'Apr', price: 335000 },\n    { month: 'May', price: 340000 },\n    { month: 'Jun', price: 345000 },\n  ];\n\n  const regionalData = [\n    { region: 'London', price: 500000 },\n    { region: 'Manchester', price: 250000 },\n    { region: 'Birmingham', price: 220000 },\n    { region: 'Leeds', price: 200000 },\n    { region: 'Liverpool', price: 180000 },\n  ];\n\n  return (\n    <>\n      {/* Only render hero if showHero prop is true */}\n      {showHero && (\n        <div className=\"w-full\">\n          <HeroSection\n            title=\"Property Market Insights & Analysis\"\n            subtitle=\"Expert analysis, regional comparisons, and investment recommendations to guide your property decisions\"\n            showSearch={false}\n            showStats={false}\n            height=\"h-[400px]\"\n          />\n        </div>\n      )}\n\n      {/* Content area */}\n      <div className={cn(\"w-full\", className)}>\n        <div className=\"container mx-auto px-4 py-12\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12\">\n            <Card>\n              <CardHeader>\n                <h2 className=\"text-xl font-semibold\">Price Trends</h2>\n              </CardHeader>\n              <CardContent className=\"h-80\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <LineChart data={priceData}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis dataKey=\"month\" />\n                    <YAxis />\n                    <Tooltip \n                      formatter={(value) => [`£${value.toLocaleString()}`, 'Average Price']}\n                    />\n                    <Line \n                      type=\"monotone\" \n                      dataKey=\"price\" \n                      stroke=\"hsl(var(--primary))\"\n                      activeDot={{ r: 8 }}\n                    />\n                  </LineChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <h2 className=\"text-xl font-semibold\">Regional Comparison</h2>\n              </CardHeader>\n              <CardContent className=\"h-80\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <LineChart data={regionalData}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis dataKey=\"region\" />\n                    <YAxis />\n                    <Tooltip \n                      formatter={(value) => [`£${value.toLocaleString()}`, 'Average Price']}\n                    />\n                    <Line \n                      type=\"monotone\" \n                      dataKey=\"price\" \n                      stroke=\"hsl(var(--primary))\"\n                      activeDot={{ r: 8 }}\n                    />\n                  </LineChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n          </div>\n\n          <Card className=\"mb-12\">\n            <CardHeader>\n              <h2 className=\"text-xl font-semibold\">Market Analysis</h2>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-muted-foreground mb-4\">\n                The UK property market continues to show resilience despite economic challenges.\n                Regional variations are significant, with some areas experiencing rapid growth\n                while others see more moderate changes.\n              </p>\n              <p className=\"text-muted-foreground mb-4\">\n                Key factors influencing the current market include:\n              </p>\n              <ul className=\"list-disc pl-5 mb-4 text-muted-foreground\">\n                <li>Interest rate changes affecting mortgage affordability</li>\n                <li>Supply constraints in high-demand areas</li>\n                <li>Increasing preference for properties with outdoor space</li>\n                <li>Remote work influencing location decisions</li>\n              </ul>\n              <Button>Download Full Report</Button>\n            </CardContent>\n          </Card>\n\n          {/* Only show premium insights for premium subscribers */}\n          {profile?.subscription_tier !== 'free' && (\n            <Card className=\"mb-12 border-primary/20 bg-gradient-to-r from-primary/5 to-background\">\n              <CardHeader>\n                <h2 className=\"text-xl font-semibold flex items-center\">\n                  Premium Market Insights\n                  <span className=\"ml-2 px-2 py-1 text-xs rounded-full bg-primary/20 text-primary\">\n                    Premium\n                  </span>\n                </h2>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-muted-foreground mb-4\">\n                  Our exclusive analysis indicates emerging hotspots in the following areas:\n                </p>\n                <ul className=\"list-disc pl-5 mb-4 text-muted-foreground\">\n                  <li>Northwest Manchester - projected 8.3% growth over 12 months</li>\n                  <li>East Birmingham suburbs - increasing demand from young professionals</li>\n                  <li>Coastal towns in the Southwest - rising popularity for remote workers</li>\n                </ul>\n                <Button>View Detailed Forecast</Button>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n","import React from \"react\";\nimport { Card, CardContent, CardHeader } from \"./ui/card\";\nimport { \n  LineChart, \n  Line, \n  BarChart, \n  Bar,\n  PieChart,\n  Pie,\n  Cell,\n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  Legend,\n  ResponsiveContainer \n} from 'recharts';\nimport { Button } from \"./ui/button\";\nimport { \n  BarChart3, \n  PieChart as PieChartIcon, \n  LineChart as LineChartIcon, \n  MapPin \n} from \"lucide-react\";\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from \"./ui/tabs\";\n\ninterface DataVisualizationProps {\n  user?: any;\n  profile?: any;\n  className?: string;\n}\n\nexport function DataVisualization({ user, profile, className }: DataVisualizationProps) {\n  const [activeChart, setActiveChart] = React.useState('price');\n\n  // Sample data for price trends\n  const priceData = [\n    { year: '2018', price: 280000 },\n    { year: '2019', price: 295000 },\n    { year: '2020', price: 305000 },\n    { year: '2021', price: 320000 },\n    { year: '2022', price: 335000 },\n    { year: '2023', price: 345000 },\n    { year: '2024', price: 358000 },\n  ];\n\n  // Sample data for regional property distribution\n  const regionalData = [\n    { name: 'London', value: 38 },\n    { name: 'South East', value: 22 },\n    { name: 'North West', value: 16 },\n    { name: 'Midlands', value: 14 },\n    { name: 'Scotland', value: 10 },\n  ];\n\n  // Sample data for property types\n  const propertyTypeData = [\n    { type: 'Detached', count: 420 },\n    { type: 'Semi-Detached', count: 580 },\n    { type: 'Terraced', count: 510 },\n    { type: 'Flat', count: 390 },\n    { type: 'Bungalow', count: 160 },\n  ];\n\n  // Sample data for price per square foot by region\n  const pricePerSqftData = [\n    { region: 'London', ppsqft: 650 },\n    { region: 'South East', ppsqft: 410 },\n    { region: 'East', ppsqft: 380 },\n    { region: 'South West', ppsqft: 330 },\n    { region: 'East Midlands', ppsqft: 270 },\n    { region: 'West Midlands', ppsqft: 280 },\n    { region: 'Yorkshire', ppsqft: 240 },\n    { region: 'North West', ppsqft: 230 },\n    { region: 'North East', ppsqft: 190 },\n    { region: 'Wales', ppsqft: 210 },\n    { region: 'Scotland', ppsqft: 200 },\n  ];\n\n  // Colors for pie chart\n  const COLORS = ['#0088FE', '#00C49F', '#FFBB28', '#FF8042', '#8884d8'];\n\n  return (\n    <div className=\"container mx-auto px-4 py-6\">\n      <Card className=\"mb-8\">\n        <CardHeader>\n          <h2 className=\"text-xl font-semibold\">Data Visualization Dashboard</h2>\n          <p className=\"text-muted-foreground\">\n            Interactive charts and graphs showing property market trends and statistics\n          </p>\n        </CardHeader>\n        <CardContent>\n          <Tabs defaultValue=\"price\" value={activeChart} onValueChange={setActiveChart}>\n            <TabsList className=\"mb-6\">\n              <TabsTrigger value=\"price\" className=\"flex items-center\">\n                <LineChartIcon className=\"mr-2 h-4 w-4\" />\n                Price Trends\n              </TabsTrigger>\n              <TabsTrigger value=\"regional\" className=\"flex items-center\">\n                <PieChartIcon className=\"mr-2 h-4 w-4\" />\n                Regional Distribution\n              </TabsTrigger>\n              <TabsTrigger value=\"property-type\" className=\"flex items-center\">\n                <BarChart3 className=\"mr-2 h-4 w-4\" />\n                Property Types\n              </TabsTrigger>\n              <TabsTrigger value=\"price-per-sqft\" className=\"flex items-center\">\n                <MapPin className=\"mr-2 h-4 w-4\" />\n                Price per Sq Ft\n              </TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"price\" className=\"h-[500px]\">\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <LineChart\n                  data={priceData}\n                  margin={{ top: 20, right: 30, left: 20, bottom: 10 }}\n                >\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"year\" />\n                  <YAxis \n                    tickFormatter={(value) => `£${(value/1000).toFixed(0)}k`}\n                    domain={['dataMin - 20000', 'dataMax + 20000']}\n                  />\n                  <Tooltip \n                    formatter={(value) => [`£${value.toLocaleString()}`, 'Average Price']}\n                  />\n                  <Legend />\n                  <Line \n                    type=\"monotone\" \n                    dataKey=\"price\" \n                    name=\"Average UK Property Price\" \n                    stroke=\"hsl(var(--primary))\" \n                    activeDot={{ r: 8 }} \n                    strokeWidth={2}\n                  />\n                </LineChart>\n              </ResponsiveContainer>\n            </TabsContent>\n\n            <TabsContent value=\"regional\" className=\"h-[500px]\">\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <PieChart>\n                  <Pie\n                    data={regionalData}\n                    cx=\"50%\"\n                    cy=\"50%\"\n                    labelLine={true}\n                    outerRadius={180}\n                    fill=\"#8884d8\"\n                    dataKey=\"value\"\n                    label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}\n                  >\n                    {regionalData.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                    ))}\n                  </Pie>\n                  <Tooltip formatter={(value) => [`${value}%`, 'Market Share']} />\n                  <Legend />\n                </PieChart>\n              </ResponsiveContainer>\n            </TabsContent>\n\n            <TabsContent value=\"property-type\" className=\"h-[500px]\">\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <BarChart\n                  data={propertyTypeData}\n                  margin={{ top: 20, right: 30, left: 20, bottom: 10 }}\n                >\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"type\" />\n                  <YAxis />\n                  <Tooltip formatter={(value) => [`${value.toLocaleString()} properties`, 'Count']} />\n                  <Legend />\n                  <Bar \n                    dataKey=\"count\" \n                    name=\"Number of Properties\" \n                    fill=\"hsl(var(--primary))\"\n                    barSize={60}\n                  />\n                </BarChart>\n              </ResponsiveContainer>\n            </TabsContent>\n\n            <TabsContent value=\"price-per-sqft\" className=\"h-[500px]\">\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <BarChart\n                  data={pricePerSqftData}\n                  margin={{ top: 20, right: 30, left: 20, bottom: 10 }}\n                  layout=\"vertical\"\n                >\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis type=\"number\" />\n                  <YAxis type=\"category\" dataKey=\"region\" width={100} />\n                  <Tooltip formatter={(value) => [`£${value}/sq ft`, 'Price']} />\n                  <Bar \n                    dataKey=\"ppsqft\" \n                    name=\"Price per Square Foot\" \n                    fill=\"hsl(var(--primary))\"\n                    barSize={20}\n                  />\n                </BarChart>\n              </ResponsiveContainer>\n            </TabsContent>\n          </Tabs>\n\n          <div className=\"mt-6 flex items-center justify-end\">\n            {profile?.subscription_tier !== 'free' ? (\n              <Button>\n                Download Full Report\n              </Button>\n            ) : (\n              <Button variant=\"outline\" onClick={() => window.location.href = '/pricing'}>\n                Upgrade for Full Access\n              </Button>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n        <Card>\n          <CardHeader>\n            <h2 className=\"text-xl font-semibold\">About the Data</h2>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground mb-4\">\n              Our data is sourced from multiple reliable sources including Land Registry, \n              Office for National Statistics, and major UK property portals. Data is updated\n              monthly to provide the most accurate market insights.\n            </p>\n            <p className=\"text-muted-foreground\">\n              Premium subscribers have access to additional visualizations including \n              predictive models, heat maps, and custom reporting tools.\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <h2 className=\"text-xl font-semibold\">Data Interpretation Guide</h2>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground mb-4\">\n              These visualizations help identify property market trends and regional \n              variations. When interpreting the data, consider:\n            </p>\n            <ul className=\"list-disc pl-5 mb-4 text-muted-foreground\">\n              <li>Long-term trends rather than short-term fluctuations</li>\n              <li>Regional differences in property values and growth rates</li>\n              <li>Correlation with economic indicators like interest rates</li>\n              <li>Seasonality effects on the property market</li>\n            </ul>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n} ","import React, { useState } from 'react';\nimport { MarketInsights } from './MarketInsights';\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from './ui/tabs';\nimport { DataVisualization } from './DataVisualization';\nimport { useAuth } from '../lib/auth';\nimport HeroSection from './HeroSection';\nimport { Card, CardContent, CardHeader } from \"./ui/card\";\nimport { Button } from \"./ui/button\";\nimport {\n  Newspaper,\n  LineChart,\n  Building2,\n  Globe2,\n  AlertTriangle,\n  RefreshCw,\n} from \"lucide-react\";\nimport { Layout } from \"./Layout\";\nimport { PageTransition } from \"./ui/page-transition\";\nimport {\n  fetchPropertyNews,\n  generateMarketInsights,\n  getLatestMarketInsights,\n  storeMarketInsights,\n  CREATE_MARKET_INSIGHTS_TABLE_SQL\n} from \"../lib/market-insights\";\nimport { Alert, AlertDescription, AlertTitle } from \"./ui/alert\";\n\n// Auth context checker wrapper\nconst AuthContextChecker = ({ children }: { children: React.ReactNode }) => {\n  try {\n    // Try to access auth context but don't use the result\n    useAuth();\n    // If we get here, auth context is available\n    return <>{children}</>;\n  } catch (error) {\n    // If auth context is not available, show a fallback\n    return (\n      <Layout>\n        <div className=\"min-h-screen flex flex-col items-center justify-center p-4\">\n          <Card className=\"p-6 max-w-md w-full\">\n            <h2 className=\"text-xl font-bold mb-4 text-center\">Authentication Error</h2>\n            <p className=\"text-muted-foreground mb-6 text-center\">\n              Unable to load authentication. Please refresh the page or try again later.\n            </p>\n            <Button \n              className=\"w-full\" \n              onClick={() => window.location.reload()}\n            >\n              Refresh Page\n            </Button>\n          </Card>\n        </div>\n      </Layout>\n    );\n  }\n};\n\nexport default function MarketInsightsPage() {\n  const [activeTab, setActiveTab] = useState('insights');\n  const { user, profile } = useAuth();\n\n  return (\n    <AuthContextChecker>\n      <div className=\"flex flex-col w-full\">\n        {/* Hero section at the very top, before any other content */}\n        <HeroSection\n          title=\"Property Market Insights & Analysis\"\n          subtitle=\"Expert analysis, regional comparisons, and investment recommendations to guide your property decisions\"\n          showSearch={false}\n          showStats={false}\n          height=\"h-[400px]\"\n        />\n\n        {/* Tab navigation after the hero */}\n        <div className=\"container mx-auto px-4 py-6\">\n          <Tabs \n            defaultValue=\"insights\" \n            value={activeTab}\n            onValueChange={setActiveTab}\n            className=\"w-full\"\n          >\n            <TabsList className=\"mb-6\">\n              <TabsTrigger value=\"insights\">Market Insights</TabsTrigger>\n              <TabsTrigger value=\"visualization\">Data Visualization</TabsTrigger>\n            </TabsList>\n            \n            <TabsContent value=\"insights\" className=\"mt-0\">\n              {/* Don't render a hero inside MarketInsights since we already have one above */}\n              <MarketInsights \n                user={user} \n                profile={profile} \n                className=\"mt-0\"\n                showHero={false} // Pass prop to indicate hero should be hidden\n              />\n            </TabsContent>\n            \n            <TabsContent value=\"visualization\" className=\"mt-0\">\n              <DataVisualization user={user} profile={profile} />\n            </TabsContent>\n          </Tabs>\n        </div>\n      </div>\n    </AuthContextChecker>\n  );\n}\n","import { useState } from 'react';\n\n// Interface for chat responses\nexport interface ChatResponse {\n  content: string;\n  role: string;\n}\n\n// Function to get chat response with fallback\nexport async function getChatResponse(prompt: string): Promise<string> {\n  try {\n    // First try to call the API\n    console.log(\"Calling chat API with prompt:\", prompt);\n    \n    // Check if we're in development mode and should use mock data\n    if (process.env.NODE_ENV === 'development' || import.meta.env.VITE_USE_MOCK_AI === 'true') {\n      return getMockChatResponse(prompt);\n    }\n    \n    // Update the API URL to use the correct Gemini endpoint and version\n    const apiKey = import.meta.env.VITE_GEMINI_API_KEY;\n    const apiUrl = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent';\n    \n    const response = await fetch(`${apiUrl}?key=${apiKey}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        contents: [\n          {\n            parts: [\n              {\n                text: prompt\n              }\n            ]\n          }\n        ],\n        generationConfig: {\n          temperature: 0.7,\n          maxOutputTokens: 1024,\n        }\n      })\n    });\n    \n    if (!response.ok) {\n      console.error(\"API error:\", response.status, await response.text());\n      throw new Error(`API error: ${response.status} - ${await response.text()}`);\n    }\n    \n    const data = await response.json();\n    const content = data.candidates?.[0]?.content?.parts?.[0]?.text || \n                   \"Sorry, I couldn't generate a response at this time.\";\n                   \n    return content;\n  } catch (error) {\n    console.error(\"Error getting chat response:\", error);\n    \n    // Fall back to mock response\n    return getMockChatResponse(prompt);\n  }\n}\n\n// Function to get predictive analytics with fallback\nexport async function getPredictiveAnalytics(location: string): Promise<any> {\n  try {\n    console.log(\"Getting predictive analytics for location:\", location);\n    \n    // Use mock data in development mode\n    if (process.env.NODE_ENV === 'development' || import.meta.env.VITE_USE_MOCK_AI === 'true') {\n      return getMockPredictiveAnalytics(location);\n    }\n    \n    // Update API endpoint to match the current Gemini structure\n    const apiKey = import.meta.env.VITE_GEMINI_API_KEY;\n    const apiUrl = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent';\n    \n    const prompt = `Generate predictive analytics for property investment in ${location} for the next 5 years. Include price growth predictions, rental yield trends, and market dynamics. Format as JSON with the following structure: {\n      \"priceGrowthPrediction\": { \"year1\": 2.5, \"year2\": 3.1, \"year3\": 3.5, \"year4\": 2.8, \"year5\": 3.0 },\n      \"rentalYieldTrend\": { \"year1\": 5.2, \"year2\": 5.3, \"year3\": 5.4, \"year4\": 5.3, \"year5\": 5.2 },\n      \"marketSummary\": \"Brief summary of market dynamics\",\n      \"keyFactors\": [\"Factor 1\", \"Factor 2\", \"Factor 3\"]\n    }`;\n    \n    const response = await fetch(`${apiUrl}?key=${apiKey}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        contents: [\n          {\n            parts: [\n              {\n                text: prompt\n              }\n            ]\n          }\n        ],\n        generationConfig: {\n          temperature: 0.2,\n          maxOutputTokens: 1024,\n        }\n      })\n    });\n    \n    if (!response.ok) {\n      throw new Error(`API response was not ok`);\n    }\n    \n    const data = await response.json();\n    const content = data.candidates?.[0]?.content?.parts?.[0]?.text || null;\n    \n    if (!content) throw new Error(\"No content returned from API\");\n    \n    // Extract JSON from the response\n    let jsonMatch = content.match(/```json\\n([\\s\\S]*?)\\n```/) || \n                    content.match(/```([\\s\\S]*?)```/) ||\n                    content.match(/(\\{[\\s\\S]*\\})/);\n                    \n    if (jsonMatch && jsonMatch[1]) {\n      return JSON.parse(jsonMatch[1].trim());\n    } else {\n      // Try parsing the whole response if no JSON block is found\n      try {\n        return JSON.parse(content);\n      } catch (e) {\n        console.error(\"Error parsing predictive analytics:\", e);\n        return getMockPredictiveAnalytics(location);\n      }\n    }\n  } catch (error) {\n    console.error(\"Error fetching predictive analytics:\", error);\n    return getMockPredictiveAnalytics(location);\n  }\n}\n\n// Function to get investment hotspots with fallback\nexport async function getInvestmentHotspots(region: string): Promise<any> {\n  try {\n    console.log(\"Getting investment hotspots for region:\", region);\n    \n    // Use mock data in development mode\n    if (process.env.NODE_ENV === 'development' || import.meta.env.VITE_USE_MOCK_AI === 'true') {\n      return getMockHotspots(region);\n    }\n    \n    // Update API endpoint to match the current Gemini structure\n    const apiKey = import.meta.env.VITE_GEMINI_API_KEY;\n    const apiUrl = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent';\n    \n    const prompt = `Generate a list of emerging property investment hotspots in ${region} with reasons why they are promising. Format as JSON with the following structure: \n    {\n      \"hotspots\": [\n        {\n          \"area\": \"Area name\",\n          \"growthPotential\": 4.2,\n          \"reasons\": [\"Reason 1\", \"Reason 2\"],\n          \"estimatedROI\": 5.8,\n          \"investmentType\": \"Buy-to-let\"\n        }\n      ]\n    }\n    Include 3-5 different hotspots.`;\n    \n    const response = await fetch(`${apiUrl}?key=${apiKey}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        contents: [\n          {\n            parts: [\n              {\n                text: prompt\n              }\n            ]\n          }\n        ],\n        generationConfig: {\n          temperature: 0.3,\n          maxOutputTokens: 1024,\n        }\n      })\n    });\n    \n    if (!response.ok) {\n      throw new Error(`API response was not ok`);\n    }\n    \n    const data = await response.json();\n    const content = data.candidates?.[0]?.content?.parts?.[0]?.text || null;\n    \n    if (!content) throw new Error(\"No content returned from API\");\n    \n    // Extract JSON from the response\n    let jsonMatch = content.match(/```json\\n([\\s\\S]*?)\\n```/) || \n                    content.match(/```([\\s\\S]*?)```/) ||\n                    content.match(/(\\{[\\s\\S]*\\})/);\n                    \n    if (jsonMatch && jsonMatch[1]) {\n      return JSON.parse(jsonMatch[1].trim());\n    } else {\n      // Try parsing the whole response if no JSON block is found\n      try {\n        return JSON.parse(content);\n      } catch (e) {\n        console.error(\"Failed to parse hotspots:\", e);\n        return getMockHotspots(region);\n      }\n    }\n  } catch (error) {\n    console.error(\"Failed to fetch hotspots:\", error);\n    return getMockHotspots(region);\n  }\n}\n\n// Mock functions to provide fallback data\nfunction getMockChatResponse(prompt: string): string {\n  if (prompt.includes(\"market insights\")) {\n    return \"Based on recent data, the property market in this area has shown strong growth over the past 12 months. Average prices have increased by approximately 7.3%, which is above the national average of 4.5%. Rental yields remain competitive at around 5.2% for typical properties. The local economy is benefiting from new infrastructure projects and employment opportunities, which should provide continued stability. Demand currently exceeds supply, especially for 2-3 bedroom properties, creating a seller's market. Analysts predict continued but more moderate growth over the next 24 months.\";\n  } else if (prompt.includes(\"investment advice\")) {\n    return \"For property investors looking at this market, there are several strategies worth considering:\\n\\n1. Buy-to-let opportunities are particularly strong in the north and east neighborhoods, where rental demand from young professionals is high.\\n\\n2. Properties requiring renovation can offer significant value-add opportunities, with potential for 15-20% equity gains after improvements.\\n\\n3. The local council has approved new development zones which may present off-plan purchase opportunities with favorable terms.\\n\\n4. Houses with potential for extension or conversion to multiple units can maximize returns in areas with strict planning constraints.\\n\\n5. Consider the strong local university market for HMO investments, which typically yield 2-3% higher than standard rentals.\";\n  } else {\n    return \"The current property market shows mixed signals. While some areas continue to see price growth, others have stabilized. Factors influencing the market include interest rate changes, supply constraints, and evolving work patterns affecting location preferences. For specific investment advice, consider local economic indicators, infrastructure developments, and demographic trends particular to your target area.\";\n  }\n}\n\nfunction getMockPredictiveAnalytics(location: string): any {\n  return {\n    priceGrowthPrediction: {\n      year1: 3.2,\n      year2: 3.5,\n      year3: 4.1,\n      year4: 3.8,\n      year5: 3.9\n    },\n    rentalYieldTrend: {\n      year1: 5.3,\n      year2: 5.4,\n      year3: 5.5,\n      year4: 5.4,\n      year5: 5.3\n    },\n    marketSummary: `The property market in ${location} shows promising growth potential over the next 5 years, supported by infrastructure development and increasing demand. While some volatility is expected in years 2-3, the overall trajectory remains positive.`,\n    keyFactors: [\n      \"New transportation links improving connectivity\",\n      \"Growing tech sector bringing high-income professionals to the area\",\n      \"Limited new housing supply in development pipeline\",\n      \"Strong rental demand from young professionals\",\n      \"Government stimulus for first-time buyers\"\n    ]\n  };\n}\n\nfunction getMockHotspots(region: string): any {\n  return {\n    hotspots: [\n      {\n        area: `${region} - North District`,\n        growthPotential: 4.7,\n        reasons: [\n          \"New tech hub development creating employment\",\n          \"Improved transport links reducing commute times\",\n          \"Regeneration project transforming former industrial areas\"\n        ],\n        estimatedROI: 6.2,\n        investmentType: \"Buy-to-let apartments\"\n      },\n      {\n        area: `${region} - Riverside`,\n        growthPotential: 5.1,\n        reasons: [\n          \"Waterfront development project nearing completion\",\n          \"Limited supply of premium properties\",\n          \"Growing demand from young professionals\"\n        ],\n        estimatedROI: 5.8,\n        investmentType: \"Luxury apartments\"\n      },\n      {\n        area: `${region} - University Area`,\n        growthPotential: 3.9,\n        reasons: [\n          \"Consistent student housing demand\",\n          \"University expansion plans announced\",\n          \"Improving local amenities and nightlife\"\n        ],\n        estimatedROI: 7.3,\n        investmentType: \"HMO for students\"\n      },\n      {\n        area: `${region} - Central Village`,\n        growthPotential: 4.5,\n        reasons: [\n          \"Character properties with renovation potential\",\n          \"Growing tourism supporting short-term rentals\",\n          \"New boutique retail and restaurant scene\"\n        ],\n        estimatedROI: 6.5,\n        investmentType: \"Period conversions\"\n      }\n    ]\n  };\n}\n\n// React hook for using chat responses\nexport function useChat() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [response, setResponse] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  const sendMessage = async (message: string) => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const response = await getChatResponse(message);\n      setResponse(response);\n      return response;\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Unknown error occurred';\n      setError(errorMessage);\n      return null;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return {\n    sendMessage,\n    response,\n    isLoading,\n    error\n  };\n}\n\nexport const popularQuestions = [\n  \"Calculate stamp duty for a £400,000 property\",\n  \"What are typical legal fees for property purchase?\",\n  \"Explain all costs involved in buying a property\",\n  \"How much should I budget for property maintenance?\",\n  \"What surveys do I need when buying a property?\",\n  \"Calculate monthly mortgage payments for £300,000\",\n];\n\nexport const formatMessage = (response: any) => {\n  // Check if we got an error response\n  if (!response.success === false) {\n    return `<span class=\"block text-red-500\">${response.message}</span>`;\n  }\n\n  const text = typeof response === 'string' ? response : response.message;\n\n  // Replace **bold** with styled spans\n  let formattedText = text.replace(\n    /\\*\\*(.*?)\\*\\*/g,\n    '<span class=\"font-bold\">$1</span>'\n  );\n  \n  // Replace *italic* with styled spans\n  formattedText = formattedText.replace(\n    /\\*(.*?)\\*/g,\n    '<span class=\"italic\">$1</span>'\n  );\n  \n  // Replace bullet points\n  formattedText = formattedText.replace(\n    /^- (.+)$/gm,\n    '<span class=\"block ml-2\">• $1</span>'\n  );\n  \n  // Replace numbered lists\n  formattedText = formattedText.replace(\n    /^\\d+\\. (.+)$/gm,\n    '<span class=\"block ml-2\">$&</span>'\n  );\n\n  // Split by newlines and wrap in spans\n  return formattedText.split('\\n').map((line, i) => (\n    line ? `<span class=\"block\">${line}</span>` : '<span class=\"block h-2\"></span>'\n  )).join('');\n};\n\n","import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader } from \"./ui/card\";\nimport { Button } from \"./ui/button\";\nimport { ArrowRight, TrendingUp, Home, PoundSterling, RefreshCw } from \"lucide-react\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"./ui/tabs\";\nimport {\n  LineChart,\n  Line,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  AreaChart,\n  Area,\n} from \"recharts\";\nimport { getChatResponse, formatMessage, getPredictiveAnalytics, getInvestmentHotspots } from \"../lib/chat\";\nimport { formatCurrency } from \"../lib/utils\";\nimport { Badge } from \"./ui/badge\";\nimport HeroSection from \"./HeroSection\";\n\ninterface MarketTrendsProps {\n  trends?: Array<{\n    title: string;\n    value: string;\n    change: string;\n    isPositive: boolean;\n  }>;\n  articles?: Array<{\n    title: string;\n    excerpt: string;\n    date: string;\n  }>;\n  user?: any;\n  profile?: any;\n}\n\n// Add this type for the heatmap data\ninterface RegionData {\n  name: string;\n  priceGrowth: number;\n  averagePrice: number;\n  transactions: number;\n}\n\ninterface PredictiveData {\n  region: string;\n  currentValue: number;\n  predictedValue: number;\n  confidence: number;\n  growthFactors: string[];\n}\n\ninterface HotspotData {\n  area: string;\n  score: number;\n  factors: string[];\n  predictedGrowth: number;\n  investmentType: 'Residential' | 'Commercial' | 'Mixed';\n}\n\nconst MarketTrends = ({\n  trends = [\n    {\n      title: \"Average Home Price\",\n      value: \"£450,000\",\n      change: \"+5.2%\",\n      isPositive: true,\n    },\n    {\n      title: \"Days on Market\",\n      value: \"28\",\n      change: \"-12%\",\n      isPositive: true,\n    },\n    {\n      title: \"Available Listings\",\n      value: \"1,234\",\n      change: \"-3.1%\",\n      isPositive: false,\n    },\n  ],\n  articles = [\n    {\n      title: \"Understanding the Current Real Estate Market\",\n      excerpt:\n        \"Get insights into the latest trends and what they mean for buyers and sellers.\",\n      date: \"2024-03-15\",\n    },\n    {\n      title: \"Top 5 Investment Opportunities in Real Estate\",\n      excerpt:\n        \"Discover the most promising areas for property investment in the current market.\",\n      date: \"2024-03-10\",\n    },\n    {\n      title: \"Real Estate Market Forecast 2024\",\n      excerpt:\n        \"Expert predictions and analysis for the upcoming year in real estate.\",\n      date: \"2024-03-05\",\n    },\n  ],\n  user,\n  profile\n}: MarketTrendsProps) => {\n  // Sample data for charts\n  const priceData = [\n    { month: \"Jan\", price: 450000 },\n    { month: \"Feb\", price: 455000 },\n    { month: \"Mar\", price: 458000 },\n    { month: \"Apr\", price: 462000 },\n    { month: \"May\", price: 470000 },\n    { month: \"Jun\", price: 475000 },\n  ];\n\n  const regionalData = [\n    { region: \"London\", price: 500000, growth: 5.2 },\n    { region: \"Manchester\", price: 250000, growth: 7.8 },\n    { region: \"Birmingham\", price: 220000, growth: 6.5 },\n    { region: \"Leeds\", price: 200000, growth: 8.1 },\n    { region: \"Liverpool\", price: 180000, growth: 9.2 },\n  ];\n\n  // Add this data near your other sample data\n  const heatmapData: RegionData[] = [\n    { name: \"London\", priceGrowth: 5.2, averagePrice: 500000, transactions: 1200 },\n    { name: \"South East\", priceGrowth: 4.8, averagePrice: 375000, transactions: 950 },\n    { name: \"South West\", priceGrowth: 4.5, averagePrice: 310000, transactions: 780 },\n    { name: \"East of England\", priceGrowth: 4.2, averagePrice: 325000, transactions: 820 },\n    { name: \"West Midlands\", priceGrowth: 6.1, averagePrice: 240000, transactions: 680 },\n    { name: \"East Midlands\", priceGrowth: 5.8, averagePrice: 225000, transactions: 650 },\n    { name: \"Yorkshire\", priceGrowth: 7.2, averagePrice: 195000, transactions: 720 },\n    { name: \"North West\", priceGrowth: 8.1, averagePrice: 205000, transactions: 850 },\n    { name: \"North East\", priceGrowth: 6.5, averagePrice: 155000, transactions: 480 },\n    { name: \"Wales\", priceGrowth: 5.9, averagePrice: 185000, transactions: 520 },\n    { name: \"Scotland\", priceGrowth: 5.4, averagePrice: 175000, transactions: 680 },\n  ];\n\n  // Add this SVG map component\n  const UKMap = ({ data }: { data: RegionData[] }) => {\n    return (\n      <div className=\"relative w-full h-full flex items-center justify-center\">\n        <svg\n          viewBox=\"0 0 500 800\"\n          className=\"w-full h-full max-h-[400px]\"\n          style={{ maxWidth: '300px' }}\n        >\n          {/* Simple UK regions - basic shapes for visualization */}\n          {[\n            { path: \"M250,600 L300,550 L350,600 L300,650 Z\", name: \"London\" },\n            { path: \"M200,500 L300,450 L350,500 L250,550 Z\", name: \"South East\" },\n            { path: \"M150,450 L250,400 L300,450 L200,500 Z\", name: \"South West\" },\n            { path: \"M300,450 L400,400 L450,450 L350,500 Z\", name: \"East of England\" },\n            { path: \"M200,350 L300,300 L350,350 L250,400 Z\", name: \"West Midlands\" },\n            { path: \"M300,350 L400,300 L450,350 L350,400 Z\", name: \"East Midlands\" },\n            { path: \"M200,250 L300,200 L350,250 L250,300 Z\", name: \"Yorkshire\" },\n            { path: \"M150,200 L250,150 L300,200 L200,250 Z\", name: \"North West\" },\n            { path: \"M250,150 L350,100 L400,150 L300,200 Z\", name: \"North East\" },\n            { path: \"M100,350 L200,300 L250,350 L150,400 Z\", name: \"Wales\" },\n            { path: \"M150,100 L300,50 L350,100 L200,150 Z\", name: \"Scotland\" },\n          ].map((region) => {\n            const regionData = data.find(d => d.name === region.name);\n            const growth = regionData?.priceGrowth || 0;\n            return (\n              <g key={region.name}>\n                <path\n                  d={region.path}\n                  fill={`hsl(${120 * (growth / 10)}, 70%, 50%)`}\n                  stroke=\"white\"\n                  strokeWidth=\"2\"\n                  className=\"transition-colors duration-300 hover:brightness-110 cursor-pointer\"\n                />\n                <title>{`${region.name}: +${growth}%`}</title>\n              </g>\n            );\n          })}\n        </svg>\n      </div>\n    );\n  };\n\n  const [marketInsights, setMarketInsights] = useState<string>(\"\");\n  const [isLoadingInsights, setIsLoadingInsights] = useState(false);\n  const [refreshingInsights, setRefreshingInsights] = useState(false);\n\n  const fetchMarketInsights = async (location: string) => {\n    setIsLoadingInsights(true);\n    try {\n      const response = await getChatResponse(\n        `Provide a concise market insight for property investment in ${location} with recent price trends, rental yields, and future outlook. Keep it under 200 words.`\n      );\n      setMarketInsights(response);\n    } catch (error) {\n      console.error(\"Error fetching market insights:\", error);\n      setMarketInsights(\n        \"We're currently experiencing some issues retrieving market insights. Please try again later or contact support if the problem persists.\"\n      );\n    } finally {\n      setIsLoadingInsights(false);\n    }\n  };\n\n  const [predictiveData, setPredictiveData] = useState<PredictiveData[]>([]);\n  const [hotspots, setHotspots] = useState<HotspotData[]>([]);\n  const [isLoadingAnalytics, setIsLoadingAnalytics] = useState(false);\n  const [refreshingPredictions, setRefreshingPredictions] = useState(false);\n  const [refreshingHotspots, setRefreshingHotspots] = useState(false);\n  const [isLoadingHotspots, setIsLoadingHotspots] = useState(false);\n\n  const fetchPredictiveAnalytics = async (location: string) => {\n    setIsLoadingAnalytics(true);\n    try {\n      const data = await getPredictiveAnalytics(location);\n      \n      // Check if we got an array or transform the object into an array format\n      if (Array.isArray(data)) {\n        setPredictiveData(data);\n      } else if (data.regions && Array.isArray(data.regions)) {\n        // If the API returns data in a different format with regions array\n        setPredictiveData(data.regions);\n      } else {\n        // Transform the object into an array with a single entry for fallback\n        const transformedData = [\n          {\n            region: location || \"United Kingdom\",\n            currentValue: 350000,\n            predictedValue: 350000 * (1 + (data.priceGrowthPrediction?.year1 || 3.2) / 100),\n            confidence: 85,\n            growthFactors: data.keyFactors || [\"Data temporarily unavailable\"]\n          }\n        ];\n        setPredictiveData(transformedData);\n      }\n    } catch (error) {\n      console.error(\"Error fetching predictive analytics:\", error);\n      // Set fallback data structure as an array with one element\n      setPredictiveData([\n        {\n          region: location || \"United Kingdom\",\n          currentValue: 350000,\n          predictedValue: 361200, // 3.2% growth\n          confidence: 75,\n          growthFactors: [\n            \"Data temporarily unavailable\",\n            \"Please try again later\"\n          ]\n        }\n      ]);\n    } finally {\n      setIsLoadingAnalytics(false);\n    }\n  };\n\n  const fetchHotspots = async (region: string) => {\n    setIsLoadingHotspots(true);\n    try {\n      const data = await getInvestmentHotspots(region);\n      \n      // Check if we got hotspots array directly or it's nested in a property\n      if (Array.isArray(data)) {\n        // Ensure each hotspot has a factors array\n        const safeHotspots = data.map(hotspot => ({\n          ...hotspot,\n          factors: hotspot.factors || []\n        }));\n        setHotspots(safeHotspots);\n      } else if (data.hotspots && Array.isArray(data.hotspots)) {\n        // Ensure each hotspot has a factors array\n        const safeHotspots = data.hotspots.map(hotspot => ({\n          ...hotspot,\n          factors: hotspot.factors || []\n        }));\n        setHotspots(safeHotspots);\n      } else {\n        // Fallback with empty array if data is not in expected format\n        console.warn(\"Hotspots data is not in expected format:\", data);\n        setHotspots([]);\n      }\n    } catch (error) {\n      console.error(\"Error fetching hotspots:\", error);\n      // Use fallback data structure\n      setHotspots([\n        {\n          area: `${region} - North District`,\n          score: 75,\n          predictedGrowth: 4.2,\n          factors: [\n            \"Data currently unavailable\",\n            \"Try again later\"\n          ],\n          investmentType: \"Residential\"\n        },\n        {\n          area: `${region} - Central Area`,\n          score: 68,\n          predictedGrowth: 3.8,\n          factors: [\n            \"Data currently unavailable\",\n            \"Try again later\"\n          ],\n          investmentType: \"Commercial\"\n        }\n      ]);\n    } finally {\n      setIsLoadingHotspots(false);\n    }\n  };\n\n  const handleRefreshInsights = async () => {\n    setRefreshingInsights(true);\n    await fetchMarketInsights(\"United Kingdom\");\n    setRefreshingInsights(false);\n  };\n\n  const handleRefreshPredictions = async () => {\n    setRefreshingPredictions(true);\n    await fetchPredictiveAnalytics(\"United Kingdom\");\n    setRefreshingPredictions(false);\n  };\n\n  const handleRefreshHotspots = async () => {\n    setRefreshingHotspots(true);\n    await fetchHotspots(\"United Kingdom\");\n    setRefreshingHotspots(false);\n  };\n\n  const [bitcoinPrice, setBitcoinPrice] = useState<number | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [bitcoinLoading, setBitcoinLoading] = useState(true);\n\n  const fetchBitcoinPrice = async () => {\n    try {\n      setBitcoinLoading(true);\n      const response = await fetch(\n        'https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=gbp'\n      );\n      \n      if (!response.ok) {\n        throw new Error('Failed to fetch Bitcoin price');\n      }\n\n      const data = await response.json();\n      setBitcoinPrice(data.bitcoin.gbp);\n      setError(null);\n    } catch (err) {\n      console.error('Error fetching Bitcoin price:', err);\n      setError('Failed to load Bitcoin price');\n      setBitcoinPrice(null);\n    } finally {\n      setBitcoinLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    // Load initial data\n    fetchMarketInsights(\"United Kingdom\");\n    fetchPredictiveAnalytics(\"United Kingdom\");\n    fetchHotspots(\"United Kingdom\");\n    fetchBitcoinPrice();\n    \n    // Optional: setup refresh interval\n    const refreshInterval = setInterval(() => {\n      fetchBitcoinPrice();\n    }, 60000); // Refresh Bitcoin price every minute\n    \n    return () => clearInterval(refreshInterval);\n  }, []);\n\n  return (\n    <>\n      {/* Hero Section for Market Trends */}\n      <HeroSection\n        title=\"Property Market Trends & Insights\"\n        subtitle=\"Discover the latest market data, price forecasts, and investment hotspots to make informed property decisions\"\n        showSearch={false}\n        showStats={false}\n        height=\"h-[400px]\"\n      />\n      \n      <section className=\"w-full py-8 sm:py-16 bg-background relative overflow-hidden\">\n        <div className=\"container mx-auto px-4 mb-16\">\n          <Card className=\"bg-card border-border\">\n            <CardHeader>\n              <h2 className=\"text-2xl font-semibold\">\n                Real Estate Trends Visualization\n              </h2>\n            </CardHeader>\n            <CardContent>\n              <Tabs defaultValue=\"overview\" className=\"w-full\">\n                <TabsList className=\"w-full mb-8\">\n                  <div className=\"grid w-full grid-cols-1 sm:grid-cols-3 gap-2\">\n                    <TabsTrigger value=\"overview\" className=\"w-full\">\n                      Price Evolution\n                    </TabsTrigger>\n                    <TabsTrigger value=\"regional\" className=\"w-full\">\n                      Regional Comparison\n                    </TabsTrigger>\n                    <TabsTrigger value=\"heatmap\" className=\"w-full\">\n                      Growth Heatmap\n                    </TabsTrigger>\n                  </div>\n                </TabsList>\n\n                <TabsContent value=\"overview\" className=\"h-[400px]\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <AreaChart data={priceData}>\n                      <defs>\n                        <linearGradient\n                          id=\"colorPrice\"\n                          x1=\"0\"\n                          y1=\"0\"\n                          x2=\"0\"\n                          y2=\"1\"\n                        >\n                          <stop\n                            offset=\"5%\"\n                            stopColor=\"hsl(var(--primary))\"\n                            stopOpacity={0.2}\n                          />\n                          <stop\n                            offset=\"95%\"\n                            stopColor=\"hsl(var(--primary))\"\n                            stopOpacity={0}\n                          />\n                        </linearGradient>\n                      </defs>\n                      <CartesianGrid strokeDasharray=\"3 3\" />\n                      <XAxis dataKey=\"month\" />\n                      <YAxis />\n                      <Tooltip />\n                      <Area\n                        type=\"monotone\"\n                        dataKey=\"price\"\n                        stroke=\"hsl(var(--primary))\"\n                        fillOpacity={1}\n                        fill=\"url(#colorPrice)\"\n                      />\n                    </AreaChart>\n                  </ResponsiveContainer>\n                </TabsContent>\n\n                <TabsContent value=\"regional\" className=\"h-[400px]\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <LineChart data={regionalData}>\n                      <CartesianGrid strokeDasharray=\"3 3\" />\n                      <XAxis dataKey=\"region\" />\n                      <YAxis />\n                      <Tooltip />\n                      <Line\n                        type=\"monotone\"\n                        dataKey=\"price\"\n                        stroke=\"hsl(var(--primary))\"\n                      />\n                      <Line\n                        type=\"monotone\"\n                        dataKey=\"growth\"\n                        stroke=\"hsl(var(--chart-1))\"\n                      />\n                    </LineChart>\n                  </ResponsiveContainer>\n                </TabsContent>\n\n                <TabsContent\n                  value=\"heatmap\"\n                  className=\"h-[400px] overflow-y-auto\"\n                >\n                  <div className=\"h-full grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                    <div className=\"space-y-4 min-h-[300px]\">\n                      <h3 className=\"font-semibold text-lg sticky top-0 bg-background border-b py-2 px-2 rounded-t-lg\">\n                        Regional Price Growth\n                      </h3>\n                      <div className=\"space-y-2 overflow-y-auto px-2\">\n                        {heatmapData\n                          .sort((a, b) => b.priceGrowth - a.priceGrowth)\n                          .map((region) => (\n                            <div\n                              key={region.name}\n                              className=\"flex items-center justify-between p-2 rounded-lg hover:bg-muted/50 transition-colors\"\n                            >\n                              <div className=\"flex items-center gap-3\">\n                                <div\n                                  className=\"w-2 h-8 rounded-full\"\n                                  style={{\n                                    backgroundColor: `hsl(${\n                                      120 * (region.priceGrowth / 10)\n                                    }, 70%, 50%)`,\n                                  }}\n                                />\n                                <div>\n                                  <p className=\"font-medium\">{region.name}</p>\n                                  <p className=\"text-sm text-muted-foreground\">\n                                    £{region.averagePrice.toLocaleString()}\n                                  </p>\n                                </div>\n                              </div>\n                              <div className=\"text-right\">\n                                <p className=\"font-bold text-emerald-500\">\n                                  +{region.priceGrowth}%\n                                </p>\n                                <p className=\"text-sm text-muted-foreground\">\n                                  {region.transactions} sales\n                                </p>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    </div>\n                    <div className=\"relative hidden lg:flex items-center justify-center bg-muted/30 rounded-xl min-h-[300px]\">\n                      <UKMap data={heatmapData} />\n                    </div>\n                  </div>\n                </TabsContent>\n              </Tabs>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"container mx-auto px-4 mb-16\">\n          <Card className=\"bg-card border-border relative ai-border-animation\">\n            <CardHeader className=\"flex flex-row items-center justify-between\">\n              <h2 className=\"text-2xl font-semibold\">AI Market Analysis</h2>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={handleRefreshInsights}\n                className={`h-8 w-8 ${refreshingInsights ? 'animate-spin' : ''}`}\n                disabled={refreshingInsights || isLoadingInsights}\n              >\n                <RefreshCw className=\"h-4 w-4\" />\n              </Button>\n            </CardHeader>\n            <CardContent>\n              {isLoadingInsights ? (\n                <div className=\"flex items-center justify-center p-8\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n                </div>\n              ) : (\n                <div \n                  className=\"prose prose-sm max-w-none\"\n                  dangerouslySetInnerHTML={{ __html: formatMessage(marketInsights) }}\n                />\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"container mx-auto px-4 mb-16 grid gap-6 md:grid-cols-2\">\n          {/* Predictive Analytics Card */}\n          <Card className=\"bg-card border-border relative ai-border-animation\">\n            <CardHeader className=\"flex flex-row items-center justify-between\">\n              <h2 className=\"text-2xl font-semibold\">Predictive Market Analytics</h2>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={handleRefreshPredictions}\n                className={`h-8 w-8 ${refreshingPredictions ? 'animate-spin' : ''}`}\n                disabled={refreshingPredictions || isLoadingAnalytics}\n              >\n                <RefreshCw className=\"h-4 w-4\" />\n              </Button>\n            </CardHeader>\n            <CardContent>\n              {isLoadingAnalytics ? (\n                <div className=\"flex items-center justify-center p-8\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {predictiveData.map((prediction, index) => (\n                    <div key={index} className=\"p-4 rounded-lg bg-muted/50\">\n                      <div className=\"flex items-center justify-between mb-3\">\n                        <h3 className=\"font-semibold text-lg\">{prediction.region}</h3>\n                        <div className=\"text-sm font-medium text-emerald-500\">\n                          +{((prediction.predictedValue - prediction.currentValue) / prediction.currentValue * 100).toFixed(1)}%\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-2 mb-3\">\n                        <div className=\"flex-1\">\n                          <div className=\"w-full bg-background rounded-full h-2\">\n                            <div\n                              className=\"bg-emerald-500 h-2 rounded-full\"\n                              style={{ width: `${prediction.confidence}%` }}\n                            />\n                          </div>\n                          <p className=\"text-xs text-muted-foreground mt-1\">Confidence: {prediction.confidence}%</p>\n                        </div>\n                      </div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        {prediction.growthFactors && Array.isArray(prediction.growthFactors) && prediction.growthFactors.length > 0\n                          ? prediction.growthFactors[0]\n                          : \"No growth factors available\"}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Investment Hotspots Card */}\n          <Card className=\"bg-card border-border relative ai-border-animation\">\n            <CardHeader className=\"flex flex-row items-center justify-between\">\n              <h2 className=\"text-2xl font-semibold\">Emerging Investment Hotspots</h2>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={handleRefreshHotspots}\n                className={`h-8 w-8 ${refreshingHotspots ? 'animate-spin' : ''}`}\n                disabled={refreshingHotspots || isLoadingHotspots}\n              >\n                <RefreshCw className=\"h-4 w-4\" />\n              </Button>\n            </CardHeader>\n            <CardContent>\n              {isLoadingHotspots ? (\n                <div className=\"flex justify-center items-center py-8\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary\"></div>\n                </div>\n              ) : hotspots.length > 0 ? (\n                <div className=\"space-y-4\">\n                  {hotspots.map((hotspot, index) => (\n                    <div\n                      key={index}\n                      className=\"bg-card border rounded-lg p-4 hover:shadow-md transition-shadow\"\n                    >\n                      <div className=\"flex justify-between items-start\">\n                        <div>\n                          <h4 className=\"font-semibold text-lg mb-1\">\n                            {hotspot.area}\n                          </h4>\n                          <div className=\"flex items-center mb-2\">\n                            <span className=\"text-sm font-medium mr-2\">\n                              Investment Score:\n                            </span>\n                            <div className=\"h-2 w-24 bg-gray-200 rounded-full overflow-hidden\">\n                              <div\n                                className=\"h-full bg-primary\"\n                                style={{ width: `${hotspot.score}%` }}\n                              ></div>\n                            </div>\n                            <span className=\"ml-2 text-sm font-medium\">\n                              {hotspot.score}/100\n                            </span>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center space-x-2\">\n                          <Badge className=\"bg-primary/80\">\n                            +{hotspot.predictedGrowth}% Growth\n                          </Badge>\n                          <Badge variant=\"outline\">\n                            {hotspot.investmentType}\n                          </Badge>\n                        </div>\n                      </div>\n                      <div className=\"mt-3\">\n                        <span className=\"text-sm font-medium\">Why Invest:</span>\n                        <ul className=\"mt-1 space-y-1\">\n                          {hotspot.factors && Array.isArray(hotspot.factors) ? (\n                            hotspot.factors.map((factor, idx) => (\n                              <li key={idx} className=\"text-sm flex items-start\">\n                                <ArrowRight className=\"h-4 w-4 mr-1 mt-1 text-primary\" />\n                                {factor}\n                              </li>\n                            ))\n                          ) : (\n                            <li className=\"text-sm flex items-start\">\n                              <ArrowRight className=\"h-4 w-4 mr-1 mt-1 text-primary\" />\n                              Data unavailable\n                            </li>\n                          )}\n                        </ul>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  No investment hotspots data available\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"container mx-auto px-4 max-w-7xl\">\n          <div className=\"mb-12 text-center\">\n            <h2 className=\"text-3xl font-bold mb-4\">Market Trends & Insights</h2>\n            <p className=\"text-muted-foreground max-w-2xl mx-auto\">\n              Stay informed with the latest real estate market trends and expert\n              insights to make better property decisions.\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12\">\n            {trends.map((trend, index) => (\n              <Card\n                key={index}\n                className={`bg-card border-border hover:scale-[1.02] transition-all duration-300 ${index === 0 ? \"bg-gradient-to-r from-emerald-400/10 to-cyan-400/10\" : \"\"}`}\n              >\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <h3 className=\"text-sm font-medium text-foreground/80\">\n                      {trend.title}\n                    </h3>\n                    {index === 0 ? (\n                      <PoundSterling className=\"w-5 h-5 text-emerald-500\" />\n                    ) : index === 1 ? (\n                      <Home className=\"w-5 h-5 text-emerald-500\" />\n                    ) : (\n                      <TrendingUp className=\"w-5 h-5 text-emerald-500\" />\n                    )}\n                  </div>\n                  <div className=\"flex items-baseline justify-between\">\n                    <span className=\"text-2xl font-bold text-foreground\">\n                      {trend.value}\n                    </span>\n                    <span\n                      className={`flex items-center ${trend.isPositive ? \"text-emerald-500\" : \"text-red-500\"}`}\n                    >\n                      {trend.change}\n                    </span>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n\n          <div className=\"container mx-auto px-4 mb-16 grid gap-6 md:grid-cols-3\">\n            {articles.map((article, index) => (\n              <Card\n                key={index}\n                className=\"bg-card border-border hover:scale-[1.02] transition-all duration-300\"\n              >\n                <CardHeader>\n                  <div className=\"flex items-center justify-between\">\n                    <h2 className=\"text-xl font-semibold\">{article.title}</h2>\n                    <span className=\"text-sm text-muted-foreground\">\n                      {new Date(article.date).toLocaleDateString(\"en-US\", {\n                        month: \"long\",\n                        day: \"numeric\",\n                        year: \"numeric\",\n                      })}\n                    </span>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground mb-4\">{article.excerpt}</p>\n                  <Button\n                    variant=\"ghost\"\n                    className=\"group hover:text-emerald-500\"\n                    onClick={() => {\n                      window.location.href = `/article/${encodeURIComponent(article.title)}`;\n                    }}\n                  >\n                    Read More\n                    <ArrowRight className=\"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform\" />\n                  </Button>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n\n          <div className=\"w-full bg-muted/50 py-12\">\n            <div className=\"max-w-[1200px] mx-auto px-4 sm:px-8\">\n              <h2 className=\"text-2xl font-bold mb-6\">Market Trends</h2>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                <Card className=\"p-6\">\n                  <h3 className=\"text-lg font-semibold mb-2\">Bitcoin Price (GBP)</h3>\n                  {bitcoinLoading ? (\n                    <div className=\"animate-pulse h-8 bg-muted rounded\" />\n                  ) : error ? (\n                    <p className=\"text-red-500\">{error}</p>\n                  ) : bitcoinPrice ? (\n                    <p className=\"text-2xl font-bold\">{formatCurrency(bitcoinPrice)}</p>\n                  ) : (\n                    <p className=\"text-muted-foreground\">Price unavailable</p>\n                  )}\n                </Card>\n                {/* Add other market trend cards here */}\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n    </>\n  );\n};\n\nexport default MarketTrends;\n\n<style>\n{`\n  .ai-border-animation::before {\n    content: '';\n    position: absolute;\n    inset: -2px;\n    background: linear-gradient(90deg, #22c55e, #10b981, #059669, #22c55e);\n    background-size: 400% 400%;\n    z-index: -1;\n    border-radius: calc(var(--radius) + 4px);\n    animation: borderAnimation 3s ease infinite;\n  }\n\n  @keyframes borderAnimation {\n    0% {\n      background-position: 0% 50%;\n    }\n    50% {\n      background-position: 100% 50%;\n    }\n    100% {\n      background-position: 0% 50%;\n    }\n  }\n`}\n</style>\n","import { motion } from \"framer-motion\";\nimport React from \"react\";\n\ninterface PageTransitionProps {\n  children: React.ReactNode;\n}\n\nexport function PageTransition({ children }: PageTransitionProps) {\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      exit={{ opacity: 0, y: 20 }}\n      transition={{ duration: 0.3 }}\n    >\n      {children}\n    </motion.div>\n  );\n}\n","import React from \"react\";\nimport HeroSection from \"./HeroSection\";\nimport { useAuth } from \"../lib/auth\";\nimport MarketTrends from \"./MarketTrends\";\nimport { Layout } from \"./Layout\";\nimport { PageTransition } from \"./ui/page-transition\";\nimport { Card } from \"./ui/card\";\nimport { Button } from \"./ui/button\";\n\n// Auth context checker wrapper\nconst AuthContextChecker = ({ children }: { children: React.ReactNode }) => {\n  try {\n    // Try to access auth context but don't use the result\n    useAuth();\n    // If we get here, auth context is available\n    return <>{children}</>;\n  } catch (error) {\n    // If auth context is not available, show a fallback\n    return (\n      <Layout>\n        <div className=\"min-h-screen flex flex-col items-center justify-center p-4\">\n          <Card className=\"p-6 max-w-md w-full\">\n            <h2 className=\"text-xl font-bold mb-4 text-center\">Authentication Error</h2>\n            <p className=\"text-muted-foreground mb-6 text-center\">\n              Unable to load authentication. Please refresh the page or try again later.\n            </p>\n            <Button \n              className=\"w-full\" \n              onClick={() => window.location.reload()}\n            >\n              Refresh Page\n            </Button>\n          </Card>\n        </div>\n      </Layout>\n    );\n  }\n};\n\nconst MarketTrendsPage = () => {\n  return (\n    <AuthContextChecker>\n      <MarketTrendsContent />\n    </AuthContextChecker>\n  );\n};\n\n// Separate the main component content to ensure useAuth is only called when context is available\nconst MarketTrendsContent = () => {\n  const { user, profile } = useAuth();\n\n  return (\n    <Layout>\n      <PageTransition>\n        <div className=\"min-h-screen bg-background\">\n          <MarketTrends user={user} profile={profile} />\n        </div>\n      </PageTransition>\n    </Layout>\n  );\n};\n\nexport default MarketTrendsPage;\n","import React from \"react\";\nimport Header from \"./Header\";\nimport { useAuth } from \"../lib/auth\";\nimport { Card, CardContent } from \"./ui/card\";\nimport { Calendar, Clock } from \"lucide-react\";\n\ninterface ArticlePageProps {\n  title: string;\n  content: string;\n  date: string;\n  readTime?: string;\n}\n\nexport function ArticlePage({\n  title = \"Understanding the Current Real Estate Market\",\n  content = \"Default content\",\n  date = new Date().toISOString(),\n  readTime = \"5 min read\",\n}: ArticlePageProps) {\n  const { user, profile } = useAuth();\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Header isAuthenticated={!!user} userProfile={profile || undefined} />\n      <main className=\"container mx-auto px-4 py-8 pt-24\">\n        <div className=\"max-w-4xl mx-auto\">\n          <Card>\n            <CardContent className=\"p-8\">\n              <h1 className=\"text-3xl font-bold mb-4\">{title}</h1>\n\n              <div className=\"flex items-center gap-4 text-muted-foreground mb-8\">\n                <div className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-4 h-4\" />\n                  <span>{new Date(date).toLocaleDateString()}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Clock className=\"w-4 h-4\" />\n                  <span>{readTime}</span>\n                </div>\n              </div>\n\n              <div className=\"prose dark:prose-invert max-w-none\">\n                {content.split(\"\\n\\n\").map((paragraph, index) => (\n                  <p key={index} className=\"mb-4\">\n                    {paragraph}\n                  </p>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </main>\n    </div>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardFooter, CardHeader } from \"./ui/card\";\nimport { Badge } from \"./ui/badge\";\nimport { Button } from \"./ui/button\";\nimport { FileText, Download, Calendar, Tag } from \"lucide-react\";\nimport { formatDistance } from \"date-fns\";\n\ninterface ResearchReportsProps {\n  user?: any;\n  profile?: any;\n}\n\nconst ResearchReports: React.FC<ResearchReportsProps> = ({ user, profile }) => {\n  const [reports, setReports] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    // Simulated fetch of research reports\n    const fetchReports = async () => {\n      try {\n        setLoading(true);\n        // This would be an API call in a real app\n        setTimeout(() => {\n          setReports([\n            {\n              id: 1,\n              title: \"UK Property Market Outlook 2024\",\n              summary: \"Comprehensive analysis of the UK property market trends, investment opportunities, and forecasts for 2024.\",\n              date: \"2024-05-15\",\n              author: \"Property Analysis Team\",\n              category: \"Market Analysis\",\n              isPremium: true,\n              downloadUrl: \"#\",\n            },\n            {\n              id: 2,\n              title: \"Regional Investment Hotspots\",\n              summary: \"Detailed report on emerging regional investment opportunities across the UK, with focus on yields and growth potential.\",\n              date: \"2024-04-22\",\n              author: \"Investment Research Division\",\n              category: \"Investment\",\n              isPremium: true,\n              downloadUrl: \"#\",\n            },\n            {\n              id: 3,\n              title: \"First-Time Buyer Guide 2024\",\n              summary: \"Essential information and advice for first-time buyers navigating the property market in 2024.\",\n              date: \"2024-03-10\",\n              author: \"Homebuyer Advisory Team\",\n              category: \"Guides\",\n              isPremium: false,\n              downloadUrl: \"#\",\n            },\n          ]);\n          setLoading(false);\n        }, 1000);\n      } catch (error) {\n        console.error(\"Error fetching research reports:\", error);\n        setLoading(false);\n      }\n    };\n\n    fetchReports();\n  }, []);\n\n  const isSubscriber = profile?.subscription_tier !== \"free\";\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {loading ? (\n          Array(3)\n            .fill(0)\n            .map((_, index) => (\n              <Card key={index} className=\"overflow-hidden\">\n                <div className=\"p-6 space-y-4\">\n                  <div className=\"h-6 bg-muted rounded animate-pulse w-3/4\"></div>\n                  <div className=\"h-24 bg-muted rounded animate-pulse\"></div>\n                  <div className=\"h-4 bg-muted rounded animate-pulse w-1/2\"></div>\n                </div>\n              </Card>\n            ))\n        ) : reports.length > 0 ? (\n          reports.map((report) => (\n            <Card key={report.id} className=\"overflow-hidden flex flex-col\">\n              <CardHeader className=\"flex flex-row items-start justify-between\">\n                <div className=\"space-y-1\">\n                  <h3 className=\"text-lg font-semibold\">{report.title}</h3>\n                  <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                    <Calendar className=\"h-4 w-4\" />\n                    <span>\n                      {formatDistance(new Date(report.date), new Date(), {\n                        addSuffix: true,\n                      })}\n                    </span>\n                  </div>\n                </div>\n                {report.isPremium && (\n                  <Badge\n                    variant=\"outline\"\n                    className=\"bg-primary/10 text-primary border-primary/20\"\n                  >\n                    Premium\n                  </Badge>\n                )}\n              </CardHeader>\n              <CardContent className=\"flex-grow\">\n                <p className=\"text-sm text-muted-foreground line-clamp-3\">\n                  {report.summary}\n                </p>\n                <div className=\"flex items-center gap-2 mt-4\">\n                  <Tag className=\"h-4 w-4 text-muted-foreground\" />\n                  <span className=\"text-xs font-medium text-muted-foreground\">\n                    {report.category}\n                  </span>\n                </div>\n              </CardContent>\n              <CardFooter className=\"border-t pt-4\">\n                {report.isPremium && !isSubscriber ? (\n                  <Button\n                    variant=\"outline\"\n                    className=\"w-full\"\n                    onClick={() => window.location.href = \"/pricing\"}\n                  >\n                    <FileText className=\"h-4 w-4 mr-2\" />\n                    Upgrade to Access\n                  </Button>\n                ) : (\n                  <Button className=\"w-full\" asChild>\n                    <a href={report.downloadUrl} download>\n                      <Download className=\"h-4 w-4 mr-2\" />\n                      Download Report\n                    </a>\n                  </Button>\n                )}\n              </CardFooter>\n            </Card>\n          ))\n        ) : (\n          <div className=\"col-span-full text-center py-12\">\n            <FileText className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-medium mb-2\">No reports available</h3>\n            <p className=\"text-muted-foreground\">\n              There are currently no research reports available.\n            </p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default ResearchReports;\n","import { supabase } from \"./supabaseClient\";\n\nexport interface Deal {\n  id: string;\n  title: string;\n  description: string;\n  location: string;\n  price: number;\n  roi_percentage: number;\n  investment_term: string;\n  property_type: string;\n  deal_type: string;\n  image_url: string;\n  created_at: string;\n  updated_at: string;\n}\n\nexport const getDeals = async (page = 1, limit = 6) => {\n  try {\n    const start = (page - 1) * limit;\n    \n    console.log('Fetching deals with params:', { page, limit, start });\n    \n    const { data, error } = await supabase\n      .from('deals')\n      .select(`\n        id,\n        title,\n        description,\n        location,\n        price,\n        roi_percentage,\n        investment_term,\n        property_type,\n        deal_type,\n        image_url,\n        created_at,\n        updated_at\n      `)\n      .range(start, start + limit - 1)\n      .order('created_at', { ascending: false });\n\n    console.log('Raw Supabase response:', { data, error });\n\n    if (error) {\n      console.error('Supabase query error:', error.message, error);\n      throw new Error(`Failed to fetch deals: ${error.message}`);\n    }\n\n    if (!data || data.length === 0) {\n      console.log('No deals found in database');\n      return [];\n    }\n\n    // Transform the data to match our Deal interface\n    const transformedData = data.map(deal => ({\n      id: deal.id,\n      title: deal.title,\n      description: deal.description,\n      location: deal.location,\n      price: Number(deal.price),\n      roi_percentage: Number(deal.roi_percentage),\n      investment_term: deal.investment_term,\n      property_type: deal.property_type,\n      deal_type: deal.deal_type,\n      image_url: deal.image_url,\n      created_at: deal.created_at,\n      updated_at: deal.updated_at\n    }));\n\n    console.log('Transformed deals:', transformedData);\n    return transformedData;\n  } catch (error) {\n    console.error('Error in getDeals:', error instanceof Error ? error.message : error);\n    throw error;\n  }\n};\n\nexport const searchDeals = async (searchTerm: string): Promise<Deal[]> => {\n  console.log('Searching deals with term:', searchTerm);\n  const term = searchTerm.toLowerCase().trim();\n\n  const { data, error } = await supabase\n    .from('deals')\n    .select(`\n      id,\n      title,\n      description,\n      location,\n      price,\n      roi_percentage,\n      investment_term,\n      property_type,\n      deal_type,\n      image_url,\n      created_at,\n      updated_at\n    `)\n    .or(\n      `title.ilike.%${term}%,` +\n      `description.ilike.%${term}%,` +\n      `location.ilike.%${term}%,` +\n      `property_type.ilike.%${term}%,` +\n      `deal_type.ilike.%${term}%`\n    )\n    .order('created_at', { ascending: false });\n\n    console.log('Search response:', { data, error });\n\n    if (error) {\n      console.error('Error searching deals:', error);\n      return [];\n    }\n\n    return data.map(deal => ({\n      id: deal.id,\n      title: deal.title,\n      description: deal.description,\n      location: deal.location,\n      price: Number(deal.price),\n      roi_percentage: Number(deal.roi_percentage),\n      investment_term: deal.investment_term,\n      property_type: deal.property_type,\n      deal_type: deal.deal_type,\n      image_url: deal.image_url,\n      created_at: deal.created_at,\n      updated_at: deal.updated_at\n    }));\n};\n\nexport const getDeal = async (id: string): Promise<Deal | null> => {\n  try {\n    // First verify the user is authenticated\n    const { data: { user } } = await supabase.auth.getUser();\n    if (!user) {\n      throw new Error('Not authenticated');\n    }\n\n    console.log('Fetching deal:', id);\n\n    const { data: deal, error } = await supabase\n      .from('deals')\n      .select(`\n        *,\n        author:profiles!deals_created_by_fkey(full_name)\n      `)\n      .eq('id', id)\n      .single();\n\n    console.log('Deal fetch result:', { deal, error });\n\n    if (error) {\n      console.error('Error fetching deal:', error);\n      return null;\n    }\n\n    if (!deal) return null;\n\n    // Transform the data\n    return {\n      ...deal,\n      images: Array.isArray(deal.images) ? deal.images : [deal.images].filter(Boolean),\n      location: typeof deal.location === 'string' ? JSON.parse(deal.location) : (deal.location || {}),\n      key_features: Array.isArray(deal.key_features) ? deal.key_features : [],\n      sensitive_info: deal.sensitive_info\n    };\n  } catch (error) {\n    console.error('Error fetching deal:', error);\n    return null;\n  }\n}; ","import { cn } from \"../../lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport function PropertyCardSkeleton() {\n  return (\n    <div className=\"overflow-hidden rounded-lg border bg-card\">\n      <Skeleton className=\"aspect-video w-full\" />\n      <div className=\"p-6 space-y-4\">\n        <Skeleton className=\"h-6 w-3/4\" />\n        <Skeleton className=\"h-4 w-1/2\" />\n        <div className=\"space-y-2\">\n          <Skeleton className=\"h-4 w-full\" />\n          <Skeleton className=\"h-4 w-5/6\" />\n        </div>\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div>\n            <Skeleton className=\"h-4 w-20 mb-1\" />\n            <Skeleton className=\"h-6 w-24\" />\n          </div>\n          <div>\n            <Skeleton className=\"h-4 w-20 mb-1\" />\n            <Skeleton className=\"h-6 w-24\" />\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport { Skeleton }\n","import React, { useState } from \"react\";\nimport { Deal } from \"../lib/deals\";\nimport { formatCurrency } from \"../lib/utils\";\nimport { Card, CardContent, CardHeader } from \"./ui/card\";\nimport { Badge } from \"./ui/badge\";\nimport { MapPin, MessageCircle } from \"lucide-react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Button } from \"./ui/button\";\nimport { MessagesModal } from \"./MessagesModal\";\nimport { PropertyCardSkeleton } from \"./ui/skeleton\";\n\ninterface DealCardProps {\n  deal: Deal;\n  isSubscriber: boolean;\n  onClick?: () => void;\n  isLoading?: boolean;\n  user?: any;\n  showMessageButton?: boolean;\n}\n\nexport function DealCard({ \n  deal, \n  isSubscriber, \n  onClick, \n  isLoading,\n  user,\n  showMessageButton = true\n}: DealCardProps) {\n  const navigate = useNavigate();\n  const [isMessageModalOpen, setIsMessageModalOpen] = useState(false);\n  \n  if (isLoading) {\n    return <PropertyCardSkeleton />;\n  }\n\n  const handleMessageClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (!user) {\n      navigate('/login');\n      return;\n    }\n    setIsMessageModalOpen(true);\n  };\n\n  return (\n    <>\n      <Card \n        className=\"overflow-hidden hover:shadow-lg transition-shadow cursor-pointer\"\n        onClick={user ? onClick : () => navigate('/login')}\n      >\n        <div className=\"relative aspect-video overflow-hidden bg-muted\">\n          <img\n            src={deal.image_url}\n            alt={deal.title}\n            className=\"object-cover w-full h-full\"\n            loading=\"lazy\"\n          />\n          {!user && (\n            <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center\">\n              <Badge variant=\"secondary\">Sign in to View</Badge>\n            </div>\n          )}\n          <div className=\"absolute top-2 right-2 flex gap-2\">\n            <Badge variant=\"secondary\" className=\"bg-white/90 text-black hover:bg-white/75\">\n              {deal.property_type}\n            </Badge>\n            <Badge variant=\"secondary\" className=\"bg-primary/90 text-white hover:bg-primary/75\">\n              {deal.deal_type}\n            </Badge>\n          </div>\n        </div>\n\n        <CardHeader>\n          <div>\n            <h3 className=\"text-lg font-semibold line-clamp-2 mb-2\">{deal.title}</h3>\n            <div className=\"flex items-center gap-1 text-sm text-muted-foreground\">\n              <MapPin className=\"h-4 w-4\" />\n              <span className=\"line-clamp-1\">{deal.location}</span>\n            </div>\n          </div>\n        </CardHeader>\n\n        <CardContent>\n          <div className=\"space-y-4\">\n            <p className=\"text-sm text-muted-foreground line-clamp-2\">\n              {deal.description}\n            </p>\n            \n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-1\">\n                <p className=\"text-sm text-muted-foreground\">Price</p>\n                <p className=\"text-lg font-semibold\">{formatCurrency(deal.price)}</p>\n              </div>\n              <div className=\"space-y-1\">\n                <p className=\"text-sm text-muted-foreground\">ROI</p>\n                <p className=\"text-lg font-semibold text-emerald-500\">\n                  {deal.roi_percentage}%\n                </p>\n              </div>\n            </div>\n            \n            <div className=\"pt-2 border-t\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-1\">\n                  <p className=\"text-sm text-muted-foreground\">Investment Term</p>\n                  <p className=\"font-medium\">{deal.investment_term}</p>\n                </div>\n                <div className=\"space-y-1\">\n                  <p className=\"text-sm text-muted-foreground\">Expected Returns</p>\n                  <p className=\"font-medium text-emerald-500\">High Yield</p>\n                </div>\n              </div>\n            </div>\n\n            {user && showMessageButton && (\n              <Button\n                variant=\"outline\"\n                className=\"w-full\"\n                onClick={handleMessageClick}\n              >\n                <MessageCircle className=\"w-4 h-4 mr-2\" />\n                Enquire About This Deal\n              </Button>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {user && (\n        <MessagesModal\n          isOpen={isMessageModalOpen}\n          onClose={() => setIsMessageModalOpen(false)}\n          receiverId=\"admin\"\n          dealId={deal.id}\n          deal={deal}\n        />\n      )}\n    </>\n  );\n} ","\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","import React, { useState } from \"react\";\nimport { Card, CardContent, CardFooter, CardHeader } from \"./ui/card\";\nimport { Button } from \"./ui/button\";\nimport { Textarea } from \"./ui/textarea\";\nimport { Label } from \"./ui/label\";\nimport { Input } from \"./ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"./ui/select\";\nimport { FileQuestion, Check, Clock, AlertTriangle } from \"lucide-react\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"./ui/tabs\";\n\ninterface ResearchRequestsProps {\n  user?: any;\n  profile?: any;\n}\n\nconst ResearchRequests: React.FC<ResearchRequestsProps> = ({ user, profile }) => {\n  const [requestType, setRequestType] = useState<string>(\"property\");\n  const [requestDetails, setRequestDetails] = useState<string>(\"\");\n  const [requestPriority, setRequestPriority] = useState<string>(\"standard\");\n  const [isSubmitting, setIsSubmitting] = useState<boolean>(false);\n  const [submittedRequests, setSubmittedRequests] = useState<any[]>([\n    {\n      id: 1,\n      type: \"Market Analysis\",\n      details: \"Detailed analysis of the Leeds property market, focusing on rental yields and capital growth potential in different neighborhoods.\",\n      priority: \"high\",\n      status: \"in-progress\",\n      submittedAt: \"2024-05-01T10:30:00Z\",\n      estimatedCompletion: \"2024-05-08T10:30:00Z\"\n    },\n    {\n      id: 2,\n      type: \"Property\",\n      details: \"Research on the historical price trends and planning permissions for 123 High Street, Manchester, M1 1AA.\",\n      priority: \"standard\",\n      status: \"completed\",\n      submittedAt: \"2024-04-15T14:45:00Z\",\n      completedAt: \"2024-04-20T09:15:00Z\"\n    }\n  ]);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsSubmitting(true);\n    \n    // Simulate API call\n    setTimeout(() => {\n      const newRequest = {\n        id: submittedRequests.length + 1,\n        type: requestType === \"property\" ? \"Property\" : \"Market Analysis\",\n        details: requestDetails,\n        priority: requestPriority,\n        status: \"pending\",\n        submittedAt: new Date().toISOString(),\n        estimatedCompletion: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString()\n      };\n      \n      setSubmittedRequests([newRequest, ...submittedRequests]);\n      setRequestDetails(\"\");\n      setIsSubmitting(false);\n    }, 1500);\n  };\n\n  const isSubscriber = profile?.subscription_tier !== \"free\";\n  const canSubmitHighPriority = isSubscriber;\n  const requestsRemaining = isSubscriber ? \"Unlimited\" : \"2 / 3\";\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case \"completed\":\n        return <Check className=\"h-5 w-5 text-green-500\" />;\n      case \"in-progress\":\n        return <Clock className=\"h-5 w-5 text-blue-500\" />;\n      case \"pending\":\n        return <Clock className=\"h-5 w-5 text-amber-500\" />;\n      default:\n        return <AlertTriangle className=\"h-5 w-5 text-red-500\" />;\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString(\"en-GB\", {\n      day: \"numeric\",\n      month: \"short\",\n      year: \"numeric\"\n    });\n  };\n\n  return (\n    <div>\n      <Card className=\"mb-8\">\n        <CardHeader>\n          <h3 className=\"text-lg font-semibold\">Request Custom Research</h3>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit}>\n            <div className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"request-type\">Request Type</Label>\n                <Select \n                  value={requestType} \n                  onValueChange={setRequestType}\n                >\n                  <SelectTrigger id=\"request-type\">\n                    <SelectValue placeholder=\"Select request type\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"property\">Property Research</SelectItem>\n                    <SelectItem value=\"market\">Market Analysis</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              \n              <div>\n                <Label htmlFor=\"request-details\">Details</Label>\n                <Textarea\n                  id=\"request-details\"\n                  placeholder=\"Please provide specific details about what you'd like us to research...\"\n                  rows={5}\n                  value={requestDetails}\n                  onChange={(e) => setRequestDetails(e.target.value)}\n                />\n              </div>\n              \n              <div>\n                <Label htmlFor=\"request-priority\">Priority</Label>\n                <Select \n                  value={requestPriority} \n                  onValueChange={setRequestPriority}\n                  disabled={!canSubmitHighPriority && requestPriority === \"high\"}\n                >\n                  <SelectTrigger id=\"request-priority\">\n                    <SelectValue placeholder=\"Select priority\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"standard\">Standard (7 days)</SelectItem>\n                    <SelectItem value=\"high\" disabled={!canSubmitHighPriority}>\n                      High Priority (3 days)\n                      {!canSubmitHighPriority && \" - Premium Feature\"}\n                    </SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          </form>\n        </CardContent>\n        <CardFooter className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between border-t pt-4\">\n          <div className=\"text-sm text-muted-foreground mb-4 sm:mb-0\">\n            Requests remaining this month: <span className=\"font-medium\">{requestsRemaining}</span>\n          </div>\n          <Button \n            type=\"submit\" \n            onClick={handleSubmit} \n            disabled={!requestDetails.trim() || isSubmitting}\n          >\n            {isSubmitting ? \"Submitting...\" : \"Submit Request\"}\n          </Button>\n        </CardFooter>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <h3 className=\"text-lg font-semibold\">Your Research Requests</h3>\n        </CardHeader>\n        <CardContent>\n          {submittedRequests.length > 0 ? (\n            <div className=\"space-y-4\">\n              {submittedRequests.map((request) => (\n                <div key={request.id} className=\"p-4 border rounded-md\">\n                  <div className=\"flex justify-between items-start\">\n                    <div>\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <FileQuestion className=\"h-4 w-4\" />\n                        <h4 className=\"font-medium\">{request.type} Request</h4>\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mb-3\">{request.details}</p>\n                      <div className=\"text-xs text-muted-foreground\">\n                        Submitted: {formatDate(request.submittedAt)}\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      {getStatusIcon(request.status)}\n                      <span className=\"text-sm font-medium capitalize\">\n                        {request.status.replace(\"-\", \" \")}\n                      </span>\n                    </div>\n                  </div>\n                  \n                  {request.status === 'in-progress' && (\n                    <div className=\"mt-4 pt-4 border-t text-xs text-muted-foreground\">\n                      Estimated completion: {formatDate(request.estimatedCompletion)}\n                    </div>\n                  )}\n                  \n                  {request.status === 'completed' && (\n                    <div className=\"mt-4 pt-4 border-t\">\n                      <Button variant=\"outline\" size=\"sm\" className=\"w-full sm:w-auto\">\n                        <Download className=\"h-4 w-4 mr-2\" />\n                        Download Report\n                      </Button>\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-8\">\n              <FileQuestion className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-medium mb-2\">No requests yet</h3>\n              <p className=\"text-muted-foreground\">\n                You haven't submitted any research requests yet.\n              </p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default ResearchRequests; ","import React, { useEffect, useState } from \"react\";\nimport HeroSection from \"./HeroSection\";\nimport { useAuth } from \"../lib/auth\";\nimport ResearchReports from \"./ResearchReports\";\nimport { PageTransition } from \"./ui/page-transition\";\nimport { Button } from \"./ui/button\";\nimport { SubscriptionModal } from \"./SubscriptionModal\";\nimport { getDeals } from '../lib/deals';\nimport { DealCard } from './DealCard';\nimport { useNavigate } from 'react-router-dom';\nimport type { Deal } from '../lib/deals';\nimport { Layout } from \"./Layout\";\nimport { Card, CardContent } from \"./ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"./ui/tabs\";\nimport ResearchRequests from \"./ResearchRequests\";\n\n// Auth context checker wrapper\nconst AuthContextChecker = ({ children }: { children: React.ReactNode }) => {\n  try {\n    // Try to access auth context but don't use the result\n    useAuth();\n    // If we get here, auth context is available\n    return <>{children}</>;\n  } catch (error) {\n    // If auth context is not available, show a fallback\n    return (\n      <Layout>\n        <div className=\"min-h-screen flex flex-col items-center justify-center p-4\">\n          <Card className=\"p-6 max-w-md w-full\">\n            <h2 className=\"text-xl font-bold mb-4 text-center\">Authentication Error</h2>\n            <p className=\"text-muted-foreground mb-6 text-center\">\n              Unable to load authentication. Please refresh the page or try again later.\n            </p>\n            <Button \n              className=\"w-full\" \n              onClick={() => window.location.reload()}\n            >\n              Refresh Page\n            </Button>\n          </Card>\n        </div>\n      </Layout>\n    );\n  }\n};\n\nconst ResearchPage: React.FC = () => {\n  return (\n    <AuthContextChecker>\n      <ResearchPageContent />\n    </AuthContextChecker>\n  );\n};\n\n// Separate the main component content to ensure useAuth is only called when context is available\nconst ResearchPageContent: React.FC = () => {\n  const { user, profile, isLoading } = useAuth();\n  const navigate = useNavigate();\n  const [deals, setDeals] = useState<Deal[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [isSubscriptionModalOpen, setIsSubscriptionModalOpen] =\n    React.useState(false);\n  const [activeTab, setActiveTab] = React.useState(\"reports\");\n\n  // Remove the subscription check for now\n  const isPro = true; // Temporarily allow access to all users\n\n  useEffect(() => {\n    let mounted = true;\n\n    async function loadDeals() {\n      try {\n        const dealsData = await getDeals();\n        if (mounted) {\n          setDeals(dealsData);\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('Error loading deals:', error);\n        if (mounted) {\n          setLoading(false);\n        }\n      }\n    }\n\n    // Only load deals if we have a user and they're not in a loading state\n    if (user && !isLoading) {\n      loadDeals();\n    } else if (!isLoading && !user) {\n      navigate('/login');\n    }\n\n    return () => {\n      mounted = false;\n    };\n  }, [user, isLoading, navigate]);\n\n  // Show loading state while checking auth\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div>Loading...</div>\n      </div>\n    );\n  }\n\n  // If no user, don't render anything (navigation will handle redirect)\n  if (!user) {\n    return null;\n  }\n\n  return (\n    <Layout>\n      <PageTransition>\n        <div className=\"min-h-screen bg-neutral\">\n          <HeroSection\n            title=\"Research & Analysis\"\n            subtitle=\"Discover in-depth market insights and property analysis\"\n            showSearch={false}\n            showStats={false}\n            height=\"h-[400px]\"\n            image=\"/research-hero.jpg\"\n          />\n          <main className=\"container mx-auto px-4 py-8\">\n            <div className=\"max-w-7xl mx-auto space-y-8\">\n              <div className=\"text-center mb-12\">\n                <h1 className=\"text-4xl font-bold mb-4 text-primary\">Latest Research</h1>\n                <p className=\"text-muted-foreground max-w-2xl mx-auto\">\n                  Stay informed with our comprehensive research reports and expert\n                  analysis\n                </p>\n              </div>\n              {isPro ? (\n                <Tabs\n                  defaultValue=\"reports\"\n                  value={activeTab}\n                  onValueChange={setActiveTab}\n                  className=\"mb-8\"\n                >\n                  <TabsList className=\"mb-4\">\n                    <TabsTrigger value=\"reports\">Research Reports</TabsTrigger>\n                    <TabsTrigger value=\"requests\">Research Requests</TabsTrigger>\n                  </TabsList>\n\n                  <TabsContent value=\"reports\">\n                    <ResearchReports user={user} profile={profile} />\n                  </TabsContent>\n\n                  <TabsContent value=\"requests\">\n                    <ResearchRequests user={user} profile={profile} />\n                  </TabsContent>\n                </Tabs>\n              ) : (\n                <div className=\"text-center py-12\">\n                  <h2 className=\"text-2xl font-semibold mb-4 text-accent\">\n                    Pro Plan Required\n                  </h2>\n                  <p className=\"text-muted-foreground mb-6\">\n                    Access to research reports is available exclusively to Pro and\n                    Premium subscribers.\n                  </p>\n                  <Button onClick={() => setIsSubscriptionModalOpen(true)} className=\"bg-primary text-white\">\n                    Upgrade to Pro\n                  </Button>\n                </div>\n              )}\n            </div>\n\n            {loading ? (\n              <div className=\"text-center py-8\">Loading deals...</div>\n            ) : (\n              <div className=\"mt-12\">\n                <h2 className=\"text-2xl font-bold mb-6\">Latest Deals</h2>\n                <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n                  {deals.map((deal) => (\n                    <DealCard \n                      key={deal.id} \n                      deal={deal}\n                      isSubscriber={profile?.subscription_tier !== 'free'}\n                    />\n                  ))}\n                </div>\n              </div>\n            )}\n          </main>\n\n          <SubscriptionModal\n            isOpen={isSubscriptionModalOpen}\n            onClose={() => setIsSubscriptionModalOpen(false)}\n          />\n        </div>\n      </PageTransition>\n    </Layout>\n  );\n};\n\nexport default ResearchPage;\n","import React from \"react\";\nimport { Layout } from \"./Layout\";\nimport HeroSection from \"./HeroSection\";\nimport { useAuth } from \"../lib/auth\";\nimport { Card, CardContent, CardHeader } from \"./ui/card\";\nimport { Button } from \"./ui/button\";\nimport { ArrowRight, Calendar, Clock, Tag } from \"lucide-react\";\nimport { PageTransition } from \"./ui/page-transition\";\n\nexport default function BlogPage() {\n  const { user: _, profile: __ } = useAuth();\n\n  const blogPosts = [\n    {\n      title: \"Understanding Property Market Cycles\",\n      excerpt:\n        \"A comprehensive guide to property market cycles and how to identify market phases for optimal investment timing.\",\n      category: \"Market Analysis\",\n      date: \"2024-03-20\",\n      readTime: \"8 min read\",\n      image:\n        \"https://images.unsplash.com/photo-1460472178825-e5240623afd5?ixlib=rb-4.0.3\",\n    },\n    {\n      title: \"Buy-to-Let Investment Strategy Guide\",\n      excerpt:\n        \"Expert insights into creating a successful buy-to-let investment strategy in today's market conditions.\",\n      category: \"Investment\",\n      date: \"2024-03-18\",\n      readTime: \"10 min read\",\n      image:\n        \"https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3\",\n    },\n    {\n      title: \"Property Tax Changes in 2024\",\n      excerpt:\n        \"Stay updated with the latest property tax regulations and how they affect property investors and homeowners.\",\n      category: \"Legal\",\n      date: \"2024-03-15\",\n      readTime: \"6 min read\",\n      image:\n        \"https://images.unsplash.com/photo-1554224155-8d04cb21cd6c?ixlib=rb-4.0.3\",\n    },\n  ];\n\n  return (\n    <PageTransition>\n      <Layout>\n        <HeroSection\n          title=\"Property Investment Blog\"\n          subtitle=\"Expert insights and analysis on the UK property market\"\n          backgroundImage=\"https://images.unsplash.com/photo-1542744173-8e7e53415bb0?ixlib=rb-4.0.3\"\n          showSearch={false}\n          showStats={false}\n          height=\"h-[400px]\"\n        />\n        <main className=\"container mx-auto px-4 py-8 pt-24 sm:pt-8\">\n          <div className=\"max-w-7xl mx-auto space-y-8\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {blogPosts.map((post, index) => (\n                <Card\n                  key={index}\n                  className=\"flex flex-col h-full hover:shadow-lg transition-shadow\"\n                >\n                  <div className=\"relative h-48 w-full overflow-hidden rounded-t-lg\">\n                    <img\n                      src={post.image}\n                      alt={post.title}\n                      className=\"w-full h-full object-cover\"\n                    />\n                  </div>\n                  <CardHeader className=\"flex flex-row items-center gap-2\">\n                    <Tag className=\"w-4 h-4\" />\n                    <span className=\"text-sm text-muted-foreground\">\n                      {post.category}\n                    </span>\n                  </CardHeader>\n                  <CardContent className=\"flex-1 flex flex-col\">\n                    <h3 className=\"text-xl font-semibold mb-2\">{post.title}</h3>\n                    <p className=\"text-muted-foreground mb-4 flex-1\">\n                      {post.excerpt}\n                    </p>\n                    <div className=\"flex items-center justify-between mt-4\">\n                      <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\n                        <div className=\"flex items-center gap-1\">\n                          <Calendar className=\"w-4 h-4\" />\n                          <span>\n                            {new Date(post.date).toLocaleDateString()}\n                          </span>\n                        </div>\n                        <div className=\"flex items-center gap-1\">\n                          <Clock className=\"w-4 h-4\" />\n                          <span>{post.readTime}</span>\n                        </div>\n                      </div>\n                      <Button\n                        variant=\"ghost\"\n                        className=\"group hover:text-primary\"\n                        onClick={() => {\n                          window.location.href = `/blog/${post.title.toLowerCase().replace(/ /g, \"-\")}`;\n                        }}\n                      >\n                        Read More\n                        <ArrowRight className=\"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform\" />\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </div>\n        </main>\n      </Layout>\n    </PageTransition>\n  );\n}\n","import React from \"react\";\nimport { Card, CardContent, CardHeader } from \"./ui/card\";\nimport { Button } from \"./ui/button\";\nimport { Input } from \"./ui/input\";\nimport { Label } from \"./ui/label\";\nimport { Textarea } from \"./ui/textarea\";\nimport {\n  Mail,\n  Phone,\n  MessageCircle,\n  FileText,\n  HelpCircle,\n  Book,\n} from \"lucide-react\";\nimport { Layout } from \"./Layout\";\nimport HeroSection from \"./HeroSection\";\nimport { PageTransition } from \"./ui/page-transition\";\n\nexport default function HelpSupportPage() {\n  const supportCategories = [\n    {\n      title: \"Getting Started\",\n      icon: <Book className=\"w-5 h-5\" />,\n      description: \"Learn the basics of using our platform\",\n      content: [\n        \"How to search for properties\",\n        \"Understanding market insights\",\n        \"Setting up your account\",\n        \"Subscription plans overview\",\n      ],\n    },\n    {\n      title: \"Account & Billing\",\n      icon: <FileText className=\"w-5 h-5\" />,\n      description: \"Manage your account and subscription\",\n      content: [\n        \"Updating account details\",\n        \"Subscription management\",\n        \"Billing history\",\n        \"Payment methods\",\n      ],\n    },\n    {\n      title: \"Technical Support\",\n      icon: <HelpCircle className=\"w-5 h-5\" />,\n      description: \"Get help with technical issues\",\n      content: [\n        \"Troubleshooting guide\",\n        \"System requirements\",\n        \"Known issues\",\n        \"Browser compatibility\",\n      ],\n    },\n  ];\n\n  const contactMethods = [\n    {\n      icon: <Mail className=\"w-5 h-5\" />,\n      title: \"Email Support\",\n      description: \"Get help via email\",\n      action: \"support@myvge.co.uk\",\n      buttonText: \"Send Email\",\n      onClick: () => (window.location.href = \"mailto:support@myvge.co.uk\"),\n    },\n    {\n      icon: <Phone className=\"w-5 h-5\" />,\n      title: \"Phone Support\",\n      description: \"Speak to our team\",\n      action: \"0800 123 4567\",\n      buttonText: \"Call Now\",\n      onClick: () => (window.location.href = \"tel:08001234567\"),\n    },\n    {\n      icon: <MessageCircle className=\"w-5 h-5\" />,\n      title: \"Live Chat\",\n      description: \"Chat with our support team\",\n      action: \"Available 24/7\",\n      buttonText: \"Start Chat\",\n      onClick: () => {\n        const event = new CustomEvent(\"open-messages\", {\n          detail: { receiverId: \"support\" },\n        });\n        window.dispatchEvent(event);\n      },\n    },\n  ];\n\n  return (\n    <PageTransition>\n      <Layout>\n        <HeroSection\n          title=\"Help & Support Center\"\n          subtitle=\"Get the assistance you need with our comprehensive support resources\"\n          backgroundImage=\"https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?ixlib=rb-4.0.3\"\n          showSearch={false}\n          showStats={false}\n          height=\"h-[400px]\"\n        />\n        <main className=\"container mx-auto px-4 py-8\">\n          <div className=\"max-w-7xl mx-auto space-y-12\">\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n              {supportCategories.map((category, index) => (\n                <Card key={index} className=\"hover:shadow-lg transition-shadow\">\n                  <CardHeader className=\"flex flex-row items-center gap-2\">\n                    {category.icon}\n                    <div>\n                      <h3 className=\"font-semibold\">{category.title}</h3>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {category.description}\n                      </p>\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    <ul className=\"space-y-2\">\n                      {category.content.map((item, i) => (\n                        <li key={i} className=\"text-sm\">\n                          • {item}\n                        </li>\n                      ))}\n                    </ul>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n\n            <div className=\"bg-card shadow rounded-lg p-8\">\n              <div className=\"text-center mb-8\">\n                <h2 className=\"text-2xl font-bold mb-2\">Contact Support</h2>\n                <p className=\"text-muted-foreground\">\n                  Choose your preferred method of contact\n                </p>\n              </div>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                {contactMethods.map((method, index) => (\n                  <Card\n                    key={index}\n                    className=\"hover:shadow-lg transition-shadow\"\n                  >\n                    <CardContent className=\"p-6 text-center\">\n                      <div className=\"mb-4 flex justify-center\">\n                        {method.icon}\n                      </div>\n                      <h3 className=\"font-semibold mb-2\">{method.title}</h3>\n                      <p className=\"text-sm text-muted-foreground mb-2\">\n                        {method.description}\n                      </p>\n                      <p className=\"text-sm font-medium mb-4\">\n                        {method.action}\n                      </p>\n                      <Button onClick={method.onClick} className=\"w-full\">\n                        {method.buttonText}\n                      </Button>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            </div>\n          </div>\n        </main>\n      </Layout>\n    </PageTransition>\n  );\n}\n","import React from \"react\";\nimport { Button } from \"./ui/button\";\nimport { Input } from \"./ui/input\";\nimport { Tabs, TabsContent } from \"./ui/tabs\";\nimport {\n  MessageCircle,\n  Send,\n  X,\n  Users,\n} from \"lucide-react\";\nimport { popularQuestions } from \"../lib/chat\";\nimport { useAuth } from \"../lib/auth\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"./ui/avatar\";\nimport { supabase } from \"../lib/supabase\";\nimport { useNavigate } from \"react-router-dom\";\n\ninterface Message {\n  text: string;\n  isUser: boolean;\n  sender?: {\n    full_name: string;\n    email: string;\n  };\n  timestamp?: string;\n}\n\ninterface Contact {\n  id: string;\n  full_name: string;\n  email: string;\n  last_message?: string;\n  unread_count?: number;\n}\n\nconst formatMessage = (text: string) => {\n  // Replace **bold** with styled spans\n  let formattedText = text.replace(\n    /\\*\\*(.*?)\\*\\*/g,\n    '<span class=\"font-bold\">$1</span>'\n  );\n  \n  // Replace *italic* with styled spans\n  formattedText = formattedText.replace(\n    /\\*(.*?)\\*/g,\n    '<span class=\"italic\">$1</span>'\n  );\n  \n  // Replace bullet points\n  formattedText = formattedText.replace(\n    /^- (.+)$/gm,\n    '<span class=\"block ml-2\">• $1</span>'\n  );\n  \n  // Replace numbered lists\n  formattedText = formattedText.replace(\n    /^\\d+\\. (.+)$/gm,\n    '<span class=\"block ml-2\">$&</span>'\n  );\n\n  // Split by newlines and wrap in spans\n  return formattedText.split('\\n').map((line) => (\n    line ? `<span class=\"block\">${line}</span>` : '<span class=\"block h-2\"></span>'\n  )).join('');\n};\n\nconst GEMINI_API_KEY = import.meta.env.VITE_GEMINI_API_KEY;\nconst GEMINI_API_URL = \"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent\";\n\nexport function ChatBot() {\n  const { user, profile } = useAuth();\n  const [isOpen, setIsOpen] = React.useState(false);\n  const [activeTab, setActiveTab] = React.useState(\"ai\");\n  const [aiMessages, setAiMessages] = React.useState<Message[]>([]);\n  const [supportMessages, setSupportMessages] = React.useState<Message[]>([]);\n  const [directMessages, setDirectMessages] = React.useState<Message[]>([]);\n  const [input, setInput] = React.useState(\"\");\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [contacts, setContacts] = React.useState<Contact[]>([]);\n  const [selectedContact, setSelectedContact] = React.useState<Contact | null>(\n    null,\n  );\n  const scrollRef = React.useRef<HTMLDivElement>(null);\n  const navigate = useNavigate();\n\n  // Load contacts for direct messaging\n  React.useEffect(() => {\n    if (user) {\n      loadContacts();\n\n      // Listen for open-messages event\n      const handleOpenMessages = (e: CustomEvent) => {\n        setIsOpen(true);\n        setActiveTab(\"messages\");\n        const receiverId = e.detail.receiverId;\n        const contact = contacts.find((c) => c.id === receiverId);\n        if (contact) {\n          setSelectedContact(contact);\n        }\n      };\n\n      window.addEventListener(\n        \"open-messages\",\n        handleOpenMessages as EventListener,\n      );\n      return () =>\n        window.removeEventListener(\n          \"open-messages\",\n          handleOpenMessages as EventListener,\n        );\n    }\n  }, [user, contacts]);\n\n  const loadContacts = async () => {\n    try {\n      const { data: messages } = await supabase\n        .from(\"messages\")\n        .select(\n          `\n          *,\n          sender:profiles!messages_sender_id_fkey(id, full_name, email),\n          receiver:profiles!messages_receiver_id_fkey(id, full_name, email)\n        `,\n        )\n        .or(`sender_id.eq.${user?.id},receiver_id.eq.${user?.id}`)\n        .order(\"created_at\", { ascending: false });\n\n      if (!messages) return;\n\n      // Create unique contacts list\n      const uniqueContacts = new Map<string, Contact>();\n      messages.forEach((msg) => {\n        const contact = msg.sender.id === user?.id ? msg.receiver : msg.sender;\n        if (!uniqueContacts.has(contact.id)) {\n          uniqueContacts.set(contact.id, {\n            id: contact.id,\n            full_name: contact.full_name,\n            email: contact.email,\n            last_message: msg.content,\n            unread_count: msg.receiver_id === user?.id && !msg.is_read ? 1 : 0,\n          });\n        }\n      });\n\n      setContacts(Array.from(uniqueContacts.values()));\n    } catch (error) {\n      console.error(\"Error loading contacts:\", error);\n    }\n  };\n\n  const handleSend = async (text: string) => {\n    if (!text.trim()) return;\n\n    if (activeTab === \"ai\") {\n      // AI chat allowed without sign in\n      setAiMessages((prev) => [...prev, { text, isUser: true }]);\n      setInput(\"\");\n      setIsLoading(true);\n\n      try {\n        // Get AI response without storing in database\n        const aiResponse = await fetch(\n          `${GEMINI_API_URL}?key=${GEMINI_API_KEY}`,\n          {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({\n              contents: [{\n                parts: [{\n                  text: text\n                }]\n              }]\n            }),\n          }\n        );\n\n        if (!aiResponse.ok) {\n          throw new Error(`AI API error: ${aiResponse.status}`);\n        }\n\n        const aiData = await aiResponse.json();\n        const response = aiData.candidates[0].content.parts[0].text;\n\n        // Only store messages if user is signed in\n        if (user) {\n          const conversationId = `ai_${user.id}_${Date.now()}`;\n          \n          await supabase.from(\"messages\").insert([\n            {\n              sender_id: user.id,\n              receiver_id: user.id,\n              content: text,\n              is_support: false,\n              conversation_id: conversationId\n            },\n            {\n              sender_id: null,\n              receiver_id: user.id,\n              content: response,\n              is_support: true,\n              conversation_id: conversationId\n            }\n          ]);\n        }\n\n        setAiMessages((prev) => [...prev, { text: response, isUser: false }]);\n      } catch (error) {\n        console.error(\"Error in AI chat:\", error);\n        setAiMessages((prev) => [\n          ...prev,\n          { text: \"Sorry, I encountered an error. Please try again.\", isUser: false }\n        ]);\n      } finally {\n        setIsLoading(false);\n      }\n    } else if (!user) {\n      // Require sign in for support and direct messages\n      setAiMessages((prev) => [\n        ...prev,\n        { text: \"Please sign in to use support and direct messaging features.\", isUser: false }\n      ]);\n      return;\n    } else if (activeTab === \"support\") {\n      // Handle support messages\n      setSupportMessages((prev) => [...prev, { text, isUser: true }]);\n      setInput(\"\");\n\n      try {\n        const supportConversationId = `support_${user.id}_${Date.now()}`;\n\n        // Insert user's support message\n        const { error: userMsgError } = await supabase.from(\"messages\").insert({\n          sender_id: user.id,\n          receiver_id: 'support',\n          content: text,\n          is_support: true,\n          conversation_id: supportConversationId\n        });\n\n        if (userMsgError) throw userMsgError;\n\n        // Insert automated support response\n        const autoResponse = \"Thank you for your message. Our support team will get back to you soon.\";\n        const { error: supportError } = await supabase.from(\"messages\").insert({\n          sender_id: null,\n          receiver_id: user.id,\n          content: autoResponse,\n          is_support: true,\n          conversation_id: supportConversationId\n        });\n\n        if (supportError) throw supportError;\n\n        setSupportMessages((prev) => [\n          ...prev,\n          { text: autoResponse, isUser: false }\n        ]);\n      } catch (error) {\n        console.error(\"Error handling support message:\", error);\n        setSupportMessages((prev) => [\n          ...prev,\n          { text: \"Sorry, there was an error sending your message. Please try again.\", isUser: false }\n        ]);\n      }\n    } else {\n      // Direct Message or Support\n      if (!user || !selectedContact) return;\n\n      try {\n        console.log(\"Sending message to Supabase:\", { // Add this line\n          sender_id: user.id,\n          receiver_id: selectedContact.id,\n          content: text,\n          is_support: activeTab === \"support\",\n        });\n        const { data, error } = await supabase.from(\"messages\").insert([\n          {\n            sender_id: user.id,\n            receiver_id: selectedContact.id,\n            content: text,\n            is_support: activeTab === \"support\",\n          },\n        ]);\n\n        if (error) {\n          console.error(\"Supabase insert error:\", error); // Add this line\n          throw error;\n        }\n\n        console.log(\"Supabase insert success:\", data); // Add this line\n\n        setDirectMessages((prev) => [\n          ...prev,\n          {\n            text,\n            isUser: true,\n            sender: {\n              full_name: profile?.full_name || \"\",\n              email: profile?.email || \"\",\n            },\n            timestamp: new Date().toISOString(),\n          },\n        ]);\n        setInput(\"\");\n      } catch (error) {\n        console.error(\"Error sending message:\", error);\n      }\n    }\n  };\n\n  const scrollToBottom = () => {\n    if (scrollRef.current) {\n      scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n    }\n  };\n\n  React.useEffect(() => {\n    scrollToBottom();\n  }, [aiMessages, supportMessages, directMessages]);\n\n  React.useEffect(() => {\n    scrollToBottom();\n  }, [isLoading]);\n\n  // Subscribe to new messages\n  React.useEffect(() => {\n    if (!user || !selectedContact) return;\n\n    const subscription = supabase\n      .channel(`messages:${user.id}:${selectedContact.id}`)\n      .on(\n        \"postgres_changes\",\n        {\n          event: \"INSERT\",\n          schema: \"public\",\n          table: \"messages\",\n          filter: `or(and(sender_id.eq.${user.id},receiver_id.eq.${selectedContact.id}),and(sender_id.eq.${selectedContact.id},receiver_id.eq.${user.id}))`,\n        },\n        (payload) => {\n          console.log(\"Realtime message received:\", payload); // Add this line\n          const newMessage = payload.new;\n          if (newMessage.sender_id !== user.id) {\n            setDirectMessages((prev) => [\n              ...prev,\n              {\n                text: newMessage.content,\n                isUser: false,\n                sender: selectedContact,\n                timestamp: newMessage.created_at,\n              },\n            ]);\n          }\n        },\n      )\n      .subscribe();\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [user, selectedContact]);\n\n  return (\n    <>\n      <div className={`fixed bottom-4 right-4 z-50 ${isOpen ? 'w-96' : 'w-auto'}`}>\n        {isOpen ? (\n          <div className=\"bg-background border rounded-lg shadow-lg\">\n            <div className=\"p-4 border-b flex justify-between items-center\">\n              <h2 className=\"font-semibold\">AI Assistant</h2>\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  onClick={() => navigate('/messages')}\n                  title=\"Chat with Users\"\n                >\n                  <Users className=\"h-4 w-4\" />\n                </Button>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  onClick={() => setIsOpen(false)}\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            </div>\n\n            <Tabs defaultValue={activeTab} onValueChange={setActiveTab}>\n              <TabsContent value=\"ai\" className=\"m-0 bg-white\">\n                <div\n                  ref={scrollRef}\n                  className=\"h-96 p-4 space-y-4 overflow-y-auto\"\n                >\n                  {aiMessages.length === 0 ? (\n                    <div className=\"space-y-4\">\n                      <p className=\"text-sm text-muted-foreground\">\n                        Hello! I'm your property assistant. Ask me anything\n                        about property investment, or try one of these popular\n                        questions:\n                      </p>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {popularQuestions.map((question, index) => (\n                          <Button\n                            key={index}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"text-xs\"\n                            onClick={() => handleSend(question)}\n                          >\n                            {question}\n                          </Button>\n                        ))}\n                      </div>\n                    </div>\n                  ) : (\n                    aiMessages.map((message, index) => (\n                      <div\n                        key={index}\n                        className={`flex ${message.isUser ? \"justify-end\" : \"justify-start\"}`}\n                      >\n                        <div\n                          className={`max-w-[80%] rounded-lg p-3 ${\n                            message.isUser\n                              ? \"bg-primary text-primary-foreground\"\n                              : \"bg-muted\"\n                          }`}\n                        >\n                          <p \n                            className=\"text-sm whitespace-pre-wrap\"\n                            dangerouslySetInnerHTML={{\n                              __html: message.isUser ? message.text : formatMessage(message.text)\n                            }}\n                          />\n                        </div>\n                      </div>\n                    ))\n                  )}\n                  {isLoading && (\n                    <div className=\"flex justify-start\">\n                      <div className=\"max-w-[80%] rounded-lg p-3 bg-muted\">\n                        <p className=\"text-sm\">Typing...</p>\n                      </div>\n                    </div>\n                  )}\n                </div>\n                <div className=\"p-4 border-t\">\n                  <div className=\"flex gap-2\">\n                    <Input\n                      value={input}\n                      onChange={(e) => setInput(e.target.value)}\n                      placeholder=\"Ask me anything about property...\"\n                      onKeyPress={(e) => {\n                        if (e.key === \"Enter\") {\n                          handleSend(input);\n                        }\n                      }}\n                    />\n                    <Button\n                      onClick={() => handleSend(input)}\n                      disabled={!input.trim()}\n                    >\n                      <Send className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"messages\" className=\"m-0 bg-white\">\n                <div\n                  ref={scrollRef}\n                  className=\"h-96 p-4 space-y-4 overflow-y-auto\"\n                >\n                  {!user ? (\n                    <div className=\"text-center p-4\">\n                      <p className=\"text-sm text-muted-foreground mb-2\">\n                        Please sign in to view messages\n                      </p>\n                    </div>\n                  ) : !selectedContact ? (\n                    <div className=\"space-y-4\">\n                      {contacts.map((contact) => (\n                        <div\n                          key={contact.id}\n                          className=\"flex items-center justify-between p-2 hover:bg-muted rounded-lg cursor-pointer\"\n                          onClick={() => setSelectedContact(contact)}\n                        >\n                          <div className=\"flex items-center gap-2\">\n                            <Avatar className=\"h-8 w-8\">\n                              <AvatarImage\n                                src={`https://ui-avatars.com/api/?name=${encodeURIComponent(contact.full_name)}&background=random`}\n                                alt={contact.full_name}\n                              />\n                              <AvatarFallback>\n                                {contact.full_name\n                                  ?.split(\" \")\n                                  .map((n) => n[0])\n                                  .join(\"\")}\n                              </AvatarFallback>\n                            </Avatar>\n                            <div>\n                              <p className=\"font-medium\">\n                                {contact.full_name}\n                              </p>\n                              <p className=\"text-sm text-muted-foreground\">\n                                {contact.last_message}\n                              </p>\n                            </div>\n                          </div>\n                          {contact.unread_count && contact.unread_count > 0 && (\n                            <span className=\"bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full\">\n                              {contact.unread_count}\n                            </span>\n                          )}\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <div className=\"space-y-4\">\n                      {directMessages.map((message, index) => (\n                        <div\n                          key={index}\n                          className={`flex ${message.isUser ? \"justify-end\" : \"justify-start\"}`}\n                        >\n                          <div\n                            className={`max-w-[80%] rounded-lg p-3 ${message.isUser ? \"bg-primary text-primary-foreground\" : \"bg-muted\"}`}\n                          >\n                            <p className=\"text-sm\">{message.text}</p>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n\n                {selectedContact && (\n                  <div className=\"p-4 border-t\">\n                    <div className=\"flex gap-2\">\n                      <Input\n                        value={input}\n                        onChange={(e) => setInput(e.target.value)}\n                        placeholder=\"Type a message...\"\n                        onKeyPress={(e) => {\n                          if (e.key === \"Enter\") {\n                            handleSend(input);\n                          }\n                        }}\n                      />\n                      <Button\n                        onClick={() => handleSend(input)}\n                        disabled={!input.trim()}\n                      >\n                        <Send className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                )}\n              </TabsContent>\n\n              <TabsContent value=\"support\" className=\"m-0 bg-white\">\n                <div\n                  ref={scrollRef}\n                  className=\"h-96 p-4 space-y-4 overflow-y-auto\"\n                >\n                  {supportMessages.length === 0 ? (\n                    <div className=\"space-y-4\">\n                      <p className=\"text-sm text-muted-foreground\">\n                        Welcome to support! How can we help you today?\n                      </p>\n                    </div>\n                  ) : (\n                    supportMessages.map((message, index) => (\n                      <div\n                        key={index}\n                        className={`flex ${message.isUser ? \"justify-end\" : \"justify-start\"}`}\n                      >\n                        <div\n                          className={`max-w-[80%] rounded-lg p-3 ${message.isUser ? \"bg-primary text-primary-foreground\" : \"bg-muted\"}`}\n                        >\n                          <p className=\"text-sm\">{message.text}</p>\n                        </div>\n                      </div>\n                    ))\n                  )}\n                </div>\n\n                <div className=\"p-4 border-t\">\n                  <div className=\"flex gap-2\">\n                    <Input\n                      value={input}\n                      onChange={(e) => setInput(e.target.value)}\n                      placeholder=\"Type your support question...\"\n                      onKeyPress={(e) => {\n                        if (e.key === \"Enter\") {\n                          handleSend(input);\n                        }\n                      }}\n                    />\n                    <Button\n                      onClick={() => handleSend(input)}\n                      disabled={!input.trim()}\n                    >\n                      <Send className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </TabsContent>\n            </Tabs>\n          </div>\n        ) : (\n          <Button\n            onClick={() => setIsOpen(true)}\n            className=\"rounded-full h-12 w-12 flex items-center justify-center\"\n          >\n            <MessageCircle className=\"h-6 w-6\" />\n          </Button>\n        )}\n      </div>\n    </>\n  );\n}\n","import { useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { supabase } from \"../lib/supabase\";\n\nexport default function AuthCallback() {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    supabase.auth.onAuthStateChange((event, session) => {\n      console.log(\"Auth state change:\", event, session); // Add this line\n      if (event === \"SIGNED_IN\") {\n        navigate(\"/dashboard\");\n      }\n    });\n\n    // Handle the initial session\n    const handleInitialSession = async () => {\n      const {\n        data: { session },\n      } = await supabase.auth.getSession();\n      console.log(\"Initial session:\", session); // Add this line\n      if (session) {\n        navigate(\"/dashboard\");\n      } else {\n        navigate(\"/\");\n      }\n    };\n\n    handleInitialSession();\n  }, [navigate]);\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center\">\n      <div className=\"text-center\">\n        <h2 className=\"text-2xl font-semibold mb-2\">Authenticating...</h2>\n        <p className=\"text-muted-foreground\">\n          Please wait while we verify your credentials.\n        </p>\n      </div>\n    </div>\n  );\n}\n","import HeroSection from \"./HeroSection\";\nimport { Layout } from \"./Layout\";\nimport { PageTransition } from \"./ui/page-transition\";\nimport { Button } from \"./ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"./ui/card\";\nimport { Badge } from \"./ui/badge\";\nimport { Brain, Building2, BarChart3, Home, MessageSquare, Shield } from \"lucide-react\";\n\nconst aiFeatures = [\n  {\n    title: \"AI Property Analysis\",\n    description: \"Advanced AI algorithms analyze market trends, rental rates, and property conditions to optimize your investment returns.\",\n    icon: Brain,\n    badge: \"AI-Powered\"\n  },\n  {\n    title: \"Smart Tenant Matching\",\n    description: \"AI-driven tenant screening and matching system to find the perfect tenants for your properties.\",\n    icon: Home,\n    badge: \"Smart Match\"\n  },\n  {\n    title: \"Predictive Maintenance\",\n    description: \"AI predicts maintenance needs before they become issues, saving you time and money.\",\n    icon: Building2,\n    badge: \"Predictive\"\n  },\n  {\n    title: \"Automated Reporting\",\n    description: \"AI-generated insights and reports on property performance, maintenance history, and financial metrics.\",\n    icon: BarChart3,\n    badge: \"Automated\"\n  },\n  {\n    title: \"AI Chat Support\",\n    description: \"24/7 AI-powered chat support for tenants and property owners.\",\n    icon: MessageSquare,\n    badge: \"24/7 Support\"\n  },\n  {\n    title: \"Smart Security\",\n    description: \"AI-enhanced security monitoring and access control systems.\",\n    icon: Shield,\n    badge: \"Enhanced\"\n  }\n];\n\nconst managementServices = [\n  {\n    title: \"Tenant Screening\",\n    description: \"Comprehensive tenant screening with AI-powered background checks and risk assessment.\",\n  },\n  {\n    title: \"Rent Collection\",\n    description: \"Smart rent collection with predictive payment analysis and automated reminders.\",\n  },\n  {\n    title: \"Property Maintenance\",\n    description: \"AI-driven maintenance scheduling and vendor management.\",\n  },\n  {\n    title: \"Financial Reporting\",\n    description: \"Advanced financial analytics with AI-powered forecasting and recommendations.\",\n  },\n];\n\nexport default function PropertyManagementPage() {\n  return (\n    <PageTransition>\n      <Layout>\n        <HeroSection\n          title=\"AI-Powered Property Management\"\n          subtitle=\"Experience the future of property management with our advanced AI solutions.\"\n          backgroundImage=\"https://images.unsplash.com/photo-1568605114967-8130f3a36994?ixlib=rb-4.0.3\"\n          showSearch={false}\n          showStats={false}\n          height=\"h-[400px]\"\n        />\n        <main className=\"container mx-auto px-4 py-8 pt-24\">\n          <div className=\"max-w-6xl mx-auto space-y-16\">\n            <div className=\"text-center\">\n              <h1 className=\"text-3xl font-bold mb-2\">\n                Next-Generation Property Management\n              </h1>\n              <p className=\"text-muted-foreground max-w-2xl mx-auto\">\n                Leveraging artificial intelligence to revolutionize property management and maximize your investment returns.\n              </p>\n            </div>\n\n            {/* AI Features Grid */}\n            <section className=\"space-y-8\">\n              <h2 className=\"text-2xl font-semibold text-center\">AI-Powered Features</h2>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {aiFeatures.map((feature, index) => (\n                  <Card key={index} className=\"hover:shadow-lg transition-shadow\">\n                    <CardHeader>\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <feature.icon className=\"h-6 w-6 text-primary\" />\n                        <Badge variant=\"secondary\">{feature.badge}</Badge>\n                      </div>\n                      <CardTitle className=\"text-xl\">{feature.title}</CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <p className=\"text-muted-foreground\">{feature.description}</p>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            </section>\n\n            {/* Traditional Services with AI Enhancement */}\n            <section className=\"space-y-8\">\n              <h2 className=\"text-2xl font-semibold text-center\">Core Services Enhanced by AI</h2>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {managementServices.map((service, index) => (\n                  <Card key={index} className=\"hover:shadow-lg transition-shadow\">\n                    <CardHeader>\n                      <CardTitle>{service.title}</CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <p className=\"text-muted-foreground\">{service.description}</p>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            </section>\n\n            <section className=\"space-y-8 bg-muted p-8 rounded-lg\">\n              <h2 className=\"text-2xl font-semibold text-center\">Why Choose Our AI-Powered Management?</h2>\n              <div className=\"prose prose-lg max-w-none\">\n                <ul className=\"list-disc pl-6 space-y-2\">\n                  <li>Reduce operational costs by up to 30% with AI automation</li>\n                  <li>Minimize vacancy rates with smart tenant matching</li>\n                  <li>Prevent maintenance issues before they occur</li>\n                  <li>Get real-time insights and predictive analytics</li>\n                  <li>24/7 automated support for tenants</li>\n                  <li>Enhanced security and risk management</li>\n                </ul>\n              </div>\n            </section>\n\n            <section className=\"text-center space-y-6\">\n              <h2 className=\"text-2xl font-semibold\">Ready to Transform Your Property Management?</h2>\n              <p className=\"text-muted-foreground max-w-2xl mx-auto\">\n                Experience the power of AI-driven property management. Contact us to learn how we can help optimize your property portfolio.\n              </p>\n              <Button size=\"lg\" className=\"px-8\">\n                Schedule a Demo\n              </Button>\n            </section>\n          </div>\n        </main>\n      </Layout>\n    </PageTransition>\n  );\n}\n","import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","// Import type only to avoid build issues\nimport type { GoogleGenerativeAI } from \"@google/generative-ai\";\n\nlet genAI: GoogleGenerativeAI;\n\nasync function initializeAI() {\n  if (!genAI) {\n    const { GoogleGenerativeAI } = await import(\"@google/generative-ai\");\n    genAI = new GoogleGenerativeAI(import.meta.env.VITE_GEMINI_API_KEY);\n  }\n  return genAI;\n}\n\nfunction sanitizeJsonString(str: string): string {\n  // Find the first { and last } to extract just the JSON object\n  const start = str.indexOf('{');\n  const end = str.lastIndexOf('}') + 1;\n  if (start === -1 || end === 0) throw new Error(\"Invalid JSON response\");\n  return str.slice(start, end);\n}\n\nexport async function getInvestmentAnalysis(propertyType: string, budget: number) {\n  const ai = await initializeAI();\n  const model = ai.getGenerativeModel({ model: \"gemini-pro\" });\n\n  const prompt = `\n    You are a UK property investment expert. Analyze investment opportunities for ${propertyType} properties with a budget of £${budget}.\n    Respond with a JSON object containing ONLY these exact fields:\n    {\n      \"analysis\": \"Brief overview of the investment opportunity\",\n      \"roi_range\": \"Expected ROI range as a percentage\",\n      \"risks\": [\"Risk 1\", \"Risk 2\", \"Risk 3\"],\n      \"opportunities\": [\"Opportunity 1\", \"Opportunity 2\", \"Opportunity 3\"],\n      \"market_trends\": [\"Trend 1\", \"Trend 2\", \"Trend 3\"]\n    }\n    Ensure each array has exactly 3 items and all fields are present.\n  `;\n\n  try {\n    const result = await model.generateContent(prompt);\n    const response = await result.response;\n    const text = sanitizeJsonString(response.text().trim());\n    console.log('Raw Analysis Response:', text);\n    \n    const parsedData = JSON.parse(text);\n    \n    // Validate the response structure\n    if (!parsedData.analysis || !parsedData.roi_range || \n        !Array.isArray(parsedData.risks) || !Array.isArray(parsedData.opportunities) || \n        !Array.isArray(parsedData.market_trends)) {\n      throw new Error('Invalid response format');\n    }\n\n    return {\n      analysis: parsedData.analysis,\n      roi_range: parsedData.roi_range,\n      risks: parsedData.risks.slice(0, 3),\n      opportunities: parsedData.opportunities.slice(0, 3),\n      market_trends: parsedData.market_trends.slice(0, 3)\n    };\n  } catch (error) {\n    console.error(\"Error in getInvestmentAnalysis:\", error);\n    return {\n      analysis: `Analysis for ${propertyType} properties with £${budget} budget is currently unavailable`,\n      roi_range: \"8-12%\",\n      risks: [\n        \"Market volatility\",\n        \"Economic uncertainty\",\n        \"Property condition risks\"\n      ],\n      opportunities: [\n        \"Value appreciation potential\",\n        \"Rental income opportunities\",\n        \"Development possibilities\"\n      ],\n      market_trends: [\n        \"Rising demand in key areas\",\n        \"Stable price growth\",\n        \"Infrastructure development\"\n      ]\n    };\n  }\n}\n\nexport async function getMarketPredictions(location: string) {\n  const ai = await initializeAI();\n  const model = ai.getGenerativeModel({ model: \"gemini-pro\" });\n\n  const prompt = `\n    You are a UK property market expert. Predict property market trends for ${location} in the next 12 months.\n    Respond ONLY with a JSON object in this exact format:\n    {\n      \"price_prediction\": \"2-3 sentence prediction of price movements\",\n      \"demand_factors\": [\"3 specific demand factors\"],\n      \"recommendations\": [\"3 specific investment recommendations\"]\n    }\n  `;\n\n  try {\n    const result = await model.generateContent(prompt);\n    const response = await result.response;\n    const text = sanitizeJsonString(response.text().trim());\n    console.log('Raw Predictions Response:', text);\n    return JSON.parse(text);\n  } catch (error) {\n    console.error(\"Error in getMarketPredictions:\", error);\n    return {\n      price_prediction: \"Market prediction currently unavailable\",\n      demand_factors: [\"Population growth\", \"Economic development\", \"Infrastructure improvements\"],\n      recommendations: [\"Research thoroughly\", \"Consider long-term potential\", \"Evaluate local amenities\"]\n    };\n  }\n}\n\nexport async function getInvestmentStrategy(investorProfile: any) {\n  const ai = await initializeAI();\n  const model = ai.getGenerativeModel({ model: \"gemini-pro\" });\n\n  const prompt = `\n    You are a UK property investment advisor. Create a strategy for a ${investorProfile.experience} investor with £${investorProfile.budget} budget and ${investorProfile.riskTolerance} risk tolerance.\n    Respond ONLY with a JSON object in this exact format:\n    {\n      \"strategy\": \"2-3 sentence overview of recommended strategy\",\n      \"portfolio_allocation\": \"Suggested portfolio breakdown percentages\",\n      \"timeline\": \"Recommended investment timeline\",\n      \"expected_returns\": \"Projected returns overview\"\n    }\n  `;\n\n  try {\n    const result = await model.generateContent(prompt);\n    const response = await result.response;\n    const text = sanitizeJsonString(response.text().trim());\n    console.log('Raw Strategy Response:', text);\n    return JSON.parse(text);\n  } catch (error) {\n    console.error(\"Error in getInvestmentStrategy:\", error);\n    return {\n      strategy: \"Investment strategy currently unavailable\",\n      portfolio_allocation: \"Residential: 60%, Commercial: 30%, Cash: 10%\",\n      timeline: \"5-10 years recommended holding period\",\n      expected_returns: \"8-12% annual return potential\"\n    };\n  }\n}\n\nexport async function getPropertyAnalysis(property: any) {\n  const ai = await initializeAI();\n  const model = ai.getGenerativeModel({ model: \"gemini-pro\" });\n\n  const prompt = `\n    As a UK property expert, analyze this property:\n    Property Type: ${property.property_type}\n    Details: ${property.bedroom} bedrooms, ${property.bathroom} bathrooms\n    Size: ${property.square_footage} sq ft\n    Location: ${property.city}\n    Price: £${property.price}\n\n    Respond with a JSON object in exactly this format:\n    {\n      \"market_value_analysis\": \"Brief analysis of the property's market value\",\n      \"investment_potential\": \"Analysis of investment potential\",\n      \"key_advantages\": [\"Advantage 1\", \"Advantage 2\", \"Advantage 3\"],\n      \"considerations\": [\"Consideration 1\", \"Consideration 2\", \"Consideration 3\"],\n      \"recommendation\": \"Brief recommendation\"\n    }\n    Keep the response strictly in this JSON format with no additional text.\n  `;\n\n  try {\n    console.log('Sending prompt to Gemini:', prompt);\n    const result = await model.generateContent(prompt);\n    const response = await result.response;\n    const text = response.text().trim();\n    console.log('Raw Gemini response:', text);\n    \n    // Clean and parse the response\n    const cleanedText = sanitizeJsonString(text);\n    console.log('Cleaned response:', cleanedText);\n    \n    const parsedData = JSON.parse(cleanedText);\n    \n    // Validate the response structure\n    if (!parsedData.market_value_analysis || \n        !parsedData.investment_potential || \n        !Array.isArray(parsedData.key_advantages) || \n        !Array.isArray(parsedData.considerations) || \n        !parsedData.recommendation) {\n      console.error('Invalid response structure:', parsedData);\n      throw new Error('Invalid response structure from AI');\n    }\n\n    return {\n      market_value_analysis: parsedData.market_value_analysis,\n      investment_potential: parsedData.investment_potential,\n      key_advantages: parsedData.key_advantages.slice(0, 3),\n      considerations: parsedData.considerations.slice(0, 3),\n      recommendation: parsedData.recommendation\n    };\n  } catch (error) {\n    console.error(\"Error in getPropertyAnalysis:\", error);\n    console.error(\"Property data:\", property);\n    \n    // More specific fallback data based on the property\n    return {\n      market_value_analysis: `This ${property.property_type} property in ${property.city} requires detailed market analysis.`,\n      investment_potential: `${property.bedroom} bedroom property with potential for rental or resale value appreciation.`,\n      key_advantages: [\n        `${property.bedroom} bedrooms suitable for the local market`,\n        `${property.square_footage} sq ft offering good space`,\n        `Located in ${property.city}`\n      ],\n      considerations: [\n        \"Current market conditions\",\n        \"Property condition assessment needed\",\n        \"Local area development plans\"\n      ],\n      recommendation: `Consider viewing this ${property.property_type} property for a detailed assessment.`\n    };\n  }\n} ","import React from \"react\";\nimport { Layout } from \"./Layout\";\nimport { PageTransition } from \"./ui/page-transition\";\nimport HeroSection from \"./HeroSection\";\nimport { Button } from \"./ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"./ui/card\";\nimport { Input } from \"./ui/input\";\nimport { \n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"./ui/select\";\nimport { Slider } from \"./ui/slider\";\nimport { \n  getInvestmentAnalysis, \n  getMarketPredictions, \n  getInvestmentStrategy \n} from \"../lib/ai-utils\";\nimport { Loader2, TrendingUp, Brain, BarChart3 } from \"lucide-react\";\n\ntype PropertyType = \"residential\" | \"commercial\" | \"industrial\";\n\nexport default function InvestmentOpportunitiesPage() {\n  const [loading, setLoading] = React.useState(false);\n  const [error, setError] = React.useState<string | null>(null);\n  const [propertyType, setPropertyType] = React.useState<PropertyType>(\"residential\");\n  const [budget, setBudget] = React.useState(250000);\n  const [location, setLocation] = React.useState(\"London\");\n  const [analysis, setAnalysis] = React.useState<any>(null);\n  const [predictions, setPredictions] = React.useState<any>(null);\n  const [strategy, setStrategy] = React.useState<any>(null);\n\n  const investorProfile = {\n    experience: \"intermediate\",\n    budget: budget,\n    riskTolerance: \"moderate\"\n  };\n\n  const handleAnalyze = async () => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      // Execute each API call separately for better error handling\n      const analysisData = await getInvestmentAnalysis(propertyType, budget);\n      if (!analysisData || typeof analysisData !== 'object') {\n        throw new Error('Invalid analysis data received');\n      }\n      setAnalysis(analysisData);\n\n      const predictionsData = await getMarketPredictions(location);\n      if (!predictionsData || typeof predictionsData !== 'object') {\n        throw new Error('Invalid predictions data received');\n      }\n      setPredictions(predictionsData);\n\n      const strategyData = await getInvestmentStrategy(investorProfile);\n      if (!strategyData || typeof strategyData !== 'object') {\n        throw new Error('Invalid strategy data received');\n      }\n      setStrategy(strategyData);\n\n    } catch (error) {\n      console.error(\"Error in analysis:\", error);\n      setError(error instanceof Error ? error.message : \"Failed to generate analysis. Please try again.\");\n      // Clear any partial results\n      setAnalysis(null);\n      setPredictions(null);\n      setStrategy(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <PageTransition>\n      <Layout>\n        <HeroSection\n          title=\"AI-Powered Investment Analysis\"\n          subtitle=\"Make data-driven investment decisions with our advanced AI analytics\"\n          showSearch={false}\n          height=\"h-[400px]\"\n          onSearch={() => {}}\n        />\n        \n        <main className=\"container mx-auto px-4 py-8 pt-24\">\n          <div className=\"max-w-7xl mx-auto space-y-12\">\n            {/* Analysis Controls */}\n            <section className=\"bg-card p-6 rounded-lg shadow-lg\">\n              <h2 className=\"text-2xl font-bold mb-6\">Investment Analysis</h2>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium\">Property Type</label>\n                  <Select \n                    defaultValue={propertyType}\n                    onValueChange={(value: PropertyType) => setPropertyType(value)}\n                  >\n                    <SelectTrigger className=\"w-full\">\n                      <SelectValue placeholder=\"Select property type\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"residential\">Residential</SelectItem>\n                      <SelectItem value=\"commercial\">Commercial</SelectItem>\n                      <SelectItem value=\"industrial\">Industrial</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium\">Location</label>\n                  <Input\n                    type=\"text\"\n                    value={location}\n                    onChange={(e) => setLocation(e.target.value)}\n                    placeholder=\"Enter location\"\n                  />\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium\">Budget: £{budget.toLocaleString()}</label>\n                  <Slider\n                    value={[budget]}\n                    onValueChange={(value) => setBudget(value[0])}\n                    min={100000}\n                    max={1000000}\n                    step={50000}\n                  />\n                </div>\n              </div>\n              \n              <Button\n                onClick={handleAnalyze}\n                disabled={loading}\n                className=\"mt-6\"\n                size=\"lg\"\n              >\n                {loading ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Analyzing...\n                  </>\n                ) : (\n                  'Analyze Investment Opportunity'\n                )}\n              </Button>\n            </section>\n\n            {/* Analysis Results */}\n            {error && (\n              <div className=\"bg-destructive/10 text-destructive p-4 rounded-lg\">\n                {error}\n              </div>\n            )}\n            \n            {analysis && predictions && strategy && !error && (\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                {/* Market Analysis */}\n                <Card>\n                  <CardHeader>\n                    <TrendingUp className=\"h-6 w-6 text-primary mb-2\" />\n                    <CardTitle>Market Analysis</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div>\n                      <h4 className=\"font-semibold\">Analysis</h4>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {analysis.analysis || \"Analysis not available\"}\n                      </p>\n                    </div>\n                    <div>\n                      <h4 className=\"font-semibold\">ROI Range</h4>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {analysis.roi_range || \"ROI range not available\"}\n                      </p>\n                    </div>\n                    <div>\n                      <h4 className=\"font-semibold\">Risks</h4>\n                      <ul className=\"list-disc pl-4 text-sm text-muted-foreground\">\n                        {Array.isArray(analysis.risks) ? (\n                          analysis.risks.map((risk: string, i: number) => (\n                            <li key={i}>{risk}</li>\n                          ))\n                        ) : (\n                          <li>Risks data not available</li>\n                        )}\n                      </ul>\n                    </div>\n                    <div>\n                      <h4 className=\"font-semibold\">Market Trends</h4>\n                      <ul className=\"list-disc pl-4 text-sm text-muted-foreground\">\n                        {Array.isArray(analysis.market_trends) ? (\n                          analysis.market_trends.map((trend: string, i: number) => (\n                            <li key={i}>{trend}</li>\n                          ))\n                        ) : (\n                          <li>Market trends not available</li>\n                        )}\n                      </ul>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Market Predictions */}\n                <Card>\n                  <CardHeader>\n                    <Brain className=\"h-6 w-6 text-primary mb-2\" />\n                    <CardTitle>AI Predictions</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-2\">\n                    <div>\n                      <h4 className=\"font-semibold\">Price Trend</h4>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {predictions.price_prediction || \"Price prediction not available\"}\n                      </p>\n                    </div>\n                    <div>\n                      <h4 className=\"font-semibold\">Demand Factors</h4>\n                      <ul className=\"list-disc pl-4 text-sm text-muted-foreground\">\n                        {Array.isArray(predictions.demand_factors) ? (\n                          predictions.demand_factors.map((factor: string, i: number) => (\n                            <li key={i}>{factor}</li>\n                          ))\n                        ) : (\n                          <li>Demand factors not available</li>\n                        )}\n                      </ul>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Investment Strategy */}\n                <Card>\n                  <CardHeader>\n                    <BarChart3 className=\"h-6 w-6 text-primary mb-2\" />\n                    <CardTitle>Recommended Strategy</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-2\">\n                    <div>\n                      <h4 className=\"font-semibold\">Portfolio Allocation</h4>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {strategy.portfolio_allocation || \"Portfolio allocation not available\"}\n                      </p>\n                    </div>\n                    <div>\n                      <h4 className=\"font-semibold\">Expected Returns</h4>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {strategy.expected_returns || \"Expected returns not available\"}\n                      </p>\n                    </div>\n                    <div>\n                      <h4 className=\"font-semibold\">Timeline</h4>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {strategy.timeline || \"Timeline not available\"}\n                      </p>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            )}\n          </div>\n        </main>\n      </Layout>\n    </PageTransition>\n  );\n}\n","import React from \"react\";\nimport Header from \"./Header\";\nimport HeroSection from \"./HeroSection\";\nimport { Layout } from \"./Layout\";\nimport { PageTransition } from \"./ui/page-transition\";\nimport { Button } from \"./ui/button\";\n\nexport default function AboutUsPage() {\n  return (\n    <PageTransition>\n      <Layout>\n        <HeroSection\n          title=\"About MyVGE\"\n          subtitle=\"Learn more about our mission and our team\"\n          backgroundImage=\"https://images.unsplash.com/photo-1507585495646-50c2b6dbd483?ixlib=rb-4.0.3\"\n          showSearch={false}\n          showStats={false}\n          height=\"h-[400px]\"\n        />\n        <main className=\"container mx-auto px-4 py-8 pt-24\">\n          <div className=\"max-w-4xl mx-auto space-y-8\">\n            <div className=\"text-center\">\n              <h1 className=\"text-3xl font-bold mb-2\">Our Story</h1>\n              <p className=\"text-muted-foreground\">\n                MyVGE is dedicated to providing property investors with the\n                tools and insights they need to succeed.\n              </p>\n            </div>\n\n            <section className=\"space-y-4\">\n              <h2 className=\"text-2xl font-semibold\">Our Mission</h2>\n              <p>\n                To empower property investors with comprehensive data, expert\n                analysis, and innovative tools to make informed decisions and\n                achieve their financial goals. We are committed to ethical\n                practices, diversity, and transparency in all our operations.\n              </p>\n            </section>\n\n            <section className=\"space-y-4\">\n              <h2 className=\"text-2xl font-semibold\">Our Values</h2>\n              <ul className=\"list-disc list-inside\">\n                <li>\n                  **Ethical Practices:** We adhere to the highest ethical\n                  standards in all our dealings, ensuring fairness and\n                  integrity.\n                </li>\n                <li>\n                  **Diversity:** We embrace diversity and inclusion, fostering\n                  a welcoming environment for all.\n                </li>\n                <li>\n                  **Transparency:** We are committed to open and honest\n                  communication, providing clear and accurate information to our\n                  users.\n                </li>\n              </ul>\n            </section>\n\n            <section className=\"space-y-4\">\n              <h2 className=\"text-2xl font-semibold\">Our Team</h2>\n              <p>\n                Our team consists of experienced property professionals, data\n                scientists, and technology experts who are passionate about\n                helping investors navigate the complexities of the real estate\n                market. We are a diverse group of individuals with a shared\n                commitment to excellence.\n              </p>\n            </section>\n\n            <section className=\"space-y-4\">\n              <h2 className=\"text-2xl font-semibold\">Contact Us</h2>\n              <p>\n                We'd love to hear from you! Contact us to learn more about our\n                services or to discuss your investment needs.\n              </p>\n              <Button>Contact Us</Button>\n            </section>\n          </div>\n        </main>\n      </Layout>\n    </PageTransition>\n  );\n}\n","import React from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"./ui/dialog\";\nimport { Deal } from \"../lib/deals\";\nimport { Badge } from \"./ui/badge\";\nimport { formatCurrency } from \"../lib/utils\";\nimport { MapPin } from \"lucide-react\";\n\ninterface DealModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  deal: Deal | null;\n  isSubscriber: boolean;\n}\n\nexport const DealModal: React.FC<DealModalProps> = ({ isOpen, onClose, deal, isSubscriber }) => {\n  if (!deal) return null;\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-3xl w-[95vw] max-h-[90vh] overflow-y-auto p-4 sm:p-6\">\n        <DialogHeader>\n          <DialogTitle className=\"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 sm:gap-4\">\n            <span className=\"text-lg sm:text-xl font-bold break-words pr-4\">{deal.title}</span>\n            <div className=\"flex gap-2 flex-wrap\">\n              <Badge className=\"text-xs\">{deal.property_type}</Badge>\n              <Badge variant=\"secondary\" className=\"text-xs\">{deal.deal_type}</Badge>\n            </div>\n          </DialogTitle>\n        </DialogHeader>\n\n        {/* Image */}\n        <div className=\"relative aspect-video mb-3 sm:mb-4 overflow-hidden rounded-lg\">\n          <img\n            src={deal.image_url}\n            alt={deal.title}\n            className=\"w-full h-full object-cover\"\n          />\n        </div>\n\n        {/* Location */}\n        <div className=\"flex items-center gap-2 mb-3 sm:mb-4 text-sm sm:text-base text-muted-foreground\">\n          <MapPin className=\"h-4 w-4 flex-shrink-0\" />\n          <span className=\"break-words\">{deal.location}</span>\n        </div>\n\n        {/* Description */}\n        <div className=\"mb-4 sm:mb-6\">\n          <h3 className=\"text-base sm:text-lg font-semibold mb-2\">Description</h3>\n          <p className=\"text-xs sm:text-sm text-muted-foreground\">{deal.description}</p>\n        </div>\n\n        {/* Financial Details */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-4 sm:mb-6\">\n          <div>\n            <h3 className=\"text-sm sm:text-base font-semibold mb-1 sm:mb-2\">Price</h3>\n            <p className=\"text-base sm:text-lg\">{formatCurrency(deal.price)}</p>\n          </div>\n          <div>\n            <h3 className=\"text-sm sm:text-base font-semibold mb-1 sm:mb-2\">ROI</h3>\n            <p className=\"text-base sm:text-lg text-emerald-500\">{deal.roi_percentage}%</p>\n          </div>\n          <div>\n            <h3 className=\"text-sm sm:text-base font-semibold mb-1 sm:mb-2\">Investment Term</h3>\n            <p className=\"text-base sm:text-lg\">{deal.investment_term}</p>\n          </div>\n          <div>\n            <h3 className=\"text-sm sm:text-base font-semibold mb-1 sm:mb-2\">Property Type</h3>\n            <p className=\"text-base sm:text-lg\">{deal.property_type}</p>\n          </div>\n        </div>\n\n        {/* Additional Details */}\n        <div className=\"space-y-3 sm:space-y-4\">\n          <div>\n            <h3 className=\"text-sm sm:text-base font-semibold mb-1 sm:mb-2\">Deal Type</h3>\n            <Badge variant=\"outline\" className=\"text-xs sm:text-sm\">{deal.deal_type}</Badge>\n          </div>\n          <div>\n            <h3 className=\"text-sm sm:text-base font-semibold mb-1 sm:mb-2\">Location</h3>\n            <p className=\"text-xs sm:text-sm text-muted-foreground break-words\">{deal.location}</p>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}; ","import { useEffect, useState } from \"react\";\nimport { useAuth } from \"../lib/auth\";\nimport { getDeals } from \"../lib/deals\";\nimport type { Deal } from \"../lib/deals\";\nimport { DealCard } from \"./DealCard\";\nimport { DealModal } from \"./DealModal\";\nimport { Layout } from \"./Layout\";\nimport { PageTransition } from \"./ui/page-transition\";\nimport HeroSection from \"./HeroSection\";\nimport { Button } from \"./ui/button\";\nimport { Card } from \"./ui/card\";\nimport { LogIn, UserPlus } from \"lucide-react\";\n\ninterface DealsPageProps {\n  onSignIn?: () => void;\n  onSignUp?: () => void;\n}\n\n// Auth context checker wrapper\nconst AuthContextChecker = ({ children }: { children: React.ReactNode }) => {\n  try {\n    // Try to access auth context but don't use the result\n    useAuth();\n    // If we get here, auth context is available\n    return <>{children}</>;\n  } catch (error) {\n    // If auth context is not available, show a fallback\n    return (\n      <Layout>\n        <div className=\"min-h-screen flex flex-col items-center justify-center p-4\">\n          <Card className=\"p-6 max-w-md w-full\">\n            <h2 className=\"text-xl font-bold mb-4 text-center\">Authentication Error</h2>\n            <p className=\"text-muted-foreground mb-6 text-center\">\n              Unable to load authentication. Please refresh the page or try again later.\n            </p>\n            <Button \n              className=\"w-full\" \n              onClick={() => window.location.reload()}\n            >\n              Refresh Page\n            </Button>\n          </Card>\n        </div>\n      </Layout>\n    );\n  }\n};\n\nexport default function DealsPage({ onSignIn, onSignUp }: DealsPageProps) {\n  // Wrap the component content in the auth checker\n  return (\n    <AuthContextChecker>\n      <DealsPageContent onSignIn={onSignIn} onSignUp={onSignUp} />\n    </AuthContextChecker>\n  );\n}\n\n// Separate the main component content to ensure useAuth is only called when context is available\nfunction DealsPageContent({ onSignIn, onSignUp }: DealsPageProps) {\n  const { user, profile, isLoading } = useAuth();\n  const [deals, setDeals] = useState<Deal[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedDeal, setSelectedDeal] = useState<Deal | null>(null);\n\n  useEffect(() => {\n    let mounted = true;\n\n    async function loadDeals() {\n      try {\n        const dealsData = await getDeals();\n        if (mounted) {\n          setDeals(dealsData);\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('Error loading deals:', error);\n        if (mounted) {\n          setLoading(false);\n        }\n      }\n    }\n\n    loadDeals(); // Load deals regardless of auth state\n\n    return () => {\n      mounted = false;\n    };\n  }, []); // Remove user and isLoading from dependencies\n\n  // Show loading state\n  if (isLoading) {\n    return (\n      <Layout>\n        <div className=\"min-h-screen flex items-center justify-center\">\n          <div>Loading...</div>\n        </div>\n      </Layout>\n    );\n  }\n\n  return (\n    <Layout>\n      <PageTransition>\n        <div className=\"min-h-screen bg-neutral\">\n          <HeroSection\n            title=\"Property Deals\"\n            subtitle=\"Discover exclusive property investment opportunities\"\n            showSearch={true}\n            showStats={false}\n            height=\"h-[400px]\"\n            image=\"/deals-hero.jpg\"\n          />\n\n          <main className=\"container mx-auto px-4 py-8\">\n            {loading ? (\n              <div className=\"text-center py-8\">Loading deals...</div>\n            ) : !user ? (\n              // Paywall for non-authenticated users\n              <div className=\"max-w-4xl mx-auto\">\n                <Card className=\"p-8 text-center mb-8\">\n                  <h2 className=\"text-2xl font-bold mb-4\">Sign in to View Full Deal Details</h2>\n                  <p className=\"text-muted-foreground mb-8\">\n                    Get access to exclusive property deals and investment opportunities. \n                    Create an account or sign in to view all available deals.\n                  </p>\n                  <div className=\"flex justify-center gap-4\">\n                    <Button \n                      onClick={onSignIn}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <LogIn className=\"w-4 w-4\" />\n                      Sign In\n                    </Button>\n                    <Button \n                      variant=\"outline\"\n                      onClick={onSignUp}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <UserPlus className=\"w-4 w-4\" />\n                      Create Account\n                    </Button>\n                  </div>\n                </Card>\n\n                {/* Show preview of deals */}\n                <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n                  {deals.map((deal) => (\n                    <DealCard \n                      key={deal.id} \n                      deal={deal}\n                      isSubscriber={false}\n                      onClick={onSignIn}\n                      user={null}\n                    />\n                  ))}\n                </div>\n              </div>\n            ) : (\n              // Full access for authenticated users\n              <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n                {deals.map((deal) => (\n                  <DealCard \n                    key={deal.id} \n                    deal={deal}\n                    isSubscriber={profile?.subscription_tier !== 'free'}\n                    onClick={() => setSelectedDeal(deal)}\n                    user={user}\n                  />\n                ))}\n              </div>\n            )}\n          </main>\n\n          <DealModal\n            isOpen={!!selectedDeal}\n            onClose={() => setSelectedDeal(null)}\n            deal={selectedDeal}\n            isSubscriber={profile?.subscription_tier !== 'free'}\n          />\n        </div>\n      </PageTransition>\n    </Layout>\n  );\n} ","import React, { useEffect, useState, useRef } from 'react';\nimport { useAuth } from '../lib/auth';\nimport { Layout } from '../components/Layout';\nimport { \n  getConversations, \n  getMessages, \n  sendMessage, \n  subscribeToMessages,\n  searchUsers as searchUsersApi,\n  Conversation,\n  MessageWithProfiles,\n  User\n} from '../lib/messages';\nimport { Card, CardContent, CardHeader, CardTitle } from '../components/ui/card';\nimport { Input } from '../components/ui/input';\nimport { Button } from '../components/ui/button';\nimport { Avatar, AvatarFallback, AvatarImage } from '../components/ui/avatar';\nimport { ScrollArea } from '../components/ui/scroll-area';\nimport { Alert, AlertDescription, AlertTitle } from '../components/ui/alert';\nimport { LoadingSpinner } from '../components/ui/loading-spinner';\nimport { formatDistanceToNow } from 'date-fns';\nimport { Send, Search, Plus, ArrowLeft, MessageSquare, UserPlus, Users, Loader2 } from 'lucide-react';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n  DialogDescription,\n} from '../components/ui/dialog';\nimport { PageTransition } from '../components/ui/page-transition';\nimport { cn } from '../lib/utils';\nimport useSWR from 'swr';\nimport { supabase } from '../lib/supabase';\n\nexport default function Messages() {\n  const { user: authUser } = useAuth();\n  const [conversations, setConversations] = useState<Conversation[]>([]);\n  const [selectedConversation, setSelectedConversation] = useState<string | null>(null);\n  const [messages, setMessages] = useState<MessageWithProfiles[]>([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(true);\n  const [isMessagesLoading, setIsMessagesLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [searchResults, setSearchResults] = useState<any[]>([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const [isNewChatOpen, setIsNewChatOpen] = useState(false);\n  const [isMobileView, setIsMobileView] = useState(false);\n  const [mobileShowMessages, setMobileShowMessages] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const { data: session } = useSWR(\"session\", async () => {\n    const { data } = await supabase.auth.getSession();\n    console.log(\"SWR session check:\", { hasSession: !!data.session, sessionUser: data.session?.user?.id });\n    return data.session;\n  });\n\n  // Authentication state detection\n  const isAuthenticated = !!authUser || !!session;\n  \n  useEffect(() => {\n    console.log(\"Authentication state:\", { \n      authUser: !!authUser, \n      authUserId: authUser?.id,\n      session: !!session, \n      sessionUserId: session?.user?.id,\n      isAuthenticated\n    });\n  }, [authUser, session, isAuthenticated]);\n\n  // Determine if we're in mobile view\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobileView(window.innerWidth < 768);\n    };\n\n    handleResize(); // Set initial value\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Toggle mobile view when conversation is selected\n  useEffect(() => {\n    if (isMobileView && selectedConversation) {\n      setMobileShowMessages(true);\n    }\n  }, [selectedConversation, isMobileView]);\n\n  // Load initial conversations when authenticated\n  useEffect(() => {\n    if (isAuthenticated) {\n      console.log(\"User is authenticated, loading conversations\");\n      loadConversations();\n      const subscription = subscribeToMessages((message) => {\n        // When a new message arrives\n        if (message.sender_id === selectedConversation || \n            message.receiver_id === selectedConversation) {\n          // Add it to the current messages if it belongs to the selected conversation\n          setMessages(prev => [...prev, message]);\n        }\n        // Refresh conversations list to update last messages\n        loadConversations();\n      });\n\n      return () => {\n        subscription?.unsubscribe();\n      };\n    } else {\n      console.log(\"User is not authenticated\");\n      setError(\"Please sign in to view your messages\");\n      setIsLoading(false);\n    }\n  }, [isAuthenticated, selectedConversation]);\n\n  // Listen for auth state changes from Supabase directly\n  useEffect(() => {\n    const { data: authListener } = supabase.auth.onAuthStateChange((event, session) => {\n      console.log(\"Auth state change detected:\", event, !!session);\n      if (session && (event === 'SIGNED_IN' || event === 'INITIAL_SESSION')) {\n        console.log(\"Auth event triggered conversation loading\");\n        setError(null);\n        loadConversations();\n      }\n    });\n\n    return () => {\n      authListener.subscription.unsubscribe();\n    };\n  }, []);\n\n  // Load messages when conversation is selected\n  useEffect(() => {\n    if (selectedConversation) {\n      loadMessages(selectedConversation);\n    }\n  }, [selectedConversation]);\n\n  // Auto-scroll to bottom when messages change\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // Load all users when the new chat dialog opens\n  useEffect(() => {\n    if (isNewChatOpen) {\n      searchUsers('');\n    }\n  }, [isNewChatOpen]);\n\n  const loadConversations = async () => {\n    try {\n      setIsLoading(true);\n      const activeUser = session?.user || authUser;\n      \n      if (!activeUser?.id) {\n        console.log(\"No active user found for loading conversations\");\n        setConversations([]);\n        return;\n      }\n      \n      console.log(`Loading conversations for user: ${activeUser.id}`);\n      const data = await getConversations();\n      console.log(\"Loaded conversations:\", data);\n      setConversations(data);\n      setError(null);\n    } catch (error) {\n      console.error(\"Error getting conversations:\", error);\n      setError(\"Failed to load conversations. Please try again.\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const loadMessages = async (userId: string) => {\n    try {\n      setIsMessagesLoading(true);\n      const msgs = await getMessages(userId);\n      setMessages(msgs);\n    } catch (err) {\n      console.error('Error loading messages:', err);\n    } finally {\n      setIsMessagesLoading(false);\n    }\n  };\n\n  const handleSendMessage = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedConversation || !newMessage.trim()) return;\n\n    try {\n      const message = await sendMessage(selectedConversation, newMessage.trim());\n      if (message) {\n        // Message will be added by the subscription\n        setNewMessage('');\n      }\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const searchUsers = async (term: string) => {\n    setIsSearching(true);\n    try {\n      // Log that we're starting a search\n      console.log(`Starting user search with term: \"${term || 'all users'}\"`);\n      \n      // Use the searchUsers function from our messages utility\n      const results = await searchUsersApi(term);\n      \n      // Log the results for debugging\n      console.log(`Search returned ${results?.length || 0} users:`, results);\n      \n      setSearchResults(results || []);\n    } catch (error) {\n      console.error('Error searching users:', error);\n      setSearchResults([]);\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  const handleBackToConversations = () => {\n    setMobileShowMessages(false);\n  };\n\n  const startNewConversation = (user: User) => {\n    // Check if we already have a conversation with this user\n    const existingConversation = conversations.find(\n      (conv) => conv.user.id === user.id\n    );\n\n    if (existingConversation) {\n      setSelectedConversation(existingConversation.user.id);\n    } else {\n      // Create a new conversation\n      const newConversation: Conversation = {\n        user,\n        lastMessage: null,\n        unreadCount: 0,\n      };\n      setSelectedConversation(newConversation.user.id);\n    }\n    setIsNewChatOpen(false);\n  };\n\n  if (!isAuthenticated && !isLoading) {\n    return (\n      <Layout>\n        <PageTransition>\n          <div className=\"container mx-auto py-8 pt-24 px-4\">\n            <div className=\"max-w-md mx-auto\">\n              <Alert variant=\"destructive\" className=\"shadow-md\">\n                <AlertTitle className=\"font-semibold\">Authentication Required</AlertTitle>\n                <AlertDescription>\n                  Please sign in to view and send messages\n                </AlertDescription>\n              </Alert>\n            </div>\n          </div>\n        </PageTransition>\n      </Layout>\n    );\n  }\n\n  return (\n    <Layout>\n      <PageTransition>\n        <div className=\"bg-gradient-to-b from-blue-50 to-white min-h-screen\">\n          <div className=\"container mx-auto px-4 py-6 pt-20 md:pt-24\">\n            <h1 className=\"text-2xl font-bold mb-6 text-center\">Your Messages</h1>\n            <div className=\"grid grid-cols-1 gap-6 max-w-7xl mx-auto\">\n              <div className=\"flex flex-col md:flex-row md:gap-6 h-[calc(100vh-220px)] md:h-[calc(100vh-260px)]\">\n                {/* Conversations List - hidden on mobile when viewing messages */}\n                <div className={cn(\n                  \"md:w-1/3 lg:w-1/4 flex-shrink-0\",\n                  (isMobileView && mobileShowMessages) ? \"hidden\" : \"flex flex-col\"\n                )}>\n                  <Card className=\"flex-1 flex flex-col overflow-hidden shadow-lg border-2 border-blue-100 rounded-xl\">\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-4 border-b bg-blue-50\">\n                      <div className=\"flex items-center gap-2\">\n                        <MessageSquare className=\"h-5 w-5 text-blue-500\" />\n                        <CardTitle>Messages</CardTitle>\n                      </div>\n                      <Dialog open={isNewChatOpen} onOpenChange={setIsNewChatOpen}>\n                        <DialogTrigger asChild>\n                          <Button size=\"icon\" variant=\"outline\" className=\"rounded-full h-8 w-8 border-blue-200 bg-white\">\n                            <Plus className=\"h-4 w-4 text-blue-500\" />\n                          </Button>\n                        </DialogTrigger>\n                        <DialogContent>\n                          <DialogHeader>\n                            <DialogTitle className=\"flex items-center gap-2\">\n                              <UserPlus className=\"h-5 w-5 text-blue-500\" />\n                              New Conversation\n                            </DialogTitle>\n                          </DialogHeader>\n                          <div className=\"space-y-4\">\n                            <div className=\"flex gap-2\">\n                              <Input\n                                placeholder=\"Search users...\"\n                                value={searchTerm}\n                                onChange={(e) => {\n                                  setSearchTerm(e.target.value);\n                                }}\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") {\n                                    searchUsers(searchTerm);\n                                  }\n                                }}\n                                className=\"flex-1\"\n                              />\n                              <Button \n                                size=\"icon\" \n                                variant=\"ghost\" \n                                disabled={isSearching} \n                                className=\"shrink-0\"\n                                onClick={() => searchUsers(searchTerm)}\n                              >\n                                {isSearching ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Search className=\"h-4 w-4\" />}\n                              </Button>\n                            </div>\n                            <ScrollArea className=\"h-[300px]\">\n                              {isSearching && (\n                                <div className=\"flex justify-center items-center h-[100px]\">\n                                  <LoadingSpinner />\n                                </div>\n                              )}\n                              {!isSearching && searchResults.length === 0 && (\n                                <div className=\"text-center text-muted-foreground p-4 bg-muted/30 rounded-lg\">\n                                  <Users className=\"h-12 w-12 mx-auto mb-2 text-muted-foreground/50\" />\n                                  <p>No users found</p>\n                                  <p className=\"text-sm mt-2\">\n                                    {searchTerm ? `No users match \"${searchTerm}\"` : \"There are no other users in the system\"}\n                                  </p>\n                                  <div className=\"mt-4 text-sm\">\n                                    <p>Try the following:</p>\n                                    <ul className=\"list-disc text-left pl-8 mt-2 space-y-1\">\n                                      <li>Check if other users have registered</li>\n                                      <li>Make sure your internet connection is working</li>\n                                      <li>Try refreshing the page</li>\n                                      <li>Check your authentication status</li>\n                                    </ul>\n                                  </div>\n                                </div>\n                              )}\n                              {!isSearching && searchResults.map(user => (\n                                <div\n                                  key={user.id}\n                                  className=\"flex items-center gap-3 p-3 hover:bg-blue-50 rounded-lg cursor-pointer transition-colors\"\n                                  onClick={() => {\n                                    setSelectedConversation(user.id);\n                                    setIsNewChatOpen(false);\n                                  }}\n                                >\n                                  <Avatar className=\"h-10 w-10 border-2 border-blue-200\">\n                                    <AvatarImage src={user.avatar_url || undefined} />\n                                    <AvatarFallback className=\"bg-blue-100 text-blue-600\">\n                                      {user.full_name?.charAt(0) || user.email?.charAt(0) || 'U'}\n                                    </AvatarFallback>\n                                  </Avatar>\n                                  <div>\n                                    <p className=\"font-medium\">{user.full_name || user.email}</p>\n                                    {user.full_name && user.email && (\n                                      <p className=\"text-xs text-muted-foreground\">{user.email}</p>\n                                    )}\n                                  </div>\n                                </div>\n                              ))}\n                            </ScrollArea>\n                          </div>\n                        </DialogContent>\n                      </Dialog>\n                    </CardHeader>\n                    <CardContent className=\"flex-1 p-0 overflow-hidden\">\n                      {error && (\n                        <Alert variant=\"destructive\" className=\"m-3 shadow-sm\">\n                          <AlertDescription>{error}</AlertDescription>\n                        </Alert>\n                      )}\n                      \n                      {isLoading ? (\n                        <div className=\"flex justify-center items-center h-full\">\n                          <LoadingSpinner size=\"lg\" />\n                        </div>\n                      ) : conversations.length === 0 ? (\n                        <div className=\"flex flex-col items-center justify-center h-full text-center px-4 py-10 bg-blue-50/50\">\n                          <MessageSquare className=\"h-16 w-16 mb-4 text-blue-200\" />\n                          <h3 className=\"text-lg font-medium mb-2\">No conversations yet</h3>\n                          <p className=\"text-muted-foreground mb-6 max-w-xs\">\n                            Start a new conversation by clicking the plus icon above\n                          </p>\n                          <Button \n                            onClick={() => setIsNewChatOpen(true)}\n                            className=\"gap-2 bg-blue-500 hover:bg-blue-600\"\n                            size=\"sm\"\n                          >\n                            <UserPlus className=\"h-4 w-4\" />\n                            New Conversation\n                          </Button>\n                        </div>\n                      ) : (\n                        <ScrollArea className=\"h-full\">\n                          <div className=\"divide-y divide-blue-100\">\n                            {conversations.map((conversation) => (\n                              <div\n                                key={conversation.user.id}\n                                className={cn(\n                                  \"p-3 cursor-pointer hover:bg-blue-50 transition-colors\",\n                                  selectedConversation === conversation.user.id ? 'bg-blue-100' : ''\n                                )}\n                                onClick={() => setSelectedConversation(conversation.user.id)}\n                              >\n                                <div className=\"flex items-center gap-3\">\n                                  <Avatar className=\"h-12 w-12 border-2 border-blue-200\">\n                                    <AvatarImage src={conversation.user.avatar_url || undefined} />\n                                    <AvatarFallback className=\"bg-blue-100 text-blue-600\">\n                                      {conversation.user.full_name.charAt(0)}\n                                    </AvatarFallback>\n                                  </Avatar>\n                                  <div className=\"flex-1 min-w-0\">\n                                    <div className=\"flex items-center justify-between\">\n                                      <p className=\"font-medium truncate\">{conversation.user.full_name}</p>\n                                      <p className=\"text-xs text-muted-foreground whitespace-nowrap pl-2\">\n                                        {formatDistanceToNow(new Date(conversation.lastMessage.created_at), {\n                                          addSuffix: true,\n                                        })}\n                                      </p>\n                                    </div>\n                                    <div className=\"flex items-center justify-between mt-1\">\n                                      <p className=\"text-sm text-muted-foreground truncate\">\n                                        {conversation.lastMessage.sender_id === authUser.id && \"You: \"}\n                                        {conversation.lastMessage.content}\n                                      </p>\n                                      {conversation.unreadCount > 0 && (\n                                        <div className=\"bg-blue-500 text-white rounded-full h-5 min-w-5 px-1.5 flex items-center justify-center text-xs ml-2\">\n                                          {conversation.unreadCount}\n                                        </div>\n                                      )}\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                            ))}\n                          </div>\n                        </ScrollArea>\n                      )}\n                    </CardContent>\n                  </Card>\n                </div>\n\n                {/* Messages - shown on mobile only when a conversation is selected */}\n                <div className={cn(\n                  \"md:flex-1 flex flex-col overflow-hidden\",\n                  (isMobileView && !mobileShowMessages) ? \"hidden\" : \"flex flex-col\"\n                )}>\n                  <Card className=\"flex-1 flex flex-col overflow-hidden shadow-lg border-2 border-blue-100 rounded-xl\">\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 px-4 py-3 border-b bg-blue-50\">\n                      {selectedConversation ? (\n                        <>\n                          {isMobileView && (\n                            <Button \n                              variant=\"ghost\" \n                              size=\"icon\" \n                              className=\"mr-1 hover:bg-blue-100\" \n                              onClick={handleBackToConversations}\n                            >\n                              <ArrowLeft className=\"h-5 w-5 text-blue-500\" />\n                            </Button>\n                          )}\n                          {conversations.find(c => c.user.id === selectedConversation)?.user && (\n                            <div className=\"flex items-center gap-2 overflow-hidden\">\n                              <Avatar className=\"h-8 w-8 border-2 border-blue-200\">\n                                <AvatarImage \n                                  src={conversations.find(c => c.user.id === selectedConversation)?.user.avatar_url || undefined} \n                                />\n                                <AvatarFallback className=\"bg-blue-100 text-blue-600\">\n                                  {conversations.find(c => c.user.id === selectedConversation)?.user.full_name.charAt(0) || 'U'}\n                                </AvatarFallback>\n                              </Avatar>\n                              <div className=\"overflow-hidden\">\n                                <p className=\"font-medium text-sm truncate\">\n                                  {conversations.find(c => c.user.id === selectedConversation)?.user.full_name}\n                                </p>\n                              </div>\n                            </div>\n                          )}\n                        </>\n                      ) : (\n                        <div className=\"font-medium\">Messages</div>\n                      )}\n                    </CardHeader>\n                    <CardContent className=\"flex-1 p-0 overflow-hidden\">\n                      {selectedConversation ? (\n                        <div className=\"h-full flex flex-col\">\n                          {isMessagesLoading ? (\n                            <div className=\"flex-1 flex justify-center items-center\">\n                              <LoadingSpinner size=\"lg\" />\n                            </div>\n                          ) : (\n                            <ScrollArea className=\"flex-1 p-4\">\n                              {messages.length === 0 ? (\n                                <div className=\"h-full flex flex-col items-center justify-center text-center px-4 bg-blue-50/50\">\n                                  <MessageSquare className=\"h-16 w-16 mb-4 text-blue-200\" />\n                                  <h3 className=\"text-lg font-medium mb-2\">No messages yet</h3>\n                                  <p className=\"text-muted-foreground mb-6 max-w-xs\">\n                                    Send a message to start the conversation\n                                  </p>\n                                </div>\n                              ) : (\n                                <div className=\"space-y-4\">\n                                  {messages.map((message, index) => {\n                                    const isUser = message.sender_id === authUser.id;\n                                    const showAvatar = !isUser && (index === 0 || messages[index - 1].sender_id !== message.sender_id);\n                                    \n                                    return (\n                                      <div\n                                        key={message.id}\n                                        className={cn(\n                                          \"flex\",\n                                          isUser ? \"justify-end\" : \"justify-start\"\n                                        )}\n                                      >\n                                        {showAvatar ? (\n                                          <Avatar className=\"mr-2 mt-1 h-8 w-8 border-2 border-blue-200\">\n                                            <AvatarImage src={message.sender.avatar_url} />\n                                            <AvatarFallback className=\"bg-blue-100 text-blue-600\">\n                                              {message.sender.full_name.charAt(0)}\n                                            </AvatarFallback>\n                                          </Avatar>\n                                        ) : !isUser && (\n                                          <div className=\"w-10\" /> // Spacer to align messages\n                                        )}\n                                        <div\n                                          className={cn(\n                                            \"max-w-[75%] rounded-2xl px-4 py-2.5 break-words shadow-sm\",\n                                            isUser \n                                              ? \"bg-blue-500 text-white rounded-tr-none\" \n                                              : \"bg-blue-100 rounded-tl-none\"\n                                          )}\n                                        >\n                                          <p className=\"text-sm\">{message.content}</p>\n                                          <p className={cn(\n                                            \"text-xs mt-1\",\n                                            isUser ? \"text-blue-100\" : \"text-blue-500\"\n                                          )}>\n                                            {formatDistanceToNow(new Date(message.created_at), { addSuffix: true })}\n                                          </p>\n                                        </div>\n                                      </div>\n                                    );\n                                  })}\n                                  <div ref={messagesEndRef} />\n                                </div>\n                              )}\n                            </ScrollArea>\n                          )}\n\n                          <form onSubmit={handleSendMessage} className=\"p-3 border-t bg-blue-50\">\n                            <div className=\"flex gap-2\">\n                              <Input\n                                value={newMessage}\n                                onChange={e => setNewMessage(e.target.value)}\n                                placeholder=\"Type a message...\"\n                                className=\"flex-1 border-blue-200 bg-white\"\n                              />\n                              <Button \n                                type=\"submit\" \n                                className=\"shrink-0 bg-blue-500 hover:bg-blue-600\" \n                                disabled={!newMessage.trim()}\n                              >\n                                <Send className=\"h-4 w-4 mr-2\" />\n                                Send\n                              </Button>\n                            </div>\n                          </form>\n                        </div>\n                      ) : (\n                        <div className=\"h-full flex flex-col items-center justify-center text-center px-4 bg-blue-50/50\">\n                          <MessageSquare className=\"h-16 w-16 mb-4 text-blue-200\" />\n                          <h3 className=\"text-lg font-medium mb-2\">Select a conversation</h3>\n                          <p className=\"text-muted-foreground mb-6 max-w-xs\">\n                            Choose a conversation from the list or start a new one\n                          </p>\n                        </div>\n                      )}\n                    </CardContent>\n                  </Card>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </PageTransition>\n    </Layout>\n  );\n}\n\nconst NewConversationDialog: React.FC<{\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onSelectUser: (user: User) => void;\n}> = ({ open, onOpenChange, onSelectUser }) => {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [searchResults, setSearchResults] = useState<User[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [hasSearched, setHasSearched] = useState(false);\n\n  // Load all users when the dialog opens\n  useEffect(() => {\n    if (open) {\n      setIsLoading(true);\n      searchUsers(\"\")\n        .then((users) => {\n          console.log(\"Initial users loaded:\", users);\n          setSearchResults(users);\n          setHasSearched(true);\n        })\n        .catch((error) => {\n          console.error(\"Error loading initial users:\", error);\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    } else {\n      // Reset state when dialog closes\n      setSearchTerm(\"\");\n      setSearchResults([]);\n      setHasSearched(false);\n    }\n  }, [open]);\n\n  const handleSearch = async () => {\n    setIsLoading(true);\n    try {\n      const users = await searchUsers(searchTerm);\n      console.log(`Search results for \"${searchTerm}\":`, users);\n      setSearchResults(users);\n      setHasSearched(true);\n    } catch (error) {\n      console.error(\"Error searching users:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle>New Conversation</DialogTitle>\n          <DialogDescription>\n            Search for users to start a conversation\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"flex items-center space-x-2 mb-4\">\n          <Input\n            placeholder=\"Search by name or email\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\") {\n                handleSearch();\n              }\n            }}\n          />\n          <Button onClick={handleSearch} disabled={isLoading}>\n            {isLoading ? (\n              <Loader2 className=\"h-4 w-4 animate-spin\" />\n            ) : (\n              <Search className=\"h-4 w-4\" />\n            )}\n          </Button>\n        </div>\n\n        <div className=\"max-h-60 overflow-y-auto\">\n          {isLoading ? (\n            <div className=\"flex justify-center py-4\">\n              <Loader2 className=\"h-6 w-6 animate-spin\" />\n            </div>\n          ) : searchResults.length > 0 ? (\n            <ul className=\"space-y-2\">\n              {searchResults.map((user) => (\n                <li key={user.id}>\n                  <button\n                    className=\"flex items-center space-x-3 w-full p-2 rounded-md hover:bg-muted transition-colors\"\n                    onClick={() => onSelectUser(user)}\n                  >\n                    <Avatar>\n                      <AvatarImage\n                        src={user.avatar_url || undefined}\n                        alt={user.full_name || \"User\"}\n                      />\n                      <AvatarFallback>\n                        {(user.full_name || \"U\").substring(0, 2)}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"text-left\">\n                      <p className=\"font-medium\">{user.full_name}</p>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {user.email}\n                      </p>\n                    </div>\n                  </button>\n                </li>\n              ))}\n            </ul>\n          ) : hasSearched ? (\n            <div className=\"text-center py-4 text-muted-foreground\">\n              No users found. {searchTerm ? \"Try a different search term.\" : \"There are no other users in the system.\"}\n            </div>\n          ) : null}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}; ","// Get the API key from environment variables\nexport const PATMA_API_KEY = import.meta.env.VITE_PATMA_API_KEY || '';\n\n// Add other configuration values here\nexport const DEFAULT_SEARCH_RADIUS = 1; // miles\nexport const DEFAULT_PAGE_SIZE = 12; ","import { PATMA_API_KEY } from '@/config';\n\nconst API_BASE_URL = 'https://app.patma.co.uk';\nconst API_PATH = '/api/prospector/v1';\n\n// Common types\nexport interface ApiResponse<T> {\n  status: 'success' | 'error';\n  response_time: number;\n  data: T;\n}\n\nexport interface PatmaProperty {\n  id: string;\n  title: string;\n  price: number;\n  description: string;\n  location: {\n    address: string;\n    postcode: string;\n    city: string;\n  };\n  features: {\n    bedrooms: number;\n    bathrooms: number;\n    receptionRooms: number;\n    propertyType: string;\n    tenure: string;\n  };\n  images: string[];\n  floorArea: {\n    size: number;\n    unit: string;\n  };\n  agent: {\n    name: string;\n    phone: string;\n    email: string;\n  };\n  listingUrl: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface SearchFilters {\n  location?: string;\n  minPrice?: number;\n  maxPrice?: number;\n  minBeds?: number;\n  maxBeds?: number;\n  propertyType?: string;\n  radius?: number;\n  page?: number;\n  limit?: number;\n}\n\nexport interface SearchResponse {\n  properties: PatmaProperty[];\n  total: number;\n  page: number;\n  totalPages: number;\n}\n\nexport interface AskingPriceResponse {\n  status: string;\n  response_time: number;\n  data: {\n    data_points: number;\n    radius: number;\n    mean: number;\n    median: number;\n  };\n  postcode: string;\n  lat: number;\n  long: number;\n  bedrooms: number;\n  property_type: string;\n}\n\nexport interface AskingPriceParams {\n  postcode: string;\n  lat?: number;\n  long?: number;\n  bedrooms?: number;\n  property_type?: 'flat' | 'terraced' | 'semi-detached' | 'detached';\n  min_data_points?: number;\n}\n\nexport interface SoldProperty {\n  id?: string;\n  address: string;\n  postcode: string;\n  price?: number;\n  sale_price?: number;\n  date_of_transfer: string;\n  property_type: string;\n  old_new?: string;\n  duration?: string;\n  bedrooms?: number;\n  floor_area?: number;\n  floor_area_units?: string;\n  latitude?: number;\n  longitude?: number;\n  distance_miles?: number;\n  tenure?: string;\n  new_build?: boolean;\n  indexation_adjusted_price?: number;\n  // Investment metrics\n  estimated_rent?: number;\n  rental_yield?: number;\n  roi?: number;\n  estimated_growth?: number;\n}\n\nexport interface ListedProperty {\n  id?: string;\n  address: string;\n  postcode: string;\n  price?: number;\n  asking_price?: number;\n  date_listed?: string;\n  property_type: string;\n  bedrooms?: number;\n  description?: string;\n  images?: string[];\n  image_url?: string;\n  agent?: {\n    name: string;\n    phone: string;\n  };\n  tenure?: string;\n  new_build?: boolean;\n  floor_area?: number;\n  floor_area_units?: string;\n  latitude?: number;\n  longitude?: number;\n  distance_miles?: number;\n  most_recent_sale_date?: string;\n  most_recent_sale_price?: number;\n  // Investment metrics\n  estimated_rent?: number;\n  rental_yield?: number;\n  roi?: number;\n  estimated_growth?: number;\n}\n\nexport interface PriceHistory {\n  property_id: string;\n  price_changes: Array<{\n    date: string;\n    price: number;\n    type: 'reduction' | 'increase' | 'initial';\n  }>;\n}\n\nexport interface SoldPricesParams {\n  postcode: string;\n  location?: string;\n  lat?: number;\n  long?: number;\n  property_type: 'flat' | 'terraced' | 'semi-detached' | 'detached' | 'bungalow';\n  tenure?: 'freehold' | 'leasehold';\n  new_build?: 'true' | 'false';\n  max_age_months?: number;\n  min_data_points?: number;\n  apply_indexation?: boolean;\n  page?: number;\n  page_size?: number;\n  radius?: number;\n}\n\nexport interface PriceHistoryParams {\n  postcode: string;\n  property_type?: 'flat' | 'terraced' | 'semi-detached' | 'detached';\n}\n\nexport interface ListPropertyParams {\n  postcode: string;\n  location?: string;\n  lat?: number;\n  long?: number;\n  radius?: number;\n  polygon?: {\n    coordinates: number[][][];\n    type: 'Polygon';\n  };\n  property_type?: 'flat' | 'terraced' | 'semi-detached' | 'detached';\n  bedrooms?: number;\n  require_sold_price?: boolean;\n  require_size?: boolean;\n  include_sold_history?: boolean;\n  include_indexation_based_value?: boolean;\n  sort_by?: 'most_recent_sale_date' | 'distance';\n  page?: number;\n  page_size?: number;\n  records_after?: string; // Format: DD/MM/YYYY\n}\n\nexport interface PriceHistoryResponse {\n  status: string;\n  response_time: number;\n  data: {\n    trend_percentage: number;\n    data_points: Array<{\n      date: string;\n      price: number;\n    }>;\n  };\n}\n\ninterface ApiError {\n  message: string;\n  status?: number;\n}\n\nconst handleApiError = (error: any): never => {\n  if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {\n    throw new Error('Unable to connect to the API. Please check your internet connection and try again.');\n  }\n  \n  const apiError: ApiError = {\n    message: error.message || 'An unexpected error occurred',\n    status: error.status\n  };\n\n  if (error.response) {\n    apiError.status = error.response.status;\n    apiError.message = error.response.data?.message || error.message;\n  }\n\n  throw apiError;\n};\n\nconst fetchApi = async (endpoint: string, options: RequestInit = {}) => {\n  try {\n    const url = `${API_BASE_URL}${endpoint}`;\n    const response = await fetch(url, {\n      ...options,\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${PATMA_API_KEY}`,\n        ...options.headers,\n      },\n    });\n\n    if (!response.ok) {\n      const error = await response.json().catch(() => ({ message: 'An error occurred' }));\n      throw { status: response.status, message: error.message };\n    }\n\n    return await response.json();\n  } catch (error) {\n    return handleApiError(error);\n  }\n};\n\n// API functions\nexport async function searchProperties(filters: SearchFilters): Promise<SearchResponse> {\n  try {\n    const queryParams = new URLSearchParams();\n    \n    // Add filters to query params\n    if (filters.location) queryParams.append('location', filters.location);\n    if (filters.minPrice) queryParams.append('minPrice', filters.minPrice.toString());\n    if (filters.maxPrice) queryParams.append('maxPrice', filters.maxPrice.toString());\n    if (filters.minBeds) queryParams.append('minBeds', filters.minBeds.toString());\n    if (filters.maxBeds) queryParams.append('maxBeds', filters.maxBeds.toString());\n    if (filters.propertyType) queryParams.append('propertyType', filters.propertyType);\n    if (filters.radius) queryParams.append('radius', filters.radius.toString());\n    if (filters.page) queryParams.append('page', filters.page.toString());\n    if (filters.limit) queryParams.append('limit', filters.limit.toString());\n\n    const response = await fetch(`${API_BASE_URL}/properties/search?${queryParams.toString()}`, {\n      headers: {\n        'Authorization': `Bearer ${PATMA_API_KEY}`,\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || 'Failed to fetch properties');\n    }\n\n    const data = await response.json();\n    return {\n      properties: data.properties,\n      total: data.total,\n      page: data.page,\n      totalPages: data.totalPages,\n    };\n  } catch (error) {\n    console.error('Error searching properties:', error);\n    throw error;\n  }\n}\n\nexport async function getPropertyDetails(propertyId: string): Promise<PatmaProperty> {\n  try {\n    const response = await fetch(`${API_BASE_URL}/properties/${propertyId}`, {\n      headers: {\n        'Authorization': `Bearer ${PATMA_API_KEY}`,\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || 'Failed to fetch property details');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching property details:', error);\n    throw error;\n  }\n}\n\nexport async function getAskingPrices(params: AskingPriceParams): Promise<AskingPriceResponse> {\n  try {\n    const queryParams = new URLSearchParams();\n    \n    // Add all parameters to query params\n    queryParams.append('postcode', params.postcode);\n    if (params.lat) queryParams.append('lat', params.lat.toString());\n    if (params.long) queryParams.append('long', params.long.toString());\n    if (params.bedrooms) queryParams.append('bedrooms', params.bedrooms.toString());\n    if (params.property_type) queryParams.append('property_type', params.property_type);\n    if (params.min_data_points) queryParams.append('min_data_points', params.min_data_points.toString());\n\n    const url = `${API_BASE_URL}${API_PATH}/asking-prices/?${queryParams.toString()}`;\n    console.log('Fetching asking prices from:', url);\n\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Authorization': `Token ${PATMA_API_KEY}`,\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || 'Failed to fetch asking prices');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching asking prices:', error);\n    throw error;\n  }\n}\n\n// Get sold properties in an area\nexport async function getSoldProperties(params: SoldPricesParams) {\n  try {\n    const queryParams = new URLSearchParams();\n    \n    // Add parameters according to API spec\n    queryParams.append('postcode', params.postcode);\n    if (params.location) queryParams.append('location', params.location);\n    if (params.lat) queryParams.append('lat', params.lat.toString());\n    if (params.long) queryParams.append('long', params.long.toString());\n    queryParams.append('property_type', params.property_type);\n    if (params.tenure) queryParams.append('tenure', params.tenure);\n    if (params.new_build) queryParams.append('new_build', params.new_build);\n    if (params.max_age_months) queryParams.append('max_age_months', params.max_age_months.toString());\n    if (params.min_data_points) queryParams.append('min_data_points', params.min_data_points.toString());\n    if (params.apply_indexation !== undefined) queryParams.append('apply_indexation', params.apply_indexation.toString());\n\n    const url = `${API_BASE_URL}${API_PATH}/sold-prices/?${queryParams.toString()}`;\n    console.log('Fetching sold properties from:', url);\n\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Authorization': `Token ${PATMA_API_KEY}`,\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({ errors: ['Unknown error occurred'] }));\n      throw new Error(errorData.errors?.[0] || `HTTP error! status: ${response.status}`);\n    }\n\n    const data = await response.json();\n    console.log('Sold properties response:', data);\n    \n    // Check if the response contains errors\n    if (data.status === 'error' || data.errors) {\n      const errorMessage = Array.isArray(data.errors) \n        ? data.errors[0] \n        : data.message || 'Failed to fetch sold properties';\n      throw new Error(errorMessage);\n    }\n\n    // Check for the specific response structure we're seeing (same as listed properties)\n    if (data && data.data && Array.isArray(data.data.available_results)) {\n      return {\n        properties: data.data.available_results,\n        total: data.data.total_results_count || data.data.available_results.length,\n        totalPages: data.data.number_of_pages || Math.ceil(data.data.total_results_count / (params.page_size || 12))\n      };\n    }\n    \n    // Check if data exists and has the expected structure\n    if (data && data.data && Array.isArray(data.data.properties)) {\n      return {\n        properties: data.data.properties,\n        total: data.data.total || data.data.properties.length,\n        totalPages: data.data.total_pages || Math.ceil(data.data.properties.length / (params.page_size || 10))\n      };\n    }\n    \n    // Return empty result if no data\n    console.warn('Unexpected API response structure for sold properties:', data);\n    return { properties: [], total: 0, totalPages: 1 };\n  } catch (error) {\n    console.error('Error fetching sold properties:', error);\n    throw error;\n  }\n}\n\n// Get currently listed properties\nexport async function getListedProperties(params: ListPropertyParams) {\n  try {\n    const queryParams = new URLSearchParams();\n    \n    // Add all parameters according to API spec\n    queryParams.append('postcode', params.postcode);\n    if (params.location) queryParams.append('location', params.location);\n    if (params.lat) queryParams.append('lat', params.lat.toString());\n    if (params.long) queryParams.append('long', params.long.toString());\n    if (params.radius) queryParams.append('radius', params.radius.toString());\n    if (params.polygon) queryParams.append('polygon', JSON.stringify(params.polygon));\n    if (params.property_type) queryParams.append('property_type', params.property_type);\n    if (params.bedrooms) queryParams.append('bedrooms', params.bedrooms.toString());\n    if (params.require_sold_price !== undefined) queryParams.append('require_sold_price', params.require_sold_price.toString());\n    if (params.require_size !== undefined) queryParams.append('require_size', params.require_size.toString());\n    if (params.include_sold_history !== undefined) queryParams.append('include_sold_history', params.include_sold_history.toString());\n    if (params.include_indexation_based_value !== undefined) queryParams.append('include_indexation_based_value', params.include_indexation_based_value.toString());\n    if (params.sort_by) queryParams.append('sort_by', params.sort_by);\n    if (params.page) queryParams.append('page', params.page.toString());\n    if (params.page_size) queryParams.append('page_size', params.page_size.toString());\n    if (params.records_after) queryParams.append('records_after', params.records_after);\n\n    const url = `${API_BASE_URL}${API_PATH}/list-property/?${queryParams.toString()}`;\n    console.log('Fetching listed properties from:', url);\n\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Authorization': `Token ${PATMA_API_KEY}`,\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n    });\n\n    const data = await response.json();\n    console.log('Listed properties response:', data);\n\n    // Check if the response contains errors\n    if (data.status === 'error' || data.errors) {\n      const errorMessage = Array.isArray(data.errors) \n        ? data.errors[0] \n        : data.message || 'Failed to fetch listed properties';\n      throw new Error(errorMessage);\n    }\n\n    // Check for the specific response structure we're seeing\n    if (data && data.data && Array.isArray(data.data.available_results)) {\n      return {\n        properties: data.data.available_results,\n        total: data.data.total_results_count || data.data.available_results.length,\n        totalPages: data.data.number_of_pages || Math.ceil(data.data.total_results_count / (params.page_size || 12))\n      };\n    }\n\n    // Check if data exists and has the expected structure\n    if (data && data.properties) {\n      return {\n        properties: data.properties || [],\n        total: data.total || data.properties?.length || 0,\n        totalPages: data.total_pages || Math.ceil((data.properties?.length || 0) / (params.page_size || 10))\n      };\n    }\n\n    // If we have data but no properties array, check for nested data structure\n    if (data && data.data && data.data.properties) {\n      return {\n        properties: data.data.properties,\n        total: data.data.total || data.data.properties.length,\n        totalPages: data.data.total_pages || Math.ceil(data.data.properties.length / (params.page_size || 10))\n      };\n    }\n    \n    // Return empty result if no valid data structure found\n    console.warn('Unexpected API response structure:', data);\n    return { properties: [], total: 0, totalPages: 1 };\n  } catch (error) {\n    console.error('Error fetching listed properties:', error);\n    throw error;\n  }\n}\n\n// Get price history for a property\nexport async function getPriceHistory(params: PriceHistoryParams) {\n  try {\n    const queryParams = new URLSearchParams();\n    queryParams.append('postcode', params.postcode);\n    if (params.property_type) queryParams.append('property_type', params.property_type);\n\n    const url = `${API_BASE_URL}${API_PATH}/price-history/?${queryParams.toString()}`;\n    console.log('Fetching price history from:', url);\n\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Authorization': `Token ${PATMA_API_KEY}`,\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || 'Failed to fetch price history');\n    }\n\n    const data = await response.json();\n    return data;\n  } catch (error) {\n    console.error('Error fetching price history:', error);\n    throw error;\n  }\n} ","import React from 'react';\nimport { Layout } from '../components/Layout';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Card } from '@/components/ui/card';\nimport { LoadingSpinner } from '@/components/ui/loading-spinner';\nimport { useToast } from '@/components/ui/use-toast';\nimport { Bed, Home, MapPin, Search, Calendar, PoundSterling, TrendingUp, X, ExternalLink, Maximize, AreaChart, ArrowUpRight, ArrowDownRight, Info, SquareIcon, Building, Key } from 'lucide-react';\nimport { formatCurrency } from '@/lib/utils';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { AskingPrices } from '@/components/AskingPrices';\nimport { \n  getListedProperties, \n  getSoldProperties,\n  getPriceHistory,\n  getAskingPrices\n} from '@/lib/patmaService';\nimport type { \n  ListedProperty, \n  SoldProperty, \n  PriceHistoryResponse,\n  AskingPricesResponse\n} from '@/lib/patmaService';\n\ninterface AskingPricesData {\n  postcode: string;\n  data?: {\n    mean: number;\n    median: number;\n  };\n}\n\ntype PropertyType = 'flat' | 'terraced' | 'semi-detached' | 'detached' | 'bungalow' | 'any';\ntype PropertyTenure = 'freehold' | 'leasehold' | 'any';\n\ninterface Filters {\n  propertyType: PropertyType;\n  tenure: PropertyTenure;\n  minBeds: string;\n  radius: number;\n  page: number;\n  limit: number;\n  newBuild: boolean;\n  maxAgeMonths: number;\n  sortBy: 'most_recent_sale_date' | 'distance';\n}\n\ninterface AreaInsights {\n  askingPrices?: AskingPricesResponse;\n  priceHistory?: PriceHistoryResponse;\n  planningApplications?: any;\n  neighborhoodData?: any;\n}\n\nexport default function Listings() {\n  const [searchTerm, setSearchTerm] = React.useState('');\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [listedProperties, setListedProperties] = React.useState<ListedProperty[]>([]);\n  const [soldProperties, setSoldProperties] = React.useState<SoldProperty[]>([]);\n  const [areaInsights, setAreaInsights] = React.useState<AreaInsights>({});\n  const [viewMode, setViewMode] = React.useState<'listed' | 'sold'>('listed');\n  const [totalResults, setTotalResults] = React.useState(0);\n  const [totalPages, setTotalPages] = React.useState(1);\n  const { toast } = useToast();\n\n  const [filters, setFilters] = React.useState<Filters>({\n    propertyType: 'any',\n    tenure: 'any',\n    minBeds: '0',\n    radius: 1,\n    page: 1,\n    limit: 12,\n    newBuild: false,\n    maxAgeMonths: 18,\n    sortBy: 'most_recent_sale_date'\n  });\n\n  const [showPricePerSqft, setShowPricePerSqft] = React.useState(true);\n  const [showStampDuty, setShowStampDuty] = React.useState(true);\n  const [showPlanningApplications, setShowPlanningApplications] = React.useState(false);\n\n  const [selectedProperty, setSelectedProperty] = React.useState<ListedProperty | SoldProperty | null>(null);\n  const [isModalOpen, setIsModalOpen] = React.useState(false);\n\n  const displayProperties = React.useMemo(() => {\n    return viewMode === 'listed' ? listedProperties : soldProperties;\n  }, [viewMode, listedProperties, soldProperties]);\n\n  const fetchAreaInsights = async (postcode: string) => {\n    try {\n      const [askingPrices, priceHistory] = await Promise.all([\n        getAskingPrices({\n          postcode,\n          property_type: filters.propertyType === 'any' ? undefined : filters.propertyType,\n          bedrooms: filters.minBeds === '0' ? undefined : parseInt(filters.minBeds),\n          radius: filters.radius\n        }),\n        getPriceHistory({\n          postcode,\n          property_type: filters.propertyType === 'any' ? undefined : filters.propertyType,\n          max_age_months: filters.maxAgeMonths\n        }),\n        // Add more API calls here when we have the corresponding functions in patmaService.ts\n        // For example:\n        // getPlanningApplications({ postcode, radius: filters.radius }),\n        // getNeighborhoodData({ postcode })\n      ]);\n\n      setAreaInsights({\n        askingPrices,\n        priceHistory,\n        // When we implement the additional API calls:\n        // planningApplications,\n        // neighborhoodData\n      });\n    } catch (error) {\n      console.error('Error fetching area insights:', error);\n    }\n  };\n\n  // Function to get a property image from various potential sources\n  const getPropertyImageUrl = (property: any): string | null => {\n    // Check if we already have a direct image URL from the API\n    if (property.image_url && typeof property.image_url === 'string' && property.image_url.trim() !== '') {\n      console.log('Using direct image URL from API');\n      return property.image_url;\n    }\n    \n    // Check for image URLs in common property fields\n    const possibleImageFields = [\n      'main_image', \n      'photo_url', \n      'thumbnail',\n      'image'\n    ];\n    \n    for (const field of possibleImageFields) {\n      if (property[field] && typeof property[field] === 'string' && property[field].trim() !== '') {\n        console.log(`Found image in property.${field}`);\n        return property[field];\n      }\n    }\n    \n    // Look for property-software.uk URLs in any string field\n    // This approach scans all string properties for PaTMa image URLs\n    for (const key in property) {\n      if (typeof property[key] === 'string' && \n          property[key].includes('property-software.uk') && \n          (property[key].endsWith('.jpg') || property[key].endsWith('.jpeg') || property[key].endsWith('.png'))) {\n        console.log(`Found PaTMa image URL in property.${key}`);\n        return property[key];\n      }\n    }\n    \n    // Check if we have images/photos arrays\n    if (property.images && Array.isArray(property.images) && property.images.length > 0) {\n      // Try to find a property-software.uk URL first\n      const patmaImage = property.images.find((img: any) => \n        typeof img === 'string' && img.includes('property-software.uk')\n      );\n      \n      if (patmaImage) {\n        console.log('Found PaTMa image URL in images array');\n        return patmaImage;\n      }\n      \n      // Fallback to the first image\n      if (typeof property.images[0] === 'string') {\n        console.log('Using first image from images array');\n        return property.images[0];\n      }\n      \n      // Check if images contain objects with URLs\n      if (property.images[0] && typeof property.images[0] === 'object' && property.images[0].url) {\n        console.log('Using URL from first image object in images array');\n        return property.images[0].url;\n      }\n    }\n    \n    // Same check for photos array\n    if (property.photos && Array.isArray(property.photos) && property.photos.length > 0) {\n      const patmaPhoto = property.photos.find((img: any) => \n        typeof img === 'string' && img.includes('property-software.uk')\n      );\n      \n      if (patmaPhoto) {\n        console.log('Found PaTMa image URL in photos array');\n        return patmaPhoto;\n      }\n      \n      if (typeof property.photos[0] === 'string') {\n        console.log('Using first image from photos array');\n        return property.photos[0];\n      }\n      \n      if (property.photos[0] && typeof property.photos[0] === 'object' && property.photos[0].url) {\n        console.log('Using URL from first image object in photos array');\n        return property.photos[0].url;\n      }\n    }\n    \n    // Check sold_history for images\n    if (property.sold_history && Array.isArray(property.sold_history) && property.sold_history.length > 0) {\n      for (const historyItem of property.sold_history) {\n        if (!historyItem) continue;\n        \n        // Check for direct image fields in history item\n        for (const field of possibleImageFields) {\n          if (historyItem[field] && typeof historyItem[field] === 'string' && historyItem[field].trim() !== '') {\n            console.log(`Found image in sold_history item.${field}`);\n            return historyItem[field];\n          }\n        }\n        \n        // Check for property-software.uk URLs in any string field\n        for (const key in historyItem) {\n          if (typeof historyItem[key] === 'string' && \n              historyItem[key].includes('property-software.uk') && \n              (historyItem[key].endsWith('.jpg') || historyItem[key].endsWith('.jpeg') || historyItem[key].endsWith('.png'))) {\n            console.log(`Found PaTMa image URL in sold_history item.${key}`);\n            return historyItem[key];\n          }\n        }\n        \n        // Check arrays in history item\n        if (historyItem.images && Array.isArray(historyItem.images) && historyItem.images.length > 0) {\n          const patmaImage = historyItem.images.find((img: any) => \n            typeof img === 'string' && img.includes('property-software.uk')\n          );\n          \n          if (patmaImage) {\n            console.log('Found PaTMa image URL in sold_history images array');\n            return patmaImage;\n          }\n          \n          if (typeof historyItem.images[0] === 'string') {\n            console.log('Using first image from sold_history images array');\n            return historyItem.images[0];\n          }\n        }\n      }\n    }\n    \n    // If no image was found, return null\n    console.log('No image found for property');\n    return null;\n  };\n\n  const handleSearch = async () => {\n    if (!searchTerm) {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: \"Please enter a location or postcode\",\n      });\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n\n      // Check if the search term is a postcode (simple validation)\n      const isPostcode = /^[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}$/i.test(searchTerm.trim());\n      \n      // For area insights, we'll still try to use the search term as a postcode\n      // Fetch area insights in parallel with property search\n      fetchAreaInsights(searchTerm).catch(error => {\n        console.error('Error fetching area insights:', error);\n        toast({\n          variant: \"destructive\",\n          title: \"Warning\",\n          description: \"Could not fetch area insights. Some information may be missing.\",\n        });\n      });\n\n      if (viewMode === 'listed') {\n        try {\n          const listedResults = await getListedProperties({\n            postcode: searchTerm.trim(),\n            // If it doesn't look like a postcode, also pass it as a location\n            location: !isPostcode ? searchTerm.trim() : undefined,\n            radius: filters.radius,\n            property_type: filters.propertyType === 'any' ? undefined : filters.propertyType,\n            tenure: filters.tenure === 'any' ? undefined : filters.tenure,\n            bedrooms: filters.minBeds === '0' ? undefined : parseInt(filters.minBeds),\n            new_build: filters.newBuild || undefined,\n            page: filters.page,\n            page_size: filters.limit,\n            sort_by: filters.sortBy,\n            include_sold_history: true,\n            require_sold_price: true,\n            require_size: true\n          });\n          \n          // Print the ENTIRE API response structure - this is critical to find the images\n          console.log('COMPLETE API RESPONSE STRUCTURE:', JSON.stringify(listedResults, null, 2));\n          \n          const sampleProperty = listedResults.properties[0];\n          if (sampleProperty) {\n            console.log('COMPLETE SAMPLE PROPERTY STRUCTURE:', JSON.stringify(sampleProperty, null, 2));\n            \n            // Check for property URLs and IDs that might help find listings\n            console.log('KEY PROPERTY FIELDS FOR IMAGE LOOKUP:', {\n              listing_url: sampleProperty.listing_url,\n              property_url: sampleProperty.property_url,\n              url: sampleProperty.url,\n              id: sampleProperty.id,\n              rightmove_id: sampleProperty.rightmove_id,\n              zoopla_id: sampleProperty.zoopla_id,\n              uprn: sampleProperty.uprn,\n              listing_detail_url: sampleProperty.listing_detail_url\n            });\n          }\n          \n          // Process properties to extract and normalize data\n          const processedProperties = listedResults.properties.map((property: any, index: number) => {\n            // Deep copy to avoid mutation issues\n            let normalizedProperty = JSON.parse(JSON.stringify(property));\n            \n            // Ensure property ID is available in a consistent format\n            if (property.uprn) {\n              normalizedProperty.uprn = String(property.uprn);\n            }\n            \n            // PRICE HANDLING - use last_sold_price when available\n            if (property.last_sold_price) {\n              normalizedProperty.price = property.last_sold_price;\n            }\n            \n            // Find the best image URL for this property\n            normalizedProperty.image_url = getPropertyImageUrl(property);\n                        \n            // Ensure property_type is always set\n            if (!normalizedProperty.property_type && property.built_form) {\n              normalizedProperty.property_type = property.built_form;\n            } else if (!normalizedProperty.property_type) {\n              normalizedProperty.property_type = \"House\";\n            }\n            \n            return normalizedProperty;\n          });\n\n          // Add investment metrics if not provided by the API\n          const propertiesWithMetrics = processedProperties.map((property: any) => \n            addInvestmentMetrics(property)\n          );\n          \n          setListedProperties(propertiesWithMetrics);\n          setTotalResults(listedResults.total);\n          setTotalPages(listedResults.totalPages);\n          \n          if (listedResults.properties.length === 0) {\n            toast({\n              variant: \"default\",\n              title: \"No Results\",\n              description: \"No listed properties found for this search criteria. Try adjusting your filters.\",\n            });\n          }\n        } catch (error) {\n          console.error('Error fetching listed properties:', error);\n          toast({\n            variant: \"destructive\",\n            title: \"Error\",\n            description: error instanceof Error ? error.message : \"Could not fetch listed properties. Please check your search criteria and try again.\",\n          });\n          setListedProperties([]);\n          setTotalResults(0);\n          setTotalPages(1);\n        }\n      } else {\n        try {\n          const soldResults = await getSoldProperties({\n            postcode: searchTerm.trim(),\n            // If it doesn't look like a postcode, also pass it as a location\n            location: !isPostcode ? searchTerm.trim() : undefined,\n            radius: filters.radius,\n            property_type: filters.propertyType === 'any' ? 'flat' : filters.propertyType as any,\n            tenure: filters.tenure === 'any' ? undefined : filters.tenure,\n            max_age_months: filters.maxAgeMonths,\n            min_data_points: 20,\n            apply_indexation: true,\n            page: filters.page,\n            page_size: filters.limit\n          });\n          \n          // Log full response structure\n          console.log('Sold properties API response structure:', JSON.stringify(soldResults, null, 2).substring(0, 500) + '...');\n          if (soldResults.properties && soldResults.properties.length > 0) {\n            console.log('First sold property full object:', soldResults.properties[0]);\n          }\n          \n          // Process properties to normalize data structures and fix missing fields\n          const processedProperties = soldResults.properties.map((property: any) => {\n            // Create a deep copy to avoid mutation issues\n            let normalizedProperty = JSON.parse(JSON.stringify(property));\n            \n            // PRICE HANDLING\n            // Check all possible price field locations\n            if (!normalizedProperty.price && !normalizedProperty.sale_price) {\n              if (property.details?.price) {\n                normalizedProperty.price = property.details.price;\n              } else if (property.price_paid) {\n                normalizedProperty.sale_price = property.price_paid;\n              } else if (property.sale_price) {\n                normalizedProperty.sale_price = property.sale_price;\n              } else if (property.latest_sold_price) {\n                normalizedProperty.sale_price = property.latest_sold_price;\n              } else if (typeof property.price === 'string') {\n                // Sometimes price comes as a string with currency symbol\n                const priceMatch = property.price.match(/[\\d,]+/);\n                if (priceMatch) {\n                  normalizedProperty.price = parseInt(priceMatch[0].replace(/,/g, ''));\n                }\n              }\n            }\n            \n            // Ensure we have a numeric price\n            if (normalizedProperty.sale_price && typeof normalizedProperty.sale_price === 'string') {\n              const priceMatch = normalizedProperty.sale_price.match(/[\\d,]+/);\n              if (priceMatch) {\n                normalizedProperty.sale_price = parseInt(priceMatch[0].replace(/,/g, ''));\n              }\n            }\n\n            // IMAGE HANDLING - Use the same image getter for sold properties\n            normalizedProperty.image_url = getPropertyImageUrl(property);\n            \n            return normalizedProperty;\n          });\n          \n          // Add investment metrics if not provided by the API\n          const propertiesWithMetrics = processedProperties.map((property: any) => \n            addInvestmentMetrics(property)\n          );\n          \n          setSoldProperties(propertiesWithMetrics);\n          setTotalResults(soldResults.total);\n          setTotalPages(soldResults.totalPages);\n          \n          if (soldResults.properties.length === 0) {\n            toast({\n              variant: \"default\",\n              title: \"No Results\",\n              description: \"No sold properties found for this search criteria. Try adjusting your filters.\",\n            });\n          }\n        } catch (error) {\n          console.error('Error fetching sold properties:', error);\n          toast({\n            variant: \"destructive\",\n            title: \"Error\",\n            description: error instanceof Error ? error.message : \"Could not fetch sold properties. Please check your search criteria and try again.\",\n          });\n          setSoldProperties([]);\n          setTotalResults(0);\n          setTotalPages(1);\n        }\n      }\n\n    } catch (error) {\n      console.error('Search error:', error);\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: error instanceof Error ? error.message : \"An unexpected error occurred. Please try again.\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Function to calculate investment metrics if they're not provided by the API\n  const addInvestmentMetrics = <T extends ListedProperty | SoldProperty>(property: T): T => {\n    const propertyWithMetrics = { ...property };\n    \n    // Determine the actual price from various possible fields\n    const price = \n      propertyWithMetrics.price || \n      propertyWithMetrics.asking_price || \n      propertyWithMetrics.sale_price || \n      (propertyWithMetrics as any).price_paid ||\n      (propertyWithMetrics as any).latest_price ||\n      0;\n    \n    if (price > 0) {\n      // Calculate stamp duty (assuming standard purchase)\n      if (!propertyWithMetrics.stamp_duty) {\n        propertyWithMetrics.stamp_duty = calculateStampDuty(price);\n      }\n      \n      // Calculate price per square foot if size data is available\n      if (propertyWithMetrics.size_sq_meters && !propertyWithMetrics.price_per_sqft) {\n        propertyWithMetrics.price_per_sqft = calculatePricePerSqft(price, propertyWithMetrics.size_sq_meters, true);\n      } else if (propertyWithMetrics.size_sq_feet && !propertyWithMetrics.price_per_sqft) {\n        propertyWithMetrics.price_per_sqft = calculatePricePerSqft(price, propertyWithMetrics.size_sq_feet, false);\n      }\n      \n      // Only calculate rent estimates if not already provided\n      if (!propertyWithMetrics.estimated_rent) {\n        // Basic rent calculation (very simplified)\n        // In reality, this would be based on location, property type, size, etc.\n        let monthlyRentEstimate = 0;\n        \n        // Rough estimate based on property type and UK averages\n        // Typically annual rent is 3-5% of property value\n        const rentYieldFactor = 0.04; // 4% annual yield\n        const annualRent = price * rentYieldFactor;\n        monthlyRentEstimate = annualRent / 12;\n        \n        // Adjust based on bedrooms if available\n        if (propertyWithMetrics.bedrooms) {\n          // Slight adjustment based on number of bedrooms\n          const bedroomFactor = 1 + (propertyWithMetrics.bedrooms - 2) * 0.1; // 10% per bedroom difference from 2\n          monthlyRentEstimate *= Math.max(0.8, Math.min(bedroomFactor, 1.5)); // Cap between 0.8x and 1.5x\n        }\n        \n        propertyWithMetrics.estimated_rent = Math.round(monthlyRentEstimate);\n        \n        // Calculate rental yield\n        if (!propertyWithMetrics.rental_yield) {\n          const annualRent = propertyWithMetrics.estimated_rent * 12;\n          propertyWithMetrics.rental_yield = (annualRent / price) * 100;\n        }\n        \n        // Calculate ROI (simplified)\n        if (!propertyWithMetrics.roi) {\n          // Assume 5-year holding period with 3% annual price appreciation\n          const annualAppreciation = 0.03;\n          const holdingYears = 5;\n          const futureValue = price * Math.pow(1 + annualAppreciation, holdingYears);\n          const totalRent = propertyWithMetrics.estimated_rent * 12 * holdingYears;\n          const totalReturn = (futureValue - price) + totalRent;\n          propertyWithMetrics.roi = (totalReturn / price) * 100;\n        }\n        \n        // Estimated annual growth\n        if (!propertyWithMetrics.estimated_growth) {\n          // Based on historical UK property price growth\n          propertyWithMetrics.estimated_growth = 3.5;\n        }\n      }\n    }\n    \n    return propertyWithMetrics;\n  };\n\n  // Function to get a fallback image based on property type\n  const getPropertyTypeImage = (propertyType: string): string => {\n    // Convert to lowercase and handle variations\n    const type = propertyType?.toLowerCase() || '';\n    \n    if (type.includes('flat') || type.includes('apartment')) {\n      return '/images/property-types/flat.jpg';\n    } else if (type.includes('terrace') || type.includes('terraced')) {\n      return '/images/property-types/terraced.jpg';\n    } else if (type.includes('semi') || type.includes('semi-detached')) {\n      return '/images/property-types/semi-detached.jpg';\n    } else if (type.includes('detached')) {\n      return '/images/property-types/detached.jpg';\n    } else if (type.includes('bungalow')) {\n      return '/images/property-types/bungalow.jpg';\n    } else if (type.includes('house')) {\n      return '/images/property-types/house.jpg';\n    }\n    \n    // Default fallback\n    return '/images/property-types/house.jpg';\n  };\n\n  // Add a function to calculate stamp duty\n  const calculateStampDuty = (price: number, isBuyToLet: boolean = false, isFirstTimeBuyer: boolean = false) => {\n    // UK Stamp Duty rates as of 2023\n    if (price <= 0) return 0;\n    \n    let stampDuty = 0;\n    \n    if (isFirstTimeBuyer) {\n      // First-time buyer rates\n      if (price <= 425000) {\n        stampDuty = 0;\n      } else if (price <= 625000) {\n        stampDuty = (price - 425000) * 0.05;\n      } else {\n        // First-time buyers purchasing property over £625,000 don't get relief\n        isFirstTimeBuyer = false;\n      }\n    }\n    \n    if (!isFirstTimeBuyer) {\n      // Standard rates\n      if (price <= 250000) {\n        stampDuty = 0;\n      } else if (price <= 925000) {\n        stampDuty = (price - 250000) * 0.05;\n      } else if (price <= 1500000) {\n        stampDuty = (price - 925000) * 0.1 + (925000 - 250000) * 0.05;\n      } else {\n        stampDuty = (price - 1500000) * 0.12 + (1500000 - 925000) * 0.1 + (925000 - 250000) * 0.05;\n      }\n    }\n    \n    // Additional rate for buy-to-let/second homes\n    if (isBuyToLet) {\n      stampDuty += price * 0.03;\n    }\n    \n    return Math.round(stampDuty);\n  };\n  \n  // Add a utility function to calculate price per square foot/meter\n  const calculatePricePerSqft = (price: number, size: number, isMetric: boolean = false) => {\n    if (!price || !size || size <= 0) return null;\n    \n    if (isMetric) {\n      // Price per square meter\n      return Math.round(price / size);\n    } else {\n      // Price per square foot (convert from square meters if necessary)\n      const sizeInSqft = isMetric ? size * 10.764 : size;\n      return Math.round(price / sizeInSqft);\n    }\n  };\n\n  React.useEffect(() => {\n    if (searchTerm) {\n      handleSearch();\n    }\n  }, [viewMode, filters.page]);\n\n  // Ensure we have a valid property type when switching to sold properties view\n  React.useEffect(() => {\n    if (viewMode === 'sold' && filters.propertyType === 'any') {\n      setFilters(prev => ({ ...prev, propertyType: 'flat' }));\n    }\n  }, [viewMode, filters.propertyType]);\n\n  // Filter handlers\n  const handlePropertyTypeChange = (value: PropertyType) => {\n    setFilters(prev => ({ ...prev, propertyType: value, page: 1 }));\n  };\n\n  const handleTenureChange = (value: PropertyTenure) => {\n    setFilters(prev => ({ ...prev, tenure: value, page: 1 }));\n  };\n\n  const handleBedroomsChange = (value: string) => {\n    setFilters(prev => ({ ...prev, minBeds: value, page: 1 }));\n  };\n\n  const handleRadiusChange = (value: string) => {\n    setFilters(prev => ({ ...prev, radius: parseFloat(value), page: 1 }));\n  };\n\n  const handleSortChange = (value: typeof filters.sortBy) => {\n    setFilters(prev => ({ ...prev, sortBy: value, page: 1 }));\n  };\n\n  // Function to open the property modal\n  const openPropertyModal = (property: ListedProperty | SoldProperty) => {\n    setSelectedProperty(property);\n    setIsModalOpen(true);\n  };\n\n  // Function to close the property modal\n  const closePropertyModal = () => {\n    setIsModalOpen(false);\n    // Keep the property data for a moment to avoid UI jumps during the closing animation\n    setTimeout(() => setSelectedProperty(null), 300);\n  };\n\n  // Add a property details modal component\n  const PropertyModal = () => {\n    if (!selectedProperty) return null;\n    \n    const price = \n      selectedProperty.price || \n      selectedProperty.asking_price || \n      selectedProperty.sale_price || \n      (selectedProperty as any).price_paid ||\n      (selectedProperty as any).latest_price || \n      0;\n      \n    const isSoldProperty = 'date_of_transfer' in selectedProperty;\n    const isListedProperty = !isSoldProperty;\n    \n    // Just use the image URL from the property, no fallbacks\n    const imageUrl = selectedProperty.image_url;\n    \n    // Format postcode with fallback\n    const displayPostcode = selectedProperty.postcode || \n                          (selectedProperty.address && selectedProperty.address.match(/[A-Z]{1,2}[0-9][0-9A-Z]?\\s?[0-9][A-Z]{2}/i)?.[0]) || \n                          \"Not Available\";\n    \n    // Extract sale history data for chart\n    const hasSaleHistory = selectedProperty.sold_history && selectedProperty.sold_history.length > 0;\n    const saleHistoryData = hasSaleHistory \n      ? selectedProperty.sold_history\n          .filter((sale: any) => sale && sale.date && !isNaN(new Date(sale.date).getTime()) && sale.price && !isNaN(parseFloat(String(sale.price))))\n          .sort((a: any, b: any) => new Date(a.date).getTime() - new Date(b.date).getTime())\n      : [];\n    \n    // Calculate price growth percentage if multiple sales\n    const priceGrowth = saleHistoryData.length >= 2 \n      ? ((saleHistoryData[saleHistoryData.length - 1].price - saleHistoryData[0].price) / saleHistoryData[0].price) * 100\n      : null;\n    \n    // Simple mortgage calculation (very basic)\n    const calculateMortgage = (propertyPrice: number, downPaymentPercent: number = 25, interestRate: number = 4.5, termYears: number = 25) => {\n      const downPayment = propertyPrice * (downPaymentPercent / 100);\n      const loanAmount = propertyPrice - downPayment;\n      const monthlyInterest = interestRate / 100 / 12;\n      const totalPayments = termYears * 12;\n      \n      const monthlyPayment = loanAmount * (\n        monthlyInterest * Math.pow(1 + monthlyInterest, totalPayments)\n      ) / (\n        Math.pow(1 + monthlyInterest, totalPayments) - 1\n      );\n      \n      return {\n        downPayment,\n        loanAmount,\n        monthlyPayment,\n        totalPayments,\n        totalRepayment: monthlyPayment * totalPayments\n      };\n    };\n    \n    // Only calculate if we have a valid price\n    const mortgageDetails = price > 0 ? calculateMortgage(price) : null;\n    \n    return (\n      <div className={`fixed inset-0 z-50 flex items-center justify-center p-4 ${isModalOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'} transition-opacity duration-300`}>\n        {/* Modal backdrop */}\n        <div className=\"absolute inset-0 bg-black/60\" onClick={closePropertyModal} />\n        \n        {/* Modal content */}\n        <div className=\"relative bg-white rounded-lg shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col\">\n          {/* Close button */}\n          <button \n            onClick={closePropertyModal}\n            className=\"absolute top-4 right-4 z-10 bg-white/80 p-1 rounded-full hover:bg-white transition-colors\"\n          >\n            <X className=\"h-6 w-6\" />\n          </button>\n          \n          <div className=\"flex flex-col md:flex-row h-full overflow-hidden\">\n            {/* Property image(s) */}\n            <div className=\"w-full md:w-2/5 h-64 md:h-auto relative bg-gray-100\">\n              {imageUrl ? (\n                <img \n                  src={imageUrl}\n                  alt={selectedProperty.address || \"Property\"}\n                  className=\"w-full h-full object-cover\"\n                />\n              ) : (\n                <div className=\"w-full h-full flex items-center justify-center\">\n                  <Home className=\"h-16 w-16 text-gray-300\" />\n                  <p className=\"text-gray-400 text-sm mt-2\">No image available</p>\n                </div>\n              )}\n              \n              {/* Property type badge */}\n              <div className=\"absolute top-4 left-4\">\n                <span className=\"bg-white/90 text-black px-3 py-1 rounded-full text-sm font-medium\">\n                  {selectedProperty.property_type}\n                </span>\n              </div>\n              \n              {/* External link if available */}\n              {selectedProperty.listing_url && (\n                <a \n                  href={selectedProperty.listing_url} \n                  target=\"_blank\" \n                  rel=\"noopener noreferrer\"\n                  className=\"absolute bottom-4 left-4 bg-white/90 text-black px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1 hover:bg-white transition-colors\"\n                >\n                  <ExternalLink className=\"h-4 w-4\" />\n                  View Listing\n                </a>\n              )}\n            </div>\n            \n            {/* Property details */}\n            <div className=\"w-full md:w-3/5 p-6 overflow-y-auto\">\n              <h2 className=\"text-xl font-bold mb-2\">{selectedProperty.address}</h2>\n              <p className=\"text-3xl font-bold mb-4 text-emerald-600\">\n                {formatCurrency(price)}\n              </p>\n              \n              {/* Key property details */}\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6\">\n                <div className=\"flex flex-col\">\n                  <span className=\"text-sm text-gray-500\">Property Type</span>\n                  <div className=\"flex items-center gap-1 mt-1\">\n                    <Building className=\"h-4 w-4 text-gray-600\" />\n                    <span className=\"font-medium\">{selectedProperty.property_type || 'N/A'}</span>\n                  </div>\n                </div>\n                \n                {selectedProperty.bedrooms && (\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-sm text-gray-500\">Bedrooms</span>\n                    <div className=\"flex items-center gap-1 mt-1\">\n                      <Bed className=\"h-4 w-4 text-gray-600\" />\n                      <span className=\"font-medium\">{selectedProperty.bedrooms}</span>\n                    </div>\n                  </div>\n                )}\n                \n                {selectedProperty.bathrooms && (\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-sm text-gray-500\">Bathrooms</span>\n                    <div className=\"flex items-center gap-1 mt-1\">\n                      <div className=\"h-4 w-4 text-gray-600 flex items-center justify-center\">🛁</div>\n                      <span className=\"font-medium\">{selectedProperty.bathrooms}</span>\n                    </div>\n                  </div>\n                )}\n                \n                <div className=\"flex flex-col\">\n                  <span className=\"text-sm text-gray-500\">Postcode</span>\n                  <div className=\"flex items-center gap-1 mt-1\">\n                    <MapPin className=\"h-4 w-4 text-gray-600\" />\n                    <span className=\"font-medium\">{displayPostcode}</span>\n                  </div>\n                </div>\n                \n                <div className=\"flex flex-col\">\n                  <span className=\"text-sm text-gray-500\">Tenure</span>\n                  <div className=\"flex items-center gap-1 mt-1\">\n                    <Key className=\"h-4 w-4 text-gray-600\" />\n                    <span className=\"font-medium\">{selectedProperty.tenure || 'N/A'}</span>\n                  </div>\n                </div>\n                \n                {isSoldProperty && (\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-sm text-gray-500\">Sold Date</span>\n                    <div className=\"flex items-center gap-1 mt-1\">\n                      <Calendar className=\"h-4 w-4 text-gray-600\" />\n                      <span className=\"font-medium\">\n                        {new Date((selectedProperty as SoldProperty).date_of_transfer).toLocaleDateString()}\n                      </span>\n                    </div>\n                  </div>\n                )}\n                \n                {(selectedProperty.size_sq_feet || selectedProperty.size_sq_meters) && (\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-sm text-gray-500\">Size</span>\n                    <div className=\"flex items-center gap-1 mt-1\">\n                      <SquareIcon className=\"h-4 w-4 text-gray-600\" />\n                      <span className=\"font-medium\">\n                        {selectedProperty.size_sq_feet ? `${selectedProperty.size_sq_feet} sq.ft` : ''}\n                        {selectedProperty.size_sq_meters ? `${selectedProperty.size_sq_meters} m²` : ''}\n                      </span>\n                    </div>\n                  </div>\n                )}\n                \n                {selectedProperty.price_per_sqft && (\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-sm text-gray-500\">Price per sq.ft</span>\n                    <div className=\"flex items-center gap-1 mt-1\">\n                      <PoundSterling className=\"h-4 w-4 text-gray-600\" />\n                      <span className=\"font-medium\">{formatCurrency(selectedProperty.price_per_sqft)}</span>\n                    </div>\n                  </div>\n                )}\n              </div>\n              \n              {/* Investment dashboard section */}\n              <div className=\"mb-6 bg-gray-50 p-4 rounded-lg border border-gray-100\">\n                <h3 className=\"text-lg font-semibold mb-3 flex items-center\">\n                  <TrendingUp className=\"h-5 w-5 mr-2 text-emerald-600\" />\n                  Investment Dashboard\n                </h3>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  {/* ROI and Yield Section */}\n                  <div className=\"space-y-4\">\n                    {selectedProperty.estimated_rent && (\n                      <div className=\"bg-blue-50 p-3 rounded\">\n                        <p className=\"text-blue-800 text-sm font-medium\">Estimated Monthly Rent</p>\n                        <p className=\"text-blue-600 text-lg font-bold mt-1\">\n                          {formatCurrency(selectedProperty.estimated_rent)}/month\n                        </p>\n                        {selectedProperty.rental_yield && (\n                          <p className=\"text-blue-600 text-sm mt-1\">\n                            {selectedProperty.rental_yield.toFixed(1)}% yield\n                          </p>\n                        )}\n                      </div>\n                    )}\n                    \n                    {selectedProperty.roi && (\n                      <div className=\"bg-purple-50 p-3 rounded\">\n                        <p className=\"text-purple-800 text-sm font-medium\">5-Year ROI Estimate</p>\n                        <p className=\"text-purple-600 text-lg font-bold mt-1\">\n                          {selectedProperty.roi.toFixed(1)}%\n                        </p>\n                        {selectedProperty.estimated_growth && (\n                          <p className=\"text-purple-600 text-sm mt-1\">\n                            {selectedProperty.estimated_growth.toFixed(1)}% annual growth\n                          </p>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Mortgage Calculator Section */}\n                  {mortgageDetails && (\n                    <div className=\"bg-emerald-50 p-3 rounded\">\n                      <p className=\"text-emerald-800 text-sm font-medium\">Mortgage Estimate (25% deposit)</p>\n                      <p className=\"text-emerald-600 text-lg font-bold mt-1\">\n                        {formatCurrency(mortgageDetails.monthlyPayment)}/month\n                      </p>\n                      <div className=\"mt-2 text-sm text-emerald-700 space-y-1\">\n                        <div className=\"flex justify-between\">\n                          <span>Deposit (25%):</span>\n                          <span>{formatCurrency(mortgageDetails.downPayment)}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span>Loan amount:</span>\n                          <span>{formatCurrency(mortgageDetails.loanAmount)}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span>Term:</span>\n                          <span>25 years at 4.5%</span>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n                \n                {/* Cash Flow Analysis */}\n                {selectedProperty.estimated_rent && mortgageDetails && (\n                  <div className=\"mt-4 bg-white p-3 rounded border border-gray-100\">\n                    <p className=\"text-gray-800 text-sm font-medium\">Monthly Cash Flow Analysis</p>\n                    <div className=\"mt-2 space-y-1 text-sm\">\n                      <div className=\"flex justify-between\">\n                        <span>Rental Income:</span>\n                        <span className=\"text-emerald-600\">+{formatCurrency(selectedProperty.estimated_rent)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span>Mortgage Payment:</span>\n                        <span className=\"text-red-600\">-{formatCurrency(mortgageDetails.monthlyPayment)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span>Management (10%):</span>\n                        <span className=\"text-red-600\">-{formatCurrency(selectedProperty.estimated_rent * 0.1)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span>Maintenance (5%):</span>\n                        <span className=\"text-red-600\">-{formatCurrency(selectedProperty.estimated_rent * 0.05)}</span>\n                      </div>\n                      <div className=\"flex justify-between font-bold pt-2 border-t border-gray-100 mt-2\">\n                        <span>Net Cash Flow:</span>\n                        <span className={`${selectedProperty.estimated_rent - mortgageDetails.monthlyPayment - selectedProperty.estimated_rent * 0.15 > 0 ? 'text-emerald-600' : 'text-red-600'}`}>\n                          {formatCurrency(selectedProperty.estimated_rent - mortgageDetails.monthlyPayment - selectedProperty.estimated_rent * 0.15)}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                )}\n              </div>\n              \n              {/* Purchase costs breakdown */}\n              {selectedProperty.stamp_duty !== undefined && (\n                <div className=\"mb-6\">\n                  <h3 className=\"text-lg font-semibold mb-3\">Purchase Costs</h3>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div className=\"bg-amber-50 p-3 rounded\">\n                      <p className=\"text-amber-800 text-sm font-medium\">Stamp Duty</p>\n                      <p className=\"text-amber-600 text-lg font-bold mt-1\">\n                        {formatCurrency(selectedProperty.stamp_duty)}\n                      </p>\n                      <p className=\"text-amber-700 text-xs mt-2\">\n                        First-time buyer? You may qualify for lower rates.\n                      </p>\n                    </div>\n                    \n                    <div className=\"bg-emerald-50 p-3 rounded\">\n                      <p className=\"text-emerald-800 text-sm font-medium\">Total Purchase Cost</p>\n                      <p className=\"text-emerald-600 text-lg font-bold mt-1\">\n                        {formatCurrency(price + (selectedProperty.stamp_duty || 0))}\n                      </p>\n                      <div className=\"mt-2 text-sm text-emerald-700 space-y-1\">\n                        <div className=\"flex justify-between\">\n                          <span>Property price:</span>\n                          <span>{formatCurrency(price)}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span>Stamp duty:</span>\n                          <span>{formatCurrency(selectedProperty.stamp_duty || 0)}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span>Legal fees (est.):</span>\n                          <span>{formatCurrency(1500)}</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n              \n              {/* Area insights with visualization */}\n              {areaInsights.priceHistory?.data?.trend_percentage !== undefined && (\n                <div className=\"mb-6\">\n                  <h3 className=\"text-lg font-semibold mb-3 flex items-center\">\n                    <AreaChart className=\"h-5 w-5 mr-2 text-blue-600\" />\n                    Area Insights\n                  </h3>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div className=\"bg-cyan-50 p-3 rounded\">\n                      <p className=\"text-cyan-800 text-sm font-medium\">Area Price Trend</p>\n                      <div className=\"flex items-center gap-1 mt-1\">\n                        {areaInsights.priceHistory.data.trend_percentage > 0 ? (\n                          <ArrowUpRight className=\"h-5 w-5 text-emerald-600\" />\n                        ) : (\n                          <ArrowDownRight className=\"h-5 w-5 text-red-600\" />\n                        )}\n                        <p className={`text-lg font-bold ${areaInsights.priceHistory.data.trend_percentage > 0 ? 'text-emerald-600' : 'text-red-600'}`}>\n                          {areaInsights.priceHistory.data.trend_percentage.toFixed(1)}%\n                        </p>\n                      </div>\n                      <p className=\"text-cyan-600 text-sm mt-1\">Last 12 months</p>\n                      \n                      {/* Add simple visual trend indicator */}\n                      <div className=\"mt-3 h-10 bg-white rounded overflow-hidden\">\n                        <div \n                          className={`h-full ${areaInsights.priceHistory.data.trend_percentage > 0 ? 'bg-emerald-500' : 'bg-red-500'}`}\n                          style={{ width: `${Math.min(Math.abs(areaInsights.priceHistory.data.trend_percentage) * 3, 100)}%` }}\n                        ></div>\n                      </div>\n                    </div>\n                    \n                    {areaInsights.askingPrices?.data?.mean && (\n                      <div className=\"bg-teal-50 p-3 rounded\">\n                        <p className=\"text-teal-800 text-sm font-medium\">Average Area Price</p>\n                        <p className=\"text-teal-600 text-lg font-bold mt-1\">\n                          {formatCurrency(areaInsights.askingPrices.data.mean)}\n                        </p>\n                        {price > 0 && (\n                          <div>\n                            <p className=\"text-teal-600 text-sm mt-1\">\n                              This property is <strong>{price < areaInsights.askingPrices.data.mean ? 'below' : 'above'}</strong> average\n                            </p>\n                            \n                            {/* Add visual price comparison */}\n                            <div className=\"mt-3 relative h-10 bg-gray-100 rounded overflow-hidden\">\n                              <div className=\"absolute inset-0 flex\">\n                                <div className=\"h-full bg-teal-200\" style={{ width: '50%' }}></div>\n                                <div className=\"h-full bg-teal-300\" style={{ width: '50%' }}></div>\n                              </div>\n                              <div \n                                className=\"absolute top-0 h-full w-1 bg-black\"\n                                style={{ \n                                  left: '50%',\n                                  transform: 'translateX(-50%)'\n                                }}\n                              ></div>\n                              <div \n                                className=\"absolute top-0 h-full w-2 bg-emerald-600 rounded\"\n                                style={{ \n                                  left: `${Math.min(Math.max((price / areaInsights.askingPrices.data.mean) * 50, 10), 90)}%`,\n                                  transform: 'translateX(-50%)'\n                                }}\n                              ></div>\n                            </div>\n                            <div className=\"flex justify-between text-xs mt-1 text-gray-600\">\n                              <span>-50%</span>\n                              <span>Average</span>\n                              <span>+50%</span>\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n              \n              {/* Additional property details if available */}\n              {selectedProperty.description && (\n                <div className=\"mb-6\">\n                  <h3 className=\"text-lg font-semibold mb-2\">Description</h3>\n                  <p className=\"text-gray-600\">{selectedProperty.description}</p>\n                </div>\n              )}\n              \n              {/* If there are sold history records, show them with visualization */}\n              {hasSaleHistory && saleHistoryData.length > 0 && (\n                <div className=\"mb-6\">\n                  <h3 className=\"text-lg font-semibold mb-3 flex items-center\">\n                    <TrendingUp className=\"h-5 w-5 mr-2 text-amber-600\" />\n                    Sale History\n                  </h3>\n                  \n                  {/* Add price growth indicator if we have multiple sales */}\n                  {priceGrowth !== null && (\n                    <div className=\"mb-3 p-3 rounded bg-amber-50\">\n                      <div className=\"flex items-center\">\n                        <span className=\"text-amber-800 text-sm mr-2\">Total Price Growth:</span>\n                        <span className={`font-bold ${priceGrowth >= 0 ? 'text-emerald-600' : 'text-red-600'}`}>\n                          {priceGrowth >= 0 ? '+' : ''}{priceGrowth.toFixed(1)}%\n                        </span>\n                      </div>\n                      \n                      {/* Add time period */}\n                      {saleHistoryData.length >= 2 && (\n                        <div className=\"text-xs text-amber-700 mt-1\">\n                          Over {Math.round((new Date(saleHistoryData[saleHistoryData.length - 1].date).getTime() - \n                                          new Date(saleHistoryData[0].date).getTime()) / \n                                          (1000 * 60 * 60 * 24 * 365))} years \n                          ({new Date(saleHistoryData[0].date).getFullYear()} to {new Date(saleHistoryData[saleHistoryData.length - 1].date).getFullYear()})\n                        </div>\n                      )}\n                    </div>\n                  )}\n                  \n                  {/* Price history visualization */}\n                  {saleHistoryData.length >= 2 && (\n                    <div className=\"mb-4 bg-white p-3 rounded border border-gray-100\">\n                      <div className=\"h-32 relative\">\n                        {/* Simple chart visualization */}\n                        <div className=\"absolute bottom-0 left-0 right-0 flex items-end h-full\">\n                          {saleHistoryData.map((sale: any, idx: number) => {\n                            const maxPrice = Math.max(...saleHistoryData.map((s: any) => s.price));\n                            const height = (sale.price / maxPrice) * 100;\n                            const width = `${100 / saleHistoryData.length}%`;\n                            const margin = idx > 0 ? '0 0 0 1px' : '0';\n                            return (\n                              <div \n                                key={idx}\n                                className=\"bg-emerald-500 hover:bg-emerald-600 transition-colors relative group\"\n                                style={{ \n                                  height: `${height}%`,\n                                  width,\n                                  margin\n                                }}\n                              >\n                                {/* Tooltip on hover */}\n                                <div className=\"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 bg-black text-white text-xs rounded px-2 py-1 whitespace-nowrap\">\n                                  <div>{formatCurrency(sale.price)}</div>\n                                  <div>{new Date(sale.date).toLocaleDateString()}</div>\n                                </div>\n                              </div>\n                            );\n                          })}\n                        </div>\n                      </div>\n                      <div className=\"flex justify-between text-xs text-gray-500 mt-2\">\n                        {saleHistoryData.map((sale: any, idx: number) => (\n                          <div key={idx}>\n                            {new Date(sale.date).getFullYear()}\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n                  \n                  {/* Detailed sale history table */}\n                  <div className=\"space-y-2\">\n                    {saleHistoryData.map((sale: any, idx: number) => (\n                      <div key={idx} className=\"flex justify-between border-b border-gray-100 pb-2\">\n                        <div className=\"flex items-center gap-2\">\n                          <Calendar className=\"h-4 w-4 text-gray-600\" />\n                          <span>{new Date(sale.date).toLocaleDateString()}</span>\n                        </div>\n                        <span className=\"font-medium\">\n                          {typeof sale.price === 'number' && !isNaN(sale.price) \n                            ? formatCurrency(sale.price) \n                            : 'Price not available'}\n                        </span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n              \n              {/* Display nearby amenities if available */}\n              {selectedProperty.nearby_stations && selectedProperty.nearby_stations.length > 0 && (\n                <div className=\"mb-6\">\n                  <h3 className=\"text-lg font-semibold mb-3\">Nearby Transport</h3>\n                  <div className=\"space-y-2\">\n                    {selectedProperty.nearby_stations.map((station: any, idx: number) => (\n                      <div key={idx} className=\"flex justify-between border-b border-gray-100 pb-2\">\n                        <span>{station.name}</span>\n                        <span className=\"text-gray-600\">{station.distance} miles</span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n              \n              {/* Display nearby schools if available */}\n              {selectedProperty.nearby_schools && selectedProperty.nearby_schools.length > 0 && (\n                <div className=\"mb-6\">\n                  <h3 className=\"text-lg font-semibold mb-3\">Nearby Schools</h3>\n                  <div className=\"space-y-2\">\n                    {selectedProperty.nearby_schools.map((school: any, idx: number) => (\n                      <div key={idx} className=\"flex justify-between border-b border-gray-100 pb-2\">\n                        <span>{school.name}</span>\n                        <span className=\"text-gray-600\">{school.distance} miles</span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <Layout>\n      {/* Hero Section - Matching Deals page design */}\n      <div className=\"bg-background\">\n        <div className=\"relative\">\n          <div className=\"absolute inset-0\">\n            <div className=\"absolute inset-0 bg-gradient-to-r from-emerald-500 to-cyan-500 mix-blend-multiply\" />\n          </div>\n          <div className=\"relative px-4 py-24 sm:px-6 sm:py-32 lg:py-40 lg:px-8\">\n            <h1 className=\"text-center text-4xl font-extrabold tracking-tight text-white sm:text-5xl lg:text-6xl\">\n              Property Search\n            </h1>\n            <p className=\"mx-auto mt-6 max-w-lg text-center text-xl text-white sm:max-w-3xl\">\n              Search through thousands of properties, compare market prices, and make informed decisions with our comprehensive property data.\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\n        {/* Combined Search and Filters Section */}\n        <div className=\"bg-white rounded-xl shadow-md p-6 mb-8 -mt-16 relative z-10\">\n          <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6\">\n            <h2 className=\"text-2xl font-bold\">Find Properties</h2>\n            <div className=\"flex gap-2\">\n              <Button\n                variant={viewMode === 'listed' ? 'default' : 'outline'}\n                onClick={() => setViewMode('listed')}\n                className=\"min-w-[120px]\"\n              >\n                Listed Properties\n              </Button>\n              <Button\n                variant={viewMode === 'sold' ? 'default' : 'outline'}\n                onClick={() => setViewMode('sold')}\n                className=\"min-w-[120px]\"\n              >\n                Sold Properties\n              </Button>\n            </div>\n          </div>\n\n          <div className=\"space-y-6\">\n            {/* Filters Grid */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\n              <Select\n                value={filters.propertyType}\n                onValueChange={handlePropertyTypeChange}\n              >\n                <SelectTrigger className=\"w-full\">\n                  <SelectValue placeholder=\"Property Type\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {/* Only show \"Any Type\" for listed properties */}\n                  {viewMode === 'listed' && (\n                    <SelectItem value=\"any\">Any Type</SelectItem>\n                  )}\n                  <SelectItem value=\"flat\">Flat</SelectItem>\n                  <SelectItem value=\"terraced\">Terraced</SelectItem>\n                  <SelectItem value=\"semi-detached\">Semi-Detached</SelectItem>\n                  <SelectItem value=\"detached\">Detached</SelectItem>\n                  <SelectItem value=\"bungalow\">Bungalow</SelectItem>\n                </SelectContent>\n              </Select>\n\n              <Select\n                value={filters.tenure}\n                onValueChange={handleTenureChange}\n              >\n                <SelectTrigger className=\"w-full\">\n                  <SelectValue placeholder=\"Tenure\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"any\">Any Tenure</SelectItem>\n                  <SelectItem value=\"freehold\">Freehold</SelectItem>\n                  <SelectItem value=\"leasehold\">Leasehold</SelectItem>\n                </SelectContent>\n              </Select>\n\n              <Select\n                value={filters.minBeds}\n                onValueChange={handleBedroomsChange}\n              >\n                <SelectTrigger className=\"w-full\">\n                  <SelectValue placeholder=\"Min Bedrooms\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"0\">Any</SelectItem>\n                  {[1, 2, 3, 4, 5].map((num) => (\n                    <SelectItem key={num} value={num.toString()}>{num}+ beds</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n\n              <Select\n                value={filters.radius.toString()}\n                onValueChange={handleRadiusChange}\n              >\n                <SelectTrigger className=\"w-full\">\n                  <SelectValue placeholder=\"Search Radius\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {[0.25, 0.5, 1, 2, 5, 10].map((num) => (\n                    <SelectItem key={num} value={num.toString()}>{num} miles</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n\n              {viewMode === 'listed' && (\n                <Select\n                  value={filters.sortBy}\n                  onValueChange={handleSortChange}\n                >\n                  <SelectTrigger className=\"w-full\">\n                    <SelectValue placeholder=\"Sort By\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"most_recent_sale_date\">Most Recent Sale</SelectItem>\n                    <SelectItem value=\"distance\">Distance</SelectItem>\n                  </SelectContent>\n                </Select>\n              )}\n            </div>\n\n            {/* Search Bar */}\n            <div className=\"flex gap-4 mt-6\">\n              <Input\n                type=\"text\"\n                placeholder=\"Enter location (postcode, city, street, etc.)\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"flex-1 h-12\"\n              />\n              <Button\n                onClick={handleSearch}\n                className=\"h-12 px-8 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white hover:from-emerald-600 hover:to-cyan-600\"\n                disabled={isLoading}\n              >\n                {isLoading ? <LoadingSpinner size=\"sm\" /> : 'Search'}\n              </Button>\n            </div>\n\n            {/* Add advanced options toggles */}\n            <div className=\"mt-4 flex flex-wrap gap-4\">\n              <label className=\"flex items-center gap-2 text-sm\">\n                <input \n                  type=\"checkbox\" \n                  checked={showPricePerSqft} \n                  onChange={(e) => setShowPricePerSqft(e.target.checked)}\n                  className=\"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500\"\n                />\n                Show price per sq.ft\n              </label>\n              <label className=\"flex items-center gap-2 text-sm\">\n                <input \n                  type=\"checkbox\" \n                  checked={showStampDuty} \n                  onChange={(e) => setShowStampDuty(e.target.checked)}\n                  className=\"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500\"\n                />\n                Show stamp duty\n              </label>\n              <label className=\"flex items-center gap-2 text-sm\">\n                <input \n                  type=\"checkbox\" \n                  checked={showPlanningApplications} \n                  onChange={(e) => setShowPlanningApplications(e.target.checked)}\n                  className=\"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500\"\n                />\n                Show planning applications\n              </label>\n            </div>\n          </div>\n        </div>\n\n        {/* Results Section */}\n        {isLoading ? (\n          <div className=\"flex justify-center items-center h-64\">\n            <LoadingSpinner size=\"lg\" />\n          </div>\n        ) : displayProperties.length > 0 ? (\n          <>\n            {/* Area insights summary - show average prices, trends, etc. */}\n            {areaInsights.askingPrices?.data && (\n              <div className=\"mb-8 bg-white rounded-lg shadow p-6\">\n                <h3 className=\"text-lg font-semibold mb-4\">Area Insights for {searchTerm}</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                  <div className=\"bg-emerald-50 rounded-lg p-4\">\n                    <h4 className=\"text-emerald-800 text-sm font-medium mb-2\">Average Asking Price</h4>\n                    <p className=\"text-2xl font-bold text-emerald-700\">\n                      {formatCurrency(areaInsights.askingPrices.data.mean || 0)}\n                    </p>\n                  </div>\n                  \n                  <div className=\"bg-blue-50 rounded-lg p-4\">\n                    <h4 className=\"text-blue-800 text-sm font-medium mb-2\">Median Asking Price</h4>\n                    <p className=\"text-2xl font-bold text-blue-700\">\n                      {formatCurrency(areaInsights.askingPrices.data.median || 0)}\n                    </p>\n                  </div>\n                  \n                  {areaInsights.priceHistory?.data?.trend_percentage !== undefined && (\n                    <div className=\"bg-purple-50 rounded-lg p-4\">\n                      <h4 className=\"text-purple-800 text-sm font-medium mb-2\">Price Trend (12 months)</h4>\n                      <p className=\"text-2xl font-bold text-purple-700\">\n                        {areaInsights.priceHistory.data.trend_percentage.toFixed(1)}%\n                      </p>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n            \n            {/* Properties grid */}\n            <div className=\"mb-6\">\n              <h3 className=\"text-lg text-gray-600\">\n                Found {totalResults} {viewMode === 'listed' ? 'listed' : 'sold'} properties\n              </h3>\n            </div>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {displayProperties.map((property, index) => (\n                <Card \n                  key={`${property.address}-${index}`} \n                  className=\"overflow-hidden hover:shadow-lg transition-shadow duration-200 cursor-pointer\"\n                  onClick={() => openPropertyModal(property)}\n                >\n                  {viewMode === 'listed' ? (\n                    <>\n                      <div className=\"aspect-video relative bg-gray-100\">\n                        {property.image_url ? (\n                          <img\n                            src={property.image_url}\n                            alt={property.address || \"Property\"}\n                            className=\"w-full h-full object-cover\"\n                            loading=\"lazy\"\n                          />\n                        ) : (\n                          <div className=\"w-full h-full flex flex-col items-center justify-center\">\n                            <Home className=\"h-12 w-12 text-gray-300\" />\n                            <p className=\"text-gray-400 text-sm mt-2\">No image available</p>\n                          </div>\n                        )}\n                        <div className=\"absolute top-2 right-2 flex gap-2\">\n                          <span className=\"bg-white/90 text-black px-3 py-1 rounded-full text-sm font-medium\">\n                            {property.property_type}\n                          </span>\n                          {property.new_build && (\n                            <span className=\"bg-emerald-500/90 text-white px-3 py-1 rounded-full text-sm font-medium\">\n                              New Build\n                            </span>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"p-4\">\n                        <h3 className=\"font-semibold text-lg line-clamp-2 mb-2\">\n                          {property.address}\n                        </h3>\n                        <p className=\"text-2xl font-bold mb-3 text-emerald-600\">\n                          {formatCurrency(\n                            property.price || \n                            property.asking_price || \n                            property.last_sold_price ||\n                            (property as any).price_paid ||\n                            (property as any).latest_price || \n                            0\n                          )}\n                        </p>\n                        \n                        {/* Show price per sq ft if available and enabled */}\n                        {showPricePerSqft && property.price_per_sqft && (\n                          <p className=\"text-sm text-gray-600 mb-3\">\n                            {formatCurrency(property.price_per_sqft)}/sq.ft\n                            {property.size_sq_feet && ` · ${property.size_sq_feet} sq.ft`}\n                            {property.size_sq_meters && ` · ${property.size_sq_meters} m²`}\n                          </p>\n                        )}\n                        \n                        <div className=\"flex flex-wrap gap-4 text-sm text-gray-600 mb-3\">\n                          <div className=\"flex items-center gap-1\">\n                            <Bed className=\"h-4 w-4\" />\n                            <span>{property.bedrooms || 'N/A'}</span>\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <MapPin className=\"h-4 w-4\" />\n                            <span>{property.postcode}</span>\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <Home className=\"h-4 w-4\" />\n                            <span>{property.tenure || 'N/A'}</span>\n                          </div>\n                        </div>\n                        \n                        {/* Stamp Duty section */}\n                        {showStampDuty && property.stamp_duty !== undefined && (\n                          <div className=\"mt-2 mb-3\">\n                            <div className=\"flex justify-between items-center\">\n                              <span className=\"text-sm text-gray-600\">Stamp Duty:</span>\n                              <span className=\"font-medium\">{formatCurrency(property.stamp_duty)}</span>\n                            </div>\n                          </div>\n                        )}\n                        \n                        {/* Enhanced Investment Metrics */}\n                        {(property.estimated_rent || property.rental_yield || property.roi || property.estimated_growth) && (\n                          <div className=\"mt-3 pt-3 border-t border-gray-100\">\n                            <h4 className=\"text-sm font-semibold text-gray-700 mb-2\">Investment Potential</h4>\n                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs\">\n                              {property.estimated_rent && (\n                                <div className=\"bg-blue-50 p-2 rounded\">\n                                  <p className=\"text-blue-800 font-medium\">Est. Rent</p>\n                                  <p className=\"text-blue-600 font-bold\">{formatCurrency(property.estimated_rent)}/mo</p>\n                                </div>\n                              )}\n                              {property.rental_yield && (\n                                <div className=\"bg-emerald-50 p-2 rounded\">\n                                  <p className=\"text-emerald-800 font-medium\">Yield</p>\n                                  <p className=\"text-emerald-600 font-bold\">{property.rental_yield.toFixed(1)}%</p>\n                                </div>\n                              )}\n                              {property.roi && (\n                                <div className=\"bg-purple-50 p-2 rounded\">\n                                  <p className=\"text-purple-800 font-medium\">5yr ROI</p>\n                                  <p className=\"text-purple-600 font-bold\">{property.roi.toFixed(1)}%</p>\n                                </div>\n                              )}\n                              {property.estimated_growth && (\n                                <div className=\"bg-amber-50 p-2 rounded\">\n                                  <p className=\"text-amber-800 font-medium\">Growth</p>\n                                  <p className=\"text-amber-600 font-bold\">{property.estimated_growth.toFixed(1)}%</p>\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    </>\n                  ) : (\n                    <div className=\"p-4\">\n                      <h3 className=\"font-semibold text-lg line-clamp-2 mb-2\">\n                        {property.address}\n                      </h3>\n                      <p className=\"text-2xl font-bold mb-3 text-emerald-600\">\n                        {formatCurrency(\n                          property.sale_price || \n                          property.price || \n                          (property as any).price_paid || \n                          0\n                        )}\n                      </p>\n                      <div className=\"flex flex-wrap gap-4 text-sm text-gray-600 mb-3\">\n                        <div className=\"flex items-center gap-1\">\n                          <MapPin className=\"h-4 w-4\" />\n                          <span>{property.postcode}</span>\n                        </div>\n                        <div className=\"flex items-center gap-1\">\n                          <Home className=\"h-4 w-4\" />\n                          <span>{property.property_type}</span>\n                        </div>\n                        <div className=\"flex items-center gap-1\">\n                          <Calendar className=\"h-4 w-4\" />\n                          <span>Sold: {new Date(property.date_of_transfer).toLocaleDateString()}</span>\n                        </div>\n                        {property.bedrooms && (\n                          <div className=\"flex items-center gap-1\">\n                            <Bed className=\"h-4 w-4\" />\n                            <span>{property.bedrooms} beds</span>\n                          </div>\n                        )}\n                      </div>\n                      \n                      {/* Stamp Duty section */}\n                      {showStampDuty && property.stamp_duty !== undefined && (\n                        <div className=\"mt-2 mb-3\">\n                          <div className=\"flex justify-between items-center\">\n                            <span className=\"text-sm text-gray-600\">Stamp Duty:</span>\n                            <span className=\"font-medium\">{formatCurrency(property.stamp_duty)}</span>\n                          </div>\n                        </div>\n                      )}\n                      \n                      {/* Enhanced Investment Metrics */}\n                      {(property.estimated_rent || property.rental_yield || property.roi || property.estimated_growth) && (\n                        <div className=\"mt-3 pt-3 border-t border-gray-100\">\n                          <h4 className=\"text-sm font-semibold text-gray-700 mb-2\">Investment Potential</h4>\n                          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs\">\n                            {property.estimated_rent && (\n                              <div className=\"bg-blue-50 p-2 rounded\">\n                                <p className=\"text-blue-800 font-medium\">Est. Rent</p>\n                                <p className=\"text-blue-600 font-bold\">{formatCurrency(property.estimated_rent)}/mo</p>\n                              </div>\n                            )}\n                            {property.rental_yield && (\n                              <div className=\"bg-emerald-50 p-2 rounded\">\n                                <p className=\"text-emerald-800 font-medium\">Yield</p>\n                                <p className=\"text-emerald-600 font-bold\">{property.rental_yield.toFixed(1)}%</p>\n                              </div>\n                            )}\n                            {property.roi && (\n                              <div className=\"bg-purple-50 p-2 rounded\">\n                                <p className=\"text-purple-800 font-medium\">5yr ROI</p>\n                                <p className=\"text-purple-600 font-bold\">{property.roi.toFixed(1)}%</p>\n                              </div>\n                            )}\n                            {property.estimated_growth && (\n                              <div className=\"bg-amber-50 p-2 rounded\">\n                                <p className=\"text-amber-800 font-medium\">Growth</p>\n                                <p className=\"text-amber-600 font-bold\">{property.estimated_growth.toFixed(1)}%</p>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </Card>\n              ))}\n            </div>\n\n            {/* Pagination */}\n            {totalPages > 1 && (\n              <div className=\"mt-8 flex justify-center gap-2\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setFilters(f => ({ ...f, page: Math.max(1, f.page - 1) }))}\n                  disabled={filters.page === 1}\n                >\n                  Previous\n                </Button>\n                <span className=\"flex items-center px-4\">\n                  Page {filters.page} of {totalPages}\n                </span>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setFilters(f => ({ ...f, page: Math.min(totalPages, f.page + 1) }))}\n                  disabled={filters.page === totalPages}\n                >\n                  Next\n                </Button>\n              </div>\n            )}\n          </>\n        ) : (\n          <div className=\"text-center py-12\">\n            <p className=\"text-gray-600\">\n              No {viewMode} properties found. Try adjusting your search criteria.\n            </p>\n          </div>\n        )}\n      </main>\n      \n      {/* Render the modal component */}\n      <PropertyModal />\n    </Layout>\n  );\n} ","import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../components/ui/card\";\nimport { Input } from \"../../components/ui/input\";\nimport { Label } from \"../../components/ui/label\";\nimport { Slider } from \"../../components/ui/slider\";\nimport { Button } from \"../../components/ui/button\";\nimport { \n  CalculatorIcon, \n  PoundSterling,\n  Calendar,\n  Percent\n} from \"lucide-react\";\n\nconst MortgageCalculator = () => {\n  const [propertyValue, setPropertyValue] = useState(250000);\n  const [deposit, setDeposit] = useState(50000);\n  const [interestRate, setInterestRate] = useState(4.5);\n  const [mortgageTerm, setMortgageTerm] = useState(25);\n  const [monthlyPayment, setMonthlyPayment] = useState<number | null>(null);\n  const [totalRepayment, setTotalRepayment] = useState<number | null>(null);\n  const [totalInterest, setTotalInterest] = useState<number | null>(null);\n\n  const calculateMortgage = () => {\n    const loanAmount = propertyValue - deposit;\n    const monthlyInterestRate = interestRate / 100 / 12;\n    const numberOfPayments = mortgageTerm * 12;\n    \n    // Calculate monthly payment using the mortgage formula\n    const x = Math.pow(1 + monthlyInterestRate, numberOfPayments);\n    const monthly = (loanAmount * x * monthlyInterestRate) / (x - 1);\n    \n    const totalPaid = monthly * numberOfPayments;\n    const totalInterestPaid = totalPaid - loanAmount;\n    \n    setMonthlyPayment(monthly);\n    setTotalRepayment(totalPaid);\n    setTotalInterest(totalInterestPaid);\n  };\n\n  // Calculate loan to value ratio\n  const ltv = ((propertyValue - deposit) / propertyValue) * 100;\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center text-xl font-semibold\">\n          <CalculatorIcon className=\"mr-2 h-5 w-5\" />\n          Mortgage Payment Calculator\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"grid gap-6\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"property-value\">Property Value</Label>\n                <span className=\"text-sm text-muted-foreground\">£{propertyValue.toLocaleString()}</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <PoundSterling className=\"h-5 w-5 text-muted-foreground\" />\n                <Slider\n                  id=\"property-value\"\n                  min={50000}\n                  max={2000000}\n                  step={5000}\n                  defaultValue={[propertyValue]}\n                  onValueChange={(value) => setPropertyValue(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={propertyValue}\n                onChange={(e) => setPropertyValue(Number(e.target.value))}\n                className=\"mt-2\"\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"deposit\">Deposit</Label>\n                <span className=\"text-sm text-muted-foreground\">£{deposit.toLocaleString()} ({ltv.toFixed(1)}% LTV)</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <PoundSterling className=\"h-5 w-5 text-muted-foreground\" />\n                <Slider\n                  id=\"deposit\"\n                  min={0}\n                  max={propertyValue}\n                  step={5000}\n                  defaultValue={[deposit]}\n                  onValueChange={(value) => setDeposit(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={deposit}\n                onChange={(e) => setDeposit(Number(e.target.value))}\n                className=\"mt-2\"\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"interest-rate\">Interest Rate</Label>\n                <span className=\"text-sm text-muted-foreground\">{interestRate}%</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <Percent className=\"h-5 w-5 text-muted-foreground\" />\n                <Slider\n                  id=\"interest-rate\"\n                  min={0.1}\n                  max={15}\n                  step={0.1}\n                  defaultValue={[interestRate]}\n                  onValueChange={(value) => setInterestRate(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={interestRate}\n                onChange={(e) => setInterestRate(Number(e.target.value))}\n                className=\"mt-2\"\n                step={0.1}\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"mortgage-term\">Mortgage Term</Label>\n                <span className=\"text-sm text-muted-foreground\">{mortgageTerm} years</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <Calendar className=\"h-5 w-5 text-muted-foreground\" />\n                <Slider\n                  id=\"mortgage-term\"\n                  min={5}\n                  max={40}\n                  step={1}\n                  defaultValue={[mortgageTerm]}\n                  onValueChange={(value) => setMortgageTerm(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={mortgageTerm}\n                onChange={(e) => setMortgageTerm(Number(e.target.value))}\n                className=\"mt-2\"\n              />\n            </div>\n            \n            <Button \n              onClick={calculateMortgage} \n              className=\"w-full mt-4\"\n            >\n              Calculate\n            </Button>\n          </div>\n          \n          <div className=\"space-y-6\">\n            {monthlyPayment !== null && (\n              <div className=\"rounded-lg border p-6 shadow-sm\">\n                <h3 className=\"text-lg font-medium\">Mortgage Summary</h3>\n                \n                <div className=\"mt-4 space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Loan Amount:</div>\n                    <div className=\"text-right font-medium\">£{(propertyValue - deposit).toLocaleString()}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Monthly Payment:</div>\n                    <div className=\"text-right font-medium\">£{monthlyPayment.toFixed(2)}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Total Repayment:</div>\n                    <div className=\"text-right font-medium\">£{totalRepayment?.toFixed(2)}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Total Interest:</div>\n                    <div className=\"text-right font-medium\">£{totalInterest?.toFixed(2)}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2 pt-4 border-t\">\n                    <div className=\"text-muted-foreground\">Loan to Value (LTV):</div>\n                    <div className=\"text-right font-medium\">{ltv.toFixed(1)}%</div>\n                  </div>\n                </div>\n              </div>\n            )}\n            \n            <Card>\n              <CardContent className=\"pt-6\">\n                <h3 className=\"text-lg font-medium mb-2\">Tips</h3>\n                <ul className=\"space-y-2 text-sm text-muted-foreground list-disc pl-5\">\n                  <li>A higher deposit lowers your monthly payments and improves rates.</li>\n                  <li>Shorter mortgage terms have higher monthly payments but less total interest.</li>\n                  <li>Most lenders offer better rates for LTV under 75%.</li>\n                  <li>Consider fees and early repayment charges when comparing mortgages.</li>\n                </ul>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default MortgageCalculator; ","import * as React from \"react\";\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\";\nimport { CheckIcon } from \"@radix-ui/react-icons\";\n\nimport { cn } from \"../../lib/utils\";\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className,\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <CheckIcon className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n));\nCheckbox.displayName = CheckboxPrimitive.Root.displayName;\n\nexport { Checkbox };\n","import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../components/ui/card\";\nimport { Input } from \"../../components/ui/input\";\nimport { Label } from \"../../components/ui/label\";\nimport { Slider } from \"../../components/ui/slider\";\nimport { Button } from \"../../components/ui/button\";\nimport { Checkbox } from \"../../components/ui/checkbox\";\nimport { CalculatorIcon, PoundSterling, Building, UserRoundCheck } from \"lucide-react\";\n\nconst StampDutyCalculator = () => {\n  const [propertyValue, setPropertyValue] = useState(300000);\n  const [isFirstTimeBuyer, setIsFirstTimeBuyer] = useState(false);\n  const [isAdditionalProperty, setIsAdditionalProperty] = useState(false);\n  const [isNonUKResident, setIsNonUKResident] = useState(false);\n  const [stampDuty, setStampDuty] = useState<number | null>(null);\n  const [breakdown, setBreakdown] = useState<Array<{band: string, tax: number}>>([]);\n\n  // Calculate stamp duty based on UK rules (as of 2023)\n  const calculateStampDuty = () => {\n    let bands: {start: number, end: number | null, rate: number}[] = [];\n    let totalTax = 0;\n    let breakdownItems: Array<{band: string, tax: number}> = [];\n\n    // Standard rates for residential properties\n    if (isFirstTimeBuyer) {\n      // First-time buyer rates\n      bands = [\n        { start: 0, end: 425000, rate: 0 },\n        { start: 425000, end: 625000, rate: 0.05 },\n        { start: 625000, end: null, rate: 0.05 }\n      ];\n    } else {\n      // Standard residential rates\n      bands = [\n        { start: 0, end: 250000, rate: 0 },\n        { start: 250000, end: 925000, rate: 0.05 },\n        { start: 925000, end: 1500000, rate: 0.1 },\n        { start: 1500000, end: null, rate: 0.12 }\n      ];\n    }\n\n    // Additional property surcharge\n    const additionalRate = isAdditionalProperty ? 0.03 : 0;\n    \n    // Non-UK resident surcharge\n    const nonUKResidentRate = isNonUKResident ? 0.02 : 0;\n\n    // Calculate tax for each band\n    let remainingValue = propertyValue;\n    bands.forEach(band => {\n      if (remainingValue > 0) {\n        const bandWidth = band.end ? band.end - band.start : remainingValue;\n        const amountInBand = Math.min(remainingValue, bandWidth);\n        \n        // Calculate tax for this band\n        const bandRate = band.rate + additionalRate + nonUKResidentRate;\n        const bandTax = amountInBand * bandRate;\n        \n        if (bandTax > 0) {\n          // Add to breakdown\n          const bandLabel = band.end \n            ? `£${band.start.toLocaleString()} - £${band.end.toLocaleString()}` \n            : `Over £${band.start.toLocaleString()}`;\n          \n          breakdownItems.push({\n            band: `${bandLabel} @ ${(bandRate * 100).toFixed(1)}%`,\n            tax: bandTax\n          });\n        }\n        \n        totalTax += bandTax;\n        remainingValue -= amountInBand;\n      }\n    });\n\n    setStampDuty(totalTax);\n    setBreakdown(breakdownItems);\n  };\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center text-xl font-semibold\">\n          <CalculatorIcon className=\"mr-2 h-5 w-5\" />\n          Stamp Duty Land Tax Calculator\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"grid gap-6\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"property-value\">Property Value</Label>\n                <span className=\"text-sm text-muted-foreground\">£{propertyValue.toLocaleString()}</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <PoundSterling className=\"h-5 w-5 text-muted-foreground\" />\n                <Slider\n                  id=\"property-value\"\n                  min={40000}\n                  max={2000000}\n                  step={5000}\n                  defaultValue={[propertyValue]}\n                  onValueChange={(value) => setPropertyValue(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={propertyValue}\n                onChange={(e) => setPropertyValue(Number(e.target.value))}\n                className=\"mt-2\"\n              />\n            </div>\n            \n            <div className=\"space-y-3 pt-4\">\n              <div className=\"flex items-center space-x-2\">\n                <Checkbox \n                  id=\"first-time-buyer\" \n                  checked={isFirstTimeBuyer}\n                  onCheckedChange={(checked) => {\n                    setIsFirstTimeBuyer(checked === true);\n                    if (checked) setIsAdditionalProperty(false);\n                  }}\n                />\n                <Label \n                  htmlFor=\"first-time-buyer\"\n                  className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n                >\n                  First-time buyer\n                </Label>\n              </div>\n              \n              <div className=\"flex items-center space-x-2\">\n                <Checkbox \n                  id=\"additional-property\" \n                  checked={isAdditionalProperty}\n                  onCheckedChange={(checked) => {\n                    setIsAdditionalProperty(checked === true);\n                    if (checked) setIsFirstTimeBuyer(false);\n                  }}\n                  disabled={isFirstTimeBuyer}\n                />\n                <Label \n                  htmlFor=\"additional-property\"\n                  className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n                >\n                  Additional property (3% surcharge)\n                </Label>\n              </div>\n              \n              <div className=\"flex items-center space-x-2\">\n                <Checkbox \n                  id=\"non-uk-resident\" \n                  checked={isNonUKResident}\n                  onCheckedChange={(checked) => setIsNonUKResident(checked === true)}\n                />\n                <Label \n                  htmlFor=\"non-uk-resident\"\n                  className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n                >\n                  Non-UK resident (2% surcharge)\n                </Label>\n              </div>\n            </div>\n            \n            <Button \n              onClick={calculateStampDuty} \n              className=\"w-full mt-4\"\n            >\n              Calculate Stamp Duty\n            </Button>\n          </div>\n          \n          <div className=\"space-y-6\">\n            {stampDuty !== null && (\n              <div className=\"rounded-lg border p-6 shadow-sm\">\n                <h3 className=\"text-lg font-medium\">Stamp Duty Summary</h3>\n                \n                <div className=\"mt-4 space-y-4\">\n                  <div className=\"grid grid-cols-1 gap-2\">\n                    <div className=\"text-lg font-semibold text-center\">\n                      Total Stamp Duty: £{stampDuty.toFixed(2)}\n                    </div>\n                  </div>\n                  \n                  {breakdown.length > 0 && (\n                    <div className=\"pt-4 border-t\">\n                      <h4 className=\"text-sm font-medium mb-2\">Breakdown:</h4>\n                      {breakdown.map((item, index) => (\n                        <div key={index} className=\"grid grid-cols-2 gap-2 text-sm\">\n                          <div className=\"text-muted-foreground\">{item.band}</div>\n                          <div className=\"text-right\">£{item.tax.toFixed(2)}</div>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n            \n            <Card>\n              <CardContent className=\"pt-6\">\n                <h3 className=\"text-lg font-medium mb-2\">Notes</h3>\n                <ul className=\"space-y-2 text-sm text-muted-foreground list-disc pl-5\">\n                  <li>First-time buyers get relief on properties up to £625,000.</li>\n                  <li>Additional properties incur a 3% surcharge on all bands.</li>\n                  <li>Non-UK residents pay an additional 2% on all bands.</li>\n                  <li>This is for standard residential property in England and Northern Ireland.</li>\n                  <li>Different rates apply in Scotland and Wales.</li>\n                </ul>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default StampDutyCalculator; ","import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../components/ui/card\";\nimport { Input } from \"../../components/ui/input\";\nimport { Label } from \"../../components/ui/label\";\nimport { Button } from \"../../components/ui/button\";\nimport { Slider } from \"../../components/ui/slider\";\nimport { CalculatorIcon, PoundSterling, Home, BadgePercent } from \"lucide-react\";\n\nconst YieldCalculator = () => {\n  const [propertyValue, setPropertyValue] = useState(250000);\n  const [monthlyRent, setMonthlyRent] = useState(1200);\n  const [annualExpenses, setAnnualExpenses] = useState(2000);\n  const [grossYield, setGrossYield] = useState<number | null>(null);\n  const [netYield, setNetYield] = useState<number | null>(null);\n\n  const calculateYield = () => {\n    const annualRent = monthlyRent * 12;\n    const grossYieldValue = (annualRent / propertyValue) * 100;\n    const netYieldValue = ((annualRent - annualExpenses) / propertyValue) * 100;\n    \n    setGrossYield(grossYieldValue);\n    setNetYield(netYieldValue);\n  };\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center text-xl font-semibold\">\n          <BadgePercent className=\"mr-2 h-5 w-5\" />\n          Rental Yield Calculator\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"grid gap-6\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"property-value\">Property Value</Label>\n                <span className=\"text-sm text-muted-foreground\">£{propertyValue.toLocaleString()}</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <PoundSterling className=\"h-5 w-5 text-muted-foreground\" />\n                <Slider\n                  id=\"property-value\"\n                  min={50000}\n                  max={1000000}\n                  step={5000}\n                  defaultValue={[propertyValue]}\n                  onValueChange={(value) => setPropertyValue(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={propertyValue}\n                onChange={(e) => setPropertyValue(Number(e.target.value))}\n                className=\"mt-2\"\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"monthly-rent\">Monthly Rent</Label>\n                <span className=\"text-sm text-muted-foreground\">£{monthlyRent}</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <PoundSterling className=\"h-5 w-5 text-muted-foreground\" />\n                <Slider\n                  id=\"monthly-rent\"\n                  min={200}\n                  max={5000}\n                  step={50}\n                  defaultValue={[monthlyRent]}\n                  onValueChange={(value) => setMonthlyRent(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={monthlyRent}\n                onChange={(e) => setMonthlyRent(Number(e.target.value))}\n                className=\"mt-2\"\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"annual-expenses\">Annual Expenses</Label>\n                <span className=\"text-sm text-muted-foreground\">£{annualExpenses}</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <PoundSterling className=\"h-5 w-5 text-muted-foreground\" />\n                <Slider\n                  id=\"annual-expenses\"\n                  min={0}\n                  max={10000}\n                  step={100}\n                  defaultValue={[annualExpenses]}\n                  onValueChange={(value) => setAnnualExpenses(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={annualExpenses}\n                onChange={(e) => setAnnualExpenses(Number(e.target.value))}\n                className=\"mt-2\"\n              />\n            </div>\n            \n            <Button \n              onClick={calculateYield} \n              className=\"w-full mt-4\"\n            >\n              Calculate Yield\n            </Button>\n          </div>\n          \n          <div className=\"space-y-6\">\n            {grossYield !== null && (\n              <div className=\"rounded-lg border p-6 shadow-sm\">\n                <h3 className=\"text-lg font-medium\">Yield Results</h3>\n                \n                <div className=\"mt-4 space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Annual Rental Income:</div>\n                    <div className=\"text-right font-medium\">£{(monthlyRent * 12).toLocaleString()}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Annual Expenses:</div>\n                    <div className=\"text-right font-medium\">£{annualExpenses.toLocaleString()}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2 pt-4 border-t\">\n                    <div className=\"text-muted-foreground\">Gross Yield:</div>\n                    <div className=\"text-right font-medium\">{grossYield.toFixed(2)}%</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Net Yield:</div>\n                    <div className=\"text-right font-medium\">{netYield.toFixed(2)}%</div>\n                  </div>\n                </div>\n              </div>\n            )}\n            \n            <Card>\n              <CardContent className=\"pt-6\">\n                <h3 className=\"text-lg font-medium mb-2\">What Makes a Good Yield?</h3>\n                <ul className=\"space-y-2 text-sm text-muted-foreground list-disc pl-5\">\n                  <li><strong>Below 3%:</strong> Generally considered low yield</li>\n                  <li><strong>3-5%:</strong> Average yield in expensive areas like London</li>\n                  <li><strong>5-7%:</strong> Good yield for most UK locations</li>\n                  <li><strong>Above 7%:</strong> Excellent yield, but check location quality</li>\n                </ul>\n                \n                <div className=\"mt-4 text-sm text-muted-foreground\">\n                  <p>Remember to include all expenses when calculating net yield:</p>\n                  <ul className=\"list-disc pl-5 mt-2\">\n                    <li>Management fees</li>\n                    <li>Maintenance costs</li>\n                    <li>Insurance</li>\n                    <li>Service charges</li>\n                    <li>Void periods</li>\n                  </ul>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default YieldCalculator; ","import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../components/ui/card\";\nimport { Input } from \"../../components/ui/input\";\nimport { Label } from \"../../components/ui/label\";\nimport { Button } from \"../../components/ui/button\";\nimport { Slider } from \"../../components/ui/slider\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"../../components/ui/select\";\nimport { CalculatorIcon, PoundSterling, TrendingUp, BadgePercent } from \"lucide-react\";\n\nconst ROICalculator = () => {\n  const [purchasePrice, setPurchasePrice] = useState(250000);\n  const [renovationCost, setRenovationCost] = useState(25000);\n  const [stampDuty, setStampDuty] = useState(2500);\n  const [otherCosts, setOtherCosts] = useState(3000);\n  const [monthlyRent, setMonthlyRent] = useState(1200);\n  const [annualExpenses, setAnnualExpenses] = useState(2400);\n  const [holdingPeriod, setHoldingPeriod] = useState(5);\n  const [annualAppreciation, setAnnualAppreciation] = useState(3);\n  const [financingMethod, setFinancingMethod] = useState(\"cash\");\n  const [mortgageDeposit, setMortgageDeposit] = useState(62500); // 25% of purchase price\n  const [interestRate, setInterestRate] = useState(4.5);\n  const [mortgageTerm, setMortgageTerm] = useState(25);\n  \n  const [results, setResults] = useState<{\n    totalInvestment: number,\n    cashFlow: number,\n    cashOnCashReturn: number,\n    estimatedSalePrice: number,\n    totalProfit: number,\n    totalROI: number,\n    annualizedROI: number\n  } | null>(null);\n\n  const calculateROI = () => {\n    // Calculate total initial investment\n    const totalInvestment = financingMethod === \"cash\" \n      ? purchasePrice + renovationCost + stampDuty + otherCosts\n      : mortgageDeposit + renovationCost + stampDuty + otherCosts;\n    \n    // Calculate annual cash flow\n    const annualRent = monthlyRent * 12;\n    let annualMortgagePayments = 0;\n    \n    if (financingMethod === \"mortgage\") {\n      const loanAmount = purchasePrice - mortgageDeposit;\n      const monthlyInterestRate = interestRate / 100 / 12;\n      const numberOfPayments = mortgageTerm * 12;\n      \n      // Calculate monthly mortgage payment\n      const x = Math.pow(1 + monthlyInterestRate, numberOfPayments);\n      const monthlyPayment = (loanAmount * x * monthlyInterestRate) / (x - 1);\n      \n      annualMortgagePayments = monthlyPayment * 12;\n    }\n    \n    const annualCashFlow = annualRent - annualExpenses - annualMortgagePayments;\n    \n    // Calculate cash-on-cash return (annual cash flow / total investment)\n    const cashOnCashReturn = (annualCashFlow / totalInvestment) * 100;\n    \n    // Calculate future property value with appreciation\n    const estimatedSalePrice = purchasePrice * Math.pow(1 + (annualAppreciation / 100), holdingPeriod);\n    \n    // Calculate outstanding mortgage (if applicable)\n    let outstandingMortgage = 0;\n    if (financingMethod === \"mortgage\") {\n      const loanAmount = purchasePrice - mortgageDeposit;\n      const monthlyInterestRate = interestRate / 100 / 12;\n      const numberOfPayments = mortgageTerm * 12;\n      const monthlyPayment = (loanAmount * Math.pow(1 + monthlyInterestRate, numberOfPayments) * monthlyInterestRate) / (Math.pow(1 + monthlyInterestRate, numberOfPayments) - 1);\n      \n      // Calculate remaining balance after holding period\n      let balance = loanAmount;\n      for (let i = 0; i < holdingPeriod * 12; i++) {\n        const interestPayment = balance * monthlyInterestRate;\n        const principalPayment = monthlyPayment - interestPayment;\n        balance -= principalPayment;\n      }\n      \n      outstandingMortgage = Math.max(0, balance);\n    }\n    \n    // Calculate total profit\n    const totalCashFlow = annualCashFlow * holdingPeriod;\n    const equityGain = estimatedSalePrice - purchasePrice - outstandingMortgage;\n    const totalProfit = totalCashFlow + equityGain;\n    \n    // Calculate total ROI (total profit / total investment)\n    const totalROI = (totalProfit / totalInvestment) * 100;\n    \n    // Calculate annualized ROI\n    const annualizedROI = Math.pow(1 + (totalROI / 100), 1 / holdingPeriod) - 1;\n    \n    setResults({\n      totalInvestment,\n      cashFlow: annualCashFlow,\n      cashOnCashReturn,\n      estimatedSalePrice,\n      totalProfit,\n      totalROI,\n      annualizedROI: annualizedROI * 100\n    });\n  };\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center text-xl font-semibold\">\n          <TrendingUp className=\"mr-2 h-5 w-5\" />\n          Return on Investment (ROI) Calculator\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"space-y-4\">\n            <h3 className=\"text-lg font-medium\">Property Details</h3>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"purchase-price\">Purchase Price</Label>\n              <div className=\"flex\">\n                <span className=\"flex items-center bg-muted px-3 rounded-l-md\">£</span>\n                <Input\n                  id=\"purchase-price\"\n                  type=\"number\"\n                  value={purchasePrice}\n                  onChange={(e) => setPurchasePrice(Number(e.target.value))}\n                  className=\"rounded-l-none\"\n                />\n              </div>\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"renovation-cost\">Renovation Cost</Label>\n              <div className=\"flex\">\n                <span className=\"flex items-center bg-muted px-3 rounded-l-md\">£</span>\n                <Input\n                  id=\"renovation-cost\"\n                  type=\"number\"\n                  value={renovationCost}\n                  onChange={(e) => setRenovationCost(Number(e.target.value))}\n                  className=\"rounded-l-none\"\n                />\n              </div>\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"stamp-duty\">Stamp Duty</Label>\n              <div className=\"flex\">\n                <span className=\"flex items-center bg-muted px-3 rounded-l-md\">£</span>\n                <Input\n                  id=\"stamp-duty\"\n                  type=\"number\"\n                  value={stampDuty}\n                  onChange={(e) => setStampDuty(Number(e.target.value))}\n                  className=\"rounded-l-none\"\n                />\n              </div>\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"other-costs\">Other Costs (Legal, Survey, etc.)</Label>\n              <div className=\"flex\">\n                <span className=\"flex items-center bg-muted px-3 rounded-l-md\">£</span>\n                <Input\n                  id=\"other-costs\"\n                  type=\"number\"\n                  value={otherCosts}\n                  onChange={(e) => setOtherCosts(Number(e.target.value))}\n                  className=\"rounded-l-none\"\n                />\n              </div>\n            </div>\n            \n            <h3 className=\"text-lg font-medium pt-4\">Rental Income & Expenses</h3>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"monthly-rent\">Monthly Rent</Label>\n              <div className=\"flex\">\n                <span className=\"flex items-center bg-muted px-3 rounded-l-md\">£</span>\n                <Input\n                  id=\"monthly-rent\"\n                  type=\"number\"\n                  value={monthlyRent}\n                  onChange={(e) => setMonthlyRent(Number(e.target.value))}\n                  className=\"rounded-l-none\"\n                />\n              </div>\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"annual-expenses\">Annual Expenses</Label>\n              <div className=\"flex\">\n                <span className=\"flex items-center bg-muted px-3 rounded-l-md\">£</span>\n                <Input\n                  id=\"annual-expenses\"\n                  type=\"number\"\n                  value={annualExpenses}\n                  onChange={(e) => setAnnualExpenses(Number(e.target.value))}\n                  className=\"rounded-l-none\"\n                />\n              </div>\n            </div>\n            \n            <h3 className=\"text-lg font-medium pt-4\">Investment Details</h3>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"financing-method\">Financing Method</Label>\n              <Select \n                defaultValue={financingMethod}\n                onValueChange={(value) => setFinancingMethod(value)}\n              >\n                <SelectTrigger id=\"financing-method\">\n                  <SelectValue placeholder=\"Select financing method\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"cash\">Cash Purchase</SelectItem>\n                  <SelectItem value=\"mortgage\">Mortgage</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            \n            {financingMethod === \"mortgage\" && (\n              <>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"mortgage-deposit\">Mortgage Deposit</Label>\n                  <div className=\"flex\">\n                    <span className=\"flex items-center bg-muted px-3 rounded-l-md\">£</span>\n                    <Input\n                      id=\"mortgage-deposit\"\n                      type=\"number\"\n                      value={mortgageDeposit}\n                      onChange={(e) => setMortgageDeposit(Number(e.target.value))}\n                      className=\"rounded-l-none\"\n                    />\n                  </div>\n                  <div className=\"text-xs text-muted-foreground mt-1\">\n                    {((mortgageDeposit / purchasePrice) * 100).toFixed(1)}% of purchase price\n                  </div>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"interest-rate\">Interest Rate (%)</Label>\n                  <Input\n                    id=\"interest-rate\"\n                    type=\"number\"\n                    value={interestRate}\n                    onChange={(e) => setInterestRate(Number(e.target.value))}\n                    step={0.1}\n                  />\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"mortgage-term\">Mortgage Term (years)</Label>\n                  <Input\n                    id=\"mortgage-term\"\n                    type=\"number\"\n                    value={mortgageTerm}\n                    onChange={(e) => setMortgageTerm(Number(e.target.value))}\n                  />\n                </div>\n              </>\n            )}\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"holding-period\">Investment Holding Period (years)</Label>\n              <Input\n                id=\"holding-period\"\n                type=\"number\"\n                value={holdingPeriod}\n                onChange={(e) => setHoldingPeriod(Number(e.target.value))}\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"annual-appreciation\">Annual Property Appreciation (%)</Label>\n              <Input\n                id=\"annual-appreciation\"\n                type=\"number\"\n                value={annualAppreciation}\n                onChange={(e) => setAnnualAppreciation(Number(e.target.value))}\n                step={0.1}\n              />\n            </div>\n            \n            <Button \n              onClick={calculateROI} \n              className=\"w-full mt-4\"\n            >\n              Calculate ROI\n            </Button>\n          </div>\n          \n          <div className=\"space-y-6\">\n            {results && (\n              <div className=\"rounded-lg border p-6 shadow-sm\">\n                <h3 className=\"text-lg font-medium\">ROI Summary</h3>\n                \n                <div className=\"mt-4 space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Total Investment:</div>\n                    <div className=\"text-right font-medium\">£{results.totalInvestment.toLocaleString()}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Annual Cash Flow:</div>\n                    <div className=\"text-right font-medium\">£{results.cashFlow.toLocaleString()}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Cash-on-Cash Return:</div>\n                    <div className=\"text-right font-medium\">{results.cashOnCashReturn.toFixed(2)}%</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2 pt-4 border-t\">\n                    <div className=\"text-muted-foreground\">Estimated Sale Price:</div>\n                    <div className=\"text-right font-medium\">£{results.estimatedSalePrice.toLocaleString()}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Total Profit:</div>\n                    <div className=\"text-right font-medium\">£{results.totalProfit.toLocaleString()}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2 pt-4 border-t font-bold\">\n                    <div>Total ROI:</div>\n                    <div className=\"text-right\">{results.totalROI.toFixed(2)}%</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2 font-bold\">\n                    <div>Annualized ROI:</div>\n                    <div className=\"text-right\">{results.annualizedROI.toFixed(2)}%</div>\n                  </div>\n                </div>\n              </div>\n            )}\n            \n            <Card>\n              <CardContent className=\"pt-6\">\n                <h3 className=\"text-lg font-medium mb-2\">ROI Explained</h3>\n                <ul className=\"space-y-2 text-sm text-muted-foreground list-disc pl-5\">\n                  <li><strong>Cash-on-Cash Return:</strong> Annual cash flow divided by your initial investment.</li>\n                  <li><strong>Total ROI:</strong> Total profit (cash flow + equity gain) as a percentage of your investment.</li>\n                  <li><strong>Annualized ROI:</strong> The yearly rate of return that would give you the total ROI over the holding period.</li>\n                </ul>\n                \n                <div className=\"mt-4 text-sm text-muted-foreground\">\n                  <p>For buy-to-let investments, aim for:</p>\n                  <ul className=\"list-disc pl-5 mt-2\">\n                    <li>Cash-on-Cash Return: 5-8%</li>\n                    <li>Total ROI: 40%+ over 5 years</li>\n                    <li>Annualized ROI: 7%+</li>\n                  </ul>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default ROICalculator; ","import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../components/ui/card\";\nimport { Input } from \"../../components/ui/input\";\nimport { Label } from \"../../components/ui/label\";\nimport { Button } from \"../../components/ui/button\";\nimport { Slider } from \"../../components/ui/slider\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"../../components/ui/select\";\nimport { CalculatorIcon, PoundSterling, Home, ShieldCheck } from \"lucide-react\";\n\nconst AffordabilityCalculator = () => {\n  const [annualIncome, setAnnualIncome] = useState(60000);\n  const [additionalIncome, setAdditionalIncome] = useState(0);\n  const [deposit, setDeposit] = useState(40000);\n  const [monthlyDebts, setMonthlyDebts] = useState(500);\n  const [interestRate, setInterestRate] = useState(4.5);\n  const [mortgageTerm, setMortgageTerm] = useState(25);\n  const [loanToIncomeMultiplier, setLoanToIncomeMultiplier] = useState(4.5);\n  \n  const [results, setResults] = useState<{\n    maxMortgage: number,\n    maxPropertyPrice: number,\n    monthlyPayment: number,\n    affordabilityRatio: number,\n    stressTestedPayment: number,\n  } | null>(null);\n\n  const calculateAffordability = () => {\n    // Calculate max mortgage based on income multiples\n    const totalIncome = annualIncome + additionalIncome;\n    const maxMortgage = totalIncome * loanToIncomeMultiplier;\n    \n    // Calculate max property price\n    const maxPropertyPrice = maxMortgage + deposit;\n    \n    // Calculate expected monthly payment\n    const monthlyInterestRate = interestRate / 100 / 12;\n    const numberOfPayments = mortgageTerm * 12;\n    \n    // Calculate monthly payment using the mortgage formula\n    const x = Math.pow(1 + monthlyInterestRate, numberOfPayments);\n    const monthlyPayment = (maxMortgage * x * monthlyInterestRate) / (x - 1);\n    \n    // Calculate affordability ratio (monthly payment as % of monthly income)\n    const monthlyIncome = totalIncome / 12;\n    const affordabilityRatio = (monthlyPayment / monthlyIncome) * 100;\n    \n    // Calculate stress-tested payment (at interest rate + 3%)\n    const stressTestRate = (interestRate + 3) / 100 / 12;\n    const stressX = Math.pow(1 + stressTestRate, numberOfPayments);\n    const stressTestedPayment = (maxMortgage * stressX * stressTestRate) / (stressX - 1);\n    \n    setResults({\n      maxMortgage,\n      maxPropertyPrice,\n      monthlyPayment,\n      affordabilityRatio,\n      stressTestedPayment,\n    });\n  };\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center text-xl font-semibold\">\n          <ShieldCheck className=\"mr-2 h-5 w-5\" />\n          Mortgage Affordability Calculator\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"space-y-4\">\n            <h3 className=\"text-lg font-medium\">Income Details</h3>\n            \n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"annual-income\">Your Annual Income</Label>\n                <span className=\"text-sm text-muted-foreground\">£{annualIncome.toLocaleString()}</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <PoundSterling className=\"h-5 w-5 text-muted-foreground\" />\n                <Slider\n                  id=\"annual-income\"\n                  min={10000}\n                  max={200000}\n                  step={1000}\n                  defaultValue={[annualIncome]}\n                  onValueChange={(value) => setAnnualIncome(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={annualIncome}\n                onChange={(e) => setAnnualIncome(Number(e.target.value))}\n                className=\"mt-2\"\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"additional-income\">Additional Annual Income (e.g., partner)</Label>\n              <div className=\"flex\">\n                <span className=\"flex items-center bg-muted px-3 rounded-l-md\">£</span>\n                <Input\n                  id=\"additional-income\"\n                  type=\"number\"\n                  value={additionalIncome}\n                  onChange={(e) => setAdditionalIncome(Number(e.target.value))}\n                  className=\"rounded-l-none\"\n                />\n              </div>\n            </div>\n            \n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"deposit\">Deposit Available</Label>\n                <span className=\"text-sm text-muted-foreground\">£{deposit.toLocaleString()}</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <PoundSterling className=\"h-5 w-5 text-muted-foreground\" />\n                <Slider\n                  id=\"deposit\"\n                  min={0}\n                  max={200000}\n                  step={5000}\n                  defaultValue={[deposit]}\n                  onValueChange={(value) => setDeposit(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={deposit}\n                onChange={(e) => setDeposit(Number(e.target.value))}\n                className=\"mt-2\"\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"monthly-debts\">Monthly Debt Payments</Label>\n              <div className=\"flex\">\n                <span className=\"flex items-center bg-muted px-3 rounded-l-md\">£</span>\n                <Input\n                  id=\"monthly-debts\"\n                  type=\"number\"\n                  value={monthlyDebts}\n                  onChange={(e) => setMonthlyDebts(Number(e.target.value))}\n                  className=\"rounded-l-none\"\n                />\n              </div>\n              <div className=\"text-xs text-muted-foreground mt-1\">\n                Include credit cards, loans, car finance, etc.\n              </div>\n            </div>\n            \n            <h3 className=\"text-lg font-medium pt-4\">Mortgage Details</h3>\n            \n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"interest-rate\">Interest Rate (%)</Label>\n                <span className=\"text-sm text-muted-foreground\">{interestRate}%</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <Slider\n                  id=\"interest-rate\"\n                  min={1}\n                  max={10}\n                  step={0.1}\n                  defaultValue={[interestRate]}\n                  onValueChange={(value) => setInterestRate(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={interestRate}\n                onChange={(e) => setInterestRate(Number(e.target.value))}\n                className=\"mt-2\"\n                step={0.1}\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <Label htmlFor=\"mortgage-term\">Mortgage Term (years)</Label>\n                <span className=\"text-sm text-muted-foreground\">{mortgageTerm} years</span>\n              </div>\n              <div className=\"flex gap-2\">\n                <Slider\n                  id=\"mortgage-term\"\n                  min={5}\n                  max={40}\n                  step={1}\n                  defaultValue={[mortgageTerm]}\n                  onValueChange={(value) => setMortgageTerm(value[0])}\n                />\n              </div>\n              <Input\n                type=\"number\"\n                value={mortgageTerm}\n                onChange={(e) => setMortgageTerm(Number(e.target.value))}\n                className=\"mt-2\"\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"loan-to-income\">Loan to Income Multiple</Label>\n              <Select \n                defaultValue={loanToIncomeMultiplier.toString()}\n                onValueChange={(value) => setLoanToIncomeMultiplier(Number(value))}\n              >\n                <SelectTrigger id=\"loan-to-income\">\n                  <SelectValue placeholder=\"Select loan to income multiple\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"4\">4.0x income</SelectItem>\n                  <SelectItem value=\"4.5\">4.5x income</SelectItem>\n                  <SelectItem value=\"5\">5.0x income</SelectItem>\n                  <SelectItem value=\"5.5\">5.5x income</SelectItem>\n                  <SelectItem value=\"6\">6.0x income</SelectItem>\n                </SelectContent>\n              </Select>\n              <div className=\"text-xs text-muted-foreground mt-1\">\n                Lenders typically offer between 4-6x your annual income\n              </div>\n            </div>\n            \n            <Button \n              onClick={calculateAffordability} \n              className=\"w-full mt-4\"\n            >\n              Calculate Affordability\n            </Button>\n          </div>\n          \n          <div className=\"space-y-6\">\n            {results && (\n              <div className=\"rounded-lg border p-6 shadow-sm\">\n                <h3 className=\"text-lg font-medium\">Affordability Results</h3>\n                \n                <div className=\"mt-4 space-y-4\">\n                  <div className=\"flex flex-col items-center py-4 border-b\">\n                    <div className=\"text-muted-foreground text-sm\">Maximum Property Price</div>\n                    <div className=\"text-3xl font-bold mt-1\">£{results.maxPropertyPrice.toLocaleString()}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Maximum Mortgage:</div>\n                    <div className=\"text-right font-medium\">£{results.maxMortgage.toLocaleString()}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Monthly Payment:</div>\n                    <div className=\"text-right font-medium\">£{results.monthlyPayment.toFixed(2)}</div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <div className=\"text-muted-foreground\">Affordability Ratio:</div>\n                    <div className=\"text-right font-medium\">\n                      {results.affordabilityRatio.toFixed(1)}%\n                      <span className={`ml-2 px-2 py-0.5 text-xs rounded-full ${results.affordabilityRatio <= 35 ? 'bg-green-100 text-green-800' : results.affordabilityRatio <= 45 ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'}`}>\n                        {results.affordabilityRatio <= 35 ? 'Good' : results.affordabilityRatio <= 45 ? 'Moderate' : 'High'}\n                      </span>\n                    </div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-2 pt-4 border-t\">\n                    <div className=\"text-muted-foreground\">Stress Tested Payment:</div>\n                    <div className=\"text-right font-medium\">£{results.stressTestedPayment.toFixed(2)}</div>\n                    <div className=\"col-span-2 text-xs text-muted-foreground\">\n                      (Monthly payment if rates increase by 3%)\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n            \n            <Card>\n              <CardContent className=\"pt-6\">\n                <h3 className=\"text-lg font-medium mb-2\">Lender Requirements</h3>\n                <ul className=\"space-y-2 text-sm text-muted-foreground list-disc pl-5\">\n                  <li><strong>Affordability Ratio:</strong> Most lenders prefer this to be below 35% of your gross monthly income.</li>\n                  <li><strong>Debt-to-Income Ratio:</strong> Your total debt payments (including mortgage) should ideally be below 45% of income.</li>\n                  <li><strong>Stress Testing:</strong> Lenders will check if you can afford payments if interest rates rise by 3%.</li>\n                  <li><strong>Deposit:</strong> Higher deposits (15%+) typically secure better interest rates.</li>\n                </ul>\n                \n                <div className=\"mt-4 text-sm text-muted-foreground\">\n                  <p className=\"font-medium\">Additional costs to consider:</p>\n                  <ul className=\"list-disc pl-5 mt-2\">\n                    <li>Stamp Duty Land Tax</li>\n                    <li>Legal fees (typically £1,000-£1,500)</li>\n                    <li>Surveyor fees (£400-£1,500)</li>\n                    <li>Mortgage arrangement fees (£0-£2,000)</li>\n                    <li>Moving costs</li>\n                  </ul>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default AffordabilityCalculator; ","import React, { useEffect } from 'react';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"../components/ui/tabs\";\nimport MortgageCalculator from \"../components/calculators/MortgageCalculator\";\nimport StampDutyCalculator from \"../components/calculators/StampDutyCalculator\";\nimport YieldCalculator from \"../components/calculators/YieldCalculator\";\nimport ROICalculator from \"../components/calculators/ROICalculator\";\nimport AffordabilityCalculator from \"../components/calculators/AffordabilityCalculator\";\nimport HeroSection from \"../components/HeroSection\";\n\n// Add any other imports you might need\n\nconst Calculators = () => {\n  // For debugging - check if HeroSection is being initialized\n  useEffect(() => {\n    console.log(\"Calculators page mounted - HeroSection should render\");\n  }, []);\n\n  return (\n    <div className=\"flex flex-col min-h-screen\">\n      {/* Hero Section - ensure it's at the top and visible */}\n      <div className=\"w-full\">\n        <HeroSection\n          title=\"Property Investment Calculators\"\n          subtitle=\"Powerful tools to analyze investments, calculate mortgage payments, and estimate potential returns\"\n          showSearch={false}\n          showStats={false}\n          height=\"h-[400px]\"\n        />\n      </div>\n      \n      {/* Main Content - add some margin to ensure it's not overlapping with the hero */}\n      <div className=\"container mx-auto px-4 py-12 mt-6\">\n        <Tabs defaultValue=\"mortgage\" className=\"w-full\">\n          <TabsList className=\"w-full mb-8\">\n            <div className=\"grid w-full grid-cols-1 sm:grid-cols-3 md:grid-cols-5 gap-2\">\n              <TabsTrigger value=\"mortgage\" className=\"w-full\">Mortgage</TabsTrigger>\n              <TabsTrigger value=\"stampduty\" className=\"w-full\">Stamp Duty</TabsTrigger>\n              <TabsTrigger value=\"yield\" className=\"w-full\">Rental Yield</TabsTrigger>\n              <TabsTrigger value=\"roi\" className=\"w-full\">ROI</TabsTrigger>\n              <TabsTrigger value=\"affordability\" className=\"w-full\">Affordability</TabsTrigger>\n            </div>\n          </TabsList>\n          \n          <TabsContent value=\"mortgage\" className=\"mt-6\">\n            <MortgageCalculator />\n          </TabsContent>\n          \n          <TabsContent value=\"stampduty\" className=\"mt-6\">\n            <StampDutyCalculator />\n          </TabsContent>\n          \n          <TabsContent value=\"yield\" className=\"mt-6\">\n            <YieldCalculator />\n          </TabsContent>\n          \n          <TabsContent value=\"roi\" className=\"mt-6\">\n            <ROICalculator />\n          </TabsContent>\n          \n          <TabsContent value=\"affordability\" className=\"mt-6\">\n            <AffordabilityCalculator />\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n};\n\nexport default Calculators; ","import { Suspense, useEffect, useState } from \"react\";\nimport { Routes, Route, Navigate, useLocation, useParams } from \"react-router-dom\";\nimport { Toaster } from \"./components/ui/toaster\";\nimport { AuthProvider, useAuth } from \"./lib/auth\";\nimport { Loading } from \"./components/ui/loading\";\nimport { ProgressBar } from \"./components/ui/progress-bar\";\nimport Header from './components/Header';\nimport Home from \"./components/home\";\nimport Dashboard from \"./components/Dashboard\";\nimport PricingPage from \"./components/PricingPage\";\nimport SubscriptionSuccess from \"./components/SubscriptionSuccess\";\nimport SubscriptionCancel from \"./components/SubscriptionCancel\";\nimport AccountSettings from \"./components/AccountSettings\";\nimport NotFound from \"./components/NotFound\";\nimport MarketInsightsPage from \"./components/MarketInsightsPage\";\nimport MarketTrendsPage from \"./components/MarketTrendsPage\";\nimport { ArticlePage } from \"./components/ArticlePage\";\nimport ResearchPage from \"./components/ResearchPage\";\nimport BlogPage from \"./components/BlogPage\";\nimport HelpSupportPage from \"./components/HelpSupportPage\";\nimport { ChatBot } from \"./components/ChatBot\";\nimport AuthCallback from \"./components/AuthCallback\";\nimport PropertyManagementPage from \"./components/PropertyManagementPage\";\nimport InvestmentOpportunitiesPage from \"./components/InvestmentOpportunitiesPage\";\nimport AboutUsPage from \"./components/AboutUsPage\";\nimport DealsPage from \"./components/DealsPage\";\nimport Messages from \"./pages/Messages\";\nimport Listings from './pages/Listings';\nimport Calculators from \"./pages/Calculators\";\n\n// Add a wrapper component for ArticlePage that extracts URL parameters\nfunction ArticlePageWrapper() {\n  const { title } = useParams();\n  \n  // Provide default or placeholder values\n  return (\n    <ArticlePage \n      title={title || \"Loading...\"} \n      content=\"Content is loading...\" \n      date={new Date().toISOString().split('T')[0]} \n    />\n  );\n}\n\n// Wrap the main content in a component to use hooks\nfunction AppContent() {\n  const [isLoading, setIsLoading] = useState(true);\n  const location = useLocation();\n  const { user, profile, signOut, refreshSession } = useAuth();\n\n  // Log auth state for debugging\n  useEffect(() => {\n    console.log(\"Auth state in App:\", { user, profile });\n    \n    // Refresh session on mount to ensure we have the latest auth state\n    refreshSession();\n  }, []);\n\n  useEffect(() => {\n    const handleStart = () => setIsLoading(true);\n    const handleStop = () => setIsLoading(false);\n\n    handleStart();\n    const timer = setTimeout(handleStop, 100);\n\n    return () => clearTimeout(timer);\n  }, [location.pathname]);\n\n  useEffect(() => {\n    document.documentElement.classList.remove(\"dark\");\n  }, []);\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Header \n        isAuthenticated={!!user}\n        userProfile={profile || undefined}\n        onSignIn={() => {\n          // This will be handled by the Header component\n        }}\n        onSignUp={() => {\n          // This will be handled by the Header component\n        }}\n        onSignOut={signOut}\n      />\n      <main>\n        <Routes>\n          <Route path=\"/\" element={<Home />} />\n          <Route path=\"/listings\" element={<Listings />} />\n          <Route path=\"/deals\" element={<DealsPage />} />\n          <Route path=\"/trends\" element={<MarketTrendsPage />} />\n          <Route path=\"/insights\" element={<MarketInsightsPage />} />\n          <Route path=\"/calculators\" element={<Calculators />} />\n          <Route path=\"/profile\" element={<AccountSettings />} />\n          <Route path=\"/login\" element={<Navigate to=\"/\" replace />} />\n          <Route path=\"/dashboard\" element={<Dashboard />} />\n          <Route path=\"/pricing\" element={<PricingPage />} />\n          <Route path=\"/subscription/success\" element={<SubscriptionSuccess />} />\n          <Route path=\"/subscription/cancel\" element={<SubscriptionCancel />} />\n          <Route path=\"/account\" element={<AccountSettings />} />\n          <Route path=\"/research\" element={<ResearchPage />} />\n          <Route path=\"/blog\" element={<BlogPage />} />\n          <Route path=\"/article/:title\" element={<ArticlePageWrapper />} />\n          <Route path=\"/blog/:slug\" element={<ArticlePageWrapper />} />\n          <Route path=\"/help\" element={<HelpSupportPage />} />\n          <Route path=\"/auth/callback\" element={<AuthCallback />} />\n          <Route path=\"/property-management\" element={<PropertyManagementPage />} />\n          <Route path=\"/investment-opportunities\" element={<InvestmentOpportunitiesPage />} />\n          <Route path=\"/about-us\" element={<AboutUsPage />} />\n          <Route path=\"/messages\" element={<Messages />} />\n          {import.meta.env.VITE_TEMPO === \"true\" && (\n            <Route path=\"/tempobook/*\" element={null} />\n          )}\n          <Route path=\"*\" element={<NotFound />} />\n        </Routes>\n      </main>\n      <ChatBot />\n      <Toaster />\n      <ProgressBar isAnimating={isLoading} />\n    </div>\n  );\n}\n\n// Main App component with providers\nfunction App() {\n  return (\n    <AuthProvider>\n      <Suspense fallback={<Loading />}>\n        <AppContent />\n      </Suspense>\n    </AuthProvider>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom/client\";\nimport App from \"./App.tsx\";\nimport \"./index.css\";\nimport { BrowserRouter } from \"react-router-dom\";\n\nimport { TempoDevtools } from \"tempo-devtools\";\nimport { AuthProvider } from \"./lib/auth\";\nimport posthog from 'posthog-js'\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\n\nTempoDevtools.init();\n\nposthog.init('phc_Pg1VGdZoazG7KyDNxnUXNZZz6zPVrGNSRtFlDnlZCcA',\n    {\n        api_host: 'https://eu.i.posthog.com',\n        person_profiles: 'identified_only' // or 'always' to create profiles for anonymous users as well\n    }\n)\n\nconst queryClient = new QueryClient();\n\nReactDOM.createRoot(document.getElementById(\"root\")!).render(\n  <React.StrictMode>\n    <QueryClientProvider client={queryClient}>\n      <BrowserRouter>\n        <AuthProvider>\n          <App />\n        </AuthProvider>\n      </BrowserRouter>\n    </QueryClientProvider>\n  </React.StrictMode>,\n);\n"],"file":"assets/index-D7ybNxYK.js"}