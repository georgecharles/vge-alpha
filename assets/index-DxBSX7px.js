import{t as Cr,c as Pr,r as o,j as e,V as Ht,R as Wt,a as as,A as Yt,C as Kt,b as Jt,T as Zt,D as Xt,P as Ar,d as Qt,e as S,S as Ir,f as ea,g as Mr,h as Rr,i as sa,k as Tr,l as Er,m as Qs,X as ct,n as ta,L as aa,o as ra,p as dt,q as na,s as ia,I as la,u as Lr,v as Dr,w as oa,x as ca,F as da,y as ma,z as Fr,B as ha,E as Or,G as xa,H as ua,J as pa,K as ga,M as fa,N as ja,O as Ur,Q as va,U as ya,W as zr,Y as $r,Z as Na,_ as Br,$ as ba,a0 as qr,a1 as wa,a2 as Sa,a3 as Gr,a4 as Vr,a5 as _a,a6 as Ne,a7 as ka,a8 as et,a9 as ms,aa as _t,ab as kt,ac as us,ad as Ct,ae as Hr,af as Wr,ag as Yr,ah as Ca,ai as Pa,aj as Pt,ak as Aa,al as Ia,am as Ma,an as Kr,ao as Jr,ap as Zr,aq as Ra,ar as Ta,as as Ea,at as Xr,au as de,av as st,aw as os,ax as Qr,ay as Bs,az as en,aA as Ps,aB as sn,aC as La,aD as mt,aE as Ye,aF as qe,aG as ue,aH as At,aI as Da,aJ as Be,aK as Me,aL as Fa,aM as As,aN as tn,aO as an,aP as rn,aQ as tt,aR as Je,aS as ht,aT as nn,aU as ln,aV as on,aW as He,aX as Es,aY as at,aZ as Ls,a_ as Ds,a$ as Fs,b0 as Os,b1 as Us,b2 as cn,b3 as dn,b4 as mn,b5 as Is,b6 as zs,b7 as hn,b8 as xt,b9 as xn,ba as Oa,bb as un,bc as Ua,bd as pn,be as za,bf as gn,bg as $a,bh as fn,bi as Ba,bj as qa,bk as jn,bl as vn,bm as Ga,bn as yn,bo as Nn,bp as It,bq as Va,br as bn,bs as wn,bt as Sn,bu as Ha,bv as _n,bw as Wa,bx as Ya,by as ls,bz as kn,bA as Ka,bB as Cn,bC as Pn,bD as An,bE as In,bF as Ja,bG as Mn,bH as Rn,bI as Za,bJ as Tn,bK as En,bL as Ln,bM as Xa,bN as Dn,bO as Qa,bP as Fn,bQ as On,bR as er,bS as sr,bT as Un,bU as zn,bV as $n,bW as Bn,bX as Mt,bY as qn,bZ as Gn,b_ as Vn,b$ as Hn,c0 as tr,c1 as Wn,c2 as te,c3 as Rt,c4 as Yn,c5 as Kn,c6 as Jn,c7 as Zn,c8 as Xn,c9 as Qn}from"./vendor-BkIQqBNA.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=t(n);fetch(n.href,l)}})();function k(...s){return Cr(Pr(s))}function V(s){return new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)}function es(s){return new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"long",year:"numeric"}).format(new Date(s))}function ar(s){return new Intl.NumberFormat("en-GB").format(s)}const ei=Ar,rr=o.forwardRef(({className:s,...a},t)=>e.jsx(Ht,{ref:t,className:k("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...a}));rr.displayName=Ht.displayName;const si=as("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),nr=o.forwardRef(({className:s,variant:a,...t},r)=>e.jsx(Wt,{ref:r,className:k(si({variant:a}),s),...t}));nr.displayName=Wt.displayName;const ti=o.forwardRef(({className:s,...a},t)=>e.jsx(Yt,{ref:t,className:k("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...a}));ti.displayName=Yt.displayName;const ir=o.forwardRef(({className:s,...a},t)=>e.jsx(Kt,{ref:t,className:k("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...a,children:e.jsx(Jt,{className:"h-4 w-4"})}));ir.displayName=Kt.displayName;const lr=o.forwardRef(({className:s,...a},t)=>e.jsx(Zt,{ref:t,className:k("text-sm font-semibold [&+div]:text-xs",s),...a}));lr.displayName=Zt.displayName;const or=o.forwardRef(({className:s,...a},t)=>e.jsx(Xt,{ref:t,className:k("text-sm opacity-90",s),...a}));or.displayName=Xt.displayName;const ai=1,ri=1e6;let Ks=0;function ni(){return Ks=(Ks+1)%Number.MAX_SAFE_INTEGER,Ks.toString()}const Js=new Map,Tt=s=>{if(Js.has(s))return;const a=setTimeout(()=>{Js.delete(s),cs({type:"REMOVE_TOAST",toastId:s})},ri);Js.set(s,a)},ii=(s,a)=>{switch(a.type){case"ADD_TOAST":return{...s,toasts:[a.toast,...s.toasts].slice(0,ai)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(t=>t.id===a.toast.id?{...t,...a.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=a;return t?Tt(t):s.toasts.forEach(r=>{Tt(r.id)}),{...s,toasts:s.toasts.map(r=>r.id===t||t===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return a.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==a.toastId)}}},Ms=[];let Rs={toasts:[]};function cs(s){Rs=ii(Rs,s),Ms.forEach(a=>{a(Rs)})}function li({...s}){const a=ni(),t=n=>cs({type:"UPDATE_TOAST",toast:{...n,id:a}}),r=()=>cs({type:"DISMISS_TOAST",toastId:a});return cs({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:n=>{n||r()}}}),{id:a,dismiss:r,update:t}}function Ce(){const[s,a]=o.useState(Rs);return o.useEffect(()=>(Ms.push(a),()=>{const t=Ms.indexOf(a);t>-1&&Ms.splice(t,1)}),[s]),{...s,toast:li,dismiss:t=>cs({type:"DISMISS_TOAST",toastId:t})}}function oi(){const{toasts:s}=Ce();return e.jsxs(ei,{children:[s.map(function({id:a,title:t,description:r,action:n,...l}){return e.jsxs(nr,{...l,children:[e.jsxs("div",{className:"grid gap-1",children:[t&&e.jsx(lr,{children:t}),r&&e.jsx(or,{children:r})]}),n,e.jsx(ir,{})]},a)}),e.jsx(rr,{})]})}const ci="https://zcuapuvvygahkzljuhyg.supabase.co",di="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpjdWFwdXZ2eWdhaGt6bGp1aHlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc5MTQwMzcsImV4cCI6MjA1MzQ5MDAzN30.GIhphzkznmDXgrUApGW479uHHluqDWqy_9cfG5sU5Xc",je=Qt(ci,di),cr=o.createContext({user:null,session:null,profile:null,isLoading:!0,signOut:async()=>{},refreshSession:async()=>{}}),Zs=async s=>{try{const{data:a,error:t}=await je.from("profiles").select("*").eq("id",s).single();return t?(console.error("Error fetching profile:",t),null):(console.log("Fetched profile data:",a),a)}catch(a){return console.error("Error in fetchProfile:",a),null}},dr=({children:s})=>{const[a,t]=o.useState(null),[r,n]=o.useState(null),[l,i]=o.useState(null),[j,h]=o.useState(!0),y=async()=>{var f,N;try{h(!0),console.log("Refreshing session...");const{data:v,error:I}=await je.auth.getSession();if(I)throw I;if(console.log("Session data:",v),n(v.session),t(((f=v.session)==null?void 0:f.user)||null),(N=v.session)!=null&&N.user){const w=await Zs(v.session.user.id);i(w)}else i(null)}catch(v){console.error("Error refreshing session:",v),t(null),i(null),n(null)}finally{h(!1)}},u=async()=>{try{h(!0);const{error:f}=await je.auth.signOut();if(f)throw f;t(null),i(null),n(null)}catch(f){console.error("Error signing out:",f)}finally{h(!1)}};o.useEffect(()=>{const N=(async()=>{var I,w;h(!0),console.log("Initializing auth...");try{const{data:c,error:d}=await je.auth.getSession();if(d)throw d;if(console.log("Initial session data:",c),n(c.session),t(((I=c.session)==null?void 0:I.user)||null),(w=c.session)!=null&&w.user){const b=await Zs(c.session.user.id);i(b)}}catch(c){console.error("Error initializing auth:",c)}finally{h(!1)}const{data:v}=je.auth.onAuthStateChange(async(c,d)=>{if(console.log("Auth state changed:",c,d),n(d),t((d==null?void 0:d.user)||null),d!=null&&d.user){const b=await Zs(d.user.id);i(b)}else i(null)});return()=>{v.subscription.unsubscribe()}})();return()=>{N.then(v=>v&&v())}},[]);const g={user:a,session:r,profile:l,isLoading:j,signOut:u,refreshSession:y};return S.createElement(cr.Provider,{value:g},s)};function Q(){return o.useContext(cr)}function mr({className:s}){return e.jsx("div",{className:k("flex items-center justify-center",s),children:e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"})})}function mi({isAnimating:s}){const[a,t]=o.useState(0);return o.useEffect(()=>{if(!s){t(0);return}t(10);const r=setTimeout(()=>t(30),100),n=setTimeout(()=>t(60),500),l=setTimeout(()=>t(80),800),i=setTimeout(()=>t(100),1e3);return()=>{clearTimeout(r),clearTimeout(n),clearTimeout(l),clearTimeout(i)}},[s]),!s&&a===0?null:e.jsx("div",{className:"fixed top-0 left-0 right-0 z-50",children:e.jsx("div",{className:"h-1 bg-primary transition-all duration-300 ease-in-out",style:{width:`${a}%`,opacity:a===100?0:1}})})}const hi=as("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),_=o.forwardRef(({className:s,variant:a,size:t,asChild:r=!1,...n},l)=>{const i=r?Ir:"button";return e.jsx(i,{className:k(hi({variant:a,size:t,className:s})),ref:l,...n})});_.displayName="Button";const ss=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(ea,{ref:r,className:k("relative overflow-hidden",s),...t,children:[e.jsx(Mr,{className:"h-full w-full rounded-[inherit]",children:a}),e.jsx(hr,{}),e.jsx(Rr,{})]}));ss.displayName=ea.displayName;const hr=o.forwardRef(({className:s,orientation:a="vertical",...t},r)=>e.jsx(sa,{ref:r,orientation:a,className:k("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...t,children:e.jsx(Tr,{className:"relative flex-1 rounded-full bg-border"})}));hr.displayName=sa.displayName;function xi({isOpen:s,onClose:a,children:t}){return e.jsx(Er,{children:s&&e.jsxs(e.Fragment,{children:[e.jsx(Qs.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm lg:hidden",onClick:a,style:{width:"100vw"}}),e.jsxs(Qs.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:20,stiffness:300},className:k("fixed inset-y-0 right-0 z-50 w-full max-w-xs bg-white shadow-2xl lg:hidden","flex flex-col"),children:[e.jsxs("div",{className:"flex h-16 items-center justify-between border-b px-6",children:[e.jsx("a",{href:"/",className:"hover:opacity-80 transition-opacity",children:e.jsx("img",{src:"https://i.postimg.cc/GpdY6N74/my-1920-x-1080-px-1.png",alt:"MyVGE",className:"h-8"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-10 w-10 rounded-full hover:bg-muted",onClick:r=>{r.stopPropagation(),a()},children:e.jsx(ct,{className:"h-5 w-5"})})]}),e.jsx(ss,{className:"flex-1",children:e.jsxs("div",{className:"flex flex-col p-6 pb-16",children:[e.jsx("div",{className:"flex-1",children:t}),e.jsx("div",{className:"mt-auto pt-6",children:e.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:["© ",new Date().getFullYear()," MyVGE. All rights reserved."]})})]})})]})]})})}const xr=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(ta,{ref:r,className:k("relative z-10 flex max-w-max flex-1 items-center justify-center",s),...t,children:[a,e.jsx(pr,{})]}));xr.displayName=ta.displayName;const ur=o.forwardRef(({className:s,...a},t)=>e.jsx(aa,{ref:t,className:k("group flex flex-1 list-none items-center justify-center space-x-1",s),...a}));ur.displayName=aa.displayName;const is=Dr,ui=as("group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"),rt=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(ra,{ref:r,className:k(ui(),"group",s),...t,children:[a," ",e.jsx(dt,{className:"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180","aria-hidden":"true"})]}));rt.displayName=ra.displayName;const nt=o.forwardRef(({className:s,...a},t)=>e.jsx(na,{ref:t,className:k("left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ",s),...a}));nt.displayName=na.displayName;const Ss=Lr,pr=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{className:k("absolute left-0 top-full flex justify-center"),children:e.jsx(ia,{className:k("origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",s),ref:t,...a})}));pr.displayName=ia.displayName;const pi=o.forwardRef(({className:s,...a},t)=>e.jsx(la,{ref:t,className:k("top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",s),...a,children:e.jsx("div",{className:"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md"})}));pi.displayName=la.displayName;const Le=o.forwardRef(({className:s,...a},t)=>e.jsx(oa,{ref:t,className:k("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...a}));Le.displayName=oa.displayName;const De=o.forwardRef(({className:s,...a},t)=>e.jsx(ca,{ref:t,className:k("aspect-square h-full w-full",s),...a}));De.displayName=ca.displayName;const Fe=o.forwardRef(({className:s,...a},t)=>e.jsx(da,{ref:t,className:k("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a}));Fe.displayName=da.displayName;const gi=zr,fi=$r,ji=o.forwardRef(({className:s,inset:a,children:t,...r},n)=>e.jsxs(ma,{ref:n,className:k("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",s),...r,children:[t,e.jsx(Fr,{className:"ml-auto h-4 w-4"})]}));ji.displayName=ma.displayName;const vi=o.forwardRef(({className:s,...a},t)=>e.jsx(ha,{ref:t,className:k("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));vi.displayName=ha.displayName;const gr=o.forwardRef(({className:s,sideOffset:a=4,...t},r)=>e.jsx(Or,{children:e.jsx(xa,{ref:r,sideOffset:a,className:k("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})}));gr.displayName=xa.displayName;const Qe=o.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(ua,{ref:r,className:k("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",s),...t}));Qe.displayName=ua.displayName;const yi=o.forwardRef(({className:s,children:a,checked:t,...r},n)=>e.jsxs(pa,{ref:n,className:k("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:t,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ga,{children:e.jsx(fa,{className:"h-4 w-4"})})}),a]}));yi.displayName=pa.displayName;const Ni=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(ja,{ref:r,className:k("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ga,{children:e.jsx(Ur,{className:"h-4 w-4 fill-current"})})}),a]}));Ni.displayName=ja.displayName;const bi=o.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(va,{ref:r,className:k("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s),...t}));bi.displayName=va.displayName;const it=o.forwardRef(({className:s,...a},t)=>e.jsx(ya,{ref:t,className:k("-mx-1 my-1 h-px bg-muted",s),...a}));it.displayName=ya.displayName;const Ge=Gr,wi=Vr,Si=Br,fr=o.forwardRef(({className:s,...a},t)=>e.jsx(Na,{ref:t,className:k("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a}));fr.displayName=Na.displayName;const Oe=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Si,{children:[e.jsx(fr,{}),e.jsxs(ba,{ref:r,className:k("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t,children:[a,e.jsxs(qr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Jt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Oe.displayName=ba.displayName;const Ue=({className:s,...a})=>e.jsx("div",{className:k("flex flex-col space-y-1.5 text-center sm:text-left",s),...a});Ue.displayName="DialogHeader";const ut=({className:s,...a})=>e.jsx("div",{className:k("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});ut.displayName="DialogFooter";const ze=o.forwardRef(({className:s,...a},t)=>e.jsx(wa,{ref:t,className:k("text-lg font-semibold leading-none tracking-tight",s),...a}));ze.displayName=wa.displayName;const ts=o.forwardRef(({className:s,...a},t)=>e.jsx(Sa,{ref:t,className:k("text-sm text-muted-foreground",s),...a}));ts.displayName=Sa.displayName;const q=o.forwardRef(({className:s,type:a,...t},r)=>e.jsx("input",{type:a,className:k("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:r,...t}));q.displayName="Input";const _i=as("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),G=o.forwardRef(({className:s,...a},t)=>e.jsx(_a,{ref:t,className:k(_i(),s),...a}));G.displayName=_a.displayName;function ki({isOpen:s,onClose:a,onSuccess:t}){const[r,n]=o.useState(""),[l,i]=o.useState(""),[j,h]=o.useState(!1),{toast:y}=Ce(),u=async g=>{g.preventDefault(),h(!0);try{console.log("Attempting login with:",r);const{data:f,error:N}=await je.auth.signInWithPassword({email:r,password:l});if(N)throw console.error("Supabase auth error:",N),N;console.log("Login successful:",f),y({title:"Success",description:"You have successfully logged in."}),a(),setTimeout(()=>{t&&t(),window.location.href=window.location.pathname},300)}catch(f){console.error("Login error:",f),y({variant:"destructive",title:"Login failed",description:f.message||"Please check your credentials and try again."})}finally{h(!1)}};return e.jsx(Ge,{open:s,onOpenChange:a,children:e.jsxs(Oe,{className:"sm:max-w-[425px]",children:[e.jsxs(Ue,{children:[e.jsx(ze,{children:"Login"}),e.jsx(ts,{children:"Enter your credentials to access your account."})]}),e.jsxs("form",{onSubmit:u,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(G,{htmlFor:"email",children:"Email"}),e.jsx(q,{id:"email",type:"email",value:r,onChange:g=>n(g.target.value),placeholder:"your.email@example.com",autoComplete:"email",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(G,{htmlFor:"password",children:"Password"}),e.jsx(q,{id:"password",type:"password",value:l,onChange:g=>i(g.target.value),autoComplete:"current-password",required:!0})]})]}),e.jsx(ut,{children:e.jsx(_,{type:"submit",disabled:j,children:j?"Logging in...":"Login"})})]})]})})}const Ci=[{title:"Investment Deals",href:"/deals",icon:"💼",requiresAuth:!0},{title:"Listings",href:"/listings",icon:"🏠",requiresAuth:!1},{title:"Market",items:[{title:"Market Trends",href:"/trends",description:"Stay updated with the latest real estate market trends",requiresAuth:!0},{title:"Market Insights",href:"/insights",description:"Deep dive into property market analytics",requiresAuth:!0},{title:"Research & Reports",href:"/research",description:"Access expert analysis and reports",requiresAuth:!1}],icon:"📊"},{title:"Services",items:[{title:"Property Management",href:"/property-management",description:"Let us take care of your property",requiresAuth:!0},{title:"Investment Opportunities",href:"/investment-opportunities",description:"Discover tailored investment strategies",requiresAuth:!0},{title:"Calculators",href:"/calculators",description:"Calculate your property investment",requiresAuth:!1}],icon:"🏠"},{title:"Messages",href:"/messages",icon:"💬",requiresAuth:!0},{title:"Pricing",href:"/pricing",icon:"💎",requiresAuth:!1},{title:"Support",href:"/help",icon:"❓",requiresAuth:!1},{title:"About Us",href:"/about-us",icon:"ℹ️",requiresAuth:!1}];function ps({isAuthenticated:s=!1,onSignIn:a,onSignUp:t,userProfile:r={},onSignOut:n}){var C,O;const[l,i]=S.useState(!1),[j,h]=S.useState(!1),[y,u]=S.useState(!1),g=Ne(),f=Q(),N=s||!!f.user,v=r&&Object.keys(r).length>0?r:f.profile,I=n||f.signOut;S.useEffect(()=>{const A=()=>{h(window.scrollY>20)};return window.addEventListener("scroll",A),()=>window.removeEventListener("scroll",A)},[]);const w=A=>{A.preventDefault(),u(!0)},c=async()=>{console.log("Sign out button clicked");try{await I(),window.location.href="/"}catch(A){console.error("Error signing out:",A)}},d=(A,L,z)=>{L&&!N&&(A.preventDefault(),u(!0)),i(!1)},b=S.forwardRef(({className:A,title:L,children:z,...p},M)=>e.jsx("li",{children:e.jsx(Ss,{asChild:!0,children:e.jsxs("a",{ref:M,className:k("block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",A??""),...p,children:[e.jsx("div",{className:"text-sm font-medium leading-none",children:L}),e.jsx("p",{className:"line-clamp-2 text-sm leading-snug text-muted-foreground",children:z})]})})}));return b.displayName="ListItem",e.jsxs(e.Fragment,{children:[e.jsx("header",{className:k("fixed top-0 left-0 right-0 z-50 transition-all duration-300",j?"py-2":"py-4"),children:e.jsx("div",{className:"px-4 mx-auto max-w-7xl",children:e.jsx("div",{className:k("rounded-full bg-white border transition-all duration-300",j?"shadow-md border-gray-200/50 backdrop-blur-md bg-white/90":"shadow-sm border-transparent"),children:e.jsxs("div",{className:"h-16 px-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx("a",{href:"/",className:"hover:opacity-80 transition-opacity",children:e.jsx("img",{src:"https://i.postimg.cc/GpdY6N74/my-1920-x-1080-px-1.png",alt:"MyVGE",className:"h-8"})}),e.jsx(xr,{className:"hidden lg:flex",children:e.jsxs(ur,{className:"gap-2",children:[e.jsxs(is,{children:[e.jsx(rt,{className:k("text-sm font-medium rounded-full px-4","bg-transparent hover:bg-gray-100 transition-colors","data-[state=open]:bg-gray-100"),children:"Market"}),e.jsx(nt,{children:e.jsxs("ul",{className:"w-[400px] gap-3 p-4 rounded-2xl",children:[N?e.jsxs(e.Fragment,{children:[e.jsx(b,{href:"/trends",title:"Market Trends",children:"Stay updated with the latest real estate market trends."}),e.jsx(b,{href:"/insights",title:"Market Insights",children:"Deep dive into property market analytics and forecasts."})]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{href:"#",onClick:w,title:"Market Trends",children:"Sign in to access market trends."}),e.jsx(b,{href:"#",onClick:w,title:"Market Insights",children:"Sign in to access market insights."})]}),e.jsx(b,{href:"/research",title:"Research & Reports",children:"Access expert analysis and reports."})]})})]}),e.jsx(is,{children:e.jsx(Ss,{className:k("text-sm font-medium rounded-full px-4 py-2","hover:bg-gray-100 transition-colors"),href:"/deals",children:"Deals"})}),e.jsx(is,{children:e.jsx(Ss,{className:k("text-sm font-medium rounded-full px-4 py-2","hover:bg-gray-100 transition-colors"),href:"/listings",children:"Listings"})}),e.jsxs(is,{children:[e.jsx(rt,{className:k("text-sm font-medium rounded-full px-4","bg-transparent hover:bg-gray-100 transition-colors","data-[state=open]:bg-gray-100"),children:"Services"}),e.jsx(nt,{children:e.jsxs("ul",{className:"w-[400px] gap-3 p-4 rounded-2xl",children:[e.jsx(b,{href:"/property-management",title:"Property Management",children:"Let us take care of your property."}),e.jsx(b,{href:"/investment-opportunities",title:"Investment Opportunities",children:"Discover tailored investment strategies."}),e.jsx(b,{href:"/calculators",title:"Calculators",children:"Calculate different aspects of your property investment."})]})})]}),e.jsx(is,{children:e.jsx(Ss,{className:k("text-sm font-medium rounded-full px-4 py-2","hover:bg-gray-100 transition-colors"),href:"/pricing",children:"Pricing"})})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("nav",{className:"hidden lg:flex items-center gap-2",children:[e.jsx("a",{href:"/help",className:k("text-sm font-medium rounded-full px-4 py-2","hover:bg-gray-100 transition-colors"),children:"Support"}),e.jsx("a",{href:"/about-us",className:k("text-sm font-medium rounded-full px-4 py-2","hover:bg-gray-100 transition-colors"),children:"About Us"})]}),e.jsxs(_,{variant:"ghost",className:"hidden md:flex bg-gradient-to-r from-emerald-400 to-cyan-400 text-white hover:from-emerald-500 hover:to-cyan-500 rounded-full border border-emerald-500/20 shadow-lg hover:shadow-emerald-500/20 transition-all duration-300",onClick:()=>g("/pricing"),children:[e.jsx(ka,{className:"mr-2 h-4 w-4"}),"Upgrade"]}),e.jsxs("div",{className:"flex items-center",children:[N?e.jsxs(gi,{children:[e.jsx(fi,{asChild:!0,children:e.jsx(_,{variant:"ghost",className:"relative h-10 w-10 rounded-full",children:e.jsxs(Le,{className:"h-10 w-10",children:[e.jsx(De,{src:`https://ui-avatars.com/api/?name=${encodeURIComponent((v==null?void 0:v.full_name)||"")}&background=random`,alt:(v==null?void 0:v.full_name)||"User avatar"}),e.jsx(Fe,{className:"bg-primary/10",children:((C=v==null?void 0:v.full_name)==null?void 0:C.split(" ").filter(Boolean).map(A=>A[0]).slice(0,2).join("").toUpperCase())||"U"})]})})}),e.jsxs(gr,{className:"w-56 mt-2 bg-white border border-gray-200 rounded-2xl shadow-lg",align:"end",forceMount:!0,children:[e.jsxs(Qe,{className:"flex-col items-start",children:[e.jsx("div",{className:"font-medium",children:v==null?void 0:v.full_name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:v==null?void 0:v.email})]}),e.jsx(it,{}),e.jsxs(Qe,{onClick:()=>g("/dashboard"),children:[e.jsx(_t,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Dashboard"})]}),e.jsxs(Qe,{onClick:()=>g("/account"),children:[e.jsx(kt,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Account Settings"})]}),e.jsxs(Qe,{onClick:()=>g("/messages"),children:[e.jsx(us,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Messages"})]}),e.jsx(it,{}),e.jsxs(Qe,{className:"text-red-500 focus:text-red-500",onClick:c,children:[e.jsx(Ct,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Log Out"})]})]})]}):e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs(_,{variant:"ghost",onClick:w,className:"rounded-full hover:bg-gray-100",children:[e.jsx(et,{className:"mr-2 h-4 w-4"}),"Sign In"]}),e.jsxs(_,{onClick:()=>t==null?void 0:t(),className:"rounded-full bg-black text-white hover:bg-gray-800",children:[e.jsx(ms,{className:"mr-2 h-4 w-4"}),"Sign Up"]})]}),e.jsx(_,{variant:"ghost",className:"lg:hidden p-2 ml-2",onClick:()=>i(!0),children:e.jsx(Hr,{className:"h-6 w-6"})})]})]})]})})})}),e.jsx(xi,{isOpen:l,onClose:()=>i(!1),children:e.jsxs("nav",{className:"space-y-6",children:[N&&e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-2",children:[e.jsxs(Le,{className:"h-10 w-10",children:[e.jsx(De,{src:`https://ui-avatars.com/api/?name=${encodeURIComponent((v==null?void 0:v.full_name)||"")}&background=random`,alt:(v==null?void 0:v.full_name)||"User avatar"}),e.jsx(Fe,{className:"bg-primary/10",children:((O=v==null?void 0:v.full_name)==null?void 0:O.split(" ").filter(Boolean).map(A=>A[0]).slice(0,2).join("").toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[e.jsx("p",{className:"text-sm font-medium leading-none truncate",children:v==null?void 0:v.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:v==null?void 0:v.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(_,{variant:"outline",className:"justify-center rounded-full",onClick:()=>{g("/dashboard"),i(!1)},children:[e.jsx(_t,{className:"mr-2 h-4 w-4"}),"Dashboard"]}),e.jsxs(_,{variant:"outline",className:"justify-center rounded-full",onClick:()=>{g("/account"),i(!1)},children:[e.jsx(kt,{className:"mr-2 h-4 w-4"}),"Account"]})]}),e.jsx("div",{className:"border-b border-border"})]}),Ci.map((A,L)=>{var z;return e.jsx("div",{className:"space-y-3",children:A.href?e.jsxs("a",{href:A.href,className:k("flex items-center space-x-3 text-lg font-medium transition-colors",!A.requiresAuth||N?"hover:text-primary":"text-muted-foreground hover:text-primary/70"),onClick:p=>d(p,A.requiresAuth,A.href),children:[e.jsx("span",{className:"text-xl",children:A.icon}),e.jsx("span",{children:A.title}),A.requiresAuth&&!N&&e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Sign in required)"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center space-x-3 text-lg font-medium",children:[e.jsx("span",{className:"text-xl",children:A.icon}),e.jsx("span",{children:A.title})]}),e.jsx("div",{className:"space-y-3 pl-9",children:(z=A.items)==null?void 0:z.map((p,M)=>e.jsxs("a",{href:p.href,className:k("block text-base transition-colors",!p.requiresAuth||N?"text-muted-foreground hover:text-primary":"text-muted-foreground/70 hover:text-primary/70"),onClick:R=>d(R,p.requiresAuth,p.href),children:[p.title,p.requiresAuth&&!N&&e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Sign in required)"})]},M))})]})},L)}),N?e.jsx("div",{className:"pt-6",children:e.jsxs(_,{variant:"outline",className:"w-full justify-center rounded-full text-red-500 hover:text-red-600 hover:bg-red-50",onClick:c,children:[e.jsx(Ct,{className:"mr-2 h-4 w-4"}),"Log Out"]})}):e.jsxs("div",{className:"space-y-4 pt-6",children:[e.jsxs(_,{variant:"outline",className:"w-full justify-center rounded-full",onClick:w,children:[e.jsx(et,{className:"mr-2 h-4 w-4"}),"Sign In"]}),e.jsxs(_,{className:"w-full justify-center rounded-full bg-gradient-to-r from-emerald-400 to-cyan-400 text-white hover:from-emerald-500 hover:to-cyan-500",onClick:()=>{t==null||t(),i(!1)},children:[e.jsx(ms,{className:"mr-2 h-4 w-4"}),"Sign Up"]})]})]})}),e.jsx(ki,{isOpen:y,onClose:()=>u(!1),onSuccess:()=>{u(!1),window.location.reload()}})]})}const Pi=({text:s="",className:a="",delay:t=100,animationFrom:r={opacity:0,transform:"translate3d(0,40px,0)"},animationTo:n={opacity:1,transform:"translate3d(0,0,0)"},easing:l=u=>u,threshold:i=.1,rootMargin:j="-100px",textAlign:h="center",onLetterAnimationComplete:y})=>{const u=s.split(" ").map(c=>c.split("")),g=u.flat(),[f,N]=o.useState(!1),v=o.useRef(null),I=o.useRef(0);o.useEffect(()=>{const c=new IntersectionObserver(([d])=>{d.isIntersecting&&(N(!0),v.current&&c.unobserve(v.current))},{threshold:i,rootMargin:j});return v.current&&c.observe(v.current),()=>c.disconnect()},[i,j]);const w=Wr(g.length,g.map((c,d)=>({from:r,to:f?async b=>{await b(n),I.current+=1,I.current===g.length&&y&&y()}:r,delay:d*t,config:{easing:l}})));return e.jsx("p",{ref:v,className:`split-parent overflow-hidden inline ${a}`,style:{textAlign:h,whiteSpace:"normal",wordWrap:"break-word"},children:u.map((c,d)=>e.jsxs("span",{style:{display:"inline-block",whiteSpace:"nowrap"},children:[c.map((b,C)=>{const O=u.slice(0,d).reduce((A,L)=>A+L.length,0)+C;return e.jsx(Yr.span,{style:w[O],className:"inline-block transform transition-opacity will-change-transform",children:b},O)}),e.jsx("span",{style:{display:"inline-block",width:"0.3em"},children:" "})]},d))})},Ai=`#version 300 es
in vec2 position;
void main() {
  gl_Position = vec4(position, 0.0, 1.0);
}
`,Ii=`#version 300 es
precision highp float;

uniform float uTime;
uniform float uAmplitude;
uniform vec3 uColorStops[3];
uniform vec2 uResolution;
uniform float uBlend;

out vec4 fragColor;

vec3 permute(vec3 x) {
  return mod(((x * 34.0) + 1.0) * x, 289.0);
}

float snoise(vec2 v){
  const vec4 C = vec4(
      0.211324865405187, 0.366025403784439,
      -0.577350269189626, 0.024390243902439
  );
  vec2 i  = floor(v + dot(v, C.yy));
  vec2 x0 = v - i + dot(i, C.xx);
  vec2 i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;
  i = mod(i, 289.0);

  vec3 p = permute(
      permute(i.y + vec3(0.0, i1.y, 1.0))
    + i.x + vec3(0.0, i1.x, 1.0)
  );

  vec3 m = max(
      0.5 - vec3(
          dot(x0, x0),
          dot(x12.xy, x12.xy),
          dot(x12.zw, x12.zw)
      ), 
      0.0
  );
  m = m * m;
  m = m * m;

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;
  m *= 1.79284291400159 - 0.85373472095314 * (a0*a0 + h*h);

  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}

struct ColorStop {
  vec3 color;
  float position;
};

#define COLOR_RAMP(colors, factor, finalColor) {                int index = 0;                                              for (int i = 0; i < 2; i++) {                                    ColorStop currentColor = colors[i];                         bool isInBetween = currentColor.position <= factor;         index = int(mix(float(index), float(i), float(isInBetween)));   }                                                           ColorStop currentColor = colors[index];                     ColorStop nextColor = colors[index + 1];                    float range = nextColor.position - currentColor.position;   float lerpFactor = (factor - currentColor.position) / range;   finalColor = mix(currentColor.color, nextColor.color, lerpFactor); }

void main() {
  vec2 uv = gl_FragCoord.xy / uResolution;
  
  ColorStop colors[3];
  colors[0] = ColorStop(uColorStops[0], 0.0);
  colors[1] = ColorStop(uColorStops[1], 0.5);
  colors[2] = ColorStop(uColorStops[2], 1.0);
  
  vec3 rampColor;
  COLOR_RAMP(colors, uv.x, rampColor);
  
  float height = snoise(vec2(uv.x * 2.0 + uTime * 0.1, uTime * 0.25)) * 0.5 * uAmplitude;
  height = exp(height);
  height = (uv.y * 2.0 - height + 0.2);
  float intensity = 0.6 * height;
  
  float midPoint = 0.20;
  float auroraAlpha = smoothstep(midPoint - uBlend * 0.5, midPoint + uBlend * 0.5, intensity);
  
  vec3 auroraColor = intensity * rampColor;
  
  fragColor = vec4(auroraColor * auroraAlpha, auroraAlpha);
}
`,Mi=s=>{const{colorStops:a=["#00d8ff","#7cff67","#00d8ff"],amplitude:t=1,blend:r=.5}=s,n=o.useRef(s);n.current=s;const l=o.useRef(null);return o.useEffect(()=>{const i=l.current;if(!i)return;const j=new Ca({alpha:!0,premultipliedAlpha:!0,antialias:!0}),h=j.gl;h.clearColor(0,0,0,0),h.enable(h.BLEND),h.blendFunc(h.ONE,h.ONE_MINUS_SRC_ALPHA),h.canvas.style.backgroundColor="transparent";let y;function u(){if(!i)return;const w=i.offsetWidth,c=i.offsetHeight;j.setSize(w,c),y&&(y.uniforms.uResolution.value=[w,c])}window.addEventListener("resize",u);const g=new Pa(h);g.attributes.uv&&delete g.attributes.uv;const f=a.map(w=>{const c=new Pt(w);return[c.r,c.g,c.b]});y=new Aa(h,{vertex:Ai,fragment:Ii,uniforms:{uTime:{value:0},uAmplitude:{value:t},uColorStops:{value:f},uResolution:{value:[i.offsetWidth,i.offsetHeight]},uBlend:{value:r}}});const N=new Ia(h,{geometry:g,program:y});i.appendChild(h.canvas);let v=0;const I=w=>{v=requestAnimationFrame(I);const{time:c=w*.01,speed:d=1}=n.current;if(y){y.uniforms.uTime.value=c*d*.1,y.uniforms.uAmplitude.value=n.current.amplitude??1,y.uniforms.uBlend.value=n.current.blend??r;const b=n.current.colorStops??a;y.uniforms.uColorStops.value=b.map(C=>{const O=new Pt(C);return[O.r,O.g,O.b]}),j.render({scene:N})}};return v=requestAnimationFrame(I),u(),()=>{var w;cancelAnimationFrame(v),window.removeEventListener("resize",u),i&&h.canvas.parentNode===i&&i.removeChild(h.canvas),(w=h.getExtension("WEBGL_lose_context"))==null||w.loseContext()}},[t]),e.jsx("div",{ref:l,className:"w-full h-full"})},Se=({onSearch:s=()=>{},title:a="Find Your Next Investment Property",subtitle:t="Search through our curated selection of properties",showSearch:r=!0,showStats:n=!0,height:l="h-[500px]",image:i})=>{const[j,h]=S.useState(""),y=g=>{g.preventDefault(),s(j)},u=()=>{console.log("Hero text animation completed!")};return e.jsxs("div",{className:`relative w-full ${l} bg-gray-900 overflow-hidden`,children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx(Mi,{colorStops:["#004F39","#FEFACA","#151513"],blend:.6,amplitude:1.2,speed:.3}),e.jsx("div",{className:"absolute inset-0 bg-black/30 backdrop-blur-[2px]"})]}),e.jsxs("div",{className:"relative h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col items-center justify-center text-center py-16 pt-24 animate-fade-in-up",children:[e.jsx(Pi,{text:a,className:"text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4",delay:50,animationFrom:{opacity:0,transform:"translate3d(0,50px,0)"},animationTo:{opacity:1,transform:"translate3d(0,0,0)"},easing:g=>1-Math.pow(1-g,3),threshold:.2,rootMargin:"-50px",onLetterAnimationComplete:u}),e.jsx("p",{className:"text-lg sm:text-xl text-gray-200 mb-6 sm:mb-8 max-w-3xl mx-auto",children:t}),r&&e.jsx("form",{onSubmit:y,className:"w-full max-w-2xl animate-fade-in-up",children:e.jsxs("div",{className:"relative",children:[e.jsx(q,{type:"text",placeholder:"Enter an address, neighbourhood, city, or postcode",value:j,onChange:g=>h(g.target.value),className:"w-full h-12 sm:h-14 pl-5 pr-14 text-base sm:text-lg bg-white/90 backdrop-blur-sm text-black border-2 border-transparent focus:border-primary"}),e.jsx(_,{type:"submit",size:"sm",variant:"ghost",className:"absolute right-2 top-1/2 -translate-y-1/2 hover:bg-transparent",children:e.jsx(Ma,{className:"w-6 h-6 text-gray-500 hover:text-primary transition-colors"})})]})})]})]})},E=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:k("rounded-xl border bg-card text-card-foreground shadow",s),...a}));E.displayName="Card";const B=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:k("flex flex-col space-y-1.5 p-6",s),...a}));B.displayName="CardHeader";const Z=o.forwardRef(({className:s,...a},t)=>e.jsx("h3",{ref:t,className:k("font-semibold leading-none tracking-tight",s),...a}));Z.displayName="CardTitle";const lt=o.forwardRef(({className:s,...a},t)=>e.jsx("p",{ref:t,className:k("text-sm text-muted-foreground",s),...a}));lt.displayName="CardDescription";const U=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:k("p-6 pt-0",s),...a}));U.displayName="CardContent";const gs=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:k("flex items-center p-6 pt-0",s),...a}));gs.displayName="CardFooter";const Ri=as("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"bg-green-500/10 text-green-500 hover:bg-green-500/20",warning:"bg-yellow-500/10 text-yellow-500 hover:bg-yellow-500/20",premium:"bg-gradient-to-r from-amber-500 to-amber-600 text-white hover:from-amber-600 hover:to-amber-700"}},defaultVariants:{variant:"default"}});function ce({className:s,variant:a,...t}){return e.jsx("div",{className:k(Ri({variant:a}),s),...t})}function $s({id:s,address:a,price:t,squareFootage:r,bedrooms:n,bathrooms:l,isPremium:i=!1,propertyType:j="residential",description:h,createdAt:y,author:u,original_price:g,roi_percentage:f,investment_term:N,deal_type:v,isSubscriber:I=!1,type:w="listing",isDeal:c=!1,images:d=[],onClick:b,onMessageAuthor:C,currentUser:O,userProfile:A}){const L=!!O,[z,p]=S.useState(!1),M=ee=>{ee.stopPropagation(),p(!z)},R=ee=>{ee.stopPropagation(),console.log("Share property:",s)},$=ee=>{ee.stopPropagation(),u&&C&&C(u.id)},J=d&&d.length>0?d[0]:`https://source.unsplash.com/random/800x600?property,house&sig=${s}`;return e.jsxs(E,{className:"overflow-hidden hover:shadow-md transition-shadow cursor-pointer",onClick:b,children:[e.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden bg-muted",children:[e.jsx("img",{src:J,alt:a,className:"object-cover w-full h-full",loading:"lazy"}),i&&e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx(ce,{variant:"secondary",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Featured"})}),c&&e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx(ce,{variant:"secondary",className:"bg-emerald-500 text-white hover:bg-emerald-600",children:"Investment Deal"})}),f&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsxs(ce,{className:"bg-emerald-500 text-white",children:[f,"% ROI"]})})]}),e.jsxs(B,{className:"p-4 pb-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:V(t)}),g&&e.jsx("div",{className:"text-sm text-muted-foreground line-through",children:V(g)})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:a})]}),e.jsxs(U,{className:"p-4 pt-2",children:[(n||l||r)&&e.jsxs("div",{className:"flex justify-between mb-3 text-sm",children:[n!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:n})," ",e.jsx("span",{className:"text-muted-foreground",children:n===1?"Bed":"Beds"})]}),l!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:l})," ",e.jsx("span",{className:"text-muted-foreground",children:l===1?"Bath":"Baths"})]}),r!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:ar(r)})," ",e.jsx("span",{className:"text-muted-foreground",children:"sq ft"})]})]}),N&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Investment Term: "}),e.jsx("span",{className:"text-sm font-medium",children:N})]}),v&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Deal Type: "}),e.jsx("span",{className:"text-sm font-medium",children:v})]}),h&&e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-2",children:h}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:es(y)}),e.jsxs("div",{className:"flex space-x-1",children:[L&&e.jsxs(e.Fragment,{children:[e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:M,children:e.jsx(Kr,{className:`h-4 w-4 ${z?"fill-red-500 text-red-500":""}`})}),u&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:$,children:e.jsx(us,{className:"h-4 w-4"})})]}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:R,children:e.jsx(Jr,{className:"h-4 w-4"})})]})]})]})]})}const Ti="https://zcuapuvvygahkzljuhyg.supabase.co",jr="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpjdWFwdXZ2eWdhaGt6bGp1aHlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc5MTQwMzcsImV4cCI6MjA1MzQ5MDAzN30.GIhphzkznmDXgrUApGW479uHHluqDWqy_9cfG5sU5Xc";console.log("Supabase Anon Key:",jr);const K=Qt(Ti,jr,{auth:{persistSession:!0,storage:window.localStorage,storageKey:"supabase.auth.token",autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"}}),Ei={BASIC:{name:"Basic",price:"£9.99",priceId:"price_1QnikACOhalwhG2QDocCWbQj",features:["Basic property search","Save up to 5 properties","Basic market trends","Email support"]},PRO:{name:"Pro",price:"£19.99",priceId:"price_1QnikPCOhalwhG2QVYfxwG5D",features:["Advanced property search","Save unlimited properties","Detailed market analysis","Premium property insights","Priority support"]},PREMIUM:{name:"Premium",price:"£49.99",priceId:"price_1QnikjCOhalwhG2QUgRtMAco",features:["All Pro features","AI-powered market predictions","Portfolio analytics","Investment ROI calculator","Dedicated account manager","24/7 phone support"]}};async function vr(s,a){try{const t=await fetch("https://clever-chaplygin6-vbfae.dev.tempolabs.ai/.netlify/functions/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({priceId:s,userId:a})}),{sessionId:r}=await t.json(),n=await Zr(void 0);n&&await n.redirectToCheckout({sessionId:r})}catch(t){throw console.error("Error creating checkout session:",t),t}}function pt({isOpen:s,onClose:a,defaultMode:t="signin"}){const[r,n]=S.useState(t);S.useEffect(()=>{n(t)},[t]);const[l,i]=S.useState(!1),[j,h]=S.useState(!1),{signIn:y,signUp:u,signInWithGoogle:g}=Q(),{toast:f}=Ce(),[N,v]=S.useState({email:"",password:"",firstName:"",lastName:""}),I=async w=>{w.preventDefault(),i(!0);try{if(r==="signin")await y(N.email,N.password)&&(f({title:"Welcome back!",description:"You have successfully signed in."}),setTimeout(()=>a(),500));else{const c=await u(N.email,N.password,N.firstName,N.lastName),d=localStorage.getItem("pending_subscription_price_id");d&&c&&"id"in c?(localStorage.removeItem("pending_subscription_price_id"),await vr(d,c.id)):(h(!0),f({title:"Welcome to MyVGE Alpha!",description:"Thank you for joining us during our alpha testing phase."}))}}catch(c){f({title:"Error",description:c.message||"An error occurred",variant:"destructive"})}finally{i(!1)}};return j?e.jsx(Ge,{open:s,onOpenChange:a,children:e.jsxs(Oe,{className:"sm:max-w-[425px]",children:[e.jsxs(Ue,{children:[e.jsx(ze,{children:"Welcome to MyVGE Alpha!"}),e.jsxs(ts,{className:"space-y-2",children:[e.jsx("p",{className:"text-lg font-medium text-primary",children:"Thank you for joining MyVGE during our alpha testing phase!"}),e.jsx("p",{children:"We've sent a confirmation email to your inbox. Please click the verification link to activate your account and start exploring MyVGE."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Note: You must confirm your email before signing in. Please check your spam folder if you don't see the email."}),e.jsx("div",{className:"mt-4 p-4 bg-primary/10 rounded-lg",children:e.jsx("p",{className:"text-sm font-medium",children:"As an alpha tester, your feedback is invaluable to us. We're excited to have you on board and look forward to your insights as we continue to improve the platform."})})]})]}),e.jsx("div",{className:"flex flex-col space-y-4 pt-4",children:e.jsx(_,{onClick:()=>{h(!1),a()},children:"Close"})})]})}):e.jsx(Ge,{open:s,onOpenChange:a,children:e.jsxs(Oe,{className:"sm:max-w-[425px]",children:[e.jsxs(Ue,{children:[e.jsx(ze,{children:r==="signin"?"Sign In":"Create Account"}),e.jsx(ts,{children:r==="signin"?"Welcome back! Please sign in to continue.":"Join MyVGE and start exploring properties."})]}),e.jsxs("form",{onSubmit:I,className:"space-y-4 pt-4",children:[r==="signup"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"firstName",children:"First Name"}),e.jsx(q,{id:"firstName",value:N.firstName,onChange:w=>v(c=>({...c,firstName:w.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"lastName",children:"Last Name"}),e.jsx(q,{id:"lastName",value:N.lastName,onChange:w=>v(c=>({...c,lastName:w.target.value})),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"email",children:"Email"}),e.jsx(q,{id:"email",type:"email",value:N.email,onChange:w=>v(c=>({...c,email:w.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"password",children:"Password"}),e.jsx(q,{id:"password",type:"password",value:N.password,onChange:w=>v(c=>({...c,password:w.target.value})),required:!0})]}),e.jsxs("div",{className:"flex flex-col space-y-4 pt-4",children:[e.jsx(_,{type:"submit",disabled:l,children:l?"Loading...":r==="signin"?"Sign In":"Create Account"}),e.jsx(_,{type:"button",variant:"link",onClick:()=>g(),disabled:l,children:"Sign In with Google"}),e.jsx(_,{type:"button",variant:"link",onClick:()=>n(r==="signin"?"signup":"signin"),children:r==="signin"?"Don't have an account? Sign up":"Already have an account? Sign in"})]})]})]})})}const Ze=Xr,Xe=o.forwardRef(({className:s,...a},t)=>e.jsx(Ra,{ref:t,className:k("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...a}));Xe.displayName=Ra.displayName;const me=o.forwardRef(({className:s,...a},t)=>e.jsx(Ta,{ref:t,className:k("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...a}));me.displayName=Ta.displayName;const oe=o.forwardRef(({className:s,...a},t)=>e.jsx(Ea,{ref:t,className:k("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));oe.displayName=Ea.displayName;function qs({isOpen:s,onClose:a,currentUser:t,userProfile:r}){const n=Ne(),l=i=>{console.log(`Subscribing to ${i} tier`),n(`/checkout?tier=${i}`),a()};return e.jsx(Ge,{open:s,onOpenChange:a,children:e.jsxs(Oe,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsx(Ue,{children:e.jsx(ze,{className:"text-2xl",children:"Upgrade Your Experience"})}),e.jsxs(Ze,{defaultValue:"monthly",className:"mt-4",children:[e.jsxs(Xe,{className:"grid w-full grid-cols-2 mb-6",children:[e.jsx(me,{value:"monthly",children:"Monthly"}),e.jsxs(me,{value:"yearly",children:["Yearly ",e.jsx("span",{className:"ml-2 text-emerald-500",children:"Save 20%"})]})]}),e.jsx(oe,{value:"monthly",children:e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2 mt-4",children:[e.jsxs("div",{className:"border rounded-lg p-6 space-y-4 relative overflow-hidden",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Basic"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Essential property insights for casual investors."}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-bold",children:"£9.99"}),e.jsx("span",{className:"text-muted-foreground",children:"/month"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Basic property data"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"5 saved properties"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Limited market insights"})]})]}),e.jsx(_,{className:"w-full",onClick:()=>l("basic"),children:(r==null?void 0:r.subscription_tier)==="basic"?"Current Plan":"Subscribe"})]}),e.jsxs("div",{className:"border rounded-lg p-6 space-y-4 relative overflow-hidden bg-gradient-to-b from-blue-50 to-white dark:from-blue-950 dark:to-background",children:[e.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 text-xs font-medium rounded-bl-lg",children:"POPULAR"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Pro"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Advanced tools for serious property investors."}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-bold",children:"£29.99"}),e.jsx("span",{className:"text-muted-foreground",children:"/month"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:e.jsx("span",{className:"font-medium",children:"Everything in Basic"})})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Detailed investment metrics"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"50 saved properties"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Full market insights access"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Priority customer support"})]})]}),e.jsx(_,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:()=>l("pro"),children:(r==null?void 0:r.subscription_tier)==="pro"?"Current Plan":"Subscribe"})]})]})}),e.jsx(oe,{value:"yearly",children:e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2 mt-4",children:[e.jsxs("div",{className:"border rounded-lg p-6 space-y-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute -top-1 -right-1 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100 px-3 py-1 text-xs font-medium transform rotate-12",children:"SAVE 20%"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Basic Annual"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Essential property insights for casual investors."}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-bold",children:"£95.90"}),e.jsx("span",{className:"text-muted-foreground",children:"/year"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Equivalent to £7.99/month"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Basic property data"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"5 saved properties"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Limited market insights"})]})]}),e.jsx(_,{className:"w-full",onClick:()=>l("basic-annual"),children:(r==null?void 0:r.subscription_tier)==="basic"&&(r==null?void 0:r.subscription_status)==="yearly"?"Current Plan":"Subscribe"})]}),e.jsxs("div",{className:"border rounded-lg p-6 space-y-4 relative overflow-hidden bg-gradient-to-b from-blue-50 to-white dark:from-blue-950 dark:to-background",children:[e.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 text-xs font-medium rounded-bl-lg",children:"BEST VALUE"}),e.jsx("div",{className:"absolute -top-1 -right-12 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100 px-3 py-1 text-xs font-medium transform rotate-12",children:"SAVE 20%"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Pro Annual"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Advanced tools for serious property investors."}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-bold",children:"£287.90"}),e.jsx("span",{className:"text-muted-foreground",children:"/year"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Equivalent to £23.99/month"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:e.jsx("span",{className:"font-medium",children:"Everything in Basic"})})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Detailed investment metrics"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"50 saved properties"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Full market insights access"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-emerald-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:"Priority customer support"})]})]}),e.jsx(_,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:()=>l("pro-annual"),children:(r==null?void 0:r.subscription_tier)==="pro"&&(r==null?void 0:r.subscription_status)==="yearly"?"Current Plan":"Subscribe"})]})]})})]}),e.jsx(ut,{className:"mt-6",children:e.jsx(_,{variant:"outline",onClick:a,children:"Cancel"})})]})})}const Li=["badword1","badword2"];function Di(s){let a=s.toLowerCase();return Li.forEach(t=>{const r=new RegExp(t,"gi");a=a.replace(r,"*".repeat(t.length))}),a}async function yr(s,a,t){try{const{data:r,error:n}=await K.auth.getUser();if(n||!r.user)throw console.error("Authentication error:",n),new Error("User not authenticated");console.log("Sending message:",{sender_id:r.user.id,receiver_id:s,deal_id:t,content:a.substring(0,20)+"..."});const{data:l,error:i}=await K.from("messages").insert({sender_id:r.user.id,receiver_id:s,content:Di(a),deal_id:t,is_read:!1}).select(`
        *,
        sender:profiles!sender_id(id, full_name, avatar_url),
        receiver:profiles!receiver_id(id, full_name, avatar_url),
        deal:deals(*)
      `).single();if(i)throw console.error("Database error:",i),i;if(!l)throw console.error("No data returned from insert"),new Error("Failed to send message");return console.log("Message sent successfully:",{messageId:l.id}),l}catch(r){return console.error("Error sending message:",r),null}}async function Fi(){try{const{data:{session:s},error:a}=await K.auth.getSession();if(a)return console.error("Session error in getConversations:",a),[];if(!s){console.log("No active session found in getConversations - trying getUser fallback");const{data:r,error:n}=await K.auth.getUser();if(n||!(r!=null&&r.user))return console.error("User not authenticated in getConversations:",n||"No user data"),[];const l=r.user.id;return console.log(`Found user via getUser: ${l}`),await Et(l)}const t=s.user.id;return console.log(`Using session user for conversations: ${t}`),await Et(t)}catch(s){return console.error("Error getting conversations:",s),[]}}async function Et(s){const{data:a,error:t}=await K.from("messages").select(`
      *,
      sender:profiles!sender_id(id, full_name, avatar_url),
      receiver:profiles!receiver_id(id, full_name, avatar_url),
      deal:deals(*)
    `).filter("sender_id","eq",s).filter("receiver_id","eq",s,{foreignTable:"or"}).order("created_at",{ascending:!1});if(t)return console.error("Error fetching conversations:",t),[];const r=new Map;return a==null||a.forEach(n=>{const l=n.sender_id===s?n.receiver:n.sender,i=l.id;if(!r.has(i))r.set(i,{user:l,lastMessage:n,unreadCount:n.receiver_id===s&&!n.is_read?1:0});else if(n.receiver_id===s&&!n.is_read){const j=r.get(i);j.unreadCount++}}),Array.from(r.values())}async function Nr(s){try{const{data:a,error:t}=await K.auth.getUser();if(t||!a.user)throw console.error("Authentication error:",t),new Error("User not authenticated");console.log("Fetching messages with user:",s);const{data:r,error:n}=await K.from("messages").select(`
        *,
        sender:profiles!sender_id(id, full_name, avatar_url),
        receiver:profiles!receiver_id(id, full_name, avatar_url),
        deal:deals(*)
      `).or(`and(sender_id.eq.${a.user.id},receiver_id.eq.${s}),and(sender_id.eq.${s},receiver_id.eq.${a.user.id})`).order("created_at",{ascending:!0});if(n)throw console.error("Database error:",n),n;console.log(`Found ${(r==null?void 0:r.length)||0} messages`);const l=(r==null?void 0:r.filter(i=>i.receiver_id===a.user.id&&!i.is_read))||[];if(l.length>0){console.log(`Marking ${l.length} messages as read`);const{error:i}=await K.from("messages").update({is_read:!0}).in("id",l.map(j=>j.id));i&&console.error("Error marking messages as read:",i)}return r||[]}catch(a){return console.error("Error getting messages:",a),[]}}function Oi(s){try{return K.channel("messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},async t=>{const{data:r,error:n}=await K.from("messages").select(`
              *,
              sender:profiles!sender_id(id, full_name, avatar_url),
              receiver:profiles!receiver_id(id, full_name, avatar_url),
              deal:deals(*)
            `).eq("id",t.new.id).single();!n&&r&&s(r)}).subscribe()}catch(a){return console.error("Error subscribing to messages:",a),null}}async function Ui(s){try{let a;const{data:{session:t}}=await K.auth.getSession();if(t)a=t.user.id,console.log(`Using session user for search: ${a}`);else{const{data:i,error:j}=await K.auth.getUser();if(j||!(i!=null&&i.user))throw console.error("Failed to get authenticated user:",j),new Error("Authentication required to search users");a=i.user.id,console.log(`Using getUser result for search: ${a}`)}let r=K.from("profiles").select("id, full_name, email, avatar_url").neq("id",a);if(s&&s.trim()){const i=`%${s.trim()}%`;r=r.or(`full_name.ilike.${i},email.ilike.${i}`)}const{data:n,error:l}=await r;return l?(console.error("Database error in searchUsers:",l),[]):(console.log(`Search found ${(n==null?void 0:n.length)||0} users`),n||[])}catch(a){return console.error("Error in searchUsers:",a),[]}}function Ke({size:s="md",className:a}){const t={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"};return e.jsx("div",{className:k("animate-spin rounded-full border-2 border-current border-t-transparent",t[s],a)})}const br=({isOpen:s,onClose:a,receiverId:t,dealId:r})=>{const{user:n}=Q(),[l,i]=o.useState([]),[j,h]=o.useState(""),[y,u]=o.useState(!1),[g,f]=o.useState(null),N=o.useRef(null);o.useEffect(()=>{s&&t?v():(i([]),h(""))},[s,t]),o.useEffect(()=>{w()},[l]);const v=async()=>{if(t)try{u(!0);const c=await Nr(t);if(i(c),c.length>0){const d=c[0],b=d.sender_id===(n==null?void 0:n.id)?d.receiver:d.sender;f(b)}}catch(c){console.error("Error loading messages:",c)}finally{u(!1)}},I=async c=>{if(c.preventDefault(),!(!t||!j.trim()))try{const d=await yr(t,j.trim(),r);d&&(i(b=>[...b,d]),h(""))}catch(d){console.error("Error sending message:",d)}},w=()=>{var c;(c=N.current)==null||c.scrollIntoView({behavior:"smooth"})};return e.jsx(Ge,{open:s,onOpenChange:c=>!c&&a(),children:e.jsxs(Oe,{className:"max-w-screen-md w-full",children:[e.jsx(Ue,{children:e.jsx(ze,{children:g?`Messages with ${g.full_name}`:"Messages"})}),e.jsxs("div",{className:"h-[400px] flex flex-col",children:[y?e.jsx("div",{className:"flex-1 flex justify-center items-center",children:e.jsx(Ke,{})}):e.jsxs(ss,{className:"flex-1 pr-4 mb-4",children:[l.length===0?e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:"No messages yet. Send a message to start the conversation."}):l.map(c=>e.jsxs("div",{className:`flex mb-4 ${c.sender_id===(n==null?void 0:n.id)?"justify-end":"justify-start"}`,children:[c.sender_id!==(n==null?void 0:n.id)&&e.jsxs(Le,{className:"mr-2 mt-1",children:[e.jsx(De,{src:c.sender.avatar_url}),e.jsx(Fe,{children:c.sender.full_name.charAt(0)})]}),e.jsxs("div",{className:`max-w-[70%] ${c.sender_id===(n==null?void 0:n.id)?"bg-primary text-primary-foreground":"bg-muted"} rounded-lg p-3`,children:[e.jsx("p",{children:c.content}),e.jsx("p",{className:"text-xs mt-1 opacity-70",children:st(new Date(c.created_at),{addSuffix:!0})})]})]},c.id)),e.jsx("div",{ref:N})]}),e.jsxs("form",{onSubmit:I,className:"flex gap-2",children:[e.jsx(q,{value:j,onChange:c=>h(c.target.value),placeholder:"Type a message...",autoFocus:!0}),e.jsx(_,{type:"submit",size:"icon",children:e.jsx(os,{className:"h-4 w-4"})})]})]})]})})};function zi(){const[s,a]=S.useState("");return S.useEffect(()=>{fetch("https://uselessfacts.jsph.pl/api/v2/facts/random?language=en").then(t=>t.json()).then(t=>a(t.text)).catch(t=>console.error("Error fetching random fact:",t))},[]),s?e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[e.jsx(Qr,{className:"w-4 h-4"}),e.jsx("p",{children:s})]}):null}function gt(){return e.jsx("footer",{className:"bg-gray-900 text-white py-8 sm:py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"About Us"}),e.jsx("p",{className:"text-gray-400",children:"Your trusted source for property search and market analysis."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Legal"}),e.jsxs("ul",{className:"space-y-2 text-gray-400",children:[e.jsx("li",{children:e.jsx("a",{href:"/terms",className:"hover:text-white",children:"Terms of Service"})}),e.jsx("li",{children:e.jsx("a",{href:"/privacy",className:"hover:text-white",children:"Privacy Policy"})}),e.jsx("li",{children:e.jsx("a",{href:"/disclaimer",className:"hover:text-white",children:"Legal Disclaimer"})}),e.jsx("li",{children:e.jsx("a",{href:"/gdpr",className:"hover:text-white",children:"GDPR Compliance"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Contact"}),e.jsxs("ul",{className:"space-y-2 text-gray-400",children:[e.jsx("li",{children:"info@myvge.com"}),e.jsx("li",{children:"Lytchett House, 13 Freeland Park, Poole, Dorset, England, BH16 6FA"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Compliance"}),e.jsx("ul",{className:"space-y-2 text-gray-400",children:e.jsx("li",{children:"Company No: 15271126"})})]})]}),e.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-800 space-y-4",children:[e.jsx(zi,{}),e.jsxs("div",{className:"text-center text-gray-400 space-y-2",children:[e.jsx("p",{className:"text-xs",children:"MyVGE is registered in England and Wales. Registered office: Lytchett House, 13 Freeland Park, Poole, Dorset, England, BH16 6FA. Company No: 15271126"}),e.jsx("p",{className:"text-xs",children:"The information on this website is for general information purposes only and does not constitute financial advice."}),e.jsxs("p",{children:["© ",new Date().getFullYear()," MyVGE. All rights reserved."]})]})]})]})})}const $i=as("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),hs=o.forwardRef(({className:s,variant:a,...t},r)=>e.jsx("div",{ref:r,role:"alert",className:k($i({variant:a}),s),...t}));hs.displayName="Alert";const ft=o.forwardRef(({className:s,...a},t)=>e.jsx("h5",{ref:t,className:k("mb-1 font-medium leading-none tracking-tight",s),...a}));ft.displayName="AlertTitle";const xs=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:k("text-sm [&_p]:leading-relaxed",s),...a}));xs.displayName="AlertDescription";function wr(){return e.jsxs(hs,{className:"bg-muted/50 border-muted-foreground/20",children:[e.jsx(Bs,{className:"h-4 w-4"}),e.jsx(xs,{className:"text-xs text-muted-foreground",children:"The information provided on this website is for general informational purposes only and should not be considered as financial or investment advice. Property investments carry risks and values can go down as well as up. Always seek professional advice before making investment decisions."})]})}async function Lt(s,a){try{const t=(s-1)*a;console.log("Production URL:","https://zcuapuvvygahkzljuhyg.supabase.co"),console.log("Fetching properties with params:",{page:s,perPage:a,start:t});const{data:r,error:n}=await je.from("properties").select(`
        id,
        title,
        description,
        location,
        price,
        beds,
        baths,
        sqft,
        image_url,
        is_featured,
        created_at,
        updated_at
      `).eq("is_featured",!0).range(t,t+a-1).order("created_at",{ascending:!1});if(console.log("Raw Supabase response:",{data:r,error:n}),n)throw console.error("Supabase error:",n),n;if(!r||r.length===0)return console.log("No properties found"),[];const l=r.map(i=>({id:i.id||"",title:i.title||"",description:i.description||"",location:i.location||"",price:Number(i.price)||0,beds:Number(i.beds)||0,baths:Number(i.baths)||0,sqft:Number(i.sqft)||0,image_url:i.image_url||"",is_featured:!!i.is_featured,created_at:i.created_at||new Date().toISOString(),updated_at:i.updated_at||new Date().toISOString()}));return console.log("Mapped properties:",l),l}catch(t){return console.error("Error in getFeaturedProperties:",t),[]}}async function Bi(s){try{const{data:a,error:t}=await je.from("properties").select(`
        id,
        title,
        location,
        price,
        sqft,
        beds,
        baths,
        description,
        image_url,
        is_featured,
        created_at,
        updated_at
      `).or(`
        location.ilike.%${s}%,
        description.ilike.%${s}%,
        title.ilike.%${s}%
      `).order("created_at",{ascending:!1});if(t)throw t;return a||[]}catch(a){return console.error("Error searching properties:",a),[]}}async function qi(s){const{data:a,error:t}=await je.from("saved_properties").select(`
      *,
      property:properties(*)
    `).eq("user_id",s);if(t)throw t;return a}async function Gi(s,a){try{const t=(s-1)*a;console.log("Fetching deals with params:",{page:s,perPage:a,start:t});const{data:r,error:n}=await je.from("deals").select(`
        id,
        title,
        description,
        location,
        price,
        roi_percentage,
        investment_term,
        property_type,
        deal_type,
        image_url,
        created_at,
        updated_at
      `).range(t,t+a-1).order("created_at",{ascending:!1});if(console.log("Raw Supabase deals response:",{data:r,error:n}),n)throw console.error("Supabase error:",n),n;if(!r||r.length===0)return console.log("No deals found"),[];const l=r.map(i=>({id:i.id||"",title:i.title||"",description:i.description||"",location:i.location||"",price:Number(i.price)||0,roi_percentage:Number(i.roi_percentage)||0,investment_term:i.investment_term||"",property_type:i.property_type||"",deal_type:i.deal_type||"",image_url:i.image_url||"",created_at:i.created_at||new Date().toISOString(),updated_at:i.updated_at||new Date().toISOString()}));return console.log("Mapped deals:",l),l}catch(t){return console.error("Error in getDeals:",t),[]}}const Vi=(s=6)=>en({queryKey:["deals"],queryFn:({pageParam:a=1})=>Gi(a,s),getNextPageParam:(a,t)=>a.length===s?t.length+1:void 0,staleTime:5*60*1e3,cacheTime:30*60*1e3}),_s=({children:s,direction:a="left",pauseOnHover:t=!1,reverse:r=!1,fade:n=!1,className:l,vertical:i=!1})=>e.jsxs("div",{className:k("group flex gap-4 overflow-hidden",i?"flex-col":"flex-row",l),children:[e.jsx("div",{className:k("flex min-w-full shrink-0 animate-marquee items-center justify-around gap-4",i?"flex-col":"flex-row",t&&"group-hover:[animation-play-state:paused]",r&&"animate-marquee-reverse"),children:s}),e.jsx("div",{className:k("flex min-w-full shrink-0 animate-marquee items-center justify-around gap-4",i?"flex-col":"flex-row",t&&"group-hover:[animation-play-state:paused]",r&&"animate-marquee-reverse"),children:s})]}),Hi=({baseColor:s=[.1,.1,.1],speed:a=.2,amplitude:t=.5,frequencyX:r=3,frequencyY:n=2,interactive:l=!0,...i})=>{const j=o.useRef(null);return o.useEffect(()=>{if(!j.current)return;const h=j.current,y=new Ca({antialias:!0}),u=y.gl;u.clearColor(1,1,1,1);const g=`
      attribute vec2 position;
      attribute vec2 uv;
      varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = vec4(position, 0.0, 1.0);
      }
    `,f=`
      precision highp float;
      uniform float uTime;
      uniform vec3 uResolution;
      uniform vec3 uBaseColor;
      uniform float uAmplitude;
      uniform float uFrequencyX;
      uniform float uFrequencyY;
      uniform vec2 uMouse;
      varying vec2 vUv;

      vec4 renderImage(vec2 uvCoord) {
          vec2 fragCoord = uvCoord * uResolution.xy;
          vec2 uv = (2.0 * fragCoord - uResolution.xy) / min(uResolution.x, uResolution.y);

          for (float i = 1.0; i < 10.0; i++){
              uv.x += uAmplitude / i * cos(i * uFrequencyX * uv.y + uTime + uMouse.x * 3.14159);
              uv.y += uAmplitude / i * cos(i * uFrequencyY * uv.x + uTime + uMouse.y * 3.14159);
          }

          vec2 diff = (uvCoord - uMouse);
          float dist = length(diff);
          float falloff = exp(-dist * 20.0);
          float ripple = sin(10.0 * dist - uTime * 2.0) * 0.03;
          uv += (diff / (dist + 0.0001)) * ripple * falloff;

          vec3 color = uBaseColor / abs(sin(uTime - uv.y - uv.x));
          return vec4(color, 1.0);
      }

      void main() {
          vec4 col = vec4(0.0);
          int samples = 0;
          for (int i = -1; i <= 1; i++){
              for (int j = -1; j <= 1; j++){
                  vec2 offset = vec2(float(i), float(j)) * (1.0 / min(uResolution.x, uResolution.y));
                  col += renderImage(vUv + offset);
                  samples++;
              }
          }
          gl_FragColor = col / float(samples);
      }
    `,N=new Pa(u),v=new Aa(u,{vertex:g,fragment:f,uniforms:{uTime:{value:0},uResolution:{value:new Float32Array([u.canvas.width,u.canvas.height,u.canvas.width/u.canvas.height])},uBaseColor:{value:new Float32Array(s)},uAmplitude:{value:t},uFrequencyX:{value:r},uFrequencyY:{value:n},uMouse:{value:new Float32Array([0,0])}}}),I=new Ia(u,{geometry:N,program:v});function w(){y.setSize(h.offsetWidth*1,h.offsetHeight*1);const A=v.uniforms.uResolution.value;A[0]=u.canvas.width,A[1]=u.canvas.height,A[2]=u.canvas.width/u.canvas.height}window.addEventListener("resize",w),w();function c(O){const A=h.getBoundingClientRect(),L=(O.clientX-A.left)/A.width,z=1-(O.clientY-A.top)/A.height,p=v.uniforms.uMouse.value;p[0]=L,p[1]=z}function d(O){if(O.touches.length>0){const A=O.touches[0],L=h.getBoundingClientRect(),z=(A.clientX-L.left)/L.width,p=1-(A.clientY-L.top)/L.height,M=v.uniforms.uMouse.value;M[0]=z,M[1]=p}}l&&(h.addEventListener("mousemove",c),h.addEventListener("touchmove",d));let b;function C(O){b=requestAnimationFrame(C),v.uniforms.uTime.value=O*.001*a,y.render({scene:I})}return b=requestAnimationFrame(C),h.appendChild(u.canvas),()=>{var O;cancelAnimationFrame(b),window.removeEventListener("resize",w),l&&(h.removeEventListener("mousemove",c),h.removeEventListener("touchmove",d)),u.canvas.parentElement&&u.canvas.parentElement.removeChild(u.canvas),(O=u.getExtension("WEBGL_lose_context"))==null||O.loseContext()}},[s,a,t,r,n,l]),e.jsx("div",{ref:j,className:"w-full h-full",...i})};function Wi({isOpen:s,onClose:a,property:t,currentUser:r,userProfile:n}){var O,A;const l=!!r,i=(n==null?void 0:n.subscription_tier)==="pro";if(!t)return null;const j=t.price?V(Number(t.price)):"Price on application";let h=t.location||t.address||"Address not available",y=t.postcode||((A=(O=t.location)==null?void 0:O.match(/[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}/i))==null?void 0:A[0])||"";const u=t.property_type||"Residential",g=t.beds||t.bedrooms||0,f=t.baths||t.bathrooms||0,N=t.square_footage||t.sqft||0,v=t.tenure||"Freehold",I=t.description||"No description available",c=(t.sale_history||[]).filter(L=>L&&L.sale_price&&!isNaN(Number(L.sale_price))).sort((L,z)=>new Date(z.sale_date).getTime()-new Date(L.sale_date).getTime());let d=0;if(c.length>1){const L=Number(c[0].sale_price),z=Number(c[c.length-1].sale_price);d=(L-z)/z*100}const C=((L,z,p,M)=>{const R=L*(1-z/100),$=p/100/12,J=M*12,ee=R*$*Math.pow(1+$,J)/(Math.pow(1+$,J)-1);return{monthlyPayment:ee,totalInterest:ee*J-R,totalCost:ee*J}})(Number(t.price)||0,20,4.5,25);return e.jsx(Ge,{open:s,onOpenChange:a,children:e.jsxs(Oe,{className:"max-w-full sm:max-w-3xl md:max-w-4xl max-h-[90vh] overflow-y-auto p-0 w-[95vw] mx-auto",children:[e.jsxs("div",{className:"relative h-56 sm:h-64 md:h-72 overflow-hidden",children:[e.jsx("img",{src:t.image_url||`https://source.unsplash.com/random/1200x600?property,house&sig=${t.id}`,alt:h,className:"w-full h-full object-cover"}),e.jsxs("div",{className:"absolute top-4 left-4 flex gap-2",children:[e.jsx(ce,{className:"bg-primary text-white",children:u}),t.status&&e.jsx(ce,{variant:"secondary",children:t.status})]}),e.jsx("button",{className:"absolute top-4 right-4 bg-black/50 text-white rounded-full p-2",onClick:a,"aria-label":"Close",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs(Ue,{className:"mb-4 sm:mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-2",children:[e.jsx(ze,{className:"text-xl sm:text-2xl font-bold",children:j}),e.jsxs("div",{className:"flex items-center gap-1 self-end sm:self-auto",children:[e.jsx(_,{variant:"outline",size:"sm",className:"text-xs sm:text-sm h-8",onClick:L=>L.stopPropagation(),children:"Save"}),e.jsx(_,{variant:"outline",size:"sm",className:"text-xs sm:text-sm h-8",onClick:L=>L.stopPropagation(),children:"Share"})]})]}),e.jsx(ts,{className:"text-sm sm:text-base font-medium text-foreground mt-1",children:h})]}),e.jsxs(Ze,{defaultValue:"details",className:"mt-4 sm:mt-6",children:[e.jsxs(Xe,{className:"grid grid-cols-3 w-full mb-4 sm:mb-6 h-auto",children:[e.jsx(me,{value:"details",className:"text-xs sm:text-sm py-1.5 px-1 sm:py-2 sm:px-4",children:"Property Details"}),e.jsx(me,{value:"investment",className:"text-xs sm:text-sm py-1.5 px-1 sm:py-2 sm:px-4",children:"Investment Metrics"}),e.jsx(me,{value:"history",className:"text-xs sm:text-sm py-1.5 px-1 sm:py-2 sm:px-4",children:"History & Area"})]}),e.jsxs(oe,{value:"details",className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center p-2 sm:p-3 bg-muted rounded-lg",children:[e.jsx(Ps,{className:"h-4 w-4 sm:h-5 sm:w-5 mb-1 text-muted-foreground"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium",children:[g," Beds"]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-2 sm:p-3 bg-muted rounded-lg",children:[e.jsx(sn,{className:"h-4 w-4 sm:h-5 sm:w-5 mb-1 text-muted-foreground"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium",children:[f," Baths"]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-2 sm:p-3 bg-muted rounded-lg",children:[e.jsx(La,{className:"h-4 w-4 sm:h-5 sm:w-5 mb-1 text-muted-foreground"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium",children:[ar(N)," sq ft"]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-2 sm:p-3 bg-muted rounded-lg",children:[e.jsx(mt,{className:"h-4 w-4 sm:h-5 sm:w-5 mb-1 text-muted-foreground"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:v})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-2 flex items-center",children:[e.jsx(Ye,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-muted-foreground"}),"Location"]}),e.jsxs("div",{className:"bg-muted rounded-lg p-3 sm:p-4",children:[e.jsxs("p",{className:"text-xs sm:text-sm mb-1",children:[e.jsx("span",{className:"font-medium",children:"Address:"})," ",h]}),y&&e.jsxs("p",{className:"text-xs sm:text-sm",children:[e.jsx("span",{className:"font-medium",children:"Postcode:"})," ",y]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-2 flex items-center",children:[e.jsx(Bs,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-muted-foreground"}),"Description"]}),e.jsx("div",{className:"bg-muted rounded-lg p-3 sm:p-4",children:e.jsx("p",{className:"text-xs sm:text-sm whitespace-pre-line",children:I})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-2 flex items-center",children:[e.jsx(qe,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-muted-foreground"}),"Property Documents"]}),e.jsx("div",{className:"bg-muted rounded-lg p-3 sm:p-4",children:e.jsx("p",{className:"text-xs sm:text-sm mb-2",children:l&&i?e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-center",children:[e.jsx(qe,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-primary underline cursor-pointer text-xs sm:text-sm",children:"Energy Performance Certificate (EPC)"})]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(qe,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-primary underline cursor-pointer text-xs sm:text-sm",children:"Floor Plan"})]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(qe,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-primary underline cursor-pointer text-xs sm:text-sm",children:"Property Brochure"})]})]}):e.jsxs("div",{className:"text-center py-2",children:[e.jsx("p",{className:"text-muted-foreground mb-2 text-xs sm:text-sm",children:"Upgrade to PRO to access property documents"}),e.jsx(_,{className:"text-xs sm:text-sm",size:"sm",children:"Upgrade Now"})]})})})]})]}),e.jsx(oe,{value:"investment",className:"space-y-4 sm:space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-2 sm:mb-3 flex items-center",children:[e.jsx(ue,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-muted-foreground"}),"Investment Metrics"]}),e.jsxs("div",{className:"bg-muted rounded-lg p-3 sm:p-4 space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Estimated Monthly Rent"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:V(t.estimated_rent||t.price*.004)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Rental Yield"}),e.jsxs("span",{className:"font-medium text-xs sm:text-sm",children:[t.rental_yield?t.rental_yield.toFixed(2):(t.price*.004*12/t.price*100).toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Estimated ROI (5yr)"}),e.jsxs("span",{className:"font-medium text-xs sm:text-sm",children:[t.roi?t.roi.toFixed(2):(t.price*.25/t.price*100).toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Price per sq ft"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:N>0?V(t.price/N):"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-2 sm:mb-3 flex items-center",children:[e.jsx(At,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-muted-foreground"}),"Area Insights"]}),e.jsxs("div",{className:"bg-muted rounded-lg p-3 sm:p-4 space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Average Area Price"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:V(t.area_avg_price||t.price*1.1)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Price vs. Area Average"}),e.jsx("div",{className:"flex items-center",children:t.price<(t.area_avg_price||t.price*1.1)?e.jsxs(e.Fragment,{children:[e.jsx(Da,{className:"h-3 w-3 sm:h-4 sm:w-4 text-green-500 mr-1"}),e.jsxs("span",{className:"text-green-500 font-medium text-xs sm:text-sm",children:[(((t.area_avg_price||t.price*1.1)-t.price)/(t.area_avg_price||t.price*1.1)*100).toFixed(1),"% below"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-3 w-3 sm:h-4 sm:w-4 text-amber-500 mr-1"}),e.jsxs("span",{className:"text-amber-500 font-medium text-xs sm:text-sm",children:[((t.price-(t.area_avg_price||t.price*.9))/(t.area_avg_price||t.price*.9)*100).toFixed(1),"% above"]})]})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"12-month Price Trend"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{className:"h-3 w-3 sm:h-4 sm:w-4 text-green-500 mr-1"}),e.jsx("span",{className:"text-green-500 font-medium text-xs sm:text-sm",children:"+4.2%"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-2 sm:mb-3 flex items-center",children:[e.jsx(ue,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-muted-foreground"}),"Mortgage Calculator"]}),e.jsxs("div",{className:"bg-muted rounded-lg p-3 sm:p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 mb-3 sm:mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm mb-1",children:"Property Price"}),e.jsx("p",{className:"text-sm sm:text-base font-medium",children:V(Number(t.price)||0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm mb-1",children:"Monthly Payment"}),e.jsx("p",{className:"text-sm sm:text-base font-medium",children:V(C.monthlyPayment)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm mb-1",children:"Total Interest"}),e.jsx("p",{className:"text-sm sm:text-base font-medium",children:V(C.totalInterest)})]})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground text-center mt-2",children:"Based on 20% down payment, 4.5% interest rate, 25-year term"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-2 sm:mb-3 flex items-center",children:[e.jsx(ue,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-muted-foreground"}),"Cash Flow Analysis"]}),e.jsx("div",{className:"bg-muted rounded-lg p-3 sm:p-4",children:e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Monthly Rental Income"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:V(t.estimated_rent||t.price*.004)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Mortgage Payment"}),e.jsxs("span",{className:"font-medium text-red-500 text-xs sm:text-sm",children:["-",V(C.monthlyPayment)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Est. Maintenance (10%)"}),e.jsxs("span",{className:"font-medium text-red-500 text-xs sm:text-sm",children:["-",V((t.estimated_rent||t.price*.004)*.1)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Est. Management (5%)"}),e.jsxs("span",{className:"font-medium text-red-500 text-xs sm:text-sm",children:["-",V((t.estimated_rent||t.price*.004)*.05)]})]}),e.jsxs("div",{className:"border-t pt-2 mt-2 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"Monthly Cash Flow"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:V((t.estimated_rent||t.price*.004)-C.monthlyPayment-(t.estimated_rent||t.price*.004)*.15)})]})]})})]})]})}),e.jsxs(oe,{value:"history",className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-2 sm:mb-3 flex items-center",children:[e.jsx(Me,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-muted-foreground"}),"Sale History"]}),c.length>0?e.jsxs("div",{className:"bg-muted rounded-lg p-3 sm:p-4",children:[e.jsxs("div",{className:"mb-3 sm:mb-4",children:[d!==0&&e.jsxs("div",{className:"mb-2 sm:mb-3 text-xs sm:text-sm",children:[e.jsx("span",{className:"font-medium",children:"Total price growth: "}),e.jsxs("span",{className:d>=0?"text-green-500":"text-red-500",children:[d>=0?"+":"",d.toFixed(2),"%"]})]}),e.jsx("div",{className:"relative h-16 sm:h-24 mt-4 sm:mt-6 mb-1 sm:mb-2",children:c.map((L,z)=>{const p=Math.max(...c.map(J=>Number(J.sale_price))),M=Number(L.sale_price)/p*100,R=100/c.length,$=z*R;return e.jsx("div",{className:"absolute bottom-0 bg-primary hover:bg-primary/80 rounded-t transition-all cursor-pointer group",style:{height:`${M}%`,width:`${R-5}%`,left:`${$}%`},title:`${es(L.sale_date)}: ${V(Number(L.sale_price))}`,children:e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 absolute -top-9 sm:-top-10 left-1/2 transform -translate-x-1/2 bg-background border p-1 sm:p-2 rounded text-[10px] sm:text-xs whitespace-nowrap z-10",children:[es(L.sale_date),": ",V(Number(L.sale_price))]})},z)})})]}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:c.map((L,z)=>e.jsxs("div",{className:"flex justify-between items-center py-0.5 sm:py-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Me,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-xs sm:text-sm",children:es(L.sale_date)})]}),e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:V(Number(L.sale_price))})]},z))})]}):e.jsx("div",{className:"bg-muted rounded-lg p-3 sm:p-4 text-center",children:e.jsx("p",{className:"text-muted-foreground text-xs sm:text-sm",children:"No sale history available"})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-2 sm:mb-3 flex items-center",children:[e.jsx(At,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 text-muted-foreground"}),"Neighborhood Information"]}),l&&i?e.jsxs("div",{className:"bg-muted rounded-lg p-3 sm:p-4 space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Local Schools"}),e.jsx(ce,{variant:"outline",className:"text-xs",children:"Good"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Transport Links"}),e.jsx(ce,{variant:"outline",className:"text-xs",children:"Excellent"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Local Amenities"}),e.jsx(ce,{variant:"outline",className:"text-xs",children:"Good"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm",children:"Crime Rate"}),e.jsx(ce,{variant:"outline",className:"text-xs",children:"Low"})]}),e.jsx("div",{className:"mt-2 pt-2 border-t",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"This property is located in a well-established residential area with good local schools and excellent transport links. The neighborhood has seen steady property value growth over the past 5 years."})})]}):e.jsxs("div",{className:"bg-muted rounded-lg p-3 sm:p-4 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-2 text-xs sm:text-sm",children:"Upgrade to PRO to access detailed neighborhood information"}),e.jsx(_,{className:"text-xs sm:text-sm",size:"sm",children:"Upgrade Now"})]})]})]})]})]})]})})}const We=[{name:"Savills",username:"@savills",body:"Leading the way in property investment and market analysis.",img:"https://avatar.vercel.sh/savills"},{name:"Knight Frank",username:"@knightfrank",body:"Exceptional platform for property investment insights.",img:"https://avatar.vercel.sh/knightfrank"},{name:"JLL",username:"@jll",body:"Revolutionary approach to property investment analytics.",img:"https://avatar.vercel.sh/jll"}],Yi=We.slice(0,We.length/2),Ki=We.slice(We.length/2),Ji=We.slice(0,We.length/2),Zi=We.slice(We.length/2),ks=({img:s,name:a,username:t,body:r})=>e.jsxs("figure",{className:k("relative h-full w-36 cursor-pointer overflow-hidden rounded-xl border p-4","border-gray-950/[.1] bg-gray-950/[.01] hover:bg-gray-950/[.05]","dark:border-gray-50/[.1] dark:bg-gray-50/[.10] dark:hover:bg-gray-50/[.15]"),children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx("img",{className:"rounded-full",width:"32",height:"32",alt:"",src:s}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("figcaption",{className:"text-sm font-medium dark:text-white",children:a}),e.jsx("p",{className:"text-xs font-medium dark:text-white/40",children:t})]})]}),e.jsx("blockquote",{className:"mt-2 text-sm",children:r})]}),Xi=()=>{var F;const{user:s,profile:a,signOut:t}=Q(),[r,n]=S.useState(!0),[l,i]=S.useState([]),[j,h]=S.useState(!1),[y,u]=S.useState(!1),[g,f]=S.useState(!1),[N,v]=S.useState("signin"),[I,w]=S.useState(!1),[c]=S.useState(),[d,b]=S.useState(1),[C,O]=S.useState(!0),A=6,[L,z]=S.useState(!0),[p,M]=S.useState(!1),[R,$]=S.useState(null),[J,ee]=S.useState(!1),pe=S.useRef(null),he=S.useRef(!1),{data:ae,isLoading:ge}=Vi(),_e=async(m=1,T=!1)=>{if(!he.current){he.current=!0;try{T?M(!0):z(!0),console.log("Fetching page:",m);const H=await Lt(m,A);console.log("Received properties:",H),i(m===1?H:re=>[...re,...H]),O(H.length===A),b(m),n(!1)}catch(H){console.error("Error loading properties:",H)}finally{z(!1),M(!1),he.current=!1}}};S.useEffect(()=>{r&&_e(1,!1)},[r]),S.useEffect(()=>{if(!pe.current||r||j)return;const m=new IntersectionObserver(T=>{T[0].isIntersecting&&C&&!he.current&&_e(d+1,!0)},{rootMargin:"200px",threshold:.1});return m.observe(pe.current),()=>m.disconnect()},[C,d,r,j]);const Pe=async m=>{if(!m.trim()){i([]),h(!1),b(1),O(!0),z(!0);try{const T=await Lt(1,A);i(T),O(T.length===A)}catch(T){console.error("Error loading properties:",T)}finally{z(!1)}return}h(!0),i([]);try{const H=(await Bi(m)).map(re=>({id:re.id,title:re.title,location:re.location,price:re.price,sqft:re.sqft,beds:re.beds,baths:re.baths,description:re.description,image_url:re.image_url,is_featured:re.is_featured,created_at:re.created_at,updated_at:re.updated_at}));i(H),O(!1),b(1)}catch(T){console.error("Error searching properties:",T),i([])}finally{h(!1)}},be=L,ke=l&&l.length>0;return console.log("Render state:",{isLoading:L,searchResultsLength:l==null?void 0:l.length,showLoading:be,showProperties:ke}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ps,{isAuthenticated:!!s,userProfile:a||void 0,onSignIn:()=>{v("signin"),u(!0)},onSignUp:()=>{v("signup"),u(!0)},onSignOut:async()=>{try{await t(),window.location.href="/"}catch(m){console.error("Error signing out:",m)}}}),e.jsxs("main",{children:[e.jsx(Se,{onSearch:Pe}),e.jsx("div",{className:"w-full bg-background py-8",children:e.jsxs("div",{className:"max-w-[1200px] mx-auto px-4 sm:px-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:j?"Search Results":"Featured Properties"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:be?Array(3).fill(0).map((m,T)=>e.jsx("div",{className:"w-full h-[420px] bg-muted rounded-lg animate-pulse"},T)):ke?l.map(m=>e.jsx("div",{onClick:()=>{$(m),ee(!0)},className:"cursor-pointer hover:opacity-90 transition-opacity",children:e.jsx($s,{id:m.id,address:m.location||"Location not available",price:Number(m.price)||0,squareFootage:Number(m.sqft)||0,bedrooms:Number(m.beds)||0,bathrooms:Number(m.baths)||0,isPremium:!!m.is_featured,propertyType:"residential",description:m.description||"",createdAt:m.created_at||new Date().toISOString(),images:m.image_url?[m.image_url]:[],currentUser:s,userProfile:a})},m.id||Math.random().toString())):e.jsx("div",{className:"col-span-3 text-center py-8 text-muted-foreground",children:"No properties found"})}),C&&!L&&!j&&e.jsx("div",{ref:pe,className:"h-24 flex items-center justify-center my-8",children:p?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(Ke,{}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading more properties..."})]}):e.jsx("div",{className:"h-8"})})]})}),e.jsx("div",{className:"w-full bg-background py-8",children:e.jsxs("div",{className:"max-w-[1200px] mx-auto px-4 sm:px-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Investment Deals"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ge?Array(3).fill(0).map((m,T)=>e.jsx("div",{className:"w-full h-[420px] bg-muted rounded-lg animate-pulse"},T)):(F=ae==null?void 0:ae.pages)!=null&&F[0]&&Array.isArray(ae.pages[0])?ae.pages[0].map(m=>e.jsx($s,{id:m.id,address:m.location,price:m.price,description:m.description,propertyType:m.property_type,createdAt:m.created_at,images:[m.image_url],isDeal:!0,roi_percentage:m.roi_percentage,investment_term:m.investment_term,deal_type:m.deal_type,isPremium:!0,currentUser:s,userProfile:a},m.id)):e.jsx("div",{className:"col-span-3 text-center py-8 text-muted-foreground",children:"No investment deals available"})})]})}),e.jsxs("section",{className:"w-full py-12 bg-background",children:[e.jsx("div",{className:"container mx-auto text-center mb-8",children:e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Trusted by Industry Leaders"})}),e.jsxs("div",{className:"relative flex h-96 w-full flex-row items-center justify-center gap-4 overflow-hidden [perspective:300px]",children:[e.jsxs("div",{className:"flex flex-row items-center gap-4",style:{transform:"translateX(-100px) translateY(0px) translateZ(-100px) rotateX(20deg) rotateY(-10deg) rotateZ(20deg)"},children:[e.jsx(_s,{pauseOnHover:!0,vertical:!0,className:"[--duration:20s]",children:Yi.map(m=>e.jsx(ks,{...m},m.username))}),e.jsx(_s,{reverse:!0,pauseOnHover:!0,className:"[--duration:20s]",vertical:!0,children:Ki.map(m=>e.jsx(ks,{...m},m.username))}),e.jsx(_s,{reverse:!0,pauseOnHover:!0,className:"[--duration:20s]",vertical:!0,children:Ji.map(m=>e.jsx(ks,{...m},m.username))}),e.jsx(_s,{pauseOnHover:!0,className:"[--duration:20s]",vertical:!0,children:Zi.map(m=>e.jsx(ks,{...m},m.username))})]}),e.jsx("div",{className:"pointer-events-none absolute inset-x-0 top-0 h-1/4 bg-gradient-to-b from-background"}),e.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 h-1/4 bg-gradient-to-t from-background"}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 w-1/4 bg-gradient-to-r from-background"}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 w-1/4 bg-gradient-to-l from-background"})]})]}),e.jsx("div",{className:"w-full bg-background py-8",children:e.jsx("div",{className:"max-w-[1200px] mx-auto px-4 sm:px-8",children:e.jsx("div",{className:"mb-8",children:e.jsx(wr,{})})})}),(!a||a.subscription_tier==="free")&&e.jsx("div",{className:"w-full bg-background py-16",children:e.jsx("div",{className:"max-w-[1200px] mx-auto px-4 sm:px-8",children:e.jsxs("div",{className:"relative w-full rounded-3xl overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx(Hi,{baseColor:[.1,.1,.1],speed:1,amplitude:.6,interactive:!0})}),e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-[8px]"}),e.jsxs("div",{className:"relative z-10 text-center py-12 px-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 text-white",children:"Unlock Premium Property Insights"}),e.jsx("p",{className:"text-lg text-gray-300 mb-8 max-w-2xl mx-auto",children:"Get access to detailed property analysis, market comparisons, and investment metrics to make informed decisions."}),e.jsx("button",{onClick:()=>f(!0),className:"px-8 py-3 rounded-full bg-primary text-primary-foreground hover:bg-primary/90 transition-colors",children:"Upgrade Now"})]})]})})})]}),e.jsx(gt,{}),e.jsx(pt,{isOpen:y,onClose:()=>u(!1),defaultMode:N}),e.jsx(qs,{isOpen:g,onClose:()=>f(!1),currentUser:s,userProfile:a}),e.jsx(br,{isOpen:I,onClose:()=>w(!1),receiverId:c,currentUser:s,userProfile:a}),e.jsx(Wi,{isOpen:J,onClose:()=>{ee(!1),setTimeout(()=>$(null),300)},property:R,currentUser:s,userProfile:a})]})};function le({children:s}){const{user:a,profile:t,signOut:r,isLoading:n}=Q(),[l,i]=S.useState(!1),[j,h]=S.useState("signin");return e.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[e.jsx(ps,{isAuthenticated:!!a,userProfile:t,onSignIn:()=>window.location.href="/login",onSignUp:()=>window.location.href="/signup",onSignOut:r}),e.jsx("main",{className:"flex-1",children:s}),e.jsx(gt,{}),e.jsx(pt,{isOpen:l,onClose:()=>i(!1),defaultMode:j})]})}function Qi(){const[s,a]=o.useState(null),[t,r]=o.useState(!0);return o.useEffect(()=>{const l=async()=>{try{const y=(await(await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:"What is the current Bitcoin price in GBP? Return ONLY the number, no text or currency symbols."}]}]})})).json()).candidates[0].content.parts[0].text,u=parseFloat(y.replace(/[^0-9.]/g,""));isNaN(u)||(a(u),r(!1))}catch(j){console.error("Error fetching Bitcoin price:",j)}};l();const i=setInterval(l,6e4);return()=>clearInterval(i)},[]),{btcPrice:s,loading:t,convertGBPtoBTC:l=>s?l/s:null}}function el({amount:s}){const{loading:a,convertGBPtoBTC:t}=Qi(),r=t(s);return a?e.jsx("span",{className:"text-muted-foreground",children:"Loading..."}):r?e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Fa,{className:"h-4 w-4 text-[#F7931A]"}),r.toFixed(2)]}):null}async function sl(s,a){var t;try{console.log("Starting profile update for user:",s),console.log("Updates to apply:",a);const{data:r,error:n}=await K.from("profiles").select("role").eq("id",(t=(await K.auth.getUser()).data.user)==null?void 0:t.id);if(n)throw console.error("Admin check error:",n),n;if(!(r!=null&&r.length)||r[0].role!=="admin")throw new Error("Unauthorized: Only admins can update user profiles");const{data:l,error:i}=await K.from("profiles").select("*").eq("id",s);if(i)throw console.error("User verification error:",i),i;if(!(l!=null&&l.length))throw new Error("User not found");console.log("Existing user:",l[0]);const j={...a,updated_at:new Date().toISOString()};console.log("Applying updates:",j);const{data:h,error:y}=await K.from("profiles").update(j).eq("id",s).select();if(y)throw console.error("Profile update error:",y),y;if(!(h!=null&&h.length))throw console.error("No data returned from update"),new Error("Update failed - no data returned");if(console.log("Profile updated successfully:",h[0]),a.role)try{await K.auth.admin.updateUserById(s,{user_metadata:{role:a.role}}),console.log("Auth metadata updated for role change")}catch(u){console.warn("Failed to update auth metadata (non-critical):",u)}return h[0]}catch(r){throw console.error("Error in updateUserProfile:",r),r}}async function Dt(){try{const{data:s,error:a}=await K.from("profiles").select(`
        *,
        subscription_tier,
        subscription_status,
        role
      `).order("created_at",{ascending:!1});if(a)throw console.error("Profiles fetch error:",a),a;return s?s.map(t=>({...t,role:t.role||"user",subscription_tier:t.subscription_tier||"free",subscription_status:t.subscription_status||"active"})):[]}catch(s){throw console.error("Error fetching users:",s),s}}async function tl(s,a){try{console.log("Importing properties:",{count:s.length,userId:a});const{data:t,error:r}=await K.from("properties").insert(s.map(n=>({...n,added_by_user_id:a,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})));if(r)throw console.error("Supabase error:",r),r;return console.log("Import successful:",t),t}catch(t){throw console.error("Error importing properties:",t),t}}const jt=o.forwardRef(({className:s,...a},t)=>e.jsx("textarea",{className:k("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a}));jt.displayName="Textarea";function al({children:s}){const[a,t]=o.useState(!1),[r,n]=o.useState(!0);o.useEffect(()=>{l()},[]);const l=()=>{n(!0);try{const i=Q();t(!0)}catch(i){console.error("Auth context not available:",i),t(!1)}finally{n(!1)}};return r?e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Checking authentication..."})]})}):a?e.jsx(e.Fragment,{children:s}):e.jsx("div",{className:"flex items-center justify-center min-h-[300px]",children:e.jsxs("div",{className:"text-center max-w-md p-6 border rounded-lg bg-muted/50",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Authentication Error"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Unable to access authentication. This may be due to a temporary issue or your session has expired."}),e.jsxs(_,{variant:"outline",onClick:()=>{window.location.reload()},className:"inline-flex items-center gap-2",children:[e.jsx(As,{className:"h-4 w-4"})," Refresh Page"]})]})})}function rl(){const[s,a]=o.useState(!1),[t,r]=o.useState(""),[n,l]=o.useState(!1),[i,j]=o.useState(!1),[h,y]=o.useState([]),[u,g]=o.useState(new Set),[f,N]=o.useState(1),[v,I]=o.useState(1),[w,c]=o.useState(0),[d,b]=o.useState(null),[C,O]=o.useState(""),[A,L]=o.useState(!1),[z,p]=o.useState("idle"),[M,R]=o.useState(""),{user:$}=Q(),{toast:J}=Ce();o.useEffect(()=>{s||(y([]),g(new Set),N(1),I(1),c(0),r(""))},[s]);const ee=async()=>{if(!(!($!=null&&$.id)||u.size===0))try{j(!0);const ae=h.filter(ge=>u.has(ge.id));await tl(ae,$.id),J({title:"Success",description:`Imported ${u.size} properties successfully`}),a(!1)}catch{J({variant:"destructive",title:"Error",description:"Failed to import properties. Please try again."})}finally{j(!1)}},pe=ae=>{ae.target.files&&ae.target.files.length>0&&(b(ae.target.files[0]),O(""))},he=ae=>{O(ae.target.value),b(null)};return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Property Importer"}),e.jsx("p",{className:"text-muted-foreground",children:"Import properties from external sources by uploading a JSON file or pasting JSON data."})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(E,{children:[e.jsxs(B,{children:[e.jsx(Z,{children:"Upload JSON File"}),e.jsx(lt,{children:"Import properties from a JSON file"})]}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-6 text-center hover:bg-muted/50 transition-colors",children:[e.jsx(tn,{className:"h-10 w-10 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Drag and drop a JSON file here, or click to browse"}),e.jsx(q,{type:"file",accept:".json",onChange:pe,className:"hidden",id:"file-upload"}),e.jsx(G,{htmlFor:"file-upload",className:"cursor-pointer",children:e.jsx(_,{variant:"outline",type:"button",children:"Browse Files"})})]}),d&&e.jsxs("div",{className:"bg-muted p-3 rounded text-sm",children:[e.jsx("p",{className:"font-medium mb-1",children:"Selected file:"}),e.jsxs("p",{className:"text-muted-foreground",children:[d.name," (",Math.round(d.size/1024)," KB)"]})]})]})})]}),e.jsxs(E,{children:[e.jsxs(B,{children:[e.jsx(Z,{children:"Paste JSON Data"}),e.jsx(lt,{children:"Paste your JSON data directly"})]}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(jt,{placeholder:'{"properties": [{"address": "123 Main St", "price": 250000, ...}]}',rows:8,value:C,onChange:he,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"JSON must be properly formatted and contain property data."})]})})]})]}),e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsx(_,{onClick:ee,disabled:A||!d&&!C,className:"px-8",children:A?"Importing...":"Import Properties"})}),z!=="idle"&&e.jsxs(hs,{variant:z==="success"?"default":"destructive",className:"mt-6",children:[z==="success"?e.jsx(an,{className:"h-4 w-4"}):e.jsx(rn,{className:"h-4 w-4"}),e.jsx(ft,{children:z==="success"?"Import Successful":"Import Failed"}),e.jsx(xs,{children:M})]}),e.jsxs(E,{className:"mt-8",children:[e.jsx(B,{children:e.jsxs(Z,{className:"flex items-center gap-2",children:[e.jsx(Bs,{className:"h-5 w-5"}),"Import Format Guidelines"]})}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your JSON data should follow this structure:"}),e.jsx("pre",{className:"bg-muted p-4 rounded-md text-xs overflow-auto",children:`{
  "properties": [
    {
      "address": "123 Main Street, London, E1 6AN",
      "price": 450000,
      "type": "flat",
      "bedrooms": 2,
      "bathrooms": 1,
      "size_sqft": 750,
      "description": "A spacious 2 bedroom flat...",
      "images": ["image1.jpg", "image2.jpg"]
    },
    {
      // Additional properties...
    }
  ]
}`}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"You can also import a simple array of property objects."})]})})]})]})}function nl(){return e.jsx(al,{children:e.jsx(rl,{})})}function il(){const{user:s,profile:a}=Q(),t=Ne(),[r,n]=S.useState([]),[l,i]=S.useState([]),[j,h]=S.useState([]),[y,u]=S.useState({totalProperties:0,totalValue:0,averagePrice:0,totalProfit:0,monthlyIncome:0}),[g,f]=S.useState(!0),[N,v]=S.useState(null),I=S.useCallback(async()=>{if(!(!s||(a==null?void 0:a.role)!=="admin"))try{const d=await Dt();h(d)}catch(d){console.error("Error loading users:",d),v("Failed to load users")}finally{f(!1)}},[s,a]),w=async(d,b)=>{try{f(!0),console.log("Attempting to update user:",d),console.log("Updates:",b);const C=await sl(d,b);console.log("Update successful:",C);const O=await Dt();h(O),alert("User updated successfully")}catch(C){console.error("Error updating user:",C),alert(C.message||"Failed to update user. Please check console for details.")}finally{f(!1)}},c=S.useCallback(async()=>{if(s)try{const[d,{data:b}]=await Promise.all([qi(s.id),K.from("properties").select(`*,
            assigned_user:profiles!properties_assigned_user_id_fkey(full_name, email),
            author:profiles!properties_created_by_fkey(full_name, email)`).eq("created_by",s.id)]);i(b||[]),n(d);const C=(b||[]).length+d.length,O=[...b||[],...d].reduce((p,M)=>p+(M.price||0),0),A=O/(C||1),L=[...b||[],...d].reduce((p,M)=>p+(M.potential_profit||0),0),z=[...b||[],...d].reduce((p,M)=>p+(M.monthly_income||0),0);u({totalProperties:C,totalValue:O,averagePrice:A,totalProfit:L,monthlyIncome:z})}catch(d){console.error("Error loading properties:",d)}},[s]);return S.useEffect(()=>{if(!s){t("/");return}c(),I()},[s,t,c,I]),s?e.jsx(le,{children:e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsx(nl,{})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(E,{children:e.jsxs(U,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Portfolio Value"}),e.jsx(ue,{className:"w-5 h-5 text-primary"})]}),e.jsxs("p",{className:"text-3xl font-bold",children:["£",y.totalValue.toLocaleString()]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[y.totalProperties," properties"]})]})}),e.jsx(E,{children:e.jsxs(U,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Average Price"}),e.jsx(tt,{className:"w-5 h-5 text-primary"})]}),e.jsxs("p",{className:"text-3xl font-bold",children:["£",y.averagePrice.toLocaleString()]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Per property"})]})}),e.jsx(E,{children:e.jsxs(U,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Total Profit"}),e.jsx(Je,{className:"w-5 h-5 text-primary"})]}),e.jsxs("p",{className:"text-3xl font-bold",children:["£",y.totalProfit.toLocaleString()]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Estimated profit"})]})}),e.jsx(E,{children:e.jsxs(U,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"BTC Value"}),e.jsx(Fa,{className:"w-5 h-5 text-[#F7931A]"})]}),e.jsx(el,{amount:y.totalValue}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Portfolio in BTC"})]})})]}),(a==null?void 0:a.role)==="admin"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[e.jsx(ht,{className:"w-5 h-5"})," User Management"]})}),N&&e.jsx("div",{className:"text-red-500 mb-4",children:N}),g?e.jsx("div",{children:"Loading..."}):e.jsx("div",{className:"grid gap-4",children:j.map(d=>e.jsx("div",{className:"border p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:d.full_name}),e.jsx("p",{className:"text-sm text-gray-600",children:d.email})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:d.role,onChange:b=>w(d.id,{role:b.target.value}),className:"border rounded p-1",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"moderator",children:"Moderator"}),e.jsx("option",{value:"admin",children:"Admin"})]}),e.jsxs("select",{value:d.subscription_tier,onChange:b=>w(d.id,{subscription_tier:b.target.value}),className:"border rounded p-1",children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"basic",children:"Basic"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"premium",children:"Premium"})]})]})]})},d.id))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[e.jsx(nn,{className:"w-5 h-5"})," Saved Properties"]}),e.jsx("div",{className:"space-y-4",children:r.map(d=>e.jsx($s,{...d.property,isSubscriber:(a==null?void 0:a.subscription_tier)!=="free"},d.property.id))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[e.jsx(tt,{className:"w-5 h-5"})," Added Properties"]}),e.jsx("div",{className:"space-y-4",children:l.map(d=>e.jsx($s,{...d,isSubscriber:(a==null?void 0:a.subscription_tier)!=="free"},d.id))})]})]})]})})}):(t("/"),null)}function ll({onSubscribe:s}){const{profile:a}=Q(),t=(a==null?void 0:a.subscription_tier)||"free";return e.jsx("div",{className:"py-16 bg-background",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Choose Your Plan"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Select the perfect plan for your property investment journey"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-7xl mx-auto",children:Object.entries(Ei).map(([r,n])=>e.jsxs(E,{className:`relative ${r==="PRO"?"border-primary shadow-lg scale-105 bg-gradient-to-r from-emerald-400/10 to-cyan-400/10":""}`,children:[r==="PRO"&&e.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 bg-gradient-to-r from-emerald-400 to-cyan-400 text-white px-4 py-1 rounded-full text-sm font-medium border border-emerald-500/20 shadow-lg",children:"Most Popular"}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-2xl font-bold",children:n.name}),r==="PREMIUM"&&e.jsx(ka,{className:"h-6 w-6 text-yellow-500"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-4xl font-bold",children:n.price}),e.jsx("span",{className:"text-gray-600 ml-2",children:"/month"})]})]}),e.jsx(U,{children:e.jsx("ul",{className:"space-y-3",children:n.features.map((l,i)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(de,{className:"h-5 w-5 text-green-500 mt-0.5"}),e.jsx("span",{children:l})]},i))})}),e.jsx(gs,{children:e.jsx(_,{className:"w-full",variant:r==="PRO"?"default":"outline",onClick:()=>s(n.priceId),disabled:t===r.toLowerCase(),children:t===r.toLowerCase()?"Current Plan":"Subscribe"})})]},r))})]})})}function ol(){const{user:s,profile:a,signOut:t}=Q(),{toast:r}=Ce(),[n,l]=S.useState(!1),[i,j]=S.useState("signin"),h=async y=>{if(!s){localStorage.setItem("pending_subscription_price_id",y),j("signup"),l(!0);return}try{await vr(y,s.id)}catch{r({title:"Error",description:"Failed to start subscription process. Please try again.",variant:"destructive"})}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ps,{isAuthenticated:!!s,userProfile:a||void 0,onSignIn:()=>{j("signin"),l(!0)},onSignUp:()=>{j("signup"),l(!0)},onSignOut:async()=>{try{await t(),window.location.href="/"}catch(y){console.error("Error signing out:",y)}}}),e.jsx(Se,{title:"Choose Your Perfect Plan",subtitle:"Select the perfect subscription plan to unlock premium features and detailed property insights",backgroundImage:"https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?ixlib=rb-4.0.3",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsxs("main",{children:[e.jsx(ll,{onSubscribe:h}),e.jsxs("div",{className:"container mx-auto px-4 py-12",children:[e.jsxs("div",{className:"max-w-4xl mx-auto prose dark:prose-invert mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6",children:"Investment Plans for Every Property Investor"}),e.jsx("p",{children:"Choose from our range of subscription plans designed to meet the needs of property investors at every level. From market analysis to detailed property insights, our plans provide the tools you need to make informed investment decisions."}),e.jsx("h3",{className:"text-2xl font-semibold mt-8 mb-4",children:"Plan Benefits"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Access to comprehensive property market data and analytics"}),e.jsx("li",{children:"Real-time market insights and trend analysis"}),e.jsx("li",{children:"Advanced property search and filtering capabilities"}),e.jsx("li",{children:"Investment calculators and ROI projections"}),e.jsx("li",{children:"Portfolio tracking and management tools"})]}),e.jsx("h3",{className:"text-2xl font-semibold mt-8 mb-4",children:"Why Subscribe?"}),e.jsx("p",{children:"Our subscription plans give you access to premium features and insights that help you stay ahead in the property market. From basic market analysis to advanced AI-powered predictions, we provide the tools you need to make successful property investments."}),e.jsx("h3",{className:"text-2xl font-semibold mt-8 mb-4",children:"Money-Back Guarantee"}),e.jsx("p",{children:"We're confident in the value our platform provides. If you're not satisfied with your subscription within the first 30 days, we'll provide a full refund, no questions asked."})]}),e.jsx(wr,{})]})]}),e.jsx(gt,{}),e.jsx(pt,{isOpen:n,onClose:()=>l(!1),defaultMode:i})]})}function cl(s){const[a,t]=S.useState(0),[r,n]=S.useState(!1),{user:l}=Q(),{toast:i}=Ce(),[j,h]=S.useState({profileImage:"",bannerImage:"",selectedWidgets:[]}),y=async()=>{if(l){n(!0);try{const{error:g}=await K.from("profiles").update({avatar_url:j.profileImage||`https://api.dicebear.com/7.x/avataaars/svg?seed=${l.email}`,banner_url:j.bannerImage||"https://images.unsplash.com/photo-1486406146926-c627a92ad1ab",dashboard_widgets:j.selectedWidgets,onboarding_completed:!0}).eq("id",l.id);if(g)throw g;i({title:"Setup Complete!",description:"Your profile has been updated successfully."}),s.onClose()}catch{i({title:"Error",description:"Failed to update profile. Please try again.",variant:"destructive"})}finally{n(!1)}}},u=[{title:"Profile Image",description:"Add a profile image to personalize your account",component:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{children:"Profile Image URL"}),e.jsx(q,{placeholder:"Enter image URL or leave blank for default avatar",value:j.profileImage,onChange:g=>h(f=>({...f,profileImage:g.target.value}))})]}),j.profileImage&&e.jsx("img",{src:j.profileImage,alt:"Profile Preview",className:"w-24 h-24 rounded-full object-cover mx-auto"})]})},{title:"Dashboard Banner",description:"Choose a banner image for your dashboard",component:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{children:"Banner Image URL"}),e.jsx(q,{placeholder:"Enter banner image URL or leave blank for default",value:j.bannerImage,onChange:g=>h(f=>({...f,bannerImage:g.target.value}))})]}),j.bannerImage&&e.jsx("img",{src:j.bannerImage,alt:"Banner Preview",className:"w-full h-32 object-cover rounded-md"})]})},{title:"Dashboard Widgets",description:"Select the widgets you want to see on your dashboard",component:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:["market_trends","property_news","saved_properties","price_alerts","market_insights","investment_calculator"].map(g=>e.jsx(_,{variant:j.selectedWidgets.includes(g)?"default":"outline",onClick:()=>h(f=>({...f,selectedWidgets:f.selectedWidgets.includes(g)?f.selectedWidgets.filter(N=>N!==g):[...f.selectedWidgets,g]})),className:"h-auto py-4 px-6 text-left flex flex-col items-start space-y-2",children:e.jsx("span",{className:"font-medium capitalize",children:g.replace("_"," ")})},g))})})}];return e.jsx(Ge,{open:s.isOpen,onOpenChange:s.onClose,children:e.jsxs(Oe,{className:"sm:max-w-[600px]",children:[e.jsxs(Ue,{children:[e.jsx(ze,{children:u[a].title}),e.jsx(ts,{children:u[a].description})]}),e.jsx("div",{className:"py-6",children:u[a].component}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(_,{variant:"outline",onClick:()=>t(g=>Math.max(0,g-1)),disabled:a===0,children:"Previous"}),e.jsx(_,{onClick:()=>{a===u.length-1?y():t(g=>Math.min(u.length-1,g+1))},disabled:r,children:a===u.length-1?"Complete Setup":"Next"})]})]})})}function dl(){const s=Ne(),[a]=ln(),{toast:t}=Ce(),{user:r}=Q(),[n,l]=o.useState(!0);return o.useEffect(()=>{a.get("session_id")&&t({title:"Subscription Successful!",description:"Thank you for subscribing. Your premium features are now available."}),n||s("/dashboard")},[n,s,a,t]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"max-w-md w-full mx-auto p-8",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Subscription Successful!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Thank you for subscribing. Your premium features are now available."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Setting up your preferences..."})]})})}),e.jsx(cl,{isOpen:n,onClose:()=>{l(!1),s("/dashboard")}})]})}function ml(){const s=Ne(),{toast:a}=Ce();return o.useEffect(()=>{a({title:"Subscription Cancelled",description:"Your subscription process was cancelled. Please try again if this was a mistake.",variant:"destructive"});const t=setTimeout(()=>{s("/")},3e3);return()=>clearTimeout(t)},[]),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"max-w-md w-full mx-auto p-8",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Subscription Cancelled"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Your subscription process was cancelled. Please try again if this was a mistake."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting you to the homepage..."})]})})})}const hl=5*1024*1024,Ft=["image/jpeg","image/png","image/webp"];function xl({currentAvatarUrl:s,onUpload:a,userInitials:t}){const[r,n]=o.useState(!1),{toast:l}=Ce(),i=S.useRef(null),j=async h=>{var u;const y=(u=h.target.files)==null?void 0:u[0];if(y){if(y.size>hl){l({title:"File too large",description:"Please select an image under 5MB",variant:"destructive"});return}if(!Ft.includes(y.type)){l({title:"Invalid file type",description:"Please select a JPEG, PNG or WebP image",variant:"destructive"});return}try{n(!0),await a(y),l({title:"Success",description:"Profile picture updated successfully"})}catch(g){console.error("Error uploading avatar:",g),l({title:"Upload failed",description:"Failed to update profile picture. Please try again.",variant:"destructive"})}finally{n(!1)}}};return e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs(Le,{className:"h-24 w-24",children:[e.jsx(De,{src:s}),e.jsx(Fe,{children:t})]}),e.jsx("input",{type:"file",ref:i,className:"hidden",accept:Ft.join(","),onChange:j}),e.jsx(_,{variant:"outline",onClick:()=>{var h;return(h=i.current)==null?void 0:h.click()},disabled:r,children:r?"Uploading...":"Change Profile Picture"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Maximum file size: 5MB. Supported formats: JPEG, PNG, WebP"})]})}function Ot(){var u;const{user:s,profile:a}=Q(),{toast:t}=Ce(),[r,n]=o.useState(!1),[l,i]=o.useState({fullName:(a==null?void 0:a.full_name)||"",currentPassword:"",newPassword:"",confirmPassword:""}),j=async g=>{if(s)try{const f=g.name.split(".").pop(),N=`${s.id}-${Date.now()}.${f}`,v=`${s.id}/${N}`,{error:I,data:w}=await K.storage.from("avatars").upload(v,g,{cacheControl:"3600",upsert:!0});if(I)throw console.error("Upload error:",I),I;const{data:{publicUrl:c}}=K.storage.from("avatars").getPublicUrl(v);console.log("File uploaded, public URL:",c);const{error:d}=await K.from("profiles").update({avatar_url:c,updated_at:new Date().toISOString()}).eq("id",s.id);if(d)throw console.error("Profile update error:",d),d;const{data:b,error:C}=await K.from("profiles").select("avatar_url").eq("id",s.id).single();if(C)throw console.error("Verification error:",C),C;console.log("Profile updated with new avatar:",b),window.location.reload()}catch(f){throw console.error("Error in handleAvatarUpload:",f),f}},h=async g=>{if(g.preventDefault(),!!s)try{if(n(!0),l.fullName!==(a==null?void 0:a.full_name)){const{error:f}=await K.from("profiles").update({full_name:l.fullName}).eq("id",s.id);if(f)throw f}if(l.newPassword){if(l.newPassword!==l.confirmPassword)throw new Error("New passwords do not match");const{error:f}=await K.auth.updateUser({password:l.newPassword});if(f)throw f}t({title:"Success",description:"Profile updated successfully"}),i(f=>({...f,currentPassword:"",newPassword:"",confirmPassword:""}))}catch(f){console.error("Error updating profile:",f),t({title:"Update failed",description:f.message||"Failed to update profile",variant:"destructive"})}finally{n(!1)}},y=((u=a==null?void 0:a.full_name)==null?void 0:u.split(" ").map(g=>g[0]).join("").toUpperCase())||"??";return e.jsx(le,{children:e.jsx("div",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-2xl mx-auto space-y-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Account Settings"}),e.jsxs(E,{children:[e.jsx(B,{children:e.jsx(Z,{children:"Profile Picture"})}),e.jsx(U,{children:e.jsx(xl,{currentAvatarUrl:a==null?void 0:a.avatar_url,onUpload:j,userInitials:y})})]}),e.jsxs(E,{children:[e.jsx(B,{children:e.jsx(Z,{children:"Profile Information"})}),e.jsx(U,{children:e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(G,{htmlFor:"fullName",children:"Full Name"}),e.jsx(q,{id:"fullName",value:l.fullName,onChange:g=>i(f=>({...f,fullName:g.target.value}))})]}),e.jsxs("div",{children:[e.jsx(G,{htmlFor:"email",children:"Email"}),e.jsx(q,{id:"email",value:(s==null?void 0:s.email)||"",disabled:!0})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Change Password"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(G,{htmlFor:"currentPassword",children:"Current Password"}),e.jsx(q,{id:"currentPassword",type:"password",value:l.currentPassword,onChange:g=>i(f=>({...f,currentPassword:g.target.value}))})]}),e.jsxs("div",{children:[e.jsx(G,{htmlFor:"newPassword",children:"New Password"}),e.jsx(q,{id:"newPassword",type:"password",value:l.newPassword,onChange:g=>i(f=>({...f,newPassword:g.target.value}))})]}),e.jsxs("div",{children:[e.jsx(G,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsx(q,{id:"confirmPassword",type:"password",value:l.confirmPassword,onChange:g=>i(f=>({...f,confirmPassword:g.target.value}))})]})]})]}),e.jsx(_,{type:"submit",disabled:r,children:r?"Saving...":"Save Changes"})]})})]})]})})})}const ul=()=>e.jsx("div",{className:"flex flex-col items-center justify-center min-h-[80vh] px-4",children:e.jsxs("div",{className:"text-center space-y-6 max-w-2xl",children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tight sm:text-6xl text-primary",children:"404"}),e.jsx("h2",{className:"text-2xl font-semibold tracking-tight sm:text-3xl",children:"Page Not Found"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Sorry, we couldn't find the page you're looking for. The page might have been removed, renamed, or doesn't exist."}),e.jsx("div",{className:"flex justify-center gap-4 pt-4",children:e.jsx(_,{asChild:!0,children:e.jsxs(on,{to:"/",className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4"}),"Back to Home"]})})})]})}),Ut=[{title:"UK House Prices Show Resilience Despite Economic Pressures",source:"Property News UK",published_at:new Date().toISOString(),url:"#",excerpt:"The latest data shows UK house prices maintaining stability with regional variations in growth rates."},{title:"New Rental Reforms Set to Transform Landlord-Tenant Relationships",source:"Real Estate Times",published_at:new Date(Date.now()-864e5).toISOString(),url:"#",excerpt:"The government's proposed rental reforms aim to provide greater security for tenants while maintaining landlord rights."},{title:"Property Investment Shifts: Where Buyers Are Looking in 2024",source:"Investment Quarterly",published_at:new Date(Date.now()-1728e5).toISOString(),url:"#",excerpt:"Investor focus is moving toward emerging regional hotspots as work patterns continue to evolve post-pandemic."},{title:"Interest Rate Forecast and Impact on Mortgage Market",source:"Financial Property Review",published_at:new Date(Date.now()-2592e5).toISOString(),url:"#",excerpt:"Analysts predict stabilizing interest rates may provide relief for mortgage holders in the coming quarters."},{title:"Green Homes Grant: What Property Owners Need to Know",source:"Sustainable Housing",published_at:new Date(Date.now()-3456e5).toISOString(),url:"#",excerpt:"The latest initiatives for improving energy efficiency in UK homes and the financial incentives available."}],ds=`
# UK Property Market Insights: July 2024

## Latest Tax Law Changes

The UK property market continues to adapt to recent regulatory changes. In April 2024, the government implemented adjustments to Capital Gains Tax (CGT) rates for property investors, with the higher rate increasing from 28% to 30% for residential property disposals. Buy-to-let landlords face additional reporting requirements for rental income above £10,000 annually.

The Stamp Duty Land Tax (SDLT) thresholds remain unchanged from last year's autumn statement, with first-time buyers enjoying relief up to £425,000 (down from £625,000 in 2023).

## Landlord Regulations

Licensing requirements have expanded to include mandatory electrical safety certificates (EICR) renewals every five years, and the new Decent Homes Standard now applies to the private rental sector. Tenant rights have strengthened with the Renters Reform Bill provisions now in effect, limiting no-fault evictions and establishing stronger grounds for possession.

Property safety regulations now include stricter rules for carbon monoxide alarms, with mandatory installation in all rooms with fixed combustion appliances.

## Government Policies

The Housing Ministry has announced a target of 300,000 new homes annually by 2026, with planning reforms to streamline development in designated growth zones. The Help to Buy equity loan scheme has been replaced with the First Homes initiative, offering 30-50% discounts on market value for first-time buyers.

Regional variations exist in Scotland's Private Housing (Tenancies) Act and Wales' Renting Homes Act, creating a patchwork regulatory landscape.

## Market Impact Analysis

These regulatory changes are creating downward pressure on rental yields, with the average UK yield dropping from 5.8% to 5.2% over the past year. Property values in commuter belts have shown greater resilience (+3.2%) compared to city centers (+1.7%).

Investment strategy adjustments should focus on regions with strong infrastructure investment and employment growth, particularly the Midlands and Northern England which offer better yields despite regulatory pressures.
`,zt=`
# Market Risk Assessment: UK Property Sector

## Current Risk Level: Moderate

### Interest Rate Risk
The Bank of England's current base rate of 4.25% represents a stabilization after the peak of 5.25% in late 2023. While further cuts are anticipated, they are expected to be gradual, maintaining moderate pressure on mortgage affordability.

### Regulatory Risk
The implementation phase of the Renters Reform Bill creates temporary uncertainty for landlords adapting to new requirements. Compliance costs have increased approximately 12% year-over-year.

### Market Liquidity Risk
Transaction volumes remain 15% below pre-pandemic levels, extending the average time to sell from 45 to 63 days. Regional variations are significant, with London experiencing greater liquidity constraints than the North East.

### Recommendation
Investors should focus on properties with strong fundamentals that can weather short-term market fluctuations, particularly those in areas with diverse economic bases and strong rental demand.
`,$t=[{area:"Manchester - Salford Quays",propertyType:"2-bedroom apartments",averagePrice:21e4,expectedYield:5.8,growthPotential:"High",keyFactors:["Tech industry expansion","Transport improvements","Regeneration projects"]},{area:"Birmingham - Jewellery Quarter",propertyType:"1-2 bedroom converted industrial",averagePrice:185e3,expectedYield:5.4,growthPotential:"Medium-High",keyFactors:["HS2 development impact","Growing young professional population","Cultural district revival"]},{area:"Leeds - South Bank",propertyType:"New build city apartments",averagePrice:195e3,expectedYield:5.9,growthPotential:"High",keyFactors:["Major regeneration area","Financial sector growth","University expansion"]}];async function pl(){try{const{error:s}=await je.from("market_insights").select("id").limit(1);if(s&&s.code==="42P01"){console.log("Market insights table does not exist, attempting to create it...");const{error:a}=await je.rpc("create_market_insights_table");return a?(console.error("Failed to create market_insights table:",a),!1):(console.log("Market insights table created successfully"),!0)}return!0}catch(s){return console.error("Error checking/creating market_insights table:",s),!1}}async function gl(){try{const s=await fetch("https://newsapi.org/v2/everything?q=uk+property+market&sortBy=publishedAt&apiKey=YOUR_API_KEY&pageSize=10");if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();return a.articles&&a.articles.length>0?a.articles.map(t=>({title:t.title,source:t.source.name,published_at:t.publishedAt,url:t.url,excerpt:t.description})):(console.log("No articles found in API response, using mock data"),Ut)}catch(s){return console.error("Error fetching property news:",s),Ut}}async function fl(s){try{const a="AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo";if(!a||a.includes("YOUR_API_KEY"))return console.warn("Using mock data: No valid API key provided for Gemini"),ds;const t=`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${a}`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:s}]}],generationConfig:{temperature:.7,maxOutputTokens:1024}})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();let l="";return n.candidates&&n.candidates[0]&&n.candidates[0].content?l=n.candidates[0].content.parts.filter(j=>j.text).map(j=>j.text).join(`
`):n.text&&(l=n.text),l||(console.warn("Empty response from Gemini API, using mock data"),ds)}catch(a){return console.error("Error generating insights:",a),ds}}async function jl(){try{await pl();const{data:s,error:a}=await je.from("market_insights").select("*").order("generated_at",{ascending:!1}).limit(1);return a?(console.error("Error fetching market insights:",a),{id:"mock-id",content:ds,generated_at:new Date().toISOString()}):s&&s.length>0?s[0]:null}catch(s){return console.error("Error in getLatestMarketInsights:",s),{id:"mock-id",content:ds,generated_at:new Date().toISOString()}}}async function vl(){try{return zt}catch(s){return console.error("Error fetching risk assessment:",s),zt}}async function yl(){try{return $t}catch(s){return console.error("Error fetching personalized opportunities:",s),$t}}async function Nl(s="UK"){try{return{region:s,currentAveragePrice:29e4,predictedGrowthRate:3.8,confidenceScore:82,timeframe:"12 months",factors:["Interest rate stabilization","Housing supply constraints","Regional economic development"]}}catch(a){return console.error("Error fetching predictive analytics:",a),{region:s,currentAveragePrice:29e4,predictedGrowthRate:3.2,confidenceScore:75,timeframe:"12 months",factors:["Mock data - API unavailable","Contact administrator for actual predictions"]}}}function bl({user:s,profile:a,className:t,showHero:r=!0}){const[n,l]=S.useState([]),[i,j]=S.useState(""),[h,y]=S.useState("No risk assessment data available."),[u,g]=S.useState([]),[f,N]=S.useState(!0),[v,I]=S.useState(null);S.useEffect(()=>{(async()=>{try{const b=await gl();l(b.slice(0,5));const C=await jl();if(C)j(C.content);else{const z=await fl("Provide a concise analysis of the current UK property market trends, focusing on interest rates, price movements, and market sentiment. Include key statistics and recommendations for investors.");j(z)}const O=await vl();y(O);const A=await yl();g(A);const L=await Nl()}catch(b){console.error("Error loading market data:",b),I("Failed to load market data.")}finally{N(!1)}})()},[]);const w=[{month:"Jan",price:32e4},{month:"Feb",price:325e3},{month:"Mar",price:329e3},{month:"Apr",price:335e3},{month:"May",price:34e4},{month:"Jun",price:345e3}],c=[{region:"London",price:5e5},{region:"Manchester",price:25e4},{region:"Birmingham",price:22e4},{region:"Leeds",price:2e5},{region:"Liverpool",price:18e4}];return e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"w-full",children:e.jsx(Se,{title:"Property Market Insights & Analysis",subtitle:"Expert analysis, regional comparisons, and investment recommendations to guide your property decisions",showSearch:!1,showStats:!1,height:"h-[400px]"})}),e.jsx("div",{className:k("w-full",t),children:e.jsxs("div",{className:"container mx-auto px-4 py-12",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12",children:[e.jsxs(E,{children:[e.jsx(B,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"Price Trends"})}),e.jsx(U,{className:"h-80",children:e.jsx(Es,{width:"100%",height:"100%",children:e.jsxs(at,{data:w,children:[e.jsx(Ls,{strokeDasharray:"3 3"}),e.jsx(Ds,{dataKey:"month"}),e.jsx(Fs,{}),e.jsx(Os,{formatter:d=>[`£${d.toLocaleString()}`,"Average Price"]}),e.jsx(Us,{type:"monotone",dataKey:"price",stroke:"hsl(var(--primary))",activeDot:{r:8}})]})})})]}),e.jsxs(E,{children:[e.jsx(B,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"Regional Comparison"})}),e.jsx(U,{className:"h-80",children:e.jsx(Es,{width:"100%",height:"100%",children:e.jsxs(at,{data:c,children:[e.jsx(Ls,{strokeDasharray:"3 3"}),e.jsx(Ds,{dataKey:"region"}),e.jsx(Fs,{}),e.jsx(Os,{formatter:d=>[`£${d.toLocaleString()}`,"Average Price"]}),e.jsx(Us,{type:"monotone",dataKey:"price",stroke:"hsl(var(--primary))",activeDot:{r:8}})]})})})]})]}),e.jsxs(E,{className:"mb-12",children:[e.jsx(B,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"Market Analysis"})}),e.jsxs(U,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"The UK property market continues to show resilience despite economic challenges. Regional variations are significant, with some areas experiencing rapid growth while others see more moderate changes."}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Key factors influencing the current market include:"}),e.jsxs("ul",{className:"list-disc pl-5 mb-4 text-muted-foreground",children:[e.jsx("li",{children:"Interest rate changes affecting mortgage affordability"}),e.jsx("li",{children:"Supply constraints in high-demand areas"}),e.jsx("li",{children:"Increasing preference for properties with outdoor space"}),e.jsx("li",{children:"Remote work influencing location decisions"})]}),e.jsx(_,{children:"Download Full Report"})]})]}),(a==null?void 0:a.subscription_tier)!=="free"&&e.jsxs(E,{className:"mb-12 border-primary/20 bg-gradient-to-r from-primary/5 to-background",children:[e.jsx(B,{children:e.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:["Premium Market Insights",e.jsx("span",{className:"ml-2 px-2 py-1 text-xs rounded-full bg-primary/20 text-primary",children:"Premium"})]})}),e.jsxs(U,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Our exclusive analysis indicates emerging hotspots in the following areas:"}),e.jsxs("ul",{className:"list-disc pl-5 mb-4 text-muted-foreground",children:[e.jsx("li",{children:"Northwest Manchester - projected 8.3% growth over 12 months"}),e.jsx("li",{children:"East Birmingham suburbs - increasing demand from young professionals"}),e.jsx("li",{children:"Coastal towns in the Southwest - rising popularity for remote workers"})]}),e.jsx(_,{children:"View Detailed Forecast"})]})]})]})})]})}const wl=[{id:"price_trends",name:"Price Trends",icon:e.jsx(Je,{className:"h-4 w-4 mr-2"})},{id:"regional_comparison",name:"Regional Comparison",icon:e.jsx(Ye,{className:"h-4 w-4 mr-2"})},{id:"property_types",name:"Property Types",icon:e.jsx(He,{className:"h-4 w-4 mr-2"})},{id:"growth_forecast",name:"Growth Forecast",icon:e.jsx(Be,{className:"h-4 w-4 mr-2"})},{id:"rental_yield",name:"Rental Yield Analysis",icon:e.jsx(ue,{className:"h-4 w-4 mr-2"})},{id:"market_activity",name:"Market Activity",icon:e.jsx(mt,{className:"h-4 w-4 mr-2"})}],Sl=()=>e.jsxs("div",{className:"bg-muted rounded-lg p-4 relative aspect-[16/9]",children:[e.jsx("div",{className:"absolute inset-0 flex items-end p-6",children:e.jsx("div",{className:"w-full flex items-end h-4/5 space-x-1",children:Array.from({length:12}).map((s,a)=>{const t=30+a*1.5,r=Math.random()*15-7.5,n=t+r;return e.jsx("div",{className:"w-full bg-primary rounded-t-sm transition-all duration-300 hover:opacity-80",style:{height:`${n}%`},title:`Month ${a+1}: £${Math.round(28e4+a*1e3+r*1e3)}`},a)})})}),e.jsx("div",{className:"absolute top-2 left-2 text-xs font-medium text-foreground/70",children:"Price (£)"}),e.jsx("div",{className:"absolute bottom-2 right-2 text-xs font-medium text-foreground/70",children:"Last 12 Months"})]}),_l=()=>e.jsxs("div",{className:"bg-muted rounded-lg p-4 relative aspect-[16/9]",children:[e.jsx("div",{className:"absolute inset-0 flex items-end p-6",children:e.jsx("div",{className:"w-full flex items-end h-4/5 space-x-3",children:[{region:"NW",height:75,growth:4.8},{region:"NE",height:65,growth:4.1},{region:"YOR",height:70,growth:4.5},{region:"MID",height:60,growth:3.9},{region:"SE",height:45,growth:2.5},{region:"LON",height:35,growth:.2},{region:"SW",height:50,growth:3},{region:"WAL",height:55,growth:3.5},{region:"SCO",height:60,growth:3.8}].map((s,a)=>e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"w-full bg-primary rounded-t-sm transition-all duration-300 hover:opacity-80",style:{height:`${s.height}%`},title:`${s.region}: ${s.growth}% growth`}),e.jsx("span",{className:"text-xs mt-1 text-foreground/70",children:s.region})]},a))})}),e.jsx("div",{className:"absolute top-2 left-2 text-xs font-medium text-foreground/70",children:"Growth (%)"})]}),kl=()=>e.jsxs("div",{className:"bg-muted rounded-lg p-4 relative aspect-[16/9]",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"w-64 h-64 relative rounded-full bg-primary/5",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-500",style:{clipPath:"polygon(50% 50%, 50% 0%, 100% 0%, 100% 100%, 50% 100%)"}}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-green-500",style:{clipPath:"polygon(50% 50%, 100% 100%, 50% 100%)"}}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-amber-500",style:{clipPath:"polygon(50% 50%, 50% 100%, 0% 100%, 0% 50%)"}}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-red-500",style:{clipPath:"polygon(50% 50%, 0% 50%, 0% 0%, 50% 0%)"}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-20 h-20 rounded-full bg-background"})})]})}),e.jsxs("div",{className:"absolute bottom-4 left-4 flex flex-col space-y-1",children:[e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx("div",{className:"w-3 h-3 rounded-sm bg-blue-500 mr-2"}),e.jsx("span",{children:"Detached (40%)"})]}),e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx("div",{className:"w-3 h-3 rounded-sm bg-green-500 mr-2"}),e.jsx("span",{children:"Semi-detached (25%)"})]}),e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx("div",{className:"w-3 h-3 rounded-sm bg-amber-500 mr-2"}),e.jsx("span",{children:"Terraced (20%)"})]}),e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx("div",{className:"w-3 h-3 rounded-sm bg-red-500 mr-2"}),e.jsx("span",{children:"Flats (15%)"})]})]})]}),Cl=()=>e.jsx("div",{className:"bg-muted rounded-lg p-4 relative aspect-[16/9]",children:e.jsx("div",{className:"absolute inset-0 flex items-end p-6",children:e.jsxs("div",{className:"w-full h-4/5 relative",children:[e.jsx("div",{className:"absolute left-1/3 bottom-0 h-full w-px bg-foreground/20 z-10"}),e.jsx("div",{className:"absolute left-1/3 bottom-0 w-3 h-3 rounded-full bg-primary transform -translate-x-1.5 z-20"}),e.jsx("div",{className:"absolute left-1/3 bottom-8 bg-background border rounded-md px-2 py-1 text-xs transform -translate-x-1/2 z-20",children:"Current"}),e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full h-px bg-primary/70"})}),e.jsx("div",{className:"absolute left-1/3 right-0 bottom-0 h-full bg-gradient-to-r from-blue-500/10 to-green-500/10 z-0 border-l border-dashed border-foreground/20"}),e.jsx("div",{className:"absolute left-1/3 bottom-1/2 right-0 h-px bg-green-500 transform rotate-[5deg] origin-left z-10"}),e.jsx("div",{className:"absolute left-1/3 bottom-1/2 right-0 h-px bg-green-500/30 transform rotate-[12deg] origin-left z-10 border-dashed"}),e.jsx("div",{className:"absolute left-1/3 bottom-1/2 right-0 h-px bg-green-500/30 transform rotate-[2deg] origin-left z-10 border-dashed"}),e.jsx("div",{className:"absolute top-2 left-2 text-xs font-medium text-foreground/70",children:"Price (£)"}),e.jsx("div",{className:"absolute bottom-2 right-2 text-xs font-medium text-foreground/70",children:"5 Year Forecast"}),e.jsxs("div",{className:"absolute right-8 top-1/4 bg-background border rounded-md px-2 py-1 text-xs z-20",children:[e.jsx("span",{className:"text-green-500 font-medium",children:"+18.5%"})," Forecast 5Y Growth"]})]})})}),Pl=()=>e.jsxs("div",{className:"bg-muted rounded-lg p-4 relative aspect-[16/9]",children:[e.jsx("div",{className:"absolute inset-0 p-6 grid grid-cols-3 gap-4",children:[{city:"Liverpool",yield:7.2},{city:"Manchester",yield:6.7},{city:"Nottingham",yield:6.5},{city:"Leeds",yield:6.1},{city:"Sheffield",yield:5.8},{city:"Birmingham",yield:5.5},{city:"Edinburgh",yield:5.1},{city:"Bristol",yield:4.6},{city:"London",yield:3.9}].map((s,a)=>e.jsxs("div",{className:"flex flex-col items-center justify-end h-full",children:[e.jsx("div",{className:"w-full max-w-16 bg-gradient-to-t from-primary to-primary/70 rounded-t-sm relative overflow-hidden",style:{height:`${s.yield/8*100}%`},children:e.jsxs("div",{className:"absolute inset-x-0 bottom-0 text-center text-white text-xs font-semibold",children:[s.yield,"%"]})}),e.jsx("div",{className:"mt-1 text-xs text-center line-clamp-1",children:s.city})]},a))}),e.jsx("div",{className:"absolute top-2 left-2 text-xs font-medium text-foreground/70",children:"Rental Yield (%)"})]}),Al=()=>e.jsxs("div",{className:"bg-muted rounded-lg p-4 relative aspect-[16/9]",children:[e.jsx("div",{className:"absolute inset-0 flex items-end p-6",children:e.jsx("div",{className:"w-full flex items-end h-4/5 space-x-1",children:Array.from({length:24}).map((s,a)=>{const t=a%12;let r=40;t>=3&&t<=7&&(r+=30),(t>=9||t<=1)&&(r-=10);const n=Math.random()*15-7.5,l=r+n,i=a===23;return e.jsx("div",{className:`w-full rounded-t-sm transition-all duration-300 hover:opacity-80 ${i?"bg-primary":"bg-primary/60"}`,style:{height:`${l}%`},title:`Month ${a%12+1}: ${Math.round(l*100)} transactions`},a)})})}),e.jsx("div",{className:"absolute top-2 left-2 text-xs font-medium text-foreground/70",children:"Transaction Volume"}),e.jsx("div",{className:"absolute bottom-2 right-2 text-xs font-medium text-foreground/70",children:"Last 24 Months"})]});function Il({user:s,profile:a}){const[t,r]=o.useState("price_trends"),[n,l]=o.useState(!1),i=(a==null?void 0:a.subscription_tier)==="premium"||(a==null?void 0:a.subscription_tier)==="pro",[j,h]=o.useState(!1);o.useEffect(()=>{h(!0);const u=setTimeout(()=>{h(!1)},500);return()=>clearTimeout(u)},[t]);const y=()=>{if(!i)return e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 sm:p-12 text-center",children:[e.jsx(cn,{className:"h-12 w-12 sm:h-16 sm:w-16 mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold mb-2",children:"Premium Feature"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-md mb-6",children:"Advanced data visualizations are available with our Pro and Premium subscriptions."}),e.jsx(_,{onClick:()=>l(!0),children:"Upgrade Now"})]});if(j)return e.jsxs("div",{className:"p-8 sm:p-12 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary/30 border-t-primary rounded-full mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading visualization data..."})]});switch(t){case"price_trends":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsx("h3",{className:"text-lg font-medium",children:"UK House Price Trends (Last 12 Months)"}),e.jsxs(ce,{variant:"outline",className:"w-fit",children:[e.jsx(Be,{className:"h-3 w-3 text-green-500 mr-1"}),e.jsx("span",{className:"text-green-500 text-xs",children:"+2.3% YoY"})]})]}),e.jsx(Sl,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Average Price"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:"£289,950"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+2.3% from last year"})]})]}),e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Monthly Change"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:"+0.5%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Compared to -0.1% last month"})]})]}),e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Annual Growth"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:"+2.3%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Steady increase since Q1"})]})]})]})]});case"regional_comparison":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Regional Price Comparison"}),e.jsx(_l,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Highest Growth Region"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"North West"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(Be,{className:"h-3 w-3 text-green-500 mr-1"}),e.jsx("span",{className:"text-xs text-green-500",children:"+4.8% annual growth"})]})]})]}),e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Lowest Growth Region"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"London"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(Be,{className:"h-3 w-3 text-amber-500 mr-1"}),e.jsx("span",{className:"text-xs text-amber-500",children:"+0.2% annual growth"})]})]})]}),e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"UK Average"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"+2.3%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Annual price growth"})]})]})]})]});case"property_types":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Property Types Distribution"}),e.jsx(kl,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Fastest Growing Type"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"Detached Houses"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(Be,{className:"h-3 w-3 text-green-500 mr-1"}),e.jsx("span",{className:"text-xs text-green-500",children:"+3.5% annual growth"})]})]})]}),e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Best Rental Yield"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"Flats/Apartments"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(ue,{className:"h-3 w-3 text-primary mr-1"}),e.jsx("span",{className:"text-xs",children:"5.1% average yield"})]})]})]})]})]});case"growth_forecast":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"5-Year Growth Forecast"}),e.jsx(Cl,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Base Forecast"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"+18.5%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Over next 5 years"})]})]}),e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Upper Bound"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"+24.2%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Optimistic scenario"})]})]}),e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Lower Bound"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"+12.8%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Conservative scenario"})]})]})]})]});case"rental_yield":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Rental Yield Analysis"}),e.jsx(Pl,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Top Performing City"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"Liverpool"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(ue,{className:"h-3 w-3 text-green-500 mr-1"}),e.jsx("span",{className:"text-xs text-green-500",children:"7.2% average yield"})]})]})]}),e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"UK Average"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"5.5%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Rental yield across UK"})]})]}),e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"London"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"3.9%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Lower yield, higher capital growth"})]})]})]})]});case"market_activity":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Market Activity (Transaction Volume)"}),e.jsx(Al,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Current Month"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"86,420"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(Be,{className:"h-3 w-3 text-green-500 mr-1"}),e.jsx("span",{className:"text-xs text-green-500",children:"+4.2% vs last month"})]})]})]}),e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Year-on-Year"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"+12.5%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Increase from last year"})]})]}),e.jsxs(E,{children:[e.jsx(B,{className:"pb-2",children:e.jsx(Z,{className:"text-sm font-medium",children:"Forecast"})}),e.jsxs(U,{children:[e.jsx("div",{className:"text-xl font-bold",children:"Increasing"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Expected to rise over Q3"})]})]})]})]});default:return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Select a visualization type to view data"})})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Data Visualization"}),e.jsx("p",{className:"text-muted-foreground",children:"Explore market trends with interactive visualizations"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-2 md:gap-4",children:wl.map(u=>e.jsx(_,{variant:t===u.id?"default":"outline",className:"w-full h-auto py-2 px-3 flex flex-col sm:flex-row items-center justify-center sm:justify-start text-xs sm:text-sm whitespace-normal sm:whitespace-nowrap",onClick:()=>r(u.id),children:e.jsxs("span",{className:"flex items-center justify-center sm:justify-start w-full",children:[e.jsx("span",{className:"sm:inline-block",children:u.icon}),e.jsx("span",{className:"text-center sm:text-left",children:u.name})]})},u.id))}),e.jsxs(E,{className:"mt-6",children:[e.jsx(U,{className:"pt-6",children:y()}),e.jsx(gs,{className:"text-xs text-muted-foreground border-t pt-4 mt-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Bs,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:"Data updated: June 13, 2024"})]})})]}),e.jsx(qs,{isOpen:n,onClose:()=>l(!1),currentUser:s,userProfile:a})]})}function ye({children:s}){return e.jsx(Qs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3},children:s})}const Ml=({children:s})=>{try{return Q(),e.jsx(e.Fragment,{children:s})}catch{return e.jsx(le,{children:e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:e.jsxs(E,{className:"p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Authentication Error"}),e.jsx("p",{className:"text-muted-foreground mb-6 text-center",children:"Unable to load authentication. Please refresh the page or try again later."}),e.jsx(_,{className:"w-full",onClick:()=>window.location.reload(),children:"Refresh Page"})]})})})}};function Rl(){const[s,a]=o.useState("insights"),{user:t,profile:r}=Q();return e.jsx(Ml,{children:e.jsx(le,{children:e.jsx(ye,{children:e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx(Se,{title:"Property Market Insights & Analysis",subtitle:"Expert analysis, regional comparisons, and investment recommendations to guide your property decisions",showSearch:!1,showStats:!1,height:"h-[300px] sm:h-[350px] md:h-[400px]"}),e.jsx("div",{className:"container mx-auto px-4 py-4 sm:py-6",children:e.jsxs(Ze,{defaultValue:"insights",value:s,onValueChange:a,className:"w-full",children:[e.jsxs(Xe,{className:"w-full mb-4 sm:mb-6 grid grid-cols-2",children:[e.jsx(me,{value:"insights",className:"text-sm sm:text-base",children:"Market Insights"}),e.jsx(me,{value:"visualization",className:"text-sm sm:text-base",children:"Data Visualization"})]}),e.jsx(oe,{value:"insights",className:"mt-0",children:e.jsx(bl,{user:t,profile:r,className:"mt-0",showHero:!1})}),e.jsx(oe,{value:"visualization",className:"mt-0",children:e.jsx(Il,{user:t,profile:r})})]})})]})})})})}async function Tl(s){var a,t,r,n,l;try{console.log("Calling chat API with prompt:",s);const h=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent?key=AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:s}]}],generationConfig:{temperature:.7,maxOutputTokens:1024}})});if(!h.ok)throw console.error("API error:",h.status,await h.text()),new Error(`API error: ${h.status} - ${await h.text()}`);return((l=(n=(r=(t=(a=(await h.json()).candidates)==null?void 0:a[0])==null?void 0:t.content)==null?void 0:r.parts)==null?void 0:n[0])==null?void 0:l.text)||"Sorry, I couldn't generate a response at this time."}catch(i){return console.error("Error getting chat response:",i),Dl(s)}}async function El(s){var a,t,r,n,l;try{console.log("Getting predictive analytics for location:",s);const i="AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo",j="https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent",h=`Generate predictive analytics for property investment in ${s} for the next 5 years. Include price growth predictions, rental yield trends, and market dynamics. Format as JSON with the following structure: {
      "priceGrowthPrediction": { "year1": 2.5, "year2": 3.1, "year3": 3.5, "year4": 2.8, "year5": 3.0 },
      "rentalYieldTrend": { "year1": 5.2, "year2": 5.3, "year3": 5.4, "year4": 5.3, "year5": 5.2 },
      "marketSummary": "Brief summary of market dynamics",
      "keyFactors": ["Factor 1", "Factor 2", "Factor 3"]
    }`,y=await fetch(`${j}?key=${i}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:h}]}],generationConfig:{temperature:.2,maxOutputTokens:1024}})});if(!y.ok)throw new Error("API response was not ok");const g=((l=(n=(r=(t=(a=(await y.json()).candidates)==null?void 0:a[0])==null?void 0:t.content)==null?void 0:r.parts)==null?void 0:n[0])==null?void 0:l.text)||null;if(!g)throw new Error("No content returned from API");let f=g.match(/```json\n([\s\S]*?)\n```/)||g.match(/```([\s\S]*?)```/)||g.match(/(\{[\s\S]*\})/);if(f&&f[1])return JSON.parse(f[1].trim());try{return JSON.parse(g)}catch(N){return console.error("Error parsing predictive analytics:",N),Bt(s)}}catch(i){return console.error("Error fetching predictive analytics:",i),Bt(s)}}async function Ll(s){var a,t,r,n,l;try{console.log("Getting investment hotspots for region:",s);const i="AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo",j="https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent",h=`Generate a list of emerging property investment hotspots in ${s} with reasons why they are promising. Format as JSON with the following structure: 
    {
      "hotspots": [
        {
          "area": "Area name",
          "growthPotential": 4.2,
          "reasons": ["Reason 1", "Reason 2"],
          "estimatedROI": 5.8,
          "investmentType": "Buy-to-let"
        }
      ]
    }
    Include 3-5 different hotspots.`,y=await fetch(`${j}?key=${i}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:h}]}],generationConfig:{temperature:.3,maxOutputTokens:1024}})});if(!y.ok)throw new Error("API response was not ok");const g=((l=(n=(r=(t=(a=(await y.json()).candidates)==null?void 0:a[0])==null?void 0:t.content)==null?void 0:r.parts)==null?void 0:n[0])==null?void 0:l.text)||null;if(!g)throw new Error("No content returned from API");let f=g.match(/```json\n([\s\S]*?)\n```/)||g.match(/```([\s\S]*?)```/)||g.match(/(\{[\s\S]*\})/);if(f&&f[1])return JSON.parse(f[1].trim());try{return JSON.parse(g)}catch(N){return console.error("Failed to parse hotspots:",N),qt(s)}}catch(i){return console.error("Failed to fetch hotspots:",i),qt(s)}}function Dl(s){return s.includes("market insights")?"Based on recent data, the property market in this area has shown strong growth over the past 12 months. Average prices have increased by approximately 7.3%, which is above the national average of 4.5%. Rental yields remain competitive at around 5.2% for typical properties. The local economy is benefiting from new infrastructure projects and employment opportunities, which should provide continued stability. Demand currently exceeds supply, especially for 2-3 bedroom properties, creating a seller's market. Analysts predict continued but more moderate growth over the next 24 months.":s.includes("investment advice")?`For property investors looking at this market, there are several strategies worth considering:

1. Buy-to-let opportunities are particularly strong in the north and east neighborhoods, where rental demand from young professionals is high.

2. Properties requiring renovation can offer significant value-add opportunities, with potential for 15-20% equity gains after improvements.

3. The local council has approved new development zones which may present off-plan purchase opportunities with favorable terms.

4. Houses with potential for extension or conversion to multiple units can maximize returns in areas with strict planning constraints.

5. Consider the strong local university market for HMO investments, which typically yield 2-3% higher than standard rentals.`:"The current property market shows mixed signals. While some areas continue to see price growth, others have stabilized. Factors influencing the market include interest rate changes, supply constraints, and evolving work patterns affecting location preferences. For specific investment advice, consider local economic indicators, infrastructure developments, and demographic trends particular to your target area."}function Bt(s){return{priceGrowthPrediction:{year1:3.2,year2:3.5,year3:4.1,year4:3.8,year5:3.9},rentalYieldTrend:{year1:5.3,year2:5.4,year3:5.5,year4:5.4,year5:5.3},marketSummary:`The property market in ${s} shows promising growth potential over the next 5 years, supported by infrastructure development and increasing demand. While some volatility is expected in years 2-3, the overall trajectory remains positive.`,keyFactors:["New transportation links improving connectivity","Growing tech sector bringing high-income professionals to the area","Limited new housing supply in development pipeline","Strong rental demand from young professionals","Government stimulus for first-time buyers"]}}function qt(s){return{hotspots:[{area:`${s} - North District`,growthPotential:4.7,reasons:["New tech hub development creating employment","Improved transport links reducing commute times","Regeneration project transforming former industrial areas"],estimatedROI:6.2,investmentType:"Buy-to-let apartments"},{area:`${s} - Riverside`,growthPotential:5.1,reasons:["Waterfront development project nearing completion","Limited supply of premium properties","Growing demand from young professionals"],estimatedROI:5.8,investmentType:"Luxury apartments"},{area:`${s} - University Area`,growthPotential:3.9,reasons:["Consistent student housing demand","University expansion plans announced","Improving local amenities and nightlife"],estimatedROI:7.3,investmentType:"HMO for students"},{area:`${s} - Central Village`,growthPotential:4.5,reasons:["Character properties with renovation potential","Growing tourism supporting short-term rentals","New boutique retail and restaurant scene"],estimatedROI:6.5,investmentType:"Period conversions"}]}}const Fl=["Calculate stamp duty for a £400,000 property","What are typical legal fees for property purchase?","Explain all costs involved in buying a property","How much should I budget for property maintenance?","What surveys do I need when buying a property?","Calculate monthly mortgage payments for £300,000"],Ol=s=>{if(s.success)return`<span class="block text-red-500">${s.message}</span>`;let t=(typeof s=="string"?s:s.message).replace(/\*\*(.*?)\*\*/g,'<span class="font-bold">$1</span>');return t=t.replace(/\*(.*?)\*/g,'<span class="italic">$1</span>'),t=t.replace(/^- (.+)$/gm,'<span class="block ml-2">• $1</span>'),t=t.replace(/^\d+\. (.+)$/gm,'<span class="block ml-2">$&</span>'),t.split(`
`).map((r,n)=>r?`<span class="block">${r}</span>`:'<span class="block h-2"></span>').join("")},Ul=({trends:s=[{title:"Average Home Price",value:"£450,000",change:"+5.2%",isPositive:!0},{title:"Days on Market",value:"28",change:"-12%",isPositive:!0},{title:"Available Listings",value:"1,234",change:"-3.1%",isPositive:!1}],articles:a=[{title:"Understanding the Current Real Estate Market",excerpt:"Get insights into the latest trends and what they mean for buyers and sellers.",date:"2024-03-15"},{title:"Top 5 Investment Opportunities in Real Estate",excerpt:"Discover the most promising areas for property investment in the current market.",date:"2024-03-10"},{title:"Real Estate Market Forecast 2024",excerpt:"Expert predictions and analysis for the upcoming year in real estate.",date:"2024-03-05"}],user:t,profile:r})=>{const n=[{month:"Jan",price:45e4},{month:"Feb",price:455e3},{month:"Mar",price:458e3},{month:"Apr",price:462e3},{month:"May",price:47e4},{month:"Jun",price:475e3}],l=[{region:"London",price:5e5,growth:5.2},{region:"Manchester",price:25e4,growth:7.8},{region:"Birmingham",price:22e4,growth:6.5},{region:"Leeds",price:2e5,growth:8.1},{region:"Liverpool",price:18e4,growth:9.2}],i=[{name:"London",priceGrowth:5.2,averagePrice:5e5,transactions:1200},{name:"South East",priceGrowth:4.8,averagePrice:375e3,transactions:950},{name:"South West",priceGrowth:4.5,averagePrice:31e4,transactions:780},{name:"East of England",priceGrowth:4.2,averagePrice:325e3,transactions:820},{name:"West Midlands",priceGrowth:6.1,averagePrice:24e4,transactions:680},{name:"East Midlands",priceGrowth:5.8,averagePrice:225e3,transactions:650},{name:"Yorkshire",priceGrowth:7.2,averagePrice:195e3,transactions:720},{name:"North West",priceGrowth:8.1,averagePrice:205e3,transactions:850},{name:"North East",priceGrowth:6.5,averagePrice:155e3,transactions:480},{name:"Wales",priceGrowth:5.9,averagePrice:185e3,transactions:520},{name:"Scotland",priceGrowth:5.4,averagePrice:175e3,transactions:680}],j=({data:F})=>e.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:e.jsx("svg",{viewBox:"0 0 500 800",className:"w-full h-full max-h-[400px]",style:{maxWidth:"300px"},children:[{path:"M250,600 L300,550 L350,600 L300,650 Z",name:"London"},{path:"M200,500 L300,450 L350,500 L250,550 Z",name:"South East"},{path:"M150,450 L250,400 L300,450 L200,500 Z",name:"South West"},{path:"M300,450 L400,400 L450,450 L350,500 Z",name:"East of England"},{path:"M200,350 L300,300 L350,350 L250,400 Z",name:"West Midlands"},{path:"M300,350 L400,300 L450,350 L350,400 Z",name:"East Midlands"},{path:"M200,250 L300,200 L350,250 L250,300 Z",name:"Yorkshire"},{path:"M150,200 L250,150 L300,200 L200,250 Z",name:"North West"},{path:"M250,150 L350,100 L400,150 L300,200 Z",name:"North East"},{path:"M100,350 L200,300 L250,350 L150,400 Z",name:"Wales"},{path:"M150,100 L300,50 L350,100 L200,150 Z",name:"Scotland"}].map(m=>{const T=F.find(re=>re.name===m.name),H=(T==null?void 0:T.priceGrowth)||0;return e.jsxs("g",{children:[e.jsx("path",{d:m.path,fill:`hsl(${120*(H/10)}, 70%, 50%)`,stroke:"white",strokeWidth:"2",className:"transition-colors duration-300 hover:brightness-110 cursor-pointer"}),e.jsx("title",{children:`${m.name}: +${H}%`})]},m.name)})})}),[h,y]=o.useState(""),[u,g]=o.useState(!1),[f,N]=o.useState(!1),v=async F=>{g(!0);try{const m=await Tl(`Provide a concise market insight for property investment in ${F} with recent price trends, rental yields, and future outlook. Keep it under 200 words.`);y(m)}catch(m){console.error("Error fetching market insights:",m),y("We're currently experiencing some issues retrieving market insights. Please try again later or contact support if the problem persists.")}finally{g(!1)}},[I,w]=o.useState([]),[c,d]=o.useState([]),[b,C]=o.useState(!1),[O,A]=o.useState(!1),[L,z]=o.useState(!1),[p,M]=o.useState(!1),R=async F=>{var m;C(!0);try{const T=await El(F);if(Array.isArray(T))w(T);else if(T.regions&&Array.isArray(T.regions))w(T.regions);else{const H=[{region:F||"United Kingdom",currentValue:35e4,predictedValue:35e4*(1+(((m=T.priceGrowthPrediction)==null?void 0:m.year1)||3.2)/100),confidence:85,growthFactors:T.keyFactors||["Data temporarily unavailable"]}];w(H)}}catch(T){console.error("Error fetching predictive analytics:",T),w([{region:F,currentValue:35e4,predictedValue:361200,confidence:75,growthFactors:["Data temporarily unavailable","Please try again later"]}])}finally{C(!1)}},$=async F=>{M(!0);try{const m=await Ll(F);if(Array.isArray(m)){const T=m.map(H=>({...H,factors:H.factors||[]}));d(T)}else if(m.hotspots&&Array.isArray(m.hotspots)){const T=m.hotspots.map(H=>({...H,factors:H.factors||[]}));d(T)}else console.warn("Hotspots data is not in expected format:",m),d([])}catch(m){console.error("Error fetching hotspots:",m),d([{area:`${F} - North District`,score:75,predictedGrowth:4.2,factors:["Data currently unavailable","Try again later"],investmentType:"Residential"},{area:`${F} - Central Area`,score:68,predictedGrowth:3.8,factors:["Data currently unavailable","Try again later"],investmentType:"Commercial"}])}finally{M(!1)}},J=async()=>{N(!0),await v("United Kingdom"),N(!1)},ee=async()=>{A(!0),await R("United Kingdom"),A(!1)},pe=async()=>{z(!0),await $("United Kingdom"),z(!1)},[he,ae]=o.useState(null),[ge,_e]=o.useState(null),[Pe,be]=o.useState(!0),ke=async()=>{try{be(!0);const F=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=gbp");if(!F.ok)throw new Error("Failed to fetch Bitcoin price");const m=await F.json();ae(m.bitcoin.gbp),_e(null)}catch(F){console.error("Error fetching Bitcoin price:",F),_e("Failed to load Bitcoin price"),ae(null)}finally{be(!1)}};return o.useEffect(()=>{v("United Kingdom"),R("United Kingdom"),$("United Kingdom"),ke();const F=setInterval(()=>{ke()},6e4);return()=>clearInterval(F)},[]),e.jsxs(e.Fragment,{children:[e.jsx(Se,{title:"Property Market Trends & Insights",subtitle:"Discover the latest market data, price forecasts, and investment hotspots to make informed property decisions",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsxs("section",{className:"w-full py-8 sm:py-16 bg-background relative overflow-hidden",children:[e.jsx("div",{className:"container mx-auto px-4 mb-16",children:e.jsxs(E,{className:"bg-card border-border",children:[e.jsx(B,{children:e.jsx("h2",{className:"text-2xl font-semibold",children:"Real Estate Trends Visualization"})}),e.jsx(U,{children:e.jsxs(Ze,{defaultValue:"overview",className:"w-full",children:[e.jsx(Xe,{className:"w-full mb-8",children:e.jsxs("div",{className:"grid w-full grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsx(me,{value:"overview",className:"w-full",children:"Price Evolution"}),e.jsx(me,{value:"regional",className:"w-full",children:"Regional Comparison"}),e.jsx(me,{value:"heatmap",className:"w-full",children:"Growth Heatmap"})]})}),e.jsx(oe,{value:"overview",className:"h-[400px]",children:e.jsx(Es,{width:"100%",height:"100%",children:e.jsxs(dn,{data:n,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorPrice",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"hsl(var(--primary))",stopOpacity:.2}),e.jsx("stop",{offset:"95%",stopColor:"hsl(var(--primary))",stopOpacity:0})]})}),e.jsx(Ls,{strokeDasharray:"3 3"}),e.jsx(Ds,{dataKey:"month"}),e.jsx(Fs,{}),e.jsx(Os,{}),e.jsx(mn,{type:"monotone",dataKey:"price",stroke:"hsl(var(--primary))",fillOpacity:1,fill:"url(#colorPrice)"})]})})}),e.jsx(oe,{value:"regional",className:"h-[400px]",children:e.jsx(Es,{width:"100%",height:"100%",children:e.jsxs(at,{data:l,children:[e.jsx(Ls,{strokeDasharray:"3 3"}),e.jsx(Ds,{dataKey:"region"}),e.jsx(Fs,{}),e.jsx(Os,{}),e.jsx(Us,{type:"monotone",dataKey:"price",stroke:"hsl(var(--primary))"}),e.jsx(Us,{type:"monotone",dataKey:"growth",stroke:"hsl(var(--chart-1))"})]})})}),e.jsx(oe,{value:"heatmap",className:"h-[400px] overflow-y-auto",children:e.jsxs("div",{className:"h-full grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4 min-h-[300px]",children:[e.jsx("h3",{className:"font-semibold text-lg sticky top-0 bg-background border-b py-2 px-2 rounded-t-lg",children:"Regional Price Growth"}),e.jsx("div",{className:"space-y-2 overflow-y-auto px-2",children:i.sort((F,m)=>m.priceGrowth-F.priceGrowth).map(F=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-8 rounded-full",style:{backgroundColor:`hsl(${120*(F.priceGrowth/10)}, 70%, 50%)`}}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:F.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["£",F.averagePrice.toLocaleString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-emerald-500",children:["+",F.priceGrowth,"%"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[F.transactions," sales"]})]})]},F.name))})]}),e.jsx("div",{className:"relative hidden lg:flex items-center justify-center bg-muted/30 rounded-xl min-h-[300px]",children:e.jsx(j,{data:i})})]})})]})})]})}),e.jsx("div",{className:"container mx-auto px-4 mb-16",children:e.jsxs(E,{className:"bg-card border-border relative ai-border-animation",children:[e.jsxs(B,{className:"flex flex-row items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"AI Market Analysis"}),e.jsx(_,{variant:"ghost",size:"icon",onClick:J,className:`h-8 w-8 ${f?"animate-spin":""}`,disabled:f||u,children:e.jsx(As,{className:"h-4 w-4"})})]}),e.jsx(U,{children:u?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:Ol(h)}})})]})}),e.jsxs("div",{className:"container mx-auto px-4 mb-16 grid gap-6 md:grid-cols-2",children:[e.jsxs(E,{className:"bg-card border-border relative ai-border-animation",children:[e.jsxs(B,{className:"flex flex-row items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Predictive Market Analytics"}),e.jsx(_,{variant:"ghost",size:"icon",onClick:ee,className:`h-8 w-8 ${O?"animate-spin":""}`,disabled:O||b,children:e.jsx(As,{className:"h-4 w-4"})})]}),e.jsx(U,{children:b?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsx("div",{className:"space-y-4",children:I.map((F,m)=>e.jsxs("div",{className:"p-4 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-lg",children:F.region}),e.jsxs("div",{className:"text-sm font-medium text-emerald-500",children:["+",((F.predictedValue-F.currentValue)/F.currentValue*100).toFixed(1),"%"]})]}),e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"w-full bg-background rounded-full h-2",children:e.jsx("div",{className:"bg-emerald-500 h-2 rounded-full",style:{width:`${F.confidence}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Confidence: ",F.confidence,"%"]})]})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:F.growthFactors&&Array.isArray(F.growthFactors)&&F.growthFactors.length>0?F.growthFactors[0]:"No growth factors available"})]},m))})})]}),e.jsxs(E,{className:"bg-card border-border relative ai-border-animation",children:[e.jsxs(B,{className:"flex flex-row items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Emerging Investment Hotspots"}),e.jsx(_,{variant:"ghost",size:"icon",onClick:pe,className:`h-8 w-8 ${L?"animate-spin":""}`,disabled:L||p,children:e.jsx(As,{className:"h-4 w-4"})})]}),e.jsx(U,{children:p?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):c.length>0?e.jsx("div",{className:"space-y-4",children:c.map((F,m)=>e.jsxs("div",{className:"bg-card border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg mb-1",children:F.area}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium mr-2",children:"Investment Score:"}),e.jsx("div",{className:"h-2 w-24 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary",style:{width:`${F.score}%`}})}),e.jsxs("span",{className:"ml-2 text-sm font-medium",children:[F.score,"/100"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(ce,{className:"bg-primary/80",children:["+",F.predictedGrowth,"% Growth"]}),e.jsx(ce,{variant:"outline",children:F.investmentType})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-sm font-medium",children:"Why Invest:"}),e.jsx("ul",{className:"mt-1 space-y-1",children:F.factors&&Array.isArray(F.factors)?F.factors.map((T,H)=>e.jsxs("li",{className:"text-sm flex items-start",children:[e.jsx(Is,{className:"h-4 w-4 mr-1 mt-1 text-primary"}),T]},H)):e.jsxs("li",{className:"text-sm flex items-start",children:[e.jsx(Is,{className:"h-4 w-4 mr-1 mt-1 text-primary"}),"Data unavailable"]})})]})]},m))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No investment hotspots data available"})})]})]}),e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl",children:[e.jsxs("div",{className:"mb-12 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Market Trends & Insights"}),e.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Stay informed with the latest real estate market trends and expert insights to make better property decisions."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:s.map((F,m)=>e.jsx(E,{className:`bg-card border-border hover:scale-[1.02] transition-all duration-300 ${m===0?"bg-gradient-to-r from-emerald-400/10 to-cyan-400/10":""}`,children:e.jsxs(U,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-foreground/80",children:F.title}),m===0?e.jsx(ue,{className:"w-5 h-5 text-emerald-500"}):m===1?e.jsx(He,{className:"w-5 h-5 text-emerald-500"}):e.jsx(Je,{className:"w-5 h-5 text-emerald-500"})]}),e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-2xl font-bold text-foreground",children:F.value}),e.jsx("span",{className:`flex items-center ${F.isPositive?"text-emerald-500":"text-red-500"}`,children:F.change})]})]})},m))}),e.jsx("div",{className:"container mx-auto px-4 mb-16 grid gap-6 md:grid-cols-3",children:a.map((F,m)=>e.jsxs(E,{className:"bg-card border-border hover:scale-[1.02] transition-all duration-300",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:F.title}),e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(F.date).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]})}),e.jsxs(U,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:F.excerpt}),e.jsxs(_,{variant:"ghost",className:"group hover:text-emerald-500",onClick:()=>{window.location.href=`/article/${encodeURIComponent(F.title)}`},children:["Read More",e.jsx(Is,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})]})]},m))}),e.jsx("div",{className:"w-full bg-muted/50 py-12",children:e.jsxs("div",{className:"max-w-[1200px] mx-auto px-4 sm:px-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Market Trends"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:e.jsxs(E,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Bitcoin Price (GBP)"}),Pe?e.jsx("div",{className:"animate-pulse h-8 bg-muted rounded"}):ge?e.jsx("p",{className:"text-red-500",children:ge}):he?e.jsx("p",{className:"text-2xl font-bold",children:V(he)}):e.jsx("p",{className:"text-muted-foreground",children:"Price unavailable"})]})})]})})]})]})]})},zl=({children:s})=>{try{return Q(),e.jsx(e.Fragment,{children:s})}catch{return e.jsx(le,{children:e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:e.jsxs(E,{className:"p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Authentication Error"}),e.jsx("p",{className:"text-muted-foreground mb-6 text-center",children:"Unable to load authentication. Please refresh the page or try again later."}),e.jsx(_,{className:"w-full",onClick:()=>window.location.reload(),children:"Refresh Page"})]})})})}},$l=()=>e.jsx(zl,{children:e.jsx(Bl,{})}),Bl=()=>{const{user:s,profile:a}=Q();return e.jsx(le,{children:e.jsx(ye,{children:e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx(Ul,{user:s,profile:a})})})})};function ql({title:s="Understanding the Current Real Estate Market",content:a="Default content",date:t=new Date().toISOString(),readTime:r="5 min read"}){const{user:n,profile:l}=Q();return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ps,{isAuthenticated:!!n,userProfile:l||void 0}),e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(E,{children:e.jsxs(U,{className:"p-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:s}),e.jsxs("div",{className:"flex items-center gap-4 text-muted-foreground mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(t).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"w-4 h-4"}),e.jsx("span",{children:r})]})]}),e.jsx("div",{className:"prose dark:prose-invert max-w-none",children:a.split(`

`).map((i,j)=>e.jsx("p",{className:"mb-4",children:i},j))})]})})})})]})}const Gl=[{id:1,title:"UK Property Market Outlook 2024",slug:"uk-property-market-outlook-2024",summary:"Comprehensive analysis of the UK property market trends, investment opportunities, and forecasts for 2024.",date:"2024-05-15",author:"Property Analysis Team",category:"Market Analysis",isPremium:!0},{id:2,title:"Regional Investment Hotspots",slug:"regional-investment-hotspots",summary:"Detailed report on emerging regional investment opportunities across the UK, with focus on yields and growth potential.",date:"2024-04-22",author:"Investment Research Division",category:"Investment",isPremium:!0},{id:3,title:"First-Time Buyer Guide 2024",slug:"first-time-buyer-guide-2024",summary:"Essential information and advice for first-time buyers navigating the property market in 2024.",date:"2024-03-10",author:"Homebuyer Advisory Team",category:"Guides",isPremium:!1}],Vl=({user:s,profile:a})=>{const[t,r]=o.useState([]),[n,l]=o.useState(!0),i=Ne();o.useEffect(()=>{(async()=>{try{l(!0),setTimeout(()=>{r(Gl),l(!1)},1e3)}catch(u){console.error("Error fetching research reports:",u),l(!1)}})()},[]);const j=(a==null?void 0:a.subscription_tier)!=="free",h=y=>{i(`/research/reports/${y.slug}`)};return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n?Array(3).fill(0).map((y,u)=>e.jsx(E,{className:"overflow-hidden",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"h-6 bg-muted rounded animate-pulse w-3/4"}),e.jsx("div",{className:"h-24 bg-muted rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-muted rounded animate-pulse w-1/2"})]})},u)):t.length>0?t.map(y=>e.jsxs(E,{className:"overflow-hidden flex flex-col",children:[e.jsxs(B,{className:"flex flex-row items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-lg font-semibold",children:y.title}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:hn(new Date(y.date),new Date,{addSuffix:!0})})]})]}),y.isPremium&&e.jsx(ce,{variant:"outline",className:"bg-primary/10 text-primary border-primary/20",children:"Premium"})]}),e.jsxs(U,{className:"flex-grow",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:y.summary}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx(xt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:y.category})]})]}),e.jsx(gs,{className:"border-t pt-4",children:y.isPremium&&!j?e.jsxs(_,{variant:"outline",className:"w-full",onClick:()=>window.location.href="/pricing",children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Upgrade to Access"]}):e.jsxs(_,{className:"w-full",onClick:()=>h(y),children:[e.jsx(xn,{className:"h-4 w-4 mr-2"}),"View Report"]})})]},y.id)):e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(qe,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No reports available"}),e.jsx("p",{className:"text-muted-foreground",children:"There are currently no research reports available."})]})})})},Sr=async(s=1,a=6)=>{try{const t=(s-1)*a;console.log("Fetching deals with params:",{page:s,limit:a,start:t});const{data:r,error:n}=await je.from("deals").select(`
        id,
        title,
        description,
        location,
        price,
        roi_percentage,
        investment_term,
        property_type,
        deal_type,
        image_url,
        created_at,
        updated_at
      `).range(t,t+a-1).order("created_at",{ascending:!1});if(console.log("Raw Supabase response:",{data:r,error:n}),n)throw console.error("Supabase query error:",n.message,n),new Error(`Failed to fetch deals: ${n.message}`);if(!r||r.length===0)return console.log("No deals found in database"),[];const l=r.map(i=>({id:i.id,title:i.title,description:i.description,location:i.location,price:Number(i.price),roi_percentage:Number(i.roi_percentage),investment_term:i.investment_term,property_type:i.property_type,deal_type:i.deal_type,image_url:i.image_url,created_at:i.created_at,updated_at:i.updated_at}));return console.log("Transformed deals:",l),l}catch(t){throw console.error("Error in getDeals:",t instanceof Error?t.message:t),t}};function $e({className:s,...a}){return e.jsx("div",{className:k("animate-pulse rounded-md bg-muted",s),...a})}function Hl(){return e.jsxs("div",{className:"overflow-hidden rounded-lg border bg-card",children:[e.jsx($e,{className:"aspect-video w-full"}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx($e,{className:"h-6 w-3/4"}),e.jsx($e,{className:"h-4 w-1/2"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($e,{className:"h-4 w-full"}),e.jsx($e,{className:"h-4 w-5/6"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx($e,{className:"h-4 w-20 mb-1"}),e.jsx($e,{className:"h-6 w-24"})]}),e.jsxs("div",{children:[e.jsx($e,{className:"h-4 w-20 mb-1"}),e.jsx($e,{className:"h-6 w-24"})]})]})]})]})}function ot({deal:s,isSubscriber:a,onClick:t,isLoading:r,user:n,showMessageButton:l=!0}){const i=Ne(),[j,h]=o.useState(!1);if(r)return e.jsx(Hl,{});const y=u=>{if(u.stopPropagation(),!n){i("/login");return}h(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(E,{className:"overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",onClick:n?t:()=>i("/login"),children:[e.jsxs("div",{className:"relative aspect-video overflow-hidden bg-muted",children:[e.jsx("img",{src:s.image_url,alt:s.title,className:"object-cover w-full h-full",loading:"lazy"}),!n&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:e.jsx(ce,{variant:"secondary",children:"Sign in to View"})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[e.jsx(ce,{variant:"secondary",className:"bg-white/90 text-black hover:bg-white/75",children:s.property_type}),e.jsx(ce,{variant:"secondary",className:"bg-primary/90 text-white hover:bg-primary/75",children:s.deal_type})]})]}),e.jsx(B,{children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold line-clamp-2 mb-2",children:s.title}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(Ye,{className:"h-4 w-4"}),e.jsx("span",{className:"line-clamp-1",children:s.location})]})]})}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Price"}),e.jsx("p",{className:"text-lg font-semibold",children:V(s.price)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"ROI"}),e.jsxs("p",{className:"text-lg font-semibold text-emerald-500",children:[s.roi_percentage,"%"]})]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Investment Term"}),e.jsx("p",{className:"font-medium",children:s.investment_term})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Expected Returns"}),e.jsx("p",{className:"font-medium text-emerald-500",children:"High Yield"})]})]})}),n&&l&&e.jsxs(_,{variant:"outline",className:"w-full",onClick:y,children:[e.jsx(us,{className:"w-4 h-4 mr-2"}),"Enquire About This Deal"]})]})})]}),n&&e.jsx(br,{isOpen:j,onClose:()=>h(!1),receiverId:"admin",dealId:s.id,deal:s})]})}const Te=yn,Ee=Nn,Ae=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Oa,{ref:r,className:k("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...t,children:[a,e.jsx(un,{asChild:!0,children:e.jsx(dt,{className:"h-4 w-4 opacity-50"})})]}));Ae.displayName=Oa.displayName;const _r=o.forwardRef(({className:s,...a},t)=>e.jsx(Ua,{ref:t,className:k("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(pn,{className:"h-4 w-4"})}));_r.displayName=Ua.displayName;const kr=o.forwardRef(({className:s,...a},t)=>e.jsx(za,{ref:t,className:k("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(dt,{className:"h-4 w-4"})}));kr.displayName=za.displayName;const Ie=o.forwardRef(({className:s,children:a,position:t="popper",...r},n)=>e.jsx(gn,{children:e.jsxs($a,{ref:n,className:k("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...r,children:[e.jsx(_r,{}),e.jsx(fn,{className:k("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(kr,{})]})}));Ie.displayName=$a.displayName;const Wl=o.forwardRef(({className:s,...a},t)=>e.jsx(Ba,{ref:t,className:k("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a}));Wl.displayName=Ba.displayName;const X=o.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(qa,{ref:r,className:k("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(jn,{children:e.jsx(de,{className:"h-4 w-4"})})}),e.jsx(vn,{children:a})]}));X.displayName=qa.displayName;const Yl=o.forwardRef(({className:s,...a},t)=>e.jsx(Ga,{ref:t,className:k("-mx-1 my-1 h-px bg-muted",s),...a}));Yl.displayName=Ga.displayName;const Kl=({user:s,profile:a})=>{const[t,r]=o.useState("property"),[n,l]=o.useState(""),[i,j]=o.useState("standard"),[h,y]=o.useState(!1),[u,g]=o.useState([{id:1,type:"Market Analysis",details:"Detailed analysis of the Leeds property market, focusing on rental yields and capital growth potential in different neighborhoods.",priority:"high",status:"in-progress",submittedAt:"2024-05-01T10:30:00Z",estimatedCompletion:"2024-05-08T10:30:00Z"},{id:2,type:"Property",details:"Research on the historical price trends and planning permissions for 123 High Street, Manchester, M1 1AA.",priority:"standard",status:"completed",submittedAt:"2024-04-15T14:45:00Z",completedAt:"2024-04-20T09:15:00Z"}]),f=d=>{d.preventDefault(),y(!0),setTimeout(()=>{const b={id:u.length+1,type:t==="property"?"Property":"Market Analysis",details:n,priority:i,status:"pending",submittedAt:new Date().toISOString(),estimatedCompletion:new Date(Date.now()+6048e5).toISOString()};g([b,...u]),l(""),y(!1)},1500)},N=(a==null?void 0:a.subscription_tier)!=="free",v=N,I=N?"Unlimited":"2 / 3",w=d=>{switch(d){case"completed":return e.jsx(de,{className:"h-5 w-5 text-green-500"});case"in-progress":return e.jsx(zs,{className:"h-5 w-5 text-blue-500"});case"pending":return e.jsx(zs,{className:"h-5 w-5 text-amber-500"});default:return e.jsx(bn,{className:"h-5 w-5 text-red-500"})}},c=d=>new Date(d).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"});return e.jsxs("div",{children:[e.jsxs(E,{className:"mb-8",children:[e.jsx(B,{children:e.jsx("h3",{className:"text-lg font-semibold",children:"Request Custom Research"})}),e.jsx(U,{children:e.jsx("form",{onSubmit:f,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(G,{htmlFor:"request-type",children:"Request Type"}),e.jsxs(Te,{value:t,onValueChange:r,children:[e.jsx(Ae,{id:"request-type",children:e.jsx(Ee,{placeholder:"Select request type"})}),e.jsxs(Ie,{children:[e.jsx(X,{value:"property",children:"Property Research"}),e.jsx(X,{value:"market",children:"Market Analysis"})]})]})]}),e.jsxs("div",{children:[e.jsx(G,{htmlFor:"request-details",children:"Details"}),e.jsx(jt,{id:"request-details",placeholder:"Please provide specific details about what you'd like us to research...",rows:5,value:n,onChange:d=>l(d.target.value)})]}),e.jsxs("div",{children:[e.jsx(G,{htmlFor:"request-priority",children:"Priority"}),e.jsxs(Te,{value:i,onValueChange:j,disabled:!v&&i==="high",children:[e.jsx(Ae,{id:"request-priority",children:e.jsx(Ee,{placeholder:"Select priority"})}),e.jsxs(Ie,{children:[e.jsx(X,{value:"standard",children:"Standard (7 days)"}),e.jsxs(X,{value:"high",disabled:!v,children:["High Priority (3 days)",!v&&" - Premium Feature"]})]})]})]})]})})}),e.jsxs(gs,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between border-t pt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground mb-4 sm:mb-0",children:["Requests remaining this month: ",e.jsx("span",{className:"font-medium",children:I})]}),e.jsx(_,{type:"submit",onClick:f,disabled:!n.trim()||h,children:h?"Submitting...":"Submit Request"})]})]}),e.jsxs(E,{children:[e.jsx(B,{children:e.jsx("h3",{className:"text-lg font-semibold",children:"Your Research Requests"})}),e.jsx(U,{children:u.length>0?e.jsx("div",{className:"space-y-4",children:u.map(d=>e.jsxs("div",{className:"p-4 border rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsxs("h4",{className:"font-medium",children:[d.type," Request"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:d.details}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Submitted: ",c(d.submittedAt)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[w(d.status),e.jsx("span",{className:"text-sm font-medium capitalize",children:d.status.replace("-"," ")})]})]}),d.status==="in-progress"&&e.jsxs("div",{className:"mt-4 pt-4 border-t text-xs text-muted-foreground",children:["Estimated completion: ",c(d.estimatedCompletion)]}),d.status==="completed"&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs(_,{variant:"outline",size:"sm",className:"w-full sm:w-auto",children:[e.jsx(Va,{className:"h-4 w-4 mr-2"}),"Download Report"]})})]},d.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(It,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No requests yet"}),e.jsx("p",{className:"text-muted-foreground",children:"You haven't submitted any research requests yet."})]})})]})]})},Jl=({children:s})=>{try{return Q(),e.jsx(e.Fragment,{children:s})}catch{return e.jsx(le,{children:e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:e.jsxs(E,{className:"p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Authentication Error"}),e.jsx("p",{className:"text-muted-foreground mb-6 text-center",children:"Unable to load authentication. Please refresh the page or try again later."}),e.jsx(_,{className:"w-full",onClick:()=>window.location.reload(),children:"Refresh Page"})]})})})}},Zl=()=>e.jsx(Jl,{children:e.jsx(Xl,{})}),Xl=()=>{const{user:s,profile:a,isLoading:t}=Q(),r=Ne(),[n,l]=o.useState([]),[i,j]=o.useState(!0),[h,y]=S.useState(!1),[u,g]=S.useState("reports");return o.useEffect(()=>{let f=!0;async function N(){try{const v=await Sr();f&&(l(v),j(!1))}catch(v){console.error("Error loading deals:",v),f&&j(!1)}}return s&&!t?N():!t&&!s&&r("/login"),()=>{f=!1}},[s,t,r]),t?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{children:"Loading..."})}):s?e.jsx(le,{children:e.jsx(ye,{children:e.jsxs("div",{className:"min-h-screen bg-neutral",children:[e.jsx(Se,{title:"Research & Analysis",subtitle:"Discover in-depth market insights and property analysis",showSearch:!1,showStats:!1,height:"h-[400px]",image:"/research-hero.jpg"}),e.jsxs("main",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4 text-primary",children:"Latest Research"}),e.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Stay informed with our comprehensive research reports and expert analysis"})]}),e.jsxs(Ze,{defaultValue:"reports",value:u,onValueChange:g,className:"mb-8",children:[e.jsxs(Xe,{className:"mb-4",children:[e.jsx(me,{value:"reports",children:"Research Reports"}),e.jsx(me,{value:"requests",children:"Research Requests"})]}),e.jsx(oe,{value:"reports",children:e.jsx(Vl,{user:s,profile:a})}),e.jsx(oe,{value:"requests",children:e.jsx(Kl,{user:s,profile:a})})]})]}),i?e.jsx("div",{className:"text-center py-8",children:"Loading deals..."}):e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Latest Deals"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:n.map(f=>e.jsx(ot,{deal:f,isSubscriber:(a==null?void 0:a.subscription_tier)!=="free"},f.id))})]})]}),e.jsx(qs,{isOpen:h,onClose:()=>y(!1)})]})})}):null};function Ql(){const{user:s,profile:a}=Q(),t=[{title:"Understanding Property Market Cycles",excerpt:"A comprehensive guide to property market cycles and how to identify market phases for optimal investment timing.",category:"Market Analysis",date:"2024-03-20",readTime:"8 min read",image:"https://images.unsplash.com/photo-1460472178825-e5240623afd5?ixlib=rb-4.0.3"},{title:"Buy-to-Let Investment Strategy Guide",excerpt:"Expert insights into creating a successful buy-to-let investment strategy in today's market conditions.",category:"Investment",date:"2024-03-18",readTime:"10 min read",image:"https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3"},{title:"Property Tax Changes in 2024",excerpt:"Stay updated with the latest property tax regulations and how they affect property investors and homeowners.",category:"Legal",date:"2024-03-15",readTime:"6 min read",image:"https://images.unsplash.com/photo-1554224155-8d04cb21cd6c?ixlib=rb-4.0.3"}];return e.jsx(ye,{children:e.jsxs(le,{children:[e.jsx(Se,{title:"Property Investment Blog",subtitle:"Expert insights and analysis on the UK property market",backgroundImage:"https://images.unsplash.com/photo-1542744173-8e7e53415bb0?ixlib=rb-4.0.3",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24 sm:pt-8",children:e.jsx("div",{className:"max-w-7xl mx-auto space-y-8",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((r,n)=>e.jsxs(E,{className:"flex flex-col h-full hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"relative h-48 w-full overflow-hidden rounded-t-lg",children:e.jsx("img",{src:r.image,alt:r.title,className:"w-full h-full object-cover"})}),e.jsxs(B,{className:"flex flex-row items-center gap-2",children:[e.jsx(xt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:r.category})]}),e.jsxs(U,{className:"flex-1 flex flex-col",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:r.title}),e.jsx("p",{className:"text-muted-foreground mb-4 flex-1",children:r.excerpt}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(r.date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(zs,{className:"w-4 h-4"}),e.jsx("span",{children:r.readTime})]})]}),e.jsxs(_,{variant:"ghost",className:"group hover:text-primary",onClick:()=>{window.location.href=`/blog/${r.title.toLowerCase().replace(/ /g,"-")}`},children:["Read More",e.jsx(Is,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})]})]})]},n))})})})]})})}function eo(){const s=[{title:"Getting Started",icon:e.jsx(wn,{className:"w-5 h-5"}),description:"Learn the basics of using our platform",content:["How to search for properties","Understanding market insights","Setting up your account","Subscription plans overview"]},{title:"Account & Billing",icon:e.jsx(qe,{className:"w-5 h-5"}),description:"Manage your account and subscription",content:["Updating account details","Subscription management","Billing history","Payment methods"]},{title:"Technical Support",icon:e.jsx(Sn,{className:"w-5 h-5"}),description:"Get help with technical issues",content:["Troubleshooting guide","System requirements","Known issues","Browser compatibility"]}],a=[{icon:e.jsx(Ha,{className:"w-5 h-5"}),title:"Email Support",description:"Get help via email",action:"support@myvge.co.uk",buttonText:"Send Email",onClick:()=>window.location.href="mailto:support@myvge.co.uk"},{icon:e.jsx(_n,{className:"w-5 h-5"}),title:"Phone Support",description:"Speak to our team",action:"0800 123 4567",buttonText:"Call Now",onClick:()=>window.location.href="tel:08001234567"},{icon:e.jsx(us,{className:"w-5 h-5"}),title:"Live Chat",description:"Chat with our support team",action:"Available 24/7",buttonText:"Start Chat",onClick:()=>{const t=new CustomEvent("open-messages",{detail:{receiverId:"support"}});window.dispatchEvent(t)}}];return e.jsx(ye,{children:e.jsxs(le,{children:[e.jsx(Se,{title:"Help & Support Center",subtitle:"Get the assistance you need with our comprehensive support resources",backgroundImage:"https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?ixlib=rb-4.0.3",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsx("main",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-12",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:s.map((t,r)=>e.jsxs(E,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(B,{className:"flex flex-row items-center gap-2",children:[t.icon,e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.description})]})]}),e.jsx(U,{children:e.jsx("ul",{className:"space-y-2",children:t.content.map((n,l)=>e.jsxs("li",{className:"text-sm",children:["• ",n]},l))})})]},r))}),e.jsxs("div",{className:"bg-card shadow rounded-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Contact Support"}),e.jsx("p",{className:"text-muted-foreground",children:"Choose your preferred method of contact"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:a.map((t,r)=>e.jsx(E,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(U,{className:"p-6 text-center",children:[e.jsx("div",{className:"mb-4 flex justify-center",children:t.icon}),e.jsx("h3",{className:"font-semibold mb-2",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:t.description}),e.jsx("p",{className:"text-sm font-medium mb-4",children:t.action}),e.jsx(_,{onClick:t.onClick,className:"w-full",children:t.buttonText})]})},r))})]})]})})]})})}const so=s=>{let a=s.replace(/\*\*(.*?)\*\*/g,'<span class="font-bold">$1</span>');return a=a.replace(/\*(.*?)\*/g,'<span class="italic">$1</span>'),a=a.replace(/^- (.+)$/gm,'<span class="block ml-2">• $1</span>'),a=a.replace(/^\d+\. (.+)$/gm,'<span class="block ml-2">$&</span>'),a.split(`
`).map(t=>t?`<span class="block">${t}</span>`:'<span class="block h-2"></span>').join("")},to="AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo",ao="https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent";function ro(){const{user:s,profile:a}=Q(),[t,r]=S.useState(!1),[n,l]=S.useState("ai"),[i,j]=S.useState([]),[h,y]=S.useState([]),[u,g]=S.useState([]),[f,N]=S.useState(""),[v,I]=S.useState(!1),[w,c]=S.useState([]),[d,b]=S.useState(null),C=S.useRef(null),O=Ne();S.useEffect(()=>{if(s){A();const p=M=>{r(!0),l("messages");const R=M.detail.receiverId,$=w.find(J=>J.id===R);$&&b($)};return window.addEventListener("open-messages",p),()=>window.removeEventListener("open-messages",p)}},[s,w]);const A=async()=>{try{const{data:p}=await K.from("messages").select(`
          *,
          sender:profiles!messages_sender_id_fkey(id, full_name, email),
          receiver:profiles!messages_receiver_id_fkey(id, full_name, email)
        `).or(`sender_id.eq.${s==null?void 0:s.id},receiver_id.eq.${s==null?void 0:s.id}`).order("created_at",{ascending:!1});if(!p)return;const M=new Map;p.forEach(R=>{const $=R.sender.id===(s==null?void 0:s.id)?R.receiver:R.sender;M.has($.id)||M.set($.id,{id:$.id,full_name:$.full_name,email:$.email,last_message:R.content,unread_count:R.receiver_id===(s==null?void 0:s.id)&&!R.is_read?1:0})}),c(Array.from(M.values()))}catch(p){console.error("Error loading contacts:",p)}},L=async p=>{if(p.trim())if(n==="ai"){j(M=>[...M,{text:p,isUser:!0}]),N(""),I(!0);try{const M=await fetch(`${ao}?key=${to}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:p}]}]})});if(!M.ok)throw new Error(`AI API error: ${M.status}`);const $=(await M.json()).candidates[0].content.parts[0].text;if(s){const J=`ai_${s.id}_${Date.now()}`;await K.from("messages").insert([{sender_id:s.id,receiver_id:s.id,content:p,is_support:!1,conversation_id:J},{sender_id:null,receiver_id:s.id,content:$,is_support:!0,conversation_id:J}])}j(J=>[...J,{text:$,isUser:!1}])}catch(M){console.error("Error in AI chat:",M),j(R=>[...R,{text:"Sorry, I encountered an error. Please try again.",isUser:!1}])}finally{I(!1)}}else if(s)if(n==="support"){y(M=>[...M,{text:p,isUser:!0}]),N("");try{const M=`support_${s.id}_${Date.now()}`,{error:R}=await K.from("messages").insert({sender_id:s.id,receiver_id:"support",content:p,is_support:!0,conversation_id:M});if(R)throw R;const $="Thank you for your message. Our support team will get back to you soon.",{error:J}=await K.from("messages").insert({sender_id:null,receiver_id:s.id,content:$,is_support:!0,conversation_id:M});if(J)throw J;y(ee=>[...ee,{text:$,isUser:!1}])}catch(M){console.error("Error handling support message:",M),y(R=>[...R,{text:"Sorry, there was an error sending your message. Please try again.",isUser:!1}])}}else{if(!s||!d)return;try{console.log("Sending message to Supabase:",{sender_id:s.id,receiver_id:d.id,content:p,is_support:n==="support"});const{data:M,error:R}=await K.from("messages").insert([{sender_id:s.id,receiver_id:d.id,content:p,is_support:n==="support"}]);if(R)throw console.error("Supabase insert error:",R),R;console.log("Supabase insert success:",M),g($=>[...$,{text:p,isUser:!0,sender:{full_name:(a==null?void 0:a.full_name)||"",email:(a==null?void 0:a.email)||""},timestamp:new Date().toISOString()}]),N("")}catch(M){console.error("Error sending message:",M)}}else{j(M=>[...M,{text:"Please sign in to use support and direct messaging features.",isUser:!1}]);return}},z=()=>{C.current&&(C.current.scrollTop=C.current.scrollHeight)};return S.useEffect(()=>{z()},[i,h,u]),S.useEffect(()=>{z()},[v]),S.useEffect(()=>{if(!s||!d)return;const p=K.channel(`messages:${s.id}:${d.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`or(and(sender_id.eq.${s.id},receiver_id.eq.${d.id}),and(sender_id.eq.${d.id},receiver_id.eq.${s.id}))`},M=>{console.log("Realtime message received:",M);const R=M.new;R.sender_id!==s.id&&g($=>[...$,{text:R.content,isUser:!1,sender:d,timestamp:R.created_at}])}).subscribe();return()=>{p.unsubscribe()}},[s,d]),e.jsx(e.Fragment,{children:e.jsx("div",{className:`fixed bottom-4 right-4 z-50 ${t?"w-96":"w-auto"}`,children:t?e.jsxs("div",{className:"bg-background border rounded-lg shadow-lg",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"font-semibold",children:"AI Assistant"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>O("/messages"),title:"Chat with Users",children:e.jsx(ht,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>r(!1),children:e.jsx(ct,{className:"h-4 w-4"})})]})]}),e.jsxs(Ze,{defaultValue:n,onValueChange:l,children:[e.jsxs(oe,{value:"ai",className:"m-0 bg-white",children:[e.jsxs("div",{ref:C,className:"h-96 p-4 space-y-4 overflow-y-auto",children:[i.length===0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hello! I'm your property assistant. Ask me anything about property investment, or try one of these popular questions:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Fl.map((p,M)=>e.jsx(_,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>L(p),children:p},M))})]}):i.map((p,M)=>e.jsx("div",{className:`flex ${p.isUser?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${p.isUser?"bg-primary text-primary-foreground":"bg-muted"}`,children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:p.isUser?p.text:so(p.text)}})})},M)),v&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"max-w-[80%] rounded-lg p-3 bg-muted",children:e.jsx("p",{className:"text-sm",children:"Typing..."})})})]}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{value:f,onChange:p=>N(p.target.value),placeholder:"Ask me anything about property...",onKeyPress:p=>{p.key==="Enter"&&L(f)}}),e.jsx(_,{onClick:()=>L(f),disabled:!f.trim(),children:e.jsx(os,{className:"h-4 w-4"})})]})})]}),e.jsxs(oe,{value:"messages",className:"m-0 bg-white",children:[e.jsx("div",{ref:C,className:"h-96 p-4 space-y-4 overflow-y-auto",children:s?d?e.jsx("div",{className:"space-y-4",children:u.map((p,M)=>e.jsx("div",{className:`flex ${p.isUser?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${p.isUser?"bg-primary text-primary-foreground":"bg-muted"}`,children:e.jsx("p",{className:"text-sm",children:p.text})})},M))}):e.jsx("div",{className:"space-y-4",children:w.map(p=>{var M;return e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-muted rounded-lg cursor-pointer",onClick:()=>b(p),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Le,{className:"h-8 w-8",children:[e.jsx(De,{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(p.full_name)}&background=random`,alt:p.full_name}),e.jsx(Fe,{children:(M=p.full_name)==null?void 0:M.split(" ").map(R=>R[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:p.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:p.last_message})]})]}),p.unread_count&&p.unread_count>0&&e.jsx("span",{className:"bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full",children:p.unread_count})]},p.id)})}):e.jsx("div",{className:"text-center p-4",children:e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Please sign in to view messages"})})}),d&&e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{value:f,onChange:p=>N(p.target.value),placeholder:"Type a message...",onKeyPress:p=>{p.key==="Enter"&&L(f)}}),e.jsx(_,{onClick:()=>L(f),disabled:!f.trim(),children:e.jsx(os,{className:"h-4 w-4"})})]})})]}),e.jsxs(oe,{value:"support",className:"m-0 bg-white",children:[e.jsx("div",{ref:C,className:"h-96 p-4 space-y-4 overflow-y-auto",children:h.length===0?e.jsx("div",{className:"space-y-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Welcome to support! How can we help you today?"})}):h.map((p,M)=>e.jsx("div",{className:`flex ${p.isUser?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${p.isUser?"bg-primary text-primary-foreground":"bg-muted"}`,children:e.jsx("p",{className:"text-sm",children:p.text})})},M))}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{value:f,onChange:p=>N(p.target.value),placeholder:"Type your support question...",onKeyPress:p=>{p.key==="Enter"&&L(f)}}),e.jsx(_,{onClick:()=>L(f),disabled:!f.trim(),children:e.jsx(os,{className:"h-4 w-4"})})]})})]})]})]}):e.jsx(_,{onClick:()=>r(!0),className:"rounded-full h-12 w-12 flex items-center justify-center",children:e.jsx(us,{className:"h-6 w-6"})})})})}function no(){const s=Ne();return o.useEffect(()=>{K.auth.onAuthStateChange((t,r)=>{console.log("Auth state change:",t,r),t==="SIGNED_IN"&&s("/dashboard")}),(async()=>{const{data:{session:t}}=await K.auth.getSession();console.log("Initial session:",t),s(t?"/dashboard":"/")})()},[s]),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Authenticating..."}),e.jsx("p",{className:"text-muted-foreground",children:"Please wait while we verify your credentials."})]})})}const io=[{title:"AI Property Analysis",description:"Advanced AI algorithms analyze market trends, rental rates, and property conditions to optimize your investment returns.",icon:Wa,badge:"AI-Powered"},{title:"Smart Tenant Matching",description:"AI-driven tenant screening and matching system to find the perfect tenants for your properties.",icon:He,badge:"Smart Match"},{title:"Predictive Maintenance",description:"AI predicts maintenance needs before they become issues, saving you time and money.",icon:tt,badge:"Predictive"},{title:"Automated Reporting",description:"AI-generated insights and reports on property performance, maintenance history, and financial metrics.",icon:Ya,badge:"Automated"},{title:"AI Chat Support",description:"24/7 AI-powered chat support for tenants and property owners.",icon:ls,badge:"24/7 Support"},{title:"Smart Security",description:"AI-enhanced security monitoring and access control systems.",icon:kn,badge:"Enhanced"}],lo=[{title:"Tenant Screening",description:"Comprehensive tenant screening with AI-powered background checks and risk assessment."},{title:"Rent Collection",description:"Smart rent collection with predictive payment analysis and automated reminders."},{title:"Property Maintenance",description:"AI-driven maintenance scheduling and vendor management."},{title:"Financial Reporting",description:"Advanced financial analytics with AI-powered forecasting and recommendations."}];function oo(){return e.jsx(ye,{children:e.jsxs(le,{children:[e.jsx(Se,{title:"AI-Powered Property Management",subtitle:"Experience the future of property management with our advanced AI solutions.",backgroundImage:"https://images.unsplash.com/photo-1568605114967-8130f3a36994?ixlib=rb-4.0.3",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-16",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Next-Generation Property Management"}),e.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Leveraging artificial intelligence to revolutionize property management and maximize your investment returns."})]}),e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-center",children:"AI-Powered Features"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:io.map((s,a)=>e.jsxs(E,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(s.icon,{className:"h-6 w-6 text-primary"}),e.jsx(ce,{variant:"secondary",children:s.badge})]}),e.jsx(Z,{className:"text-xl",children:s.title})]}),e.jsx(U,{children:e.jsx("p",{className:"text-muted-foreground",children:s.description})})]},a))})]}),e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-center",children:"Core Services Enhanced by AI"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:lo.map((s,a)=>e.jsxs(E,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(B,{children:e.jsx(Z,{children:s.title})}),e.jsx(U,{children:e.jsx("p",{className:"text-muted-foreground",children:s.description})})]},a))})]}),e.jsxs("section",{className:"space-y-8 bg-muted p-8 rounded-lg",children:[e.jsx("h2",{className:"text-2xl font-semibold text-center",children:"Why Choose Our AI-Powered Management?"}),e.jsx("div",{className:"prose prose-lg max-w-none",children:e.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[e.jsx("li",{children:"Reduce operational costs by up to 30% with AI automation"}),e.jsx("li",{children:"Minimize vacancy rates with smart tenant matching"}),e.jsx("li",{children:"Prevent maintenance issues before they occur"}),e.jsx("li",{children:"Get real-time insights and predictive analytics"}),e.jsx("li",{children:"24/7 automated support for tenants"}),e.jsx("li",{children:"Enhanced security and risk management"})]})})]}),e.jsxs("section",{className:"text-center space-y-6",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Ready to Transform Your Property Management?"}),e.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Experience the power of AI-driven property management. Contact us to learn how we can help optimize your property portfolio."}),e.jsx(_,{size:"lg",className:"px-8",children:"Schedule a Demo"})]})]})})]})})}const ve=o.forwardRef(({className:s,...a},t)=>e.jsxs(Ka,{ref:t,className:k("relative flex w-full touch-none select-none items-center",s),...a,children:[e.jsx(Cn,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(Pn,{className:"absolute h-full bg-primary"})}),e.jsx(An,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));ve.displayName=Ka.displayName;let Xs;async function vt(){if(!Xs){const{GoogleGenerativeAI:s}=await In(async()=>{const{GoogleGenerativeAI:a}=await import("./vendor-BkIQqBNA.js").then(t=>t.ca);return{GoogleGenerativeAI:a}},[]);Xs=new s("AIzaSyD0MjDEtw7El7GSzOm9F8iIKE2uGDkVBWo")}return Xs}function yt(s){const a=s.indexOf("{"),t=s.lastIndexOf("}")+1;if(a===-1||t===0)throw new Error("Invalid JSON response");return s.slice(a,t)}async function co(s,a){const r=(await vt()).getGenerativeModel({model:"gemini-pro"}),n=`
    You are a UK property investment expert. Analyze investment opportunities for ${s} properties with a budget of £${a}.
    Respond with a JSON object containing ONLY these exact fields:
    {
      "analysis": "Brief overview of the investment opportunity",
      "roi_range": "Expected ROI range as a percentage",
      "risks": ["Risk 1", "Risk 2", "Risk 3"],
      "opportunities": ["Opportunity 1", "Opportunity 2", "Opportunity 3"],
      "market_trends": ["Trend 1", "Trend 2", "Trend 3"]
    }
    Ensure each array has exactly 3 items and all fields are present.
  `;try{const i=await(await r.generateContent(n)).response,j=yt(i.text().trim());console.log("Raw Analysis Response:",j);const h=JSON.parse(j);if(!h.analysis||!h.roi_range||!Array.isArray(h.risks)||!Array.isArray(h.opportunities)||!Array.isArray(h.market_trends))throw new Error("Invalid response format");return{analysis:h.analysis,roi_range:h.roi_range,risks:h.risks.slice(0,3),opportunities:h.opportunities.slice(0,3),market_trends:h.market_trends.slice(0,3)}}catch(l){return console.error("Error in getInvestmentAnalysis:",l),{analysis:`Analysis for ${s} properties with £${a} budget is currently unavailable`,roi_range:"8-12%",risks:["Market volatility","Economic uncertainty","Property condition risks"],opportunities:["Value appreciation potential","Rental income opportunities","Development possibilities"],market_trends:["Rising demand in key areas","Stable price growth","Infrastructure development"]}}}async function mo(s){const t=(await vt()).getGenerativeModel({model:"gemini-pro"}),r=`
    You are a UK property market expert. Predict property market trends for ${s} in the next 12 months.
    Respond ONLY with a JSON object in this exact format:
    {
      "price_prediction": "2-3 sentence prediction of price movements",
      "demand_factors": ["3 specific demand factors"],
      "recommendations": ["3 specific investment recommendations"]
    }
  `;try{const l=await(await t.generateContent(r)).response,i=yt(l.text().trim());return console.log("Raw Predictions Response:",i),JSON.parse(i)}catch(n){return console.error("Error in getMarketPredictions:",n),{price_prediction:"Market prediction currently unavailable",demand_factors:["Population growth","Economic development","Infrastructure improvements"],recommendations:["Research thoroughly","Consider long-term potential","Evaluate local amenities"]}}}async function ho(s){const t=(await vt()).getGenerativeModel({model:"gemini-pro"}),r=`
    You are a UK property investment advisor. Create a strategy for a ${s.experience} investor with £${s.budget} budget and ${s.riskTolerance} risk tolerance.
    Respond ONLY with a JSON object in this exact format:
    {
      "strategy": "2-3 sentence overview of recommended strategy",
      "portfolio_allocation": "Suggested portfolio breakdown percentages",
      "timeline": "Recommended investment timeline",
      "expected_returns": "Projected returns overview"
    }
  `;try{const l=await(await t.generateContent(r)).response,i=yt(l.text().trim());return console.log("Raw Strategy Response:",i),JSON.parse(i)}catch(n){return console.error("Error in getInvestmentStrategy:",n),{strategy:"Investment strategy currently unavailable",portfolio_allocation:"Residential: 60%, Commercial: 30%, Cash: 10%",timeline:"5-10 years recommended holding period",expected_returns:"8-12% annual return potential"}}}function xo(){const[s,a]=S.useState(!1),[t,r]=S.useState(null),[n,l]=S.useState("residential"),[i,j]=S.useState(25e4),[h,y]=S.useState("London"),[u,g]=S.useState(null),[f,N]=S.useState(null),[v,I]=S.useState(null),w={experience:"intermediate",budget:i,riskTolerance:"moderate"},c=async()=>{a(!0),r(null);try{const d=await co(n,i);if(!d||typeof d!="object")throw new Error("Invalid analysis data received");g(d);const b=await mo(h);if(!b||typeof b!="object")throw new Error("Invalid predictions data received");N(b);const C=await ho(w);if(!C||typeof C!="object")throw new Error("Invalid strategy data received");I(C)}catch(d){console.error("Error in analysis:",d),r(d instanceof Error?d.message:"Failed to generate analysis. Please try again."),g(null),N(null),I(null)}finally{a(!1)}};return e.jsx(ye,{children:e.jsxs(le,{children:[e.jsx(Se,{title:"AI-Powered Investment Analysis",subtitle:"Make data-driven investment decisions with our advanced AI analytics",showSearch:!1,height:"h-[400px]",onSearch:()=>{}}),e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-12",children:[e.jsxs("section",{className:"bg-card p-6 rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Investment Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Property Type"}),e.jsxs(Te,{defaultValue:n,onValueChange:d=>l(d),children:[e.jsx(Ae,{className:"w-full",children:e.jsx(Ee,{placeholder:"Select property type"})}),e.jsxs(Ie,{children:[e.jsx(X,{value:"residential",children:"Residential"}),e.jsx(X,{value:"commercial",children:"Commercial"}),e.jsx(X,{value:"industrial",children:"Industrial"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Location"}),e.jsx(q,{type:"text",value:h,onChange:d=>y(d.target.value),placeholder:"Enter location"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Budget: £",i.toLocaleString()]}),e.jsx(ve,{value:[i],onValueChange:d=>j(d[0]),min:1e5,max:1e6,step:5e4})]})]}),e.jsx(_,{onClick:c,disabled:s,className:"mt-6",size:"lg",children:s?e.jsxs(e.Fragment,{children:[e.jsx(Ja,{className:"mr-2 h-4 w-4 animate-spin"}),"Analyzing..."]}):"Analyze Investment Opportunity"})]}),t&&e.jsx("div",{className:"bg-destructive/10 text-destructive p-4 rounded-lg",children:t}),u&&f&&v&&!t&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(E,{children:[e.jsxs(B,{children:[e.jsx(Je,{className:"h-6 w-6 text-primary mb-2"}),e.jsx(Z,{children:"Market Analysis"})]}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Analysis"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u.analysis||"Analysis not available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"ROI Range"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u.roi_range||"ROI range not available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Risks"}),e.jsx("ul",{className:"list-disc pl-4 text-sm text-muted-foreground",children:Array.isArray(u.risks)?u.risks.map((d,b)=>e.jsx("li",{children:d},b)):e.jsx("li",{children:"Risks data not available"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Market Trends"}),e.jsx("ul",{className:"list-disc pl-4 text-sm text-muted-foreground",children:Array.isArray(u.market_trends)?u.market_trends.map((d,b)=>e.jsx("li",{children:d},b)):e.jsx("li",{children:"Market trends not available"})})]})]})]}),e.jsxs(E,{children:[e.jsxs(B,{children:[e.jsx(Wa,{className:"h-6 w-6 text-primary mb-2"}),e.jsx(Z,{children:"AI Predictions"})]}),e.jsxs(U,{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Price Trend"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.price_prediction||"Price prediction not available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Demand Factors"}),e.jsx("ul",{className:"list-disc pl-4 text-sm text-muted-foreground",children:Array.isArray(f.demand_factors)?f.demand_factors.map((d,b)=>e.jsx("li",{children:d},b)):e.jsx("li",{children:"Demand factors not available"})})]})]})]}),e.jsxs(E,{children:[e.jsxs(B,{children:[e.jsx(Ya,{className:"h-6 w-6 text-primary mb-2"}),e.jsx(Z,{children:"Recommended Strategy"})]}),e.jsxs(U,{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Portfolio Allocation"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v.portfolio_allocation||"Portfolio allocation not available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Expected Returns"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v.expected_returns||"Expected returns not available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Timeline"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v.timeline||"Timeline not available"})]})]})]})]})]})})]})})}function uo(){return e.jsx(ye,{children:e.jsxs(le,{children:[e.jsx(Se,{title:"About MyVGE",subtitle:"Learn more about our mission and our team",backgroundImage:"https://images.unsplash.com/photo-1507585495646-50c2b6dbd483?ixlib=rb-4.0.3",showSearch:!1,showStats:!1,height:"h-[400px]"}),e.jsx("main",{className:"container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Our Story"}),e.jsx("p",{className:"text-muted-foreground",children:"MyVGE is dedicated to providing property investors with the tools and insights they need to succeed."})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Our Mission"}),e.jsx("p",{children:"To empower property investors with comprehensive data, expert analysis, and innovative tools to make informed decisions and achieve their financial goals. We are committed to ethical practices, diversity, and transparency in all our operations."})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Our Values"}),e.jsxs("ul",{className:"list-disc list-inside",children:[e.jsx("li",{children:"**Ethical Practices:** We adhere to the highest ethical standards in all our dealings, ensuring fairness and integrity."}),e.jsx("li",{children:"**Diversity:** We embrace diversity and inclusion, fostering a welcoming environment for all."}),e.jsx("li",{children:"**Transparency:** We are committed to open and honest communication, providing clear and accurate information to our users."})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Our Team"}),e.jsx("p",{children:"Our team consists of experienced property professionals, data scientists, and technology experts who are passionate about helping investors navigate the complexities of the real estate market. We are a diverse group of individuals with a shared commitment to excellence."})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Contact Us"}),e.jsx("p",{children:"We'd love to hear from you! Contact us to learn more about our services or to discuss your investment needs."}),e.jsx(_,{children:"Contact Us"})]})]})})]})})}const po=({isOpen:s,onClose:a,deal:t,isSubscriber:r})=>t?e.jsx(Ge,{open:s,onOpenChange:a,children:e.jsxs(Oe,{className:"max-w-3xl w-[95vw] max-h-[90vh] overflow-y-auto p-4 sm:p-6",children:[e.jsx(Ue,{children:e.jsxs(ze,{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 sm:gap-4",children:[e.jsx("span",{className:"text-lg sm:text-xl font-bold break-words pr-4",children:t.title}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(ce,{className:"text-xs",children:t.property_type}),e.jsx(ce,{variant:"secondary",className:"text-xs",children:t.deal_type})]})]})}),e.jsx("div",{className:"relative aspect-video mb-3 sm:mb-4 overflow-hidden rounded-lg",children:e.jsx("img",{src:t.image_url,alt:t.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex items-center gap-2 mb-3 sm:mb-4 text-sm sm:text-base text-muted-foreground",children:[e.jsx(Ye,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"break-words",children:t.location})]}),e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:t.description})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"Price"}),e.jsx("p",{className:"text-base sm:text-lg",children:V(t.price)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"ROI"}),e.jsxs("p",{className:"text-base sm:text-lg text-emerald-500",children:[t.roi_percentage,"%"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"Investment Term"}),e.jsx("p",{className:"text-base sm:text-lg",children:t.investment_term})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"Property Type"}),e.jsx("p",{className:"text-base sm:text-lg",children:t.property_type})]})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"Deal Type"}),e.jsx(ce,{variant:"outline",className:"text-xs sm:text-sm",children:t.deal_type})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-1 sm:mb-2",children:"Location"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground break-words",children:t.location})]})]})]})}):null,go=({children:s})=>{try{return Q(),e.jsx(e.Fragment,{children:s})}catch{return e.jsx(le,{children:e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:e.jsxs(E,{className:"p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Authentication Error"}),e.jsx("p",{className:"text-muted-foreground mb-6 text-center",children:"Unable to load authentication. Please refresh the page or try again later."}),e.jsx(_,{className:"w-full",onClick:()=>window.location.reload(),children:"Refresh Page"})]})})})}};function fo({onSignIn:s,onSignUp:a}){return e.jsx(go,{children:e.jsx(jo,{onSignIn:s,onSignUp:a})})}function jo({onSignIn:s,onSignUp:a}){const{user:t,profile:r,isLoading:n}=Q(),[l,i]=o.useState([]),[j,h]=o.useState(!0),[y,u]=o.useState(null);return o.useEffect(()=>{let g=!0;async function f(){try{const N=await Sr();g&&(i(N),h(!1))}catch(N){console.error("Error loading deals:",N),g&&h(!1)}}return f(),()=>{g=!1}},[]),n?e.jsx(le,{children:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{children:"Loading..."})})}):e.jsx(le,{children:e.jsx(ye,{children:e.jsxs("div",{className:"min-h-screen bg-neutral",children:[e.jsx(Se,{title:"Property Deals",subtitle:"Discover exclusive property investment opportunities",showSearch:!0,showStats:!1,height:"h-[400px]",image:"/deals-hero.jpg"}),e.jsx("main",{className:"container mx-auto px-4 py-8",children:j?e.jsx("div",{className:"text-center py-8",children:"Loading deals..."}):t?e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:l.map(g=>e.jsx(ot,{deal:g,isSubscriber:(r==null?void 0:r.subscription_tier)!=="free",onClick:()=>u(g),user:t},g.id))}):e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs(E,{className:"p-8 text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Sign in to View Full Deal Details"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Get access to exclusive property deals and investment opportunities. Create an account or sign in to view all available deals."}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsxs(_,{onClick:s,className:"flex items-center gap-2",children:[e.jsx(et,{className:"w-4 w-4"}),"Sign In"]}),e.jsxs(_,{variant:"outline",onClick:a,className:"flex items-center gap-2",children:[e.jsx(ms,{className:"w-4 w-4"}),"Create Account"]})]})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:l.map(g=>e.jsx(ot,{deal:g,isSubscriber:!1,onClick:s,user:null},g.id))})]})}),e.jsx(po,{isOpen:!!y,onClose:()=>u(null),deal:y,isSubscriber:(r==null?void 0:r.subscription_tier)!=="free"})]})})})}function vo(){var Pe,be,ke,F;const{user:s}=Q(),[a,t]=o.useState([]),[r,n]=o.useState(null),[l,i]=o.useState([]),[j,h]=o.useState(""),[y,u]=o.useState(!0),[g,f]=o.useState(!1),[N,v]=o.useState(null),[I,w]=o.useState(""),[c,d]=o.useState([]),[b,C]=o.useState(!1),[O,A]=o.useState(!1),[L,z]=o.useState(!1),[p,M]=o.useState(!1),R=o.useRef(null),{data:$}=Mn("session",async()=>{var T,H;const{data:m}=await K.auth.getSession();return console.log("SWR session check:",{hasSession:!!m.session,sessionUser:(H=(T=m.session)==null?void 0:T.user)==null?void 0:H.id}),m.session}),J=!!s||!!$;o.useEffect(()=>{var m;console.log("Authentication state:",{authUser:!!s,authUserId:s==null?void 0:s.id,session:!!$,sessionUserId:(m=$==null?void 0:$.user)==null?void 0:m.id,isAuthenticated:J})},[s,$,J]),o.useEffect(()=>{const m=()=>{z(window.innerWidth<768)};return m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]),o.useEffect(()=>{L&&r&&M(!0)},[r,L]),o.useEffect(()=>{if(J){console.log("User is authenticated, loading conversations"),ee();const m=Oi(T=>{(T.sender_id===r||T.receiver_id===r)&&i(H=>[...H,T]),ee()});return()=>{m==null||m.unsubscribe()}}else console.log("User is not authenticated"),v("Please sign in to view your messages"),u(!1)},[J,r]),o.useEffect(()=>{const{data:m}=K.auth.onAuthStateChange((T,H)=>{console.log("Auth state change detected:",T,!!H),H&&(T==="SIGNED_IN"||T==="INITIAL_SESSION")&&(console.log("Auth event triggered conversation loading"),v(null),ee())});return()=>{m.subscription.unsubscribe()}},[]),o.useEffect(()=>{r&&pe(r)},[r]),o.useEffect(()=>{ae()},[l]),o.useEffect(()=>{O&&ge("")},[O]);const ee=async()=>{try{u(!0);const m=($==null?void 0:$.user)||s;if(!(m!=null&&m.id)){console.log("No active user found for loading conversations"),t([]);return}console.log(`Loading conversations for user: ${m.id}`);const T=await Fi();console.log("Loaded conversations:",T),t(T),v(null)}catch(m){console.error("Error getting conversations:",m),v("Failed to load conversations. Please try again.")}finally{u(!1)}},pe=async m=>{try{f(!0);const T=await Nr(m);i(T)}catch(T){console.error("Error loading messages:",T)}finally{f(!1)}},he=async m=>{if(m.preventDefault(),!(!r||!j.trim()))try{await yr(r,j.trim())&&h("")}catch(T){console.error("Error sending message:",T)}},ae=()=>{var m;(m=R.current)==null||m.scrollIntoView({behavior:"smooth"})},ge=async m=>{C(!0);try{console.log(`Starting user search with term: "${m||"all users"}"`);const T=await Ui(m);console.log(`Search returned ${(T==null?void 0:T.length)||0} users:`,T),d(T||[])}catch(T){console.error("Error searching users:",T),d([])}finally{C(!1)}},_e=()=>{M(!1)};return!J&&!y?e.jsx(le,{children:e.jsx(ye,{children:e.jsx("div",{className:"container mx-auto py-8 pt-24 px-4",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(hs,{variant:"destructive",className:"shadow-md",children:[e.jsx(ft,{className:"font-semibold",children:"Authentication Required"}),e.jsx(xs,{children:"Please sign in to view and send messages"})]})})})})}):e.jsx(le,{children:e.jsx(ye,{children:e.jsx("div",{className:"bg-gradient-to-b from-blue-50 to-white min-h-screen",children:e.jsxs("div",{className:"container mx-auto px-4 py-6 pt-20 md:pt-24",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Your Messages"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:gap-6 h-[calc(100vh-220px)] md:h-[calc(100vh-260px)]",children:[e.jsx("div",{className:k("md:w-1/3 lg:w-1/4 flex-shrink-0",L&&p?"hidden":"flex flex-col"),children:e.jsxs(E,{className:"flex-1 flex flex-col overflow-hidden shadow-lg border-2 border-blue-100 rounded-xl",children:[e.jsxs(B,{className:"flex flex-row items-center justify-between space-y-0 pb-4 border-b bg-blue-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-5 w-5 text-blue-500"}),e.jsx(Z,{children:"Messages"})]}),e.jsxs(Ge,{open:O,onOpenChange:A,children:[e.jsx(wi,{asChild:!0,children:e.jsx(_,{size:"icon",variant:"outline",className:"rounded-full h-8 w-8 border-blue-200 bg-white",children:e.jsx(Rn,{className:"h-4 w-4 text-blue-500"})})}),e.jsxs(Oe,{children:[e.jsx(Ue,{children:e.jsxs(ze,{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-5 w-5 text-blue-500"}),"New Conversation"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{placeholder:"Search users...",value:I,onChange:m=>{w(m.target.value)},onKeyDown:m=>{m.key==="Enter"&&ge(I)},className:"flex-1"}),e.jsx(_,{size:"icon",variant:"ghost",disabled:b,className:"shrink-0",onClick:()=>ge(I),children:b?e.jsx(Ja,{className:"h-4 w-4 animate-spin"}):e.jsx(Ma,{className:"h-4 w-4"})})]}),e.jsxs(ss,{className:"h-[300px]",children:[b&&e.jsx("div",{className:"flex justify-center items-center h-[100px]",children:e.jsx(Ke,{})}),!b&&c.length===0&&e.jsxs("div",{className:"text-center text-muted-foreground p-4 bg-muted/30 rounded-lg",children:[e.jsx(ht,{className:"h-12 w-12 mx-auto mb-2 text-muted-foreground/50"}),e.jsx("p",{children:"No users found"}),e.jsx("p",{className:"text-sm mt-2",children:I?`No users match "${I}"`:"There are no other users in the system"}),e.jsxs("div",{className:"mt-4 text-sm",children:[e.jsx("p",{children:"Try the following:"}),e.jsxs("ul",{className:"list-disc text-left pl-8 mt-2 space-y-1",children:[e.jsx("li",{children:"Check if other users have registered"}),e.jsx("li",{children:"Make sure your internet connection is working"}),e.jsx("li",{children:"Try refreshing the page"}),e.jsx("li",{children:"Check your authentication status"})]})]})]}),!b&&c.map(m=>{var T,H;return e.jsxs("div",{className:"flex items-center gap-3 p-3 hover:bg-blue-50 rounded-lg cursor-pointer transition-colors",onClick:()=>{n(m.id),A(!1)},children:[e.jsxs(Le,{className:"h-10 w-10 border-2 border-blue-200",children:[e.jsx(De,{src:m.avatar_url||void 0}),e.jsx(Fe,{className:"bg-blue-100 text-blue-600",children:((T=m.full_name)==null?void 0:T.charAt(0))||((H=m.email)==null?void 0:H.charAt(0))||"U"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m.full_name||m.email}),m.full_name&&m.email&&e.jsx("p",{className:"text-xs text-muted-foreground",children:m.email})]})]},m.id)})]})]})]})]})]}),e.jsxs(U,{className:"flex-1 p-0 overflow-hidden",children:[N&&e.jsx(hs,{variant:"destructive",className:"m-3 shadow-sm",children:e.jsx(xs,{children:N})}),y?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(Ke,{size:"lg"})}):a.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4 py-10 bg-blue-50/50",children:[e.jsx(ls,{className:"h-16 w-16 mb-4 text-blue-200"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No conversations yet"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-xs",children:"Start a new conversation by clicking the plus icon above"}),e.jsxs(_,{onClick:()=>A(!0),className:"gap-2 bg-blue-500 hover:bg-blue-600",size:"sm",children:[e.jsx(ms,{className:"h-4 w-4"}),"New Conversation"]})]}):e.jsx(ss,{className:"h-full",children:e.jsx("div",{className:"divide-y divide-blue-100",children:a.map(m=>e.jsx("div",{className:k("p-3 cursor-pointer hover:bg-blue-50 transition-colors",r===m.user.id?"bg-blue-100":""),onClick:()=>n(m.user.id),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Le,{className:"h-12 w-12 border-2 border-blue-200",children:[e.jsx(De,{src:m.user.avatar_url||void 0}),e.jsx(Fe,{className:"bg-blue-100 text-blue-600",children:m.user.full_name.charAt(0)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-medium truncate",children:m.user.full_name}),e.jsx("p",{className:"text-xs text-muted-foreground whitespace-nowrap pl-2",children:st(new Date(m.lastMessage.created_at),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:[m.lastMessage.sender_id===s.id&&"You: ",m.lastMessage.content]}),m.unreadCount>0&&e.jsx("div",{className:"bg-blue-500 text-white rounded-full h-5 min-w-5 px-1.5 flex items-center justify-center text-xs ml-2",children:m.unreadCount})]})]})]})},m.user.id))})})]})]})}),e.jsx("div",{className:k("md:flex-1 flex flex-col overflow-hidden",L&&!p?"hidden":"flex flex-col"),children:e.jsxs(E,{className:"flex-1 flex flex-col overflow-hidden shadow-lg border-2 border-blue-100 rounded-xl",children:[e.jsx(B,{className:"flex flex-row items-center justify-between space-y-0 px-4 py-3 border-b bg-blue-50",children:r?e.jsxs(e.Fragment,{children:[L&&e.jsx(_,{variant:"ghost",size:"icon",className:"mr-1 hover:bg-blue-100",onClick:_e,children:e.jsx(Za,{className:"h-5 w-5 text-blue-500"})}),((Pe=a.find(m=>m.user.id===r))==null?void 0:Pe.user)&&e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsxs(Le,{className:"h-8 w-8 border-2 border-blue-200",children:[e.jsx(De,{src:((be=a.find(m=>m.user.id===r))==null?void 0:be.user.avatar_url)||void 0}),e.jsx(Fe,{className:"bg-blue-100 text-blue-600",children:((ke=a.find(m=>m.user.id===r))==null?void 0:ke.user.full_name.charAt(0))||"U"})]}),e.jsx("div",{className:"overflow-hidden",children:e.jsx("p",{className:"font-medium text-sm truncate",children:(F=a.find(m=>m.user.id===r))==null?void 0:F.user.full_name})})]})]}):e.jsx("div",{className:"font-medium",children:"Messages"})}),e.jsx(U,{className:"flex-1 p-0 overflow-hidden",children:r?e.jsxs("div",{className:"h-full flex flex-col",children:[g?e.jsx("div",{className:"flex-1 flex justify-center items-center",children:e.jsx(Ke,{size:"lg"})}):e.jsx(ss,{className:"flex-1 p-4",children:l.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center px-4 bg-blue-50/50",children:[e.jsx(ls,{className:"h-16 w-16 mb-4 text-blue-200"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No messages yet"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-xs",children:"Send a message to start the conversation"})]}):e.jsxs("div",{className:"space-y-4",children:[l.map((m,T)=>{const H=m.sender_id===s.id,re=!H&&(T===0||l[T-1].sender_id!==m.sender_id);return e.jsxs("div",{className:k("flex",H?"justify-end":"justify-start"),children:[re?e.jsxs(Le,{className:"mr-2 mt-1 h-8 w-8 border-2 border-blue-200",children:[e.jsx(De,{src:m.sender.avatar_url}),e.jsx(Fe,{className:"bg-blue-100 text-blue-600",children:m.sender.full_name.charAt(0)})]}):!H&&e.jsx("div",{className:"w-10"}),e.jsxs("div",{className:k("max-w-[75%] rounded-2xl px-4 py-2.5 break-words shadow-sm",H?"bg-blue-500 text-white rounded-tr-none":"bg-blue-100 rounded-tl-none"),children:[e.jsx("p",{className:"text-sm",children:m.content}),e.jsx("p",{className:k("text-xs mt-1",H?"text-blue-100":"text-blue-500"),children:st(new Date(m.created_at),{addSuffix:!0})})]})]},m.id)}),e.jsx("div",{ref:R})]})}),e.jsx("form",{onSubmit:he,className:"p-3 border-t bg-blue-50",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{value:j,onChange:m=>h(m.target.value),placeholder:"Type a message...",className:"flex-1 border-blue-200 bg-white"}),e.jsxs(_,{type:"submit",className:"shrink-0 bg-blue-500 hover:bg-blue-600",disabled:!j.trim(),children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Send"]})]})})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center px-4 bg-blue-50/50",children:[e.jsx(ls,{className:"h-16 w-16 mb-4 text-blue-200"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Select a conversation"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-xs",children:"Choose a conversation from the list or start a new one"})]})})]})})]})})]})})})})}const Gs="3160af39c66686f66e595371584faa9d8087132c",Vs="https://app.patma.co.uk",Hs="/api/prospector/v1";async function yo(s){try{const a=new URLSearchParams;a.append("postcode",s.postcode),s.lat&&a.append("lat",s.lat.toString()),s.long&&a.append("long",s.long.toString()),s.bedrooms&&a.append("bedrooms",s.bedrooms.toString()),s.property_type&&a.append("property_type",s.property_type),s.min_data_points&&a.append("min_data_points",s.min_data_points.toString());const t=`${Vs}${Hs}/asking-prices/?${a.toString()}`;console.log("Fetching asking prices from:",t);const r=await fetch(t,{method:"GET",headers:{Authorization:`Token ${Gs}`,"Content-Type":"application/json",Accept:"application/json"}});if(!r.ok){const n=await r.json();throw new Error(n.message||"Failed to fetch asking prices")}return await r.json()}catch(a){throw console.error("Error fetching asking prices:",a),a}}async function No(s){var a;try{const t=new URLSearchParams;t.append("postcode",s.postcode),s.location&&t.append("location",s.location),s.lat&&t.append("lat",s.lat.toString()),s.long&&t.append("long",s.long.toString()),t.append("property_type",s.property_type),s.tenure&&t.append("tenure",s.tenure),s.new_build&&t.append("new_build",s.new_build),s.max_age_months&&t.append("max_age_months",s.max_age_months.toString()),s.min_data_points&&t.append("min_data_points",s.min_data_points.toString()),s.apply_indexation!==void 0&&t.append("apply_indexation",s.apply_indexation.toString());const r=`${Vs}${Hs}/sold-prices/?${t.toString()}`;console.log("Fetching sold properties from:",r);const n=await fetch(r,{method:"GET",headers:{Authorization:`Token ${Gs}`,"Content-Type":"application/json",Accept:"application/json"}});if(!n.ok){const i=await n.json().catch(()=>({errors:["Unknown error occurred"]}));throw new Error(((a=i.errors)==null?void 0:a[0])||`HTTP error! status: ${n.status}`)}const l=await n.json();if(console.log("Sold properties response:",l),l.status==="error"||l.errors){const i=Array.isArray(l.errors)?l.errors[0]:l.message||"Failed to fetch sold properties";throw new Error(i)}return l&&l.data&&Array.isArray(l.data.available_results)?{properties:l.data.available_results,total:l.data.total_results_count||l.data.available_results.length,totalPages:l.data.number_of_pages||Math.ceil(l.data.total_results_count/(s.page_size||12))}:l&&l.data&&Array.isArray(l.data.properties)?{properties:l.data.properties,total:l.data.total||l.data.properties.length,totalPages:l.data.total_pages||Math.ceil(l.data.properties.length/(s.page_size||10))}:(console.warn("Unexpected API response structure for sold properties:",l),{properties:[],total:0,totalPages:1})}catch(t){throw console.error("Error fetching sold properties:",t),t}}async function bo(s){var a,t;try{const r=new URLSearchParams;r.append("postcode",s.postcode),s.location&&r.append("location",s.location),s.lat&&r.append("lat",s.lat.toString()),s.long&&r.append("long",s.long.toString()),s.radius&&r.append("radius",s.radius.toString()),s.polygon&&r.append("polygon",JSON.stringify(s.polygon)),s.property_type&&r.append("property_type",s.property_type),s.bedrooms&&r.append("bedrooms",s.bedrooms.toString()),s.require_sold_price!==void 0&&r.append("require_sold_price",s.require_sold_price.toString()),s.require_size!==void 0&&r.append("require_size",s.require_size.toString()),s.include_sold_history!==void 0&&r.append("include_sold_history",s.include_sold_history.toString()),s.include_indexation_based_value!==void 0&&r.append("include_indexation_based_value",s.include_indexation_based_value.toString()),s.sort_by&&r.append("sort_by",s.sort_by),s.page&&r.append("page",s.page.toString()),s.page_size&&r.append("page_size",s.page_size.toString()),s.records_after&&r.append("records_after",s.records_after);const n=`${Vs}${Hs}/list-property/?${r.toString()}`;console.log("Fetching listed properties from:",n);const i=await(await fetch(n,{method:"GET",headers:{Authorization:`Token ${Gs}`,"Content-Type":"application/json",Accept:"application/json"}})).json();if(console.log("Listed properties response:",i),i.status==="error"||i.errors){const j=Array.isArray(i.errors)?i.errors[0]:i.message||"Failed to fetch listed properties";throw new Error(j)}return i&&i.data&&Array.isArray(i.data.available_results)?{properties:i.data.available_results,total:i.data.total_results_count||i.data.available_results.length,totalPages:i.data.number_of_pages||Math.ceil(i.data.total_results_count/(s.page_size||12))}:i&&i.properties?{properties:i.properties||[],total:i.total||((a=i.properties)==null?void 0:a.length)||0,totalPages:i.total_pages||Math.ceil((((t=i.properties)==null?void 0:t.length)||0)/(s.page_size||10))}:i&&i.data&&i.data.properties?{properties:i.data.properties,total:i.data.total||i.data.properties.length,totalPages:i.data.total_pages||Math.ceil(i.data.properties.length/(s.page_size||10))}:(console.warn("Unexpected API response structure:",i),{properties:[],total:0,totalPages:1})}catch(r){throw console.error("Error fetching listed properties:",r),r}}async function wo(s){try{const a=new URLSearchParams;a.append("postcode",s.postcode),s.property_type&&a.append("property_type",s.property_type);const t=`${Vs}${Hs}/price-history/?${a.toString()}`;console.log("Fetching price history from:",t);const r=await fetch(t,{method:"GET",headers:{Authorization:`Token ${Gs}`,"Content-Type":"application/json",Accept:"application/json"}});if(!r.ok){const l=await r.json();throw new Error(l.message||"Failed to fetch price history")}return await r.json()}catch(a){throw console.error("Error fetching price history:",a),a}}function So(){var rs,fs,js;const[s,a]=S.useState(""),[t,r]=S.useState(!1),[n,l]=S.useState([]),[i,j]=S.useState([]),[h,y]=S.useState({}),[u,g]=S.useState("listed"),[f,N]=S.useState(0),[v,I]=S.useState(1),{toast:w}=Ce(),[c,d]=S.useState({propertyType:"any",tenure:"any",minBeds:"0",radius:1,page:1,limit:12,newBuild:!1,maxAgeMonths:18,sortBy:"most_recent_sale_date"}),[b,C]=S.useState(!0),[O,A]=S.useState(!0),[L,z]=S.useState(!1),[p,M]=S.useState(null),[R,$]=S.useState(!1),J=S.useMemo(()=>u==="listed"?n:i,[u,n,i]),ee=async x=>{try{const[P,D]=await Promise.all([yo({postcode:x,property_type:c.propertyType==="any"?void 0:c.propertyType,bedrooms:c.minBeds==="0"?void 0:parseInt(c.minBeds),radius:c.radius}),wo({postcode:x,property_type:c.propertyType==="any"?void 0:c.propertyType,max_age_months:c.maxAgeMonths})]);y({askingPrices:P,priceHistory:D})}catch(P){console.error("Error fetching area insights:",P)}},pe=x=>{if(x.image_url&&typeof x.image_url=="string"&&x.image_url.trim()!=="")return console.log("Using direct image URL from API"),x.image_url;const P=["main_image","photo_url","thumbnail","image"];for(const D of P)if(x[D]&&typeof x[D]=="string"&&x[D].trim()!=="")return console.log(`Found image in property.${D}`),x[D];for(const D in x)if(typeof x[D]=="string"&&x[D].includes("property-software.uk")&&(x[D].endsWith(".jpg")||x[D].endsWith(".jpeg")||x[D].endsWith(".png")))return console.log(`Found PaTMa image URL in property.${D}`),x[D];if(x.images&&Array.isArray(x.images)&&x.images.length>0){const D=x.images.find(Y=>typeof Y=="string"&&Y.includes("property-software.uk"));if(D)return console.log("Found PaTMa image URL in images array"),D;if(typeof x.images[0]=="string")return console.log("Using first image from images array"),x.images[0];if(x.images[0]&&typeof x.images[0]=="object"&&x.images[0].url)return console.log("Using URL from first image object in images array"),x.images[0].url}if(x.photos&&Array.isArray(x.photos)&&x.photos.length>0){const D=x.photos.find(Y=>typeof Y=="string"&&Y.includes("property-software.uk"));if(D)return console.log("Found PaTMa image URL in photos array"),D;if(typeof x.photos[0]=="string")return console.log("Using first image from photos array"),x.photos[0];if(x.photos[0]&&typeof x.photos[0]=="object"&&x.photos[0].url)return console.log("Using URL from first image object in photos array"),x.photos[0].url}if(x.sold_history&&Array.isArray(x.sold_history)&&x.sold_history.length>0){for(const D of x.sold_history)if(D){for(const Y of P)if(D[Y]&&typeof D[Y]=="string"&&D[Y].trim()!=="")return console.log(`Found image in sold_history item.${Y}`),D[Y];for(const Y in D)if(typeof D[Y]=="string"&&D[Y].includes("property-software.uk")&&(D[Y].endsWith(".jpg")||D[Y].endsWith(".jpeg")||D[Y].endsWith(".png")))return console.log(`Found PaTMa image URL in sold_history item.${Y}`),D[Y];if(D.images&&Array.isArray(D.images)&&D.images.length>0){const Y=D.images.find(ne=>typeof ne=="string"&&ne.includes("property-software.uk"));if(Y)return console.log("Found PaTMa image URL in sold_history images array"),Y;if(typeof D.images[0]=="string")return console.log("Using first image from sold_history images array"),D.images[0]}}}return console.log("No image found for property"),null},he=async()=>{if(!s){w({variant:"destructive",title:"Error",description:"Please enter a location or postcode"});return}try{r(!0);const x=/^[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}$/i.test(s.trim());if(ee(s).catch(P=>{console.error("Error fetching area insights:",P),w({variant:"destructive",title:"Warning",description:"Could not fetch area insights. Some information may be missing."})}),u==="listed")try{const P=await bo({postcode:s.trim(),location:x?void 0:s.trim(),radius:c.radius,property_type:c.propertyType==="any"?void 0:c.propertyType,tenure:c.tenure==="any"?void 0:c.tenure,bedrooms:c.minBeds==="0"?void 0:parseInt(c.minBeds),new_build:c.newBuild||void 0,page:c.page,page_size:c.limit,sort_by:c.sortBy,include_sold_history:!0,require_sold_price:!0,require_size:!0});console.log("COMPLETE API RESPONSE STRUCTURE:",JSON.stringify(P,null,2));const D=P.properties[0];D&&(console.log("COMPLETE SAMPLE PROPERTY STRUCTURE:",JSON.stringify(D,null,2)),console.log("KEY PROPERTY FIELDS FOR IMAGE LOOKUP:",{listing_url:D.listing_url,property_url:D.property_url,url:D.url,id:D.id,rightmove_id:D.rightmove_id,zoopla_id:D.zoopla_id,uprn:D.uprn,listing_detail_url:D.listing_detail_url}));const ne=P.properties.map((W,we)=>{let xe=JSON.parse(JSON.stringify(W));return W.uprn&&(xe.uprn=String(W.uprn)),W.last_sold_price&&(xe.price=W.last_sold_price),xe.image_url=pe(W),!xe.property_type&&W.built_form?xe.property_type=W.built_form:xe.property_type||(xe.property_type="House"),xe}).map(W=>ae(W));l(ne),N(P.total),I(P.totalPages),P.properties.length===0&&w({variant:"default",title:"No Results",description:"No listed properties found for this search criteria. Try adjusting your filters."})}catch(P){console.error("Error fetching listed properties:",P),w({variant:"destructive",title:"Error",description:P instanceof Error?P.message:"Could not fetch listed properties. Please check your search criteria and try again."}),l([]),N(0),I(1)}else try{const P=await No({postcode:s.trim(),location:x?void 0:s.trim(),radius:c.radius,property_type:c.propertyType==="any"?"flat":c.propertyType,tenure:c.tenure==="any"?void 0:c.tenure,max_age_months:c.maxAgeMonths,min_data_points:20,apply_indexation:!0,page:c.page,page_size:c.limit});console.log("Sold properties API response structure:",JSON.stringify(P,null,2).substring(0,500)+"..."),P.properties&&P.properties.length>0&&console.log("First sold property full object:",P.properties[0]);const Y=P.properties.map(ne=>{var we;let W=JSON.parse(JSON.stringify(ne));if(!W.price&&!W.sale_price){if((we=ne.details)!=null&&we.price)W.price=ne.details.price;else if(ne.price_paid)W.sale_price=ne.price_paid;else if(ne.sale_price)W.sale_price=ne.sale_price;else if(ne.latest_sold_price)W.sale_price=ne.latest_sold_price;else if(typeof ne.price=="string"){const xe=ne.price.match(/[\d,]+/);xe&&(W.price=parseInt(xe[0].replace(/,/g,"")))}}if(W.sale_price&&typeof W.sale_price=="string"){const xe=W.sale_price.match(/[\d,]+/);xe&&(W.sale_price=parseInt(xe[0].replace(/,/g,"")))}return W.image_url=pe(ne),W}).map(ne=>ae(ne));j(Y),N(P.total),I(P.totalPages),P.properties.length===0&&w({variant:"default",title:"No Results",description:"No sold properties found for this search criteria. Try adjusting your filters."})}catch(P){console.error("Error fetching sold properties:",P),w({variant:"destructive",title:"Error",description:P instanceof Error?P.message:"Could not fetch sold properties. Please check your search criteria and try again."}),j([]),N(0),I(1)}}catch(x){console.error("Search error:",x),w({variant:"destructive",title:"Error",description:x instanceof Error?x.message:"An unexpected error occurred. Please try again."})}finally{r(!1)}},ae=x=>{const P={...x},D=P.price||P.asking_price||P.sale_price||P.price_paid||P.latest_price||0;if(D>0&&(P.stamp_duty||(P.stamp_duty=ge(D)),P.size_sq_meters&&!P.price_per_sqft?P.price_per_sqft=_e(D,P.size_sq_meters,!0):P.size_sq_feet&&!P.price_per_sqft&&(P.price_per_sqft=_e(D,P.size_sq_feet,!1)),!P.estimated_rent)){let Y=0;if(Y=D*.04/12,P.bedrooms){const we=1+(P.bedrooms-2)*.1;Y*=Math.max(.8,Math.min(we,1.5))}if(P.estimated_rent=Math.round(Y),!P.rental_yield){const we=P.estimated_rent*12;P.rental_yield=we/D*100}if(!P.roi){const Re=D*Math.pow(1.03,5),vs=P.estimated_rent*12*5,ys=Re-D+vs;P.roi=ys/D*100}P.estimated_growth||(P.estimated_growth=3.5)}return P},ge=(x,P=!1,D=!1)=>{if(x<=0)return 0;let Y=0;return D&&(x<=425e3?Y=0:x<=625e3?Y=(x-425e3)*.05:D=!1),D||(x<=25e4?Y=0:x<=925e3?Y=(x-25e4)*.05:x<=15e5?Y=(x-925e3)*.1+675e3*.05:Y=(x-15e5)*.12+575e3*.1+675e3*.05),P&&(Y+=x*.03),Math.round(Y)},_e=(x,P,D=!1)=>{if(!x||!P||P<=0)return null;if(D)return Math.round(x/P);{const Y=D?P*10.764:P;return Math.round(x/Y)}};S.useEffect(()=>{s&&he()},[u,c.page]),S.useEffect(()=>{u==="sold"&&c.propertyType==="any"&&d(x=>({...x,propertyType:"flat"}))},[u,c.propertyType]);const Pe=x=>{d(P=>({...P,propertyType:x,page:1}))},be=x=>{d(P=>({...P,tenure:x,page:1}))},ke=x=>{d(P=>({...P,minBeds:x,page:1}))},F=x=>{d(P=>({...P,radius:parseFloat(x),page:1}))},m=x=>{d(P=>({...P,sortBy:x,page:1}))},T=x=>{M(x),$(!0)},H=()=>{$(!1),setTimeout(()=>M(null),300)},re=()=>{var vs,ys,Nt,bt,wt;if(!p)return null;const x=p.price||p.asking_price||p.sale_price||p.price_paid||p.latest_price||0,P="date_of_transfer"in p,D=p.image_url,Y=p.postcode||p.address&&((vs=p.address.match(/[A-Z]{1,2}[0-9][0-9A-Z]?\s?[0-9][A-Z]{2}/i))==null?void 0:vs[0])||"Not Available",ne=p.sold_history&&p.sold_history.length>0,W=ne?p.sold_history.filter(se=>se&&se.date&&!isNaN(new Date(se.date).getTime())&&se.price&&!isNaN(parseFloat(String(se.price)))).sort((se,fe)=>new Date(se.date).getTime()-new Date(fe.date).getTime()):[],we=W.length>=2?(W[W.length-1].price-W[0].price)/W[0].price*100:null,xe=(se,fe=25,Ws=4.5,Ys=25)=>{const Ns=se*(fe/100),bs=se-Ns,ns=Ws/100/12,ws=Ys*12,St=bs*(ns*Math.pow(1+ns,ws))/(Math.pow(1+ns,ws)-1);return{downPayment:Ns,loanAmount:bs,monthlyPayment:St,totalPayments:ws,totalRepayment:St*ws}},Re=x>0?xe(x):null;return e.jsxs("div",{className:`fixed inset-0 z-50 flex items-center justify-center p-4 ${R?"opacity-100":"opacity-0 pointer-events-none"} transition-opacity duration-300`,children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:H}),e.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("button",{onClick:H,className:"absolute top-4 right-4 z-10 bg-white/80 p-1 rounded-full hover:bg-white transition-colors",children:e.jsx(ct,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex flex-col md:flex-row h-full overflow-hidden",children:[e.jsxs("div",{className:"w-full md:w-2/5 h-64 md:h-auto relative bg-gray-100",children:[D?e.jsx("img",{src:D,alt:p.address||"Property",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"w-full h-full flex items-center justify-center",children:[e.jsx(He,{className:"h-16 w-16 text-gray-300"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"No image available"})]}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:"bg-white/90 text-black px-3 py-1 rounded-full text-sm font-medium",children:p.property_type})}),p.listing_url&&e.jsxs("a",{href:p.listing_url,target:"_blank",rel:"noopener noreferrer",className:"absolute bottom-4 left-4 bg-white/90 text-black px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1 hover:bg-white transition-colors",children:[e.jsx(Tn,{className:"h-4 w-4"}),"View Listing"]})]}),e.jsxs("div",{className:"w-full md:w-3/5 p-6 overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:p.address}),e.jsx("p",{className:"text-3xl font-bold mb-4 text-emerald-600",children:V(x)}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Property Type"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(mt,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:p.property_type||"N/A"})]})]}),p.bedrooms&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Bedrooms"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(Ps,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:p.bedrooms})]})]}),p.bathrooms&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Bathrooms"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx("div",{className:"h-4 w-4 text-gray-600 flex items-center justify-center",children:"🛁"}),e.jsx("span",{className:"font-medium",children:p.bathrooms})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Postcode"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(Ye,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:Y})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Tenure"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(En,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:p.tenure||"N/A"})]})]}),P&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Sold Date"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(Me,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:new Date(p.date_of_transfer).toLocaleDateString()})]})]}),(p.size_sq_feet||p.size_sq_meters)&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Size"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(La,{className:"h-4 w-4 text-gray-600"}),e.jsxs("span",{className:"font-medium",children:[p.size_sq_feet?`${p.size_sq_feet} sq.ft`:"",p.size_sq_meters?`${p.size_sq_meters} m²`:""]})]})]}),p.price_per_sqft&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Price per sq.ft"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(ue,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:V(p.price_per_sqft)})]})]})]}),e.jsxs("div",{className:"mb-6 bg-gray-50 p-4 rounded-lg border border-gray-100",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx(Je,{className:"h-5 w-5 mr-2 text-emerald-600"}),"Investment Dashboard"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[p.estimated_rent&&e.jsxs("div",{className:"bg-blue-50 p-3 rounded",children:[e.jsx("p",{className:"text-blue-800 text-sm font-medium",children:"Estimated Monthly Rent"}),e.jsxs("p",{className:"text-blue-600 text-lg font-bold mt-1",children:[V(p.estimated_rent),"/month"]}),p.rental_yield&&e.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[p.rental_yield.toFixed(1),"% yield"]})]}),p.roi&&e.jsxs("div",{className:"bg-purple-50 p-3 rounded",children:[e.jsx("p",{className:"text-purple-800 text-sm font-medium",children:"5-Year ROI Estimate"}),e.jsxs("p",{className:"text-purple-600 text-lg font-bold mt-1",children:[p.roi.toFixed(1),"%"]}),p.estimated_growth&&e.jsxs("p",{className:"text-purple-600 text-sm mt-1",children:[p.estimated_growth.toFixed(1),"% annual growth"]})]})]}),Re&&e.jsxs("div",{className:"bg-emerald-50 p-3 rounded",children:[e.jsx("p",{className:"text-emerald-800 text-sm font-medium",children:"Mortgage Estimate (25% deposit)"}),e.jsxs("p",{className:"text-emerald-600 text-lg font-bold mt-1",children:[V(Re.monthlyPayment),"/month"]}),e.jsxs("div",{className:"mt-2 text-sm text-emerald-700 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Deposit (25%):"}),e.jsx("span",{children:V(Re.downPayment)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Loan amount:"}),e.jsx("span",{children:V(Re.loanAmount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Term:"}),e.jsx("span",{children:"25 years at 4.5%"})]})]})]})]}),p.estimated_rent&&Re&&e.jsxs("div",{className:"mt-4 bg-white p-3 rounded border border-gray-100",children:[e.jsx("p",{className:"text-gray-800 text-sm font-medium",children:"Monthly Cash Flow Analysis"}),e.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Rental Income:"}),e.jsxs("span",{className:"text-emerald-600",children:["+",V(p.estimated_rent)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Mortgage Payment:"}),e.jsxs("span",{className:"text-red-600",children:["-",V(Re.monthlyPayment)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Management (10%):"}),e.jsxs("span",{className:"text-red-600",children:["-",V(p.estimated_rent*.1)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Maintenance (5%):"}),e.jsxs("span",{className:"text-red-600",children:["-",V(p.estimated_rent*.05)]})]}),e.jsxs("div",{className:"flex justify-between font-bold pt-2 border-t border-gray-100 mt-2",children:[e.jsx("span",{children:"Net Cash Flow:"}),e.jsx("span",{className:`${p.estimated_rent-Re.monthlyPayment-p.estimated_rent*.15>0?"text-emerald-600":"text-red-600"}`,children:V(p.estimated_rent-Re.monthlyPayment-p.estimated_rent*.15)})]})]})]})]}),p.stamp_duty!==void 0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Purchase Costs"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-amber-50 p-3 rounded",children:[e.jsx("p",{className:"text-amber-800 text-sm font-medium",children:"Stamp Duty"}),e.jsx("p",{className:"text-amber-600 text-lg font-bold mt-1",children:V(p.stamp_duty)}),e.jsx("p",{className:"text-amber-700 text-xs mt-2",children:"First-time buyer? You may qualify for lower rates."})]}),e.jsxs("div",{className:"bg-emerald-50 p-3 rounded",children:[e.jsx("p",{className:"text-emerald-800 text-sm font-medium",children:"Total Purchase Cost"}),e.jsx("p",{className:"text-emerald-600 text-lg font-bold mt-1",children:V(x+(p.stamp_duty||0))}),e.jsxs("div",{className:"mt-2 text-sm text-emerald-700 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Property price:"}),e.jsx("span",{children:V(x)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Stamp duty:"}),e.jsx("span",{children:V(p.stamp_duty||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Legal fees (est.):"}),e.jsx("span",{children:V(1500)})]})]})]})]})]}),((Nt=(ys=h.priceHistory)==null?void 0:ys.data)==null?void 0:Nt.trend_percentage)!==void 0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx(Ln,{className:"h-5 w-5 mr-2 text-blue-600"}),"Area Insights"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-cyan-50 p-3 rounded",children:[e.jsx("p",{className:"text-cyan-800 text-sm font-medium",children:"Area Price Trend"}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[h.priceHistory.data.trend_percentage>0?e.jsx(Be,{className:"h-5 w-5 text-emerald-600"}):e.jsx(Da,{className:"h-5 w-5 text-red-600"}),e.jsxs("p",{className:`text-lg font-bold ${h.priceHistory.data.trend_percentage>0?"text-emerald-600":"text-red-600"}`,children:[h.priceHistory.data.trend_percentage.toFixed(1),"%"]})]}),e.jsx("p",{className:"text-cyan-600 text-sm mt-1",children:"Last 12 months"}),e.jsx("div",{className:"mt-3 h-10 bg-white rounded overflow-hidden",children:e.jsx("div",{className:`h-full ${h.priceHistory.data.trend_percentage>0?"bg-emerald-500":"bg-red-500"}`,style:{width:`${Math.min(Math.abs(h.priceHistory.data.trend_percentage)*3,100)}%`}})})]}),((wt=(bt=h.askingPrices)==null?void 0:bt.data)==null?void 0:wt.mean)&&e.jsxs("div",{className:"bg-teal-50 p-3 rounded",children:[e.jsx("p",{className:"text-teal-800 text-sm font-medium",children:"Average Area Price"}),e.jsx("p",{className:"text-teal-600 text-lg font-bold mt-1",children:V(h.askingPrices.data.mean)}),x>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-teal-600 text-sm mt-1",children:["This property is ",e.jsx("strong",{children:x<h.askingPrices.data.mean?"below":"above"})," average"]}),e.jsxs("div",{className:"mt-3 relative h-10 bg-gray-100 rounded overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 flex",children:[e.jsx("div",{className:"h-full bg-teal-200",style:{width:"50%"}}),e.jsx("div",{className:"h-full bg-teal-300",style:{width:"50%"}})]}),e.jsx("div",{className:"absolute top-0 h-full w-1 bg-black",style:{left:"50%",transform:"translateX(-50%)"}}),e.jsx("div",{className:"absolute top-0 h-full w-2 bg-emerald-600 rounded",style:{left:`${Math.min(Math.max(x/h.askingPrices.data.mean*50,10),90)}%`,transform:"translateX(-50%)"}})]}),e.jsxs("div",{className:"flex justify-between text-xs mt-1 text-gray-600",children:[e.jsx("span",{children:"-50%"}),e.jsx("span",{children:"Average"}),e.jsx("span",{children:"+50%"})]})]})]})]})]}),p.description&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-gray-600",children:p.description})]}),ne&&W.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[e.jsx(Je,{className:"h-5 w-5 mr-2 text-amber-600"}),"Sale History"]}),we!==null&&e.jsxs("div",{className:"mb-3 p-3 rounded bg-amber-50",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-amber-800 text-sm mr-2",children:"Total Price Growth:"}),e.jsxs("span",{className:`font-bold ${we>=0?"text-emerald-600":"text-red-600"}`,children:[we>=0?"+":"",we.toFixed(1),"%"]})]}),W.length>=2&&e.jsxs("div",{className:"text-xs text-amber-700 mt-1",children:["Over ",Math.round((new Date(W[W.length-1].date).getTime()-new Date(W[0].date).getTime())/(1e3*60*60*24*365))," years (",new Date(W[0].date).getFullYear()," to ",new Date(W[W.length-1].date).getFullYear(),")"]})]}),W.length>=2&&e.jsxs("div",{className:"mb-4 bg-white p-3 rounded border border-gray-100",children:[e.jsx("div",{className:"h-32 relative",children:e.jsx("div",{className:"absolute bottom-0 left-0 right-0 flex items-end h-full",children:W.map((se,fe)=>{const Ws=Math.max(...W.map(ns=>ns.price)),Ys=se.price/Ws*100,Ns=`${100/W.length}%`,bs=fe>0?"0 0 0 1px":"0";return e.jsx("div",{className:"bg-emerald-500 hover:bg-emerald-600 transition-colors relative group",style:{height:`${Ys}%`,width:Ns,margin:bs},children:e.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 bg-black text-white text-xs rounded px-2 py-1 whitespace-nowrap",children:[e.jsx("div",{children:V(se.price)}),e.jsx("div",{children:new Date(se.date).toLocaleDateString()})]})},fe)})})}),e.jsx("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:W.map((se,fe)=>e.jsx("div",{children:new Date(se.date).getFullYear()},fe))})]}),e.jsx("div",{className:"space-y-2",children:W.map((se,fe)=>e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{children:new Date(se.date).toLocaleDateString()})]}),e.jsx("span",{className:"font-medium",children:typeof se.price=="number"&&!isNaN(se.price)?V(se.price):"Price not available"})]},fe))})]}),p.nearby_stations&&p.nearby_stations.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Nearby Transport"}),e.jsx("div",{className:"space-y-2",children:p.nearby_stations.map((se,fe)=>e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{children:se.name}),e.jsxs("span",{className:"text-gray-600",children:[se.distance," miles"]})]},fe))})]}),p.nearby_schools&&p.nearby_schools.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Nearby Schools"}),e.jsx("div",{className:"space-y-2",children:p.nearby_schools.map((se,fe)=>e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{children:se.name}),e.jsxs("span",{className:"text-gray-600",children:[se.distance," miles"]})]},fe))})]})]})]})]})]})};return e.jsxs(le,{children:[e.jsx("div",{className:"bg-background",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-500 to-cyan-500 mix-blend-multiply"})}),e.jsxs("div",{className:"relative px-4 py-24 sm:px-6 sm:py-32 lg:py-40 lg:px-8",children:[e.jsx("h1",{className:"text-center text-4xl font-extrabold tracking-tight text-white sm:text-5xl lg:text-6xl",children:"Property Search"}),e.jsx("p",{className:"mx-auto mt-6 max-w-lg text-center text-xl text-white sm:max-w-3xl",children:"Search through thousands of properties, compare market prices, and make informed decisions with our comprehensive property data."})]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-8 -mt-16 relative z-10",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Find Properties"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:u==="listed"?"default":"outline",onClick:()=>g("listed"),className:"min-w-[120px]",children:"Listed Properties"}),e.jsx(_,{variant:u==="sold"?"default":"outline",onClick:()=>g("sold"),className:"min-w-[120px]",children:"Sold Properties"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(Te,{value:c.propertyType,onValueChange:Pe,children:[e.jsx(Ae,{className:"w-full",children:e.jsx(Ee,{placeholder:"Property Type"})}),e.jsxs(Ie,{children:[u==="listed"&&e.jsx(X,{value:"any",children:"Any Type"}),e.jsx(X,{value:"flat",children:"Flat"}),e.jsx(X,{value:"terraced",children:"Terraced"}),e.jsx(X,{value:"semi-detached",children:"Semi-Detached"}),e.jsx(X,{value:"detached",children:"Detached"}),e.jsx(X,{value:"bungalow",children:"Bungalow"})]})]}),e.jsxs(Te,{value:c.tenure,onValueChange:be,children:[e.jsx(Ae,{className:"w-full",children:e.jsx(Ee,{placeholder:"Tenure"})}),e.jsxs(Ie,{children:[e.jsx(X,{value:"any",children:"Any Tenure"}),e.jsx(X,{value:"freehold",children:"Freehold"}),e.jsx(X,{value:"leasehold",children:"Leasehold"})]})]}),e.jsxs(Te,{value:c.minBeds,onValueChange:ke,children:[e.jsx(Ae,{className:"w-full",children:e.jsx(Ee,{placeholder:"Min Bedrooms"})}),e.jsxs(Ie,{children:[e.jsx(X,{value:"0",children:"Any"}),[1,2,3,4,5].map(x=>e.jsxs(X,{value:x.toString(),children:[x,"+ beds"]},x))]})]}),e.jsxs(Te,{value:c.radius.toString(),onValueChange:F,children:[e.jsx(Ae,{className:"w-full",children:e.jsx(Ee,{placeholder:"Search Radius"})}),e.jsx(Ie,{children:[.25,.5,1,2,5,10].map(x=>e.jsxs(X,{value:x.toString(),children:[x," miles"]},x))})]}),u==="listed"&&e.jsxs(Te,{value:c.sortBy,onValueChange:m,children:[e.jsx(Ae,{className:"w-full",children:e.jsx(Ee,{placeholder:"Sort By"})}),e.jsxs(Ie,{children:[e.jsx(X,{value:"most_recent_sale_date",children:"Most Recent Sale"}),e.jsx(X,{value:"distance",children:"Distance"})]})]})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx(q,{type:"text",placeholder:"Enter location (postcode, city, street, etc.)",value:s,onChange:x=>a(x.target.value),className:"flex-1 h-12"}),e.jsx(_,{onClick:he,className:"h-12 px-8 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white hover:from-emerald-600 hover:to-cyan-600",disabled:t,children:t?e.jsx(Ke,{size:"sm"}):"Search"})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:x=>C(x.target.checked),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),"Show price per sq.ft"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:O,onChange:x=>A(x.target.checked),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),"Show stamp duty"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:L,onChange:x=>z(x.target.checked),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),"Show planning applications"]})]})]})]}),t?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(Ke,{size:"lg"})}):J.length>0?e.jsxs(e.Fragment,{children:[((rs=h.askingPrices)==null?void 0:rs.data)&&e.jsxs("div",{className:"mb-8 bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Area Insights for ",s]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-emerald-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-emerald-800 text-sm font-medium mb-2",children:"Average Asking Price"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-700",children:V(h.askingPrices.data.mean||0)})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-blue-800 text-sm font-medium mb-2",children:"Median Asking Price"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:V(h.askingPrices.data.median||0)})]}),((js=(fs=h.priceHistory)==null?void 0:fs.data)==null?void 0:js.trend_percentage)!==void 0&&e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-purple-800 text-sm font-medium mb-2",children:"Price Trend (12 months)"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:[h.priceHistory.data.trend_percentage.toFixed(1),"%"]})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("h3",{className:"text-lg text-gray-600",children:["Found ",f," ",u==="listed"?"listed":"sold"," properties"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:J.map((x,P)=>e.jsx(E,{className:"overflow-hidden hover:shadow-lg transition-shadow duration-200 cursor-pointer",onClick:()=>T(x),children:u==="listed"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"aspect-video relative bg-gray-100",children:[x.image_url?e.jsx("img",{src:x.image_url,alt:x.address||"Property",className:"w-full h-full object-cover",loading:"lazy"}):e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center",children:[e.jsx(He,{className:"h-12 w-12 text-gray-300"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"No image available"})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[e.jsx("span",{className:"bg-white/90 text-black px-3 py-1 rounded-full text-sm font-medium",children:x.property_type}),x.new_build&&e.jsx("span",{className:"bg-emerald-500/90 text-white px-3 py-1 rounded-full text-sm font-medium",children:"New Build"})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg line-clamp-2 mb-2",children:x.address}),e.jsx("p",{className:"text-2xl font-bold mb-3 text-emerald-600",children:V(x.price||x.asking_price||x.last_sold_price||x.price_paid||x.latest_price||0)}),b&&x.price_per_sqft&&e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[V(x.price_per_sqft),"/sq.ft",x.size_sq_feet&&` · ${x.size_sq_feet} sq.ft`,x.size_sq_meters&&` · ${x.size_sq_meters} m²`]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ps,{className:"h-4 w-4"}),e.jsx("span",{children:x.bedrooms||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"h-4 w-4"}),e.jsx("span",{children:x.postcode})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(He,{className:"h-4 w-4"}),e.jsx("span",{children:x.tenure||"N/A"})]})]}),O&&x.stamp_duty!==void 0&&e.jsx("div",{className:"mt-2 mb-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Stamp Duty:"}),e.jsx("span",{className:"font-medium",children:V(x.stamp_duty)})]})}),(x.estimated_rent||x.rental_yield||x.roi||x.estimated_growth)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Investment Potential"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[x.estimated_rent&&e.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[e.jsx("p",{className:"text-blue-800 font-medium",children:"Est. Rent"}),e.jsxs("p",{className:"text-blue-600 font-bold",children:[V(x.estimated_rent),"/mo"]})]}),x.rental_yield&&e.jsxs("div",{className:"bg-emerald-50 p-2 rounded",children:[e.jsx("p",{className:"text-emerald-800 font-medium",children:"Yield"}),e.jsxs("p",{className:"text-emerald-600 font-bold",children:[x.rental_yield.toFixed(1),"%"]})]}),x.roi&&e.jsxs("div",{className:"bg-purple-50 p-2 rounded",children:[e.jsx("p",{className:"text-purple-800 font-medium",children:"5yr ROI"}),e.jsxs("p",{className:"text-purple-600 font-bold",children:[x.roi.toFixed(1),"%"]})]}),x.estimated_growth&&e.jsxs("div",{className:"bg-amber-50 p-2 rounded",children:[e.jsx("p",{className:"text-amber-800 font-medium",children:"Growth"}),e.jsxs("p",{className:"text-amber-600 font-bold",children:[x.estimated_growth.toFixed(1),"%"]})]})]})]})]})]}):e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-lg line-clamp-2 mb-2",children:x.address}),e.jsx("p",{className:"text-2xl font-bold mb-3 text-emerald-600",children:V(x.sale_price||x.price||x.price_paid||0)}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"h-4 w-4"}),e.jsx("span",{children:x.postcode})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(He,{className:"h-4 w-4"}),e.jsx("span",{children:x.property_type})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsxs("span",{children:["Sold: ",new Date(x.date_of_transfer).toLocaleDateString()]})]}),x.bedrooms&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ps,{className:"h-4 w-4"}),e.jsxs("span",{children:[x.bedrooms," beds"]})]})]}),O&&x.stamp_duty!==void 0&&e.jsx("div",{className:"mt-2 mb-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Stamp Duty:"}),e.jsx("span",{className:"font-medium",children:V(x.stamp_duty)})]})}),(x.estimated_rent||x.rental_yield||x.roi||x.estimated_growth)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Investment Potential"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[x.estimated_rent&&e.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[e.jsx("p",{className:"text-blue-800 font-medium",children:"Est. Rent"}),e.jsxs("p",{className:"text-blue-600 font-bold",children:[V(x.estimated_rent),"/mo"]})]}),x.rental_yield&&e.jsxs("div",{className:"bg-emerald-50 p-2 rounded",children:[e.jsx("p",{className:"text-emerald-800 font-medium",children:"Yield"}),e.jsxs("p",{className:"text-emerald-600 font-bold",children:[x.rental_yield.toFixed(1),"%"]})]}),x.roi&&e.jsxs("div",{className:"bg-purple-50 p-2 rounded",children:[e.jsx("p",{className:"text-purple-800 font-medium",children:"5yr ROI"}),e.jsxs("p",{className:"text-purple-600 font-bold",children:[x.roi.toFixed(1),"%"]})]}),x.estimated_growth&&e.jsxs("div",{className:"bg-amber-50 p-2 rounded",children:[e.jsx("p",{className:"text-amber-800 font-medium",children:"Growth"}),e.jsxs("p",{className:"text-amber-600 font-bold",children:[x.estimated_growth.toFixed(1),"%"]})]})]})]})]})},`${x.address}-${P}`))}),v>1&&e.jsxs("div",{className:"mt-8 flex justify-center gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>d(x=>({...x,page:Math.max(1,x.page-1)})),disabled:c.page===1,children:"Previous"}),e.jsxs("span",{className:"flex items-center px-4",children:["Page ",c.page," of ",v]}),e.jsx(_,{variant:"outline",onClick:()=>d(x=>({...x,page:Math.min(v,x.page+1)})),disabled:c.page===v,children:"Next"})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-600",children:["No ",u," properties found. Try adjusting your search criteria."]})})]}),e.jsx(re,{})]})}const _o=()=>{const[s,a]=o.useState(25e4),[t,r]=o.useState(5e4),[n,l]=o.useState(4.5),[i,j]=o.useState(25),[h,y]=o.useState(null),[u,g]=o.useState(null),[f,N]=o.useState(null),v=()=>{const w=s-t,c=n/100/12,d=i*12,b=Math.pow(1+c,d),C=w*b*c/(b-1),O=C*d,A=O-w;y(C),g(O),N(A)},I=(s-t)/s*100;return e.jsxs(E,{className:"w-full",children:[e.jsx(B,{children:e.jsxs(Z,{className:"flex items-center text-xl font-semibold",children:[e.jsx(Xa,{className:"mr-2 h-5 w-5"}),"Mortgage Payment Calculator"]})}),e.jsx(U,{className:"grid gap-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"property-value",children:"Property Value"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",s.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(ve,{id:"property-value",min:5e4,max:2e6,step:5e3,defaultValue:[s],onValueChange:w=>a(w[0])})]}),e.jsx(q,{type:"number",value:s,onChange:w=>a(Number(w.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"deposit",children:"Deposit"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",t.toLocaleString()," (",I.toFixed(1),"% LTV)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(ve,{id:"deposit",min:0,max:s,step:5e3,defaultValue:[t],onValueChange:w=>r(w[0])})]}),e.jsx(q,{type:"number",value:t,onChange:w=>r(Number(w.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"interest-rate",children:"Interest Rate"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[n,"%"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Dn,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(ve,{id:"interest-rate",min:.1,max:15,step:.1,defaultValue:[n],onValueChange:w=>l(w[0])})]}),e.jsx(q,{type:"number",value:n,onChange:w=>l(Number(w.target.value)),className:"mt-2",step:.1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"mortgage-term",children:"Mortgage Term"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[i," years"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Me,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(ve,{id:"mortgage-term",min:5,max:40,step:1,defaultValue:[i],onValueChange:w=>j(w[0])})]}),e.jsx(q,{type:"number",value:i,onChange:w=>j(Number(w.target.value)),className:"mt-2"})]}),e.jsx(_,{onClick:v,className:"w-full mt-4",children:"Calculate"})]}),e.jsxs("div",{className:"space-y-6",children:[h!==null&&e.jsxs("div",{className:"rounded-lg border p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Mortgage Summary"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Loan Amount:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",(s-t).toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Monthly Payment:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",h.toFixed(2)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Total Repayment:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",u==null?void 0:u.toFixed(2)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Total Interest:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",f==null?void 0:f.toFixed(2)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-4 border-t",children:[e.jsx("div",{className:"text-muted-foreground",children:"Loan to Value (LTV):"}),e.jsxs("div",{className:"text-right font-medium",children:[I.toFixed(1),"%"]})]})]})]}),e.jsx(E,{children:e.jsxs(U,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Tips"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground list-disc pl-5",children:[e.jsx("li",{children:"A higher deposit lowers your monthly payments and improves rates."}),e.jsx("li",{children:"Shorter mortgage terms have higher monthly payments but less total interest."}),e.jsx("li",{children:"Most lenders offer better rates for LTV under 75%."}),e.jsx("li",{children:"Consider fees and early repayment charges when comparing mortgages."})]})]})})]})]})})]})},Ts=o.forwardRef(({className:s,...a},t)=>e.jsx(Qa,{ref:t,className:k("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...a,children:e.jsx(Fn,{className:k("flex items-center justify-center text-current"),children:e.jsx(fa,{className:"h-4 w-4"})})}));Ts.displayName=Qa.displayName;const ko=()=>{const[s,a]=o.useState(3e5),[t,r]=o.useState(!1),[n,l]=o.useState(!1),[i,j]=o.useState(!1),[h,y]=o.useState(null),[u,g]=o.useState([]),f=()=>{let N=[],v=0,I=[];t?N=[{start:0,end:425e3,rate:0},{start:425e3,end:625e3,rate:.05},{start:625e3,end:null,rate:.05}]:N=[{start:0,end:25e4,rate:0},{start:25e4,end:925e3,rate:.05},{start:925e3,end:15e5,rate:.1},{start:15e5,end:null,rate:.12}];const w=n?.03:0,c=i?.02:0;let d=s;N.forEach(b=>{if(d>0){const C=b.end?b.end-b.start:d,O=Math.min(d,C),A=b.rate+w+c,L=O*A;if(L>0){const z=b.end?`£${b.start.toLocaleString()} - £${b.end.toLocaleString()}`:`Over £${b.start.toLocaleString()}`;I.push({band:`${z} @ ${(A*100).toFixed(1)}%`,tax:L})}v+=L,d-=O}}),y(v),g(I)};return e.jsxs(E,{className:"w-full",children:[e.jsx(B,{children:e.jsxs(Z,{className:"flex items-center text-xl font-semibold",children:[e.jsx(Xa,{className:"mr-2 h-5 w-5"}),"Stamp Duty Land Tax Calculator"]})}),e.jsx(U,{className:"grid gap-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"property-value",children:"Property Value"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",s.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(ve,{id:"property-value",min:4e4,max:2e6,step:5e3,defaultValue:[s],onValueChange:N=>a(N[0])})]}),e.jsx(q,{type:"number",value:s,onChange:N=>a(Number(N.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-3 pt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ts,{id:"first-time-buyer",checked:t,onCheckedChange:N=>{r(N===!0),N&&l(!1)}}),e.jsx(G,{htmlFor:"first-time-buyer",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"First-time buyer"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ts,{id:"additional-property",checked:n,onCheckedChange:N=>{l(N===!0),N&&r(!1)},disabled:t}),e.jsx(G,{htmlFor:"additional-property",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Additional property (3% surcharge)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ts,{id:"non-uk-resident",checked:i,onCheckedChange:N=>j(N===!0)}),e.jsx(G,{htmlFor:"non-uk-resident",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Non-UK resident (2% surcharge)"})]})]}),e.jsx(_,{onClick:f,className:"w-full mt-4",children:"Calculate Stamp Duty"})]}),e.jsxs("div",{className:"space-y-6",children:[h!==null&&e.jsxs("div",{className:"rounded-lg border p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Stamp Duty Summary"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-2",children:e.jsxs("div",{className:"text-lg font-semibold text-center",children:["Total Stamp Duty: £",h.toFixed(2)]})}),u.length>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Breakdown:"}),u.map((N,v)=>e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsx("div",{className:"text-muted-foreground",children:N.band}),e.jsxs("div",{className:"text-right",children:["£",N.tax.toFixed(2)]})]},v))]})]})]}),e.jsx(E,{children:e.jsxs(U,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Notes"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground list-disc pl-5",children:[e.jsx("li",{children:"First-time buyers get relief on properties up to £625,000."}),e.jsx("li",{children:"Additional properties incur a 3% surcharge on all bands."}),e.jsx("li",{children:"Non-UK residents pay an additional 2% on all bands."}),e.jsx("li",{children:"This is for standard residential property in England and Northern Ireland."}),e.jsx("li",{children:"Different rates apply in Scotland and Wales."})]})]})})]})]})})]})},Co=()=>{const[s,a]=o.useState(25e4),[t,r]=o.useState(1200),[n,l]=o.useState(2e3),[i,j]=o.useState(null),[h,y]=o.useState(null),u=()=>{const g=t*12,f=g/s*100,N=(g-n)/s*100;j(f),y(N)};return e.jsxs(E,{className:"w-full",children:[e.jsx(B,{children:e.jsxs(Z,{className:"flex items-center text-xl font-semibold",children:[e.jsx(On,{className:"mr-2 h-5 w-5"}),"Rental Yield Calculator"]})}),e.jsx(U,{className:"grid gap-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"property-value",children:"Property Value"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",s.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(ve,{id:"property-value",min:5e4,max:1e6,step:5e3,defaultValue:[s],onValueChange:g=>a(g[0])})]}),e.jsx(q,{type:"number",value:s,onChange:g=>a(Number(g.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"monthly-rent",children:"Monthly Rent"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",t]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(ve,{id:"monthly-rent",min:200,max:5e3,step:50,defaultValue:[t],onValueChange:g=>r(g[0])})]}),e.jsx(q,{type:"number",value:t,onChange:g=>r(Number(g.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"annual-expenses",children:"Annual Expenses"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",n]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(ve,{id:"annual-expenses",min:0,max:1e4,step:100,defaultValue:[n],onValueChange:g=>l(g[0])})]}),e.jsx(q,{type:"number",value:n,onChange:g=>l(Number(g.target.value)),className:"mt-2"})]}),e.jsx(_,{onClick:u,className:"w-full mt-4",children:"Calculate Yield"})]}),e.jsxs("div",{className:"space-y-6",children:[i!==null&&e.jsxs("div",{className:"rounded-lg border p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Yield Results"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Annual Rental Income:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",(t*12).toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Annual Expenses:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",n.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-4 border-t",children:[e.jsx("div",{className:"text-muted-foreground",children:"Gross Yield:"}),e.jsxs("div",{className:"text-right font-medium",children:[i.toFixed(2),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Net Yield:"}),e.jsxs("div",{className:"text-right font-medium",children:[h.toFixed(2),"%"]})]})]})]}),e.jsx(E,{children:e.jsxs(U,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"What Makes a Good Yield?"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground list-disc pl-5",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Below 3%:"})," Generally considered low yield"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"3-5%:"})," Average yield in expensive areas like London"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"5-7%:"})," Good yield for most UK locations"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Above 7%:"})," Excellent yield, but check location quality"]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:[e.jsx("p",{children:"Remember to include all expenses when calculating net yield:"}),e.jsxs("ul",{className:"list-disc pl-5 mt-2",children:[e.jsx("li",{children:"Management fees"}),e.jsx("li",{children:"Maintenance costs"}),e.jsx("li",{children:"Insurance"}),e.jsx("li",{children:"Service charges"}),e.jsx("li",{children:"Void periods"})]})]})]})})]})]})})]})},Po=()=>{const[s,a]=o.useState(25e4),[t,r]=o.useState(25e3),[n,l]=o.useState(2500),[i,j]=o.useState(3e3),[h,y]=o.useState(1200),[u,g]=o.useState(2400),[f,N]=o.useState(5),[v,I]=o.useState(3),[w,c]=o.useState("cash"),[d,b]=o.useState(62500),[C,O]=o.useState(4.5),[A,L]=o.useState(25),[z,p]=o.useState(null),M=()=>{const R=w==="cash"?s+t+n+i:d+t+n+i,$=h*12;let J=0;if(w==="mortgage"){const F=s-d,m=C/100/12,T=A*12,H=Math.pow(1+m,T);J=F*H*m/(H-1)*12}const ee=$-u-J,pe=ee/R*100,he=s*Math.pow(1+v/100,f);let ae=0;if(w==="mortgage"){const F=s-d,m=C/100/12,T=A*12,H=F*Math.pow(1+m,T)*m/(Math.pow(1+m,T)-1);let re=F;for(let rs=0;rs<f*12;rs++){const fs=re*m,js=H-fs;re-=js}ae=Math.max(0,re)}const ge=ee*f,_e=he-s-ae,Pe=ge+_e,be=Pe/R*100,ke=Math.pow(1+be/100,1/f)-1;p({totalInvestment:R,cashFlow:ee,cashOnCashReturn:pe,estimatedSalePrice:he,totalProfit:Pe,totalROI:be,annualizedROI:ke*100})};return e.jsxs(E,{className:"w-full",children:[e.jsx(B,{children:e.jsxs(Z,{className:"flex items-center text-xl font-semibold",children:[e.jsx(Je,{className:"mr-2 h-5 w-5"}),"Return on Investment (ROI) Calculator"]})}),e.jsx(U,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Property Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"purchase-price",children:"Purchase Price"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"purchase-price",type:"number",value:s,onChange:R=>a(Number(R.target.value)),className:"rounded-l-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"renovation-cost",children:"Renovation Cost"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"renovation-cost",type:"number",value:t,onChange:R=>r(Number(R.target.value)),className:"rounded-l-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"stamp-duty",children:"Stamp Duty"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"stamp-duty",type:"number",value:n,onChange:R=>l(Number(R.target.value)),className:"rounded-l-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"other-costs",children:"Other Costs (Legal, Survey, etc.)"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"other-costs",type:"number",value:i,onChange:R=>j(Number(R.target.value)),className:"rounded-l-none"})]})]}),e.jsx("h3",{className:"text-lg font-medium pt-4",children:"Rental Income & Expenses"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"monthly-rent",children:"Monthly Rent"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"monthly-rent",type:"number",value:h,onChange:R=>y(Number(R.target.value)),className:"rounded-l-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"annual-expenses",children:"Annual Expenses"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"annual-expenses",type:"number",value:u,onChange:R=>g(Number(R.target.value)),className:"rounded-l-none"})]})]}),e.jsx("h3",{className:"text-lg font-medium pt-4",children:"Investment Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"financing-method",children:"Financing Method"}),e.jsxs(Te,{defaultValue:w,onValueChange:R=>c(R),children:[e.jsx(Ae,{id:"financing-method",children:e.jsx(Ee,{placeholder:"Select financing method"})}),e.jsxs(Ie,{children:[e.jsx(X,{value:"cash",children:"Cash Purchase"}),e.jsx(X,{value:"mortgage",children:"Mortgage"})]})]})]}),w==="mortgage"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"mortgage-deposit",children:"Mortgage Deposit"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"mortgage-deposit",type:"number",value:d,onChange:R=>b(Number(R.target.value)),className:"rounded-l-none"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[(d/s*100).toFixed(1),"% of purchase price"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"interest-rate",children:"Interest Rate (%)"}),e.jsx(q,{id:"interest-rate",type:"number",value:C,onChange:R=>O(Number(R.target.value)),step:.1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"mortgage-term",children:"Mortgage Term (years)"}),e.jsx(q,{id:"mortgage-term",type:"number",value:A,onChange:R=>L(Number(R.target.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"holding-period",children:"Investment Holding Period (years)"}),e.jsx(q,{id:"holding-period",type:"number",value:f,onChange:R=>N(Number(R.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"annual-appreciation",children:"Annual Property Appreciation (%)"}),e.jsx(q,{id:"annual-appreciation",type:"number",value:v,onChange:R=>I(Number(R.target.value)),step:.1})]}),e.jsx(_,{onClick:M,className:"w-full mt-4",children:"Calculate ROI"})]}),e.jsxs("div",{className:"space-y-6",children:[z&&e.jsxs("div",{className:"rounded-lg border p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium",children:"ROI Summary"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Total Investment:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",z.totalInvestment.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Annual Cash Flow:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",z.cashFlow.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Cash-on-Cash Return:"}),e.jsxs("div",{className:"text-right font-medium",children:[z.cashOnCashReturn.toFixed(2),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-4 border-t",children:[e.jsx("div",{className:"text-muted-foreground",children:"Estimated Sale Price:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",z.estimatedSalePrice.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Total Profit:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",z.totalProfit.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-4 border-t font-bold",children:[e.jsx("div",{children:"Total ROI:"}),e.jsxs("div",{className:"text-right",children:[z.totalROI.toFixed(2),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 font-bold",children:[e.jsx("div",{children:"Annualized ROI:"}),e.jsxs("div",{className:"text-right",children:[z.annualizedROI.toFixed(2),"%"]})]})]})]}),e.jsx(E,{children:e.jsxs(U,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"ROI Explained"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground list-disc pl-5",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Cash-on-Cash Return:"})," Annual cash flow divided by your initial investment."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Total ROI:"})," Total profit (cash flow + equity gain) as a percentage of your investment."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Annualized ROI:"})," The yearly rate of return that would give you the total ROI over the holding period."]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:[e.jsx("p",{children:"For buy-to-let investments, aim for:"}),e.jsxs("ul",{className:"list-disc pl-5 mt-2",children:[e.jsx("li",{children:"Cash-on-Cash Return: 5-8%"}),e.jsx("li",{children:"Total ROI: 40%+ over 5 years"}),e.jsx("li",{children:"Annualized ROI: 7%+"})]})]})]})})]})]})})]})},Ao=()=>{const[s,a]=o.useState(6e4),[t,r]=o.useState(0),[n,l]=o.useState(4e4),[i,j]=o.useState(500),[h,y]=o.useState(4.5),[u,g]=o.useState(25),[f,N]=o.useState(4.5),[v,I]=o.useState(null),w=()=>{const c=s+t,d=c*f,b=d+n,C=h/100/12,O=u*12,A=Math.pow(1+C,O),L=d*A*C/(A-1),z=c/12,p=L/z*100,M=(h+3)/100/12,R=Math.pow(1+M,O),$=d*R*M/(R-1);I({maxMortgage:d,maxPropertyPrice:b,monthlyPayment:L,affordabilityRatio:p,stressTestedPayment:$})};return e.jsxs(E,{className:"w-full",children:[e.jsx(B,{children:e.jsxs(Z,{className:"flex items-center text-xl font-semibold",children:[e.jsx(er,{className:"mr-2 h-5 w-5"}),"Mortgage Affordability Calculator"]})}),e.jsx(U,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Income Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"annual-income",children:"Your Annual Income"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",s.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(ve,{id:"annual-income",min:1e4,max:2e5,step:1e3,defaultValue:[s],onValueChange:c=>a(c[0])})]}),e.jsx(q,{type:"number",value:s,onChange:c=>a(Number(c.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"additional-income",children:"Additional Annual Income (e.g., partner)"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"additional-income",type:"number",value:t,onChange:c=>r(Number(c.target.value)),className:"rounded-l-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"deposit",children:"Deposit Available"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["£",n.toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(ve,{id:"deposit",min:0,max:2e5,step:5e3,defaultValue:[n],onValueChange:c=>l(c[0])})]}),e.jsx(q,{type:"number",value:n,onChange:c=>l(Number(c.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"monthly-debts",children:"Monthly Debt Payments"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center bg-muted px-3 rounded-l-md",children:"£"}),e.jsx(q,{id:"monthly-debts",type:"number",value:i,onChange:c=>j(Number(c.target.value)),className:"rounded-l-none"})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Include credit cards, loans, car finance, etc."})]}),e.jsx("h3",{className:"text-lg font-medium pt-4",children:"Mortgage Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"interest-rate",children:"Interest Rate (%)"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h,"%"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(ve,{id:"interest-rate",min:1,max:10,step:.1,defaultValue:[h],onValueChange:c=>y(c[0])})}),e.jsx(q,{type:"number",value:h,onChange:c=>y(Number(c.target.value)),className:"mt-2",step:.1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(G,{htmlFor:"mortgage-term",children:"Mortgage Term (years)"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[u," years"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(ve,{id:"mortgage-term",min:5,max:40,step:1,defaultValue:[u],onValueChange:c=>g(c[0])})}),e.jsx(q,{type:"number",value:u,onChange:c=>g(Number(c.target.value)),className:"mt-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"loan-to-income",children:"Loan to Income Multiple"}),e.jsxs(Te,{defaultValue:f.toString(),onValueChange:c=>N(Number(c)),children:[e.jsx(Ae,{id:"loan-to-income",children:e.jsx(Ee,{placeholder:"Select loan to income multiple"})}),e.jsxs(Ie,{children:[e.jsx(X,{value:"4",children:"4.0x income"}),e.jsx(X,{value:"4.5",children:"4.5x income"}),e.jsx(X,{value:"5",children:"5.0x income"}),e.jsx(X,{value:"5.5",children:"5.5x income"}),e.jsx(X,{value:"6",children:"6.0x income"})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Lenders typically offer between 4-6x your annual income"})]}),e.jsx(_,{onClick:w,className:"w-full mt-4",children:"Calculate Affordability"})]}),e.jsxs("div",{className:"space-y-6",children:[v&&e.jsxs("div",{className:"rounded-lg border p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Affordability Results"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-col items-center py-4 border-b",children:[e.jsx("div",{className:"text-muted-foreground text-sm",children:"Maximum Property Price"}),e.jsxs("div",{className:"text-3xl font-bold mt-1",children:["£",v.maxPropertyPrice.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Maximum Mortgage:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",v.maxMortgage.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Monthly Payment:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",v.monthlyPayment.toFixed(2)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-muted-foreground",children:"Affordability Ratio:"}),e.jsxs("div",{className:"text-right font-medium",children:[v.affordabilityRatio.toFixed(1),"%",e.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${v.affordabilityRatio<=35?"bg-green-100 text-green-800":v.affordabilityRatio<=45?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:v.affordabilityRatio<=35?"Good":v.affordabilityRatio<=45?"Moderate":"High"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-4 border-t",children:[e.jsx("div",{className:"text-muted-foreground",children:"Stress Tested Payment:"}),e.jsxs("div",{className:"text-right font-medium",children:["£",v.stressTestedPayment.toFixed(2)]}),e.jsx("div",{className:"col-span-2 text-xs text-muted-foreground",children:"(Monthly payment if rates increase by 3%)"})]})]})]}),e.jsx(E,{children:e.jsxs(U,{className:"pt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Lender Requirements"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground list-disc pl-5",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Affordability Ratio:"})," Most lenders prefer this to be below 35% of your gross monthly income."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Debt-to-Income Ratio:"})," Your total debt payments (including mortgage) should ideally be below 45% of income."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Stress Testing:"})," Lenders will check if you can afford payments if interest rates rise by 3%."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Deposit:"})," Higher deposits (15%+) typically secure better interest rates."]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium",children:"Additional costs to consider:"}),e.jsxs("ul",{className:"list-disc pl-5 mt-2",children:[e.jsx("li",{children:"Stamp Duty Land Tax"}),e.jsx("li",{children:"Legal fees (typically £1,000-£1,500)"}),e.jsx("li",{children:"Surveyor fees (£400-£1,500)"}),e.jsx("li",{children:"Mortgage arrangement fees (£0-£2,000)"}),e.jsx("li",{children:"Moving costs"})]})]})]})})]})]})})]})},Io=()=>(o.useEffect(()=>{console.log("Calculators page mounted - HeroSection should render")},[]),e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx("div",{className:"w-full",children:e.jsx(Se,{title:"Property Investment Calculators",subtitle:"Powerful tools to analyze investments, calculate mortgage payments, and estimate potential returns",showSearch:!1,showStats:!1,height:"h-[400px]"})}),e.jsx("div",{className:"container mx-auto px-4 py-12 mt-6",children:e.jsxs(Ze,{defaultValue:"mortgage",className:"w-full",children:[e.jsx(Xe,{className:"w-full mb-8",children:e.jsxs("div",{className:"grid w-full grid-cols-1 sm:grid-cols-3 md:grid-cols-5 gap-2",children:[e.jsx(me,{value:"mortgage",className:"w-full",children:"Mortgage"}),e.jsx(me,{value:"stampduty",className:"w-full",children:"Stamp Duty"}),e.jsx(me,{value:"yield",className:"w-full",children:"Rental Yield"}),e.jsx(me,{value:"roi",className:"w-full",children:"ROI"}),e.jsx(me,{value:"affordability",className:"w-full",children:"Affordability"})]})}),e.jsx(oe,{value:"mortgage",className:"mt-6",children:e.jsx(_o,{})}),e.jsx(oe,{value:"stampduty",className:"mt-6",children:e.jsx(ko,{})}),e.jsx(oe,{value:"yield",className:"mt-6",children:e.jsx(Co,{})}),e.jsx(oe,{value:"roi",className:"mt-6",children:e.jsx(Po,{})}),e.jsx(oe,{value:"affordability",className:"mt-6",children:e.jsx(Ao,{})})]})})]})),Gt=[{id:1,title:"UK Property Market Outlook 2024",slug:"uk-property-market-outlook-2024",summary:"Comprehensive analysis of the UK property market trends, investment opportunities, and forecasts for 2024.",content:`
      <h2>Executive Summary</h2>
      <p>The UK property market in 2024 continues to demonstrate resilience despite economic challenges. This report provides a comprehensive analysis of current trends, regional variations, and forecasts for the remainder of the year.</p>
      
      <h2>Market Overview</h2>
      <p>UK house prices have shown moderate growth of 2.3% year-on-year, with significant regional variations. The market has stabilized following the volatility of previous years, with transaction volumes returning to pre-pandemic levels.</p>
      
      <h3>Key Findings</h3>
      <ul>
        <li>Average UK house price stands at £289,950 as of May 2024</li>
        <li>Northern regions continue to outperform London and the South East</li>
        <li>First-time buyer activity has increased by 7% compared to 2023</li>
        <li>Rental yields remain robust at national average of 5.5%</li>
      </ul>
      
      <h2>Regional Analysis</h2>
      <p>The North West remains the strongest performing region with annual price growth of 4.8%. Liverpool and Manchester continue to lead with strong rental yields exceeding 7% in some areas. London has shown minimal growth at 0.2%, though prime central areas have begun to recover.</p>
      
      <h2>Investment Opportunities</h2>
      <p>Based on our analysis, we identify several key opportunity areas for property investors:</p>
      <ol>
        <li>Northern city regeneration zones, particularly in Leeds and Sheffield</li>
        <li>Commuter belt towns with improved transport links</li>
        <li>University cities with strong student rental demand</li>
        <li>Coastal locations with growing demand from remote workers</li>
      </ol>
      
      <h2>Forecast and Recommendations</h2>
      <p>We project continued moderate growth of 3-4% nationally for the remainder of 2024, with the potential for stronger performance in regional hotspots. Interest rates are expected to stabilize, potentially decreasing in Q4, which may stimulate additional market activity.</p>
      
      <p>For investors, we recommend focusing on areas with strong fundamentals: employment growth, infrastructure improvements, and demographic advantages. Diversification across regions and property types remains advisable in the current market.</p>
    `,date:"2024-05-15",author:"Property Analysis Team",authorBio:"Our Property Analysis Team consists of economists, data scientists, and real estate professionals with decades of combined experience in the UK property market.",category:"Market Analysis",readTime:"12 min read",isPremium:!0,relatedReports:[2,3],coverImage:"https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8aG91c2V8ZW58MHx8MHx8&ixlib=rb-1.2.1&w=1000&q=80"},{id:2,title:"Regional Investment Hotspots",slug:"regional-investment-hotspots",summary:"Detailed report on emerging regional investment opportunities across the UK, with focus on yields and growth potential.",content:`
      <h2>Executive Summary</h2>
      <p>This report identifies and analyzes emerging investment hotspots across UK regions, focusing on areas with strong yield potential and capital growth prospects.</p>
      
      <h2>Methodology</h2>
      <p>Our analysis combines economic data, infrastructure developments, demographic trends, and rental yield calculations to identify areas with the strongest investment potential.</p>
      
      <h2>Top Investment Locations</h2>
      <h3>1. Liverpool - Merseyside</h3>
      <p>Liverpool continues to offer some of the highest rental yields in the UK, averaging 7.2%. Regeneration projects and growing employment opportunities make this a prime investment location.</p>
      
      <h3>2. Manchester - Greater Manchester</h3>
      <p>With significant job creation in technology and media sectors, Manchester maintains strong rental demand and price growth potential. Average yields stand at 6.7%.</p>
      
      <h3>3. Leeds - West Yorkshire</h3>
      <p>Substantial infrastructure investment and a growing financial sector support Leeds' position as a key northern investment hub, with yields averaging 6.1%.</p>
      
      <h3>4. Birmingham - West Midlands</h3>
      <p>The ongoing HS2 development and city center regeneration continue to boost Birmingham's investment appeal, with rental yields of 5.5%.</p>
      
      <h3>5. Glasgow - Scotland</h3>
      <p>Offering a compelling combination of affordable property prices and strong rental demand, Glasgow presents excellent value for investors with yields around 5.8%.</p>
      
      <h2>Emerging Areas to Watch</h2>
      <p>Besides established hotspots, we've identified several emerging areas showing strong investment potential:</p>
      <ul>
        <li>Sheffield - South Yorkshire</li>
        <li>Nottingham - East Midlands</li>
        <li>Preston - Lancashire</li>
        <li>Swansea - Wales</li>
      </ul>
      
      <h2>Conclusion and Outlook</h2>
      <p>Regional cities continue to offer superior yield potential compared to London and the South East. The leveling up agenda and infrastructure improvements are likely to sustain this trend, making northern and midland cities particularly attractive for investors focused on rental returns.</p>
    `,date:"2024-04-22",author:"Investment Research Division",authorBio:"The Investment Research Division specializes in analyzing property investment trends and identifying high-potential opportunities across the UK and international markets.",category:"Investment",readTime:"15 min read",isPremium:!0,relatedReports:[1,3],coverImage:"https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8cHJvcGVydHl8ZW58MHx8MHx8&ixlib=rb-1.2.1&w=1000&q=80"},{id:3,title:"First-Time Buyer Guide 2024",slug:"first-time-buyer-guide-2024",summary:"Essential information and advice for first-time buyers navigating the property market in 2024.",content:`
      <h2>Introduction</h2>
      <p>Buying your first home is both exciting and challenging. This guide provides first-time buyers with essential information and practical advice for navigating the property market in 2024.</p>
      
      <h2>Current Market Conditions for First-Time Buyers</h2>
      <p>The 2024 market presents a mixed picture for first-time buyers. While price growth has moderated to 2.3% nationally, affordability remains challenging in many areas. However, various government schemes and competitive mortgage products designed specifically for first-time buyers offer valuable support.</p>
      
      <h2>Financial Preparation</h2>
      <h3>Saving for a Deposit</h3>
      <p>The average first-time buyer deposit currently stands at £53,000, though this varies significantly by region. We recommend:</p>
      <ul>
        <li>Setting up a dedicated savings account</li>
        <li>Considering a Lifetime ISA to benefit from government bonuses</li>
        <li>Exploring family support options including gifted deposits</li>
      </ul>
      
      <h3>Mortgage Options</h3>
      <p>Several mortgage products cater specifically to first-time buyers:</p>
      <ul>
        <li>95% LTV mortgages with government guarantees</li>
        <li>Longer-term mortgages (up to 35 years) to improve affordability</li>
        <li>Joint borrower sole proprietor mortgages for family assistance</li>
        <li>Green mortgages offering preferential rates for energy-efficient properties</li>
      </ul>
      
      <h2>Government Schemes</h2>
      <p>Several programs exist to help first-time buyers:</p>
      <ul>
        <li>First Homes scheme - discounted properties for local first-time buyers</li>
        <li>Shared Ownership - buy a portion of a property and pay rent on the remainder</li>
        <li>Help to Build - support for self-builders and custom home projects</li>
      </ul>
      
      <h2>The Buying Process</h2>
      <ol>
        <li>Establish your budget and secure a mortgage in principle</li>
        <li>Research areas and property types within your price range</li>
        <li>View properties and make an offer</li>
        <li>Instruct a solicitor and arrange surveys</li>
        <li>Exchange contracts and complete the purchase</li>
      </ol>
      
      <h2>Common Pitfalls to Avoid</h2>
      <p>First-time buyers should be aware of these common mistakes:</p>
      <ul>
        <li>Overlooking additional costs such as stamp duty, legal fees, and moving expenses</li>
        <li>Neglecting to research the local area thoroughly</li>
        <li>Skipping professional surveys to save money</li>
        <li>Stretching finances too thin without maintaining a financial cushion</li>
      </ul>
      
      <h2>Conclusion</h2>
      <p>While the process of buying your first home can seem daunting, careful preparation and the right support can make it manageable. Current market conditions offer a balanced environment for first-time buyers, with various support mechanisms available to help you take that important first step onto the property ladder.</p>
    `,date:"2024-03-10",author:"Homebuyer Advisory Team",authorBio:"Our Homebuyer Advisory Team specializes in providing practical guidance to first-time buyers and those navigating the property market.",category:"Guides",readTime:"10 min read",isPremium:!1,relatedReports:[1,2],coverImage:"https://images.unsplash.com/photo-1582268611958-ebfd161ef9cf?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8aG9tZSUyMGtleXN8ZW58MHx8MHx8&w=1000&q=80"}],Mo=()=>{const{slug:s}=sr(),{user:a,profile:t}=Q(),r=Ne(),[n,l]=o.useState(null),[i,j]=o.useState(!0),[h,y]=o.useState(!1),[u,g]=o.useState([]),f=(t==null?void 0:t.subscription_tier)!=="free";if(o.useEffect(()=>{s&&(async()=>{j(!0);try{setTimeout(()=>{const I=Gt.find(w=>w.slug===s);if(l(I||null),I!=null&&I.relatedReports){const w=Gt.filter(c=>I.relatedReports.includes(c.id)&&c.id!==I.id);g(w)}j(!1)},800)}catch(I){console.error("Error fetching report:",I),j(!1)}})()},[s]),i)return e.jsx(le,{children:e.jsx(ye,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/4 mb-8"}),e.jsx("div",{className:"h-64 bg-muted rounded mb-6"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-muted rounded"}),e.jsx("div",{className:"h-4 bg-muted rounded"}),e.jsx("div",{className:"h-4 bg-muted rounded w-5/6"})]})]})})})})});if(!n)return e.jsx(le,{children:e.jsx(ye,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[e.jsx(qe,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Report Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"The report you're looking for doesn't exist or has been removed."}),e.jsx(_,{onClick:()=>r("/research"),children:"Return to Research"})]})})})});const N=!n.isPremium||f;return e.jsxs(le,{children:[e.jsx(ye,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs(_,{variant:"outline",size:"sm",className:"mb-6",onClick:()=>r("/research"),children:[e.jsx(Za,{className:"h-4 w-4 mr-2"}),"Back to Research"]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-4",children:n.title}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),es(new Date(n.date))]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(Un,{className:"h-4 w-4 mr-1"}),n.author]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(xt,{className:"h-4 w-4 mr-1"}),n.category]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(qe,{className:"h-4 w-4 mr-1"}),n.readTime]})]}),e.jsx("div",{className:"relative aspect-[16/9] rounded-lg overflow-hidden mb-8",children:e.jsx("img",{src:n.coverImage,alt:n.title,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"text-lg mb-6",children:e.jsx("p",{className:"font-medium",children:n.summary})}),N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:n.content}}),e.jsxs("div",{className:"flex justify-between items-center mt-12 pt-6 border-t",children:[e.jsxs(_,{variant:"outline",onClick:()=>window.print(),children:[e.jsx(Va,{className:"h-4 w-4 mr-2"}),"Download PDF"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(_,{variant:"outline",size:"icon",children:e.jsx(zn,{className:"h-4 w-4"})}),e.jsx(_,{variant:"outline",size:"icon",children:e.jsx($n,{className:"h-4 w-4"})})]})]})]}):e.jsxs("div",{className:"bg-muted p-8 rounded-lg text-center my-12",children:[e.jsx(Bn,{className:"h-12 w-12 mx-auto text-primary mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Premium Content"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"This research report is available exclusively to Pro and Premium subscribers."}),e.jsx(_,{onClick:()=>y(!0),children:"Upgrade to Access"})]})]}),e.jsxs("div",{className:"border-t border-b py-6 my-8",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"About the Author"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.authorBio})]}),u.length>0&&e.jsxs("div",{className:"my-8",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Related Reports"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:u.map(v=>e.jsxs("div",{className:"border rounded-lg p-4 hover:border-primary transition-colors cursor-pointer",onClick:()=>r(`/research/reports/${v.slug}`),children:[e.jsx("h4",{className:"font-medium mb-2",children:v.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2 line-clamp-2",children:v.summary}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[e.jsx(Me,{className:"h-3 w-3 mr-1"}),es(new Date(v.date))]})]},v.id))})]})]})})}),e.jsx(qs,{isOpen:h,onClose:()=>y(!1),currentUser:a,userProfile:t})]})},Ro=Mt.object({email:Mt.string().email({message:"Please enter a valid email address"})});function To(){const{toast:s}=Ce();Ne(),Q();const[a,t]=o.useState(!1),[r,n]=o.useState(!1),[l,i]=o.useState(!1),[j,h]=o.useState(""),[y,u]=o.useState(""),[g,f]=o.useState(!1),{register:N,handleSubmit:v,formState:{errors:I}}=qn({resolver:Hn(Ro)}),w=async b=>{t(!0);try{const{error:C}=await K.from("waitlist").insert([{email:b.email,signed_up_at:new Date().toISOString()}]);C?C.code==="23505"?s({title:"You're already on the waitlist",description:"We already have your email on our waitlist. We'll notify you when you're invited to the alpha.",variant:"default"}):(console.error("Error submitting to waitlist:",C),s({title:"Submission error",description:"There was a problem adding you to the waitlist. Please try again.",variant:"destructive"})):(n(!0),s({title:"You're on the list!",description:"Thanks for joining our waitlist. We'll notify you when you're invited to the alpha.",variant:"default"}))}catch(C){console.error("Submission error:",C),s({title:"Submission error",description:"There was a problem adding you to the waitlist. Please try again.",variant:"destructive"})}finally{t(!1)}},c=async b=>{if(b.preventDefault(),!j||!y){s({title:"Missing information",description:"Please enter both email and password.",variant:"destructive"});return}try{f(!0);const{data:C,error:O}=await K.auth.signInWithPassword({email:j,password:y,options:{persistSession:!0}});if(O)throw O;s({title:"Signed in successfully",description:"Welcome to VGE Alpha.",variant:"default"}),localStorage.setItem("vge_user_authenticated","true"),localStorage.setItem("vge_auth_timestamp",Date.now().toString()),console.log("Login success, session established:",!!C.session),window.location.href="/"}catch(C){console.error("Sign in error:",C),s({title:"Authentication error",description:C.message||"There was a problem signing in. Please try again.",variant:"destructive"})}finally{f(!1)}},d=async()=>{try{const{error:b}=await K.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin+"/auth/callback",persistSession:!0}});if(b)throw b}catch(b){console.error("Google sign-in error:",b),s({title:"Authentication error",description:"There was a problem signing in with Google. Please try again.",variant:"destructive"})}};return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx("header",{className:"border-b border-border py-4 px-6",children:e.jsxs("div",{className:"container mx-auto flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"h-8 mr-2",children:e.jsx("img",{src:"/logo.svg",alt:"VGE Alpha",className:"h-full",onError:b=>{const C=b.target;C.style.display="none",C.parentElement.innerHTML+='<span class="font-bold text-2xl text-primary">VGE Alpha</span>'}})})}),e.jsx(_,{variant:"ghost",onClick:()=>i(!l),size:"sm",children:l?"Hide Developer Access":"Developer Access"})]})}),e.jsx("main",{className:"flex-grow container mx-auto px-4 py-10 flex flex-col items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-5xl grid grid-cols-1 md:grid-cols-2 gap-10 items-start",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground leading-tight",children:"Property Investment Analytics Platform"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Discover high-yield investment properties, analyze market trends, and make data-driven decisions."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(E,{className:"p-6 border-muted shadow-sm",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-foreground",children:r?"Thanks for joining our waitlist!":"Join our waitlist"}),r?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(er,{className:"h-8 w-8 text-primary"})}),e.jsx("p",{className:"text-muted-foreground",children:"We've added your email to our waitlist. We'll notify you when you're invited to try out our platform."})]}):e.jsxs("form",{onSubmit:v(w),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"email",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ha,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(q,{id:"email",placeholder:"you@example.com",className:"pl-10",autoComplete:"email",...N("email")})]}),I.email&&e.jsx("p",{className:"text-sm text-destructive",children:I.email.message})]}),e.jsxs(_,{type:"submit",className:"w-full",disabled:a,children:[a?"Submitting...":"Join Waitlist",e.jsx(Gn,{className:"ml-2 h-4 w-4"})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center mt-2",children:"We'll notify you when you're invited to our alpha release."})]})]}),l&&e.jsxs(E,{className:"p-6 border-muted bg-muted/30 shadow-sm",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 text-foreground flex items-center",children:[e.jsx(Vn,{className:"mr-2 h-5 w-5 text-yellow-500"}),"Developer Access"]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"loginEmail",children:"Email"}),e.jsx(q,{id:"loginEmail",type:"email",placeholder:"developer@vgealpha.com",autoComplete:"email",value:j,onChange:b=>h(b.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"loginPassword",children:"Password"}),e.jsx(q,{id:"loginPassword",type:"password",placeholder:"••••••••",autoComplete:"current-password",value:y,onChange:b=>u(b.target.value),required:!0})]}),e.jsx(_,{type:"submit",className:"w-full",disabled:g,children:g?"Signing in...":"Sign in with Email"})]}),e.jsxs("div",{className:"mt-4 relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-border"})}),e.jsx("div",{className:"relative flex justify-center text-xs",children:e.jsx("span",{className:"px-2 bg-muted/30 text-muted-foreground",children:"Or continue with"})})]}),e.jsx(_,{type:"button",variant:"outline",className:"w-full mt-4",onClick:d,children:"Sign in with Google"})]})]}),e.jsx("div",{className:"md:hidden mt-10",children:e.jsxs(E,{className:"p-6 border-muted",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Platform Features"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ve,{title:"Property Analytics",description:"Comprehensive analysis of potential investments",color:"bg-blue-500"}),e.jsx(Ve,{title:"Market Trends",description:"Up-to-date information on property market changes",color:"bg-green-500"}),e.jsx(Ve,{title:"Investment ROI",description:"Calculate potential returns on property investments",color:"bg-purple-500"}),e.jsx(Ve,{title:"AI Recommendations",description:"Smart suggestions based on your investment criteria",color:"bg-orange-500"})]})]})})]}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"relative rounded-lg overflow-hidden border border-border shadow-md",children:e.jsxs("div",{className:"aspect-video bg-muted p-6 flex flex-col justify-center",children:[e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-4",children:"Features"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ve,{title:"Property Analytics",description:"Comprehensive analysis of potential investments",color:"bg-blue-500"}),e.jsx(Ve,{title:"Market Trends",description:"Up-to-date information on property market changes",color:"bg-green-500"}),e.jsx(Ve,{title:"Investment ROI",description:"Calculate potential returns on property investments",color:"bg-purple-500"}),e.jsx(Ve,{title:"AI Recommendations",description:"Smart suggestions based on your investment criteria",color:"bg-orange-500"})]})]})})})]})})]})}function Ve({title:s,description:a,color:t}){return e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`${t} h-5 w-1 rounded-full mt-1`}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-foreground",children:s}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a})]})]})}function Vt(){const{title:s}=sr();return e.jsx(ql,{title:s||"Loading...",content:"Content is loading...",date:new Date().toISOString().split("T")[0]})}let Cs=!1;function ie({children:s}){const{user:a,isLoading:t}=Q(),r=Ne(),n=tr(),[l,i]=o.useState(!1);return o.useEffect(()=>{const j=localStorage.getItem("vge_user_authenticated")==="true",h=parseInt(localStorage.getItem("vge_auth_timestamp")||"0"),y=Date.now()-h<1e3*60*60;if(Cs)return;(async()=>{Cs=!0;try{if(console.log("Checking auth in PrivateRoute. User:",!!a,"Path:",n.pathname),j&&y){console.log("Local auth confirmed from waitlist login"),i(!0),Cs=!1;return}t||(a?(console.log("Auth confirmed from user context"),i(!0)):n.pathname!=="/waitlist"&&(console.log("No auth, redirecting to waitlist"),r("/waitlist",{replace:!0})))}catch(g){console.error("Error in PrivateRoute auth check:",g)}finally{Cs=!1}})()},[a,t,r,n.pathname]),(t||!l)&&!a?e.jsx(mr,{}):l||a?e.jsx(e.Fragment,{children:s}):null}function Eo(){const[s,a]=o.useState(!0),t=tr(),{user:r,profile:n,signOut:l,refreshProfile:i}=Q(),[j,h]=o.useState(!0),y=Ne();return o.useEffect(()=>{let u=!0;return t.pathname==="/waitlist"||t.pathname==="/auth/callback"?void 0:((async()=>{try{console.log("Performing initial auth check");const{data:f}=await K.auth.getSession();u&&(console.log("Initial auth check result:",!!f.session),!f.session&&t.pathname!=="/waitlist"&&y("/waitlist",{replace:!0}))}catch(f){console.error("Error in initial auth check:",f)}})(),()=>{u=!1})},[]),o.useEffect(()=>{r?(console.log("Auth state in App: User is authenticated"),localStorage.setItem("vge_user_authenticated","true"),localStorage.setItem("vge_auth_timestamp",Date.now().toString()),i&&i()):console.log("Auth state in App: User is not authenticated")},[i,r]),o.useEffect(()=>{const u=()=>a(!0),g=()=>a(!1);u();const f=setTimeout(g,100);return()=>clearTimeout(f)},[t.pathname]),o.useEffect(()=>{document.documentElement.classList.remove("dark")},[]),e.jsxs("div",{className:"min-h-screen bg-background",children:[t.pathname!=="/waitlist"&&e.jsx(ps,{isAuthenticated:!!r,userProfile:n||void 0,onSignIn:()=>{},onSignUp:()=>{},onSignOut:()=>{localStorage.removeItem("vge_user_authenticated"),localStorage.removeItem("vge_auth_timestamp"),l&&l()}}),e.jsx("main",{children:e.jsxs(Wn,{children:[e.jsx(te,{path:"/waitlist",element:e.jsx(To,{})}),e.jsx(te,{path:"/auth/callback",element:e.jsx(no,{})}),e.jsx(te,{path:"/",element:e.jsx(ie,{children:e.jsx(Xi,{})})}),e.jsx(te,{path:"/listings",element:e.jsx(ie,{children:e.jsx(So,{})})}),e.jsx(te,{path:"/deals",element:e.jsx(ie,{children:e.jsx(fo,{})})}),e.jsx(te,{path:"/trends",element:e.jsx(ie,{children:e.jsx($l,{})})}),e.jsx(te,{path:"/insights",element:e.jsx(ie,{children:e.jsx(Rl,{})})}),e.jsx(te,{path:"/calculators",element:e.jsx(ie,{children:e.jsx(Io,{})})}),e.jsx(te,{path:"/profile",element:e.jsx(ie,{children:e.jsx(Ot,{})})}),e.jsx(te,{path:"/login",element:e.jsx(Rt,{to:"/",replace:!0})}),e.jsx(te,{path:"/dashboard",element:e.jsx(ie,{children:e.jsx(il,{})})}),e.jsx(te,{path:"/pricing",element:e.jsx(ie,{children:e.jsx(ol,{})})}),e.jsx(te,{path:"/subscription/success",element:e.jsx(ie,{children:e.jsx(dl,{})})}),e.jsx(te,{path:"/subscription/cancel",element:e.jsx(ie,{children:e.jsx(ml,{})})}),e.jsx(te,{path:"/account",element:e.jsx(ie,{children:e.jsx(Ot,{})})}),e.jsx(te,{path:"/research",element:e.jsx(ie,{children:e.jsx(Zl,{})})}),e.jsx(te,{path:"/research/reports/:slug",element:e.jsx(ie,{children:e.jsx(Mo,{})})}),e.jsx(te,{path:"/blog",element:e.jsx(ie,{children:e.jsx(Ql,{})})}),e.jsx(te,{path:"/article/:title",element:e.jsx(ie,{children:e.jsx(Vt,{})})}),e.jsx(te,{path:"/blog/:slug",element:e.jsx(ie,{children:e.jsx(Vt,{})})}),e.jsx(te,{path:"/help",element:e.jsx(ie,{children:e.jsx(eo,{})})}),e.jsx(te,{path:"/property-management",element:e.jsx(ie,{children:e.jsx(oo,{})})}),e.jsx(te,{path:"/investment-opportunities",element:e.jsx(ie,{children:e.jsx(xo,{})})}),e.jsx(te,{path:"/about-us",element:e.jsx(ie,{children:e.jsx(uo,{})})}),e.jsx(te,{path:"/messages",element:e.jsx(ie,{children:e.jsx(vo,{})})}),!1,e.jsx(te,{path:"",element:e.jsx(Rt,{to:r?"/":"/waitlist",replace:!0})}),e.jsx(te,{path:"*",element:e.jsx(ul,{})})]})}),t.pathname!=="/waitlist"&&e.jsx(ro,{}),e.jsx(oi,{}),e.jsx(mi,{isAnimating:s})]})}function Lo(){return e.jsx(dr,{children:e.jsx(o.Suspense,{fallback:e.jsx(mr,{}),children:e.jsx(Eo,{})})})}Yn.TempoDevtools.init();Kn.init("phc_Pg1VGdZoazG7KyDNxnUXNZZz6zPVrGNSRtFlDnlZCcA",{api_host:"https://eu.i.posthog.com",person_profiles:"identified_only"});const Do=new Jn;Zn.createRoot(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(Xn,{client:Do,children:e.jsx(Qn,{children:e.jsx(dr,{children:e.jsx(Lo,{})})})})}));
//# sourceMappingURL=index-DxBSX7px.js.map
